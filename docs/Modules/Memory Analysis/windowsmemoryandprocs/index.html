<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Modules/Memory Analysis/windowsmemoryandprocs" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Windows内存与进程 | TryHackMe-CN</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryandprocs"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Windows内存与进程 | TryHackMe-CN"><meta data-rh="true" name="description" content="任务 1 介绍"><meta data-rh="true" property="og:description" content="任务 1 介绍"><link data-rh="true" rel="icon" href="/TryHackMe-CN/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryandprocs"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryandprocs" hreflang="en"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryandprocs" hreflang="zh"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryandprocs" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"模块","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/"},{"@type":"ListItem","position":2,"name":"内存分析","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/"},{"@type":"ListItem","position":3,"name":"Windows内存与进程","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryandprocs"}]}</script><link rel="alternate" type="application/rss+xml" href="/TryHackMe-CN/blog/rss.xml" title="TryHackMe-CN RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/TryHackMe-CN/blog/atom.xml" title="TryHackMe-CN Atom Feed"><link rel="stylesheet" href="/TryHackMe-CN/assets/css/styles.6c4c8a38.css">
<script src="/TryHackMe-CN/assets/js/runtime~main.c6e97409.js" defer="defer"></script>
<script src="/TryHackMe-CN/assets/js/main.63d06b47.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/TryHackMe-CN/img/logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/TryHackMe-CN/"><div class="navbar__logo"><img src="/TryHackMe-CN/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/TryHackMe-CN/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">TryHackMe-CN</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/TryHackMe-CN/docs/Modules/">Tutorial</a><a class="navbar__item navbar__link" href="/TryHackMe-CN/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryandprocs" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryandprocs" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh">简体中文</a></li></ul></div><a href="https://github.com/TryHackMyOffsecBox/TryHackMe-CN" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/TryHackMe-CN/docs/Modules/"><span title="模块" class="categoryLinkLabel_W154">模块</span></a><button aria-label="折叠侧边栏分类 &#x27;模块&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Attacking LLMs/"><span title="攻击大型语言模型" class="categoryLinkLabel_W154">攻击大型语言模型</span></a><button aria-label="展开侧边栏分类 &#x27;攻击大型语言模型&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Command Line/"><span title="命令行" class="categoryLinkLabel_W154">命令行</span></a><button aria-label="展开侧边栏分类 &#x27;命令行&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Container Security/"><span title="容器安全" class="categoryLinkLabel_W154">容器安全</span></a><button aria-label="展开侧边栏分类 &#x27;容器安全&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Host Evasions/"><span title="主机规避" class="categoryLinkLabel_W154">主机规避</span></a><button aria-label="展开侧边栏分类 &#x27;主机规避&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/"><span title="内存分析" class="categoryLinkLabel_W154">内存分析</span></a><button aria-label="折叠侧边栏分类 &#x27;内存分析&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/memoryanalysisintroduction"><span title="内存分析简介" class="linkLabel_WmDU">内存分析简介</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/memoryacquisition"><span title="内存获取" class="linkLabel_WmDU">内存获取</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/volatilityessentials"><span title="Volatility基础" class="linkLabel_WmDU">Volatility基础</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryandprocs"><span title="Windows内存与进程" class="linkLabel_WmDU">Windows内存与进程</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryanduseractivity"><span title="Windows内存与用户活动" class="linkLabel_WmDU">Windows内存与用户活动</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryandnetwork"><span title="Windows内存与网络" class="linkLabel_WmDU">Windows内存与网络</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Microsoft Defender XDR/"><span title="Microsoft Defender XDR" class="categoryLinkLabel_W154">Microsoft Defender XDR</span></a><button aria-label="展开侧边栏分类 &#x27;Microsoft Defender XDR&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Starters/"><span title="入门挑战" class="categoryLinkLabel_W154">入门挑战</span></a><button aria-label="展开侧边栏分类 &#x27;入门挑战&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/TryHackMe-CN/docs/Networks/"><span title="网络" class="categoryLinkLabel_W154">网络</span></a><button aria-label="展开侧边栏分类 &#x27;网络&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/TryHackMe-CN/docs/"><span title="index" class="linkLabel_WmDU">index</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/TryHackMe-CN/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/TryHackMe-CN/docs/Modules/"><span>模块</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/TryHackMe-CN/docs/Modules/Memory Analysis/"><span>内存分析</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Windows内存与进程</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Windows内存与进程</h1></header>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务-1-介绍">任务 1 介绍<a href="#任务-1-介绍" class="hash-link" aria-label="任务 1 介绍的直接链接" title="任务 1 介绍的直接链接" translate="no">​</a></h2>
<p>了解如何分析内存是取证分析师的一项基本技能。 攻击者通常完全在内存中运行其恶意软件，而不在存储设备上留下任何痕迹。 分析内存比分析存储设备稍复杂一些，需要结构化的方法。 幸运的是，像Volatility和Redline这样的工具可以帮助从内存中提取信息。 这些工具并不能自动化整个内存分析过程。 仍然需要取证分析师提取正确的信息并将其关联起来。</p>
<p>本房间是三个房间系列中的第一个。 它将指导您分析Windows主机的完整内存转储，并从中提取进程信息。 如果主机确实被入侵，您需要拼凑出攻击的范围和攻击链。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="学习目标">学习目标<a href="#学习目标" class="hash-link" aria-label="学习目标的直接链接" title="学习目标的直接链接" translate="no">​</a></h3>
<ul>
<li class="">使用Volatility从内存转储中提取进程和进程信息</li>
<li class="">分析提取的信息</li>
<li class="">报告发现结果</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="房间先决条件">房间先决条件<a href="#房间先决条件" class="hash-link" aria-label="房间先决条件的直接链接" title="房间先决条件的直接链接" translate="no">​</a></h3>
<ul>
<li class=""><a href="https://tryhackme.com/room/volatility" target="_blank" rel="noopener noreferrer" class="">Volatility</a></li>
<li class=""><a href="https://tryhackme.com/module/windows-fundamentals" target="_blank" rel="noopener noreferrer" class="">Windows基础</a>模块</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>准备好开始分析您的第一个内存转储了吗？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务2场景信息">任务2场景信息<a href="#任务2场景信息" class="hash-link" aria-label="任务2场景信息的直接链接" title="任务2场景信息的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="场景">场景<a href="#场景" class="hash-link" aria-label="场景的直接链接" title="场景的直接链接" translate="no">​</a></h3>
<p>您是处理TryHatMe公司事件的事件响应团队的一员，该公司专门在线销售帽子。 您的任务是分析一个可能被入侵的Windows主机的完整内存转储。 在您之前，另一位分析师已经获取了完整的内存转储，并从TryHatMe的IT支持团队收集了所有必要信息。 由于这是您的第一个案例，您有点紧张，但别担心；一位资深分析师将指导您。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="事件信息thm-0001">事件信息THM-0001<a href="#事件信息thm-0001" class="hash-link" aria-label="事件信息THM-0001的直接链接" title="事件信息THM-0001的直接链接" translate="no">​</a></h3>
<ul>
<li class="">2025年5月5日07:30 CET，TryHatMe启动了其事件响应计划，并将事件上报给我们。 经过初步分类，我们的团队发现了一台可能被入侵的Windows主机。 主机的详细信息如下：<!-- -->
<ul>
<li class="">主机名：WIN-001</li>
<li class="">操作系统：Windows 1022H 10.0.19045</li>
</ul>
</li>
<li class="">07:45 CET，我们的分析师Steve Stevenson获取了Windows主机的完整内存转储，并生成了哈希值以确保其完整性。 内存转储的详细信息如下：<!-- -->
<ul>
<li class="">名称：<code>THM-WIN-001_071528_07052025.dmp</code></li>
<li class="">MD5哈希：<code>78535fc49ab54fed57919255709ae650</code></li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="公司信息tryhatme">公司信息TryHatMe<a href="#公司信息tryhatme" class="hash-link" aria-label="公司信息TryHatMe的直接链接" title="公司信息TryHatMe的直接链接" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="网络拓扑图">网络拓扑图<a href="#网络拓扑图" class="hash-link" aria-label="网络拓扑图的直接链接" title="网络拓扑图的直接链接" translate="no">​</a></h4>
<p><img decoding="async" loading="lazy" alt="TryHatMe公司的网络拓扑图" src="/TryHackMe-CN/assets/images/image_20251242-204239-c8d815645075f11212bd6abd4a0ffb55.png" width="5084" height="3320" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>我已阅读案例详情，准备好了解更多信息。 </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务3-windows进程架构">任务3 Windows进程架构<a href="#任务3-windows进程架构" class="hash-link" aria-label="任务3 Windows进程架构的直接链接" title="任务3 Windows进程架构的直接链接" translate="no">​</a></h2>
<p>您可能想知道从哪里开始分析内存转储。 让我们从Windows主机上进程的关键结构的高级概述开始。 这些结构对于理解像<code>volatility</code>这样的工具从哪里提取信息至关重要。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="windows进程和线程">Windows进程和线程<a href="#windows进程和线程" class="hash-link" aria-label="Windows进程和线程的直接链接" title="Windows进程和线程的直接链接" translate="no">​</a></h3>
<p>Windows使用四种结构来创建和管理进程：</p>
<ul>
<li class=""><strong>EPROCESS</strong>是<strong>内核</strong>中进程的表示</li>
<li class=""><strong>ETHREAD</strong>是<strong>内核</strong>中线程的表示</li>
<li class=""><strong>进程环境块（PEB）<strong>保存进程范围的配置和运行时数据，位于</strong>用户空间</strong></li>
<li class=""><strong>线程环境块（TEB）<strong>保存线程特定的配置和其他信息，包括线程本地存储（TLS）、异常处理数据以及关于堆栈的信息，位于</strong>用户空间</strong></li>
</ul>
<p><img decoding="async" loading="lazy" alt="Windows进程架构" src="/TryHackMe-CN/assets/images/image_20251244-204438-f2432b45a752ba846120ec37ef7a81f5.png" width="1261" height="289" class="img_ev3q"></p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="这些结构如何关联">这些结构如何关联？<a href="#这些结构如何关联" class="hash-link" aria-label="这些结构如何关联？的直接链接" title="这些结构如何关联？的直接链接" translate="no">​</a></h4>
<p>当Windows创建一个进程时，它会执行函数<code>CreateProcess()</code>。 此函数启动进程启动，包括以下步骤：</p>
<p><img decoding="async" loading="lazy" alt="Windows进程创建流程图" src="/TryHackMe-CN/assets/images/image_20251246-204639-82c61acd9b7749a61b5552357e23b636.png" width="305" height="959" class="img_ev3q"></p>
<ol>
<li class="">内核创建一个EPROCESS和ETHREAD对象，并将它们链接在一起。 EPROCESS有一个名为<code>ThreadListHead</code>的字段，用于跟踪其所有线程</li>
<li class="">虚拟内存被初始化：<!-- -->
<ul>
<li class="">进程被分配一个虚拟地址空间（在用户模式下）
映像（EXE）被映射到内存中
为PEB和TEB分配空间
创建进程参数</li>
</ul>
</li>
<li class="">PEB和TEB被初始化。<!-- -->
<ul>
<li class="">EPROCESS包含一个指向PEB的指针</li>
<li class="">ETHREAD包含一个指向TEB的指针</li>
<li class="">TEB包含一个冗余的指向PEB的指针</li>
</ul>
</li>
<li class="">线程上下文被设置，但保持挂起状态。 此线程上下文包括：<!-- -->
<ul>
<li class="">程序的起始地址</li>
<li class="">堆栈指针</li>
<li class="">指令指针</li>
</ul>
</li>
<li class="">进程已创建，但仍处于挂起状态</li>
<li class="">进程的主线程被恢复。 这是进程的实际开始</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="您可以从这些结构中提取哪些信息">您可以从这些结构中提取哪些信息？<a href="#您可以从这些结构中提取哪些信息" class="hash-link" aria-label="您可以从这些结构中提取哪些信息？的直接链接" title="您可以从这些结构中提取哪些信息？的直接链接" translate="no">​</a></h3>
<p>像<code>volatility</code>这样的工具理解进程的架构，可以从这些结构中提取并关联数据。 特定的<code>volatility</code>模块将针对这些结构的某些字段。 下面，您可以找到每个结构的有趣字段概述。 <strong>注意：仅列出了每个结构的相关字段。 其他字段已被省略。</strong></p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="eprocess">EPROCESS<a href="#eprocess" class="hash-link" aria-label="EPROCESS的直接链接" title="EPROCESS的直接链接" translate="no">​</a></h4>
<p>以下<code>volatility</code>插件从EPROCESS提取信息：<code>pslist</code>、<code>pstree</code>、<code>psscan</code>、<code>malfind</code>、<code>getsids</code>、<code>handles</code>、<code>dlllist</code>、<code>cmdline</code>、<code>envars</code>和<code>ldrmodules</code>。 在下面的终端中，您可以找到这些模块针对的字段：</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">EPROCESS STRUCTURE</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">_EPROCESS</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HANDLE UniqueProcessId</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// PID (Process ID) </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LIST_ENTRY ActiveProcessLinks</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Link in active process list (Used to keep track of all active processes) </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UCHAR ImageFileName</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Short process name LARGE_INTEGER CreateTime; // Process creation time </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LARGE_INTEGER ExitTime</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Exit time if terminated </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PPEB Peb</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Pointer to user-mode PEB </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HANDLE InheritedFromUniqueProcessId</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Parent PID </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LIST_ENTRY ThreadListHead</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// List of ETHREADs </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PHANDLE_TABLE ObjectTable</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Handle table (points to opened files) </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID SectionObject</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Executable image mapping </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID VadRoot</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// VAD tree for memory mapping PACCESS_TOKEN Token; // Security information </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="ethread">ETHREAD<a href="#ethread" class="hash-link" aria-label="ETHREAD的直接链接" title="ETHREAD的直接链接" translate="no">​</a></h4>
<p>以下<code>volatility</code>插件从ETHREAD提取信息：<code>threads</code>、<code>ldrmodules</code>、<code>apihooks</code>和<code>malfind</code>。 在下面的终端中，您可以找到这些模块针对的字段：</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">THREAD STRUCTURE</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">_ETHREAD</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CLIENT_ID Cid</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Thread and Process IDs </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LARGE_INTEGER CreateTime</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Thread creation time </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LARGE_INTEGER ExitTime</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Thread exit time </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID StartAddress</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Kernel-level entry point </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID Win32StartAddress</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// User-mode entry point </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LIST_ENTRY ThreadListEntry</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Link in EPROCESS&#x27;s thread list </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PTEB Teb</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Pointer to TEB </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ULONG ThreadState</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Thread execution state </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ULONG WaitReason</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Reason for being blocked </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="peb">PEB<a href="#peb" class="hash-link" aria-label="PEB的直接链接" title="PEB的直接链接" translate="no">​</a></h4>
<p>以下<code>volatility</code>插件从进程环境块提取信息：<code>cmdline</code>、<code>envars</code>、<code>ldrmodules</code>和<code>malfind</code>。 在下面的终端中，您可以找到这些模块针对的字段：</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">PEB STRUCTURE</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">_PEB</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BOOLEAN BeingDebugged</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Debug flag</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID ImageBaseAddress</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Base address of executable </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PPEB_LDR_DATA Ldr</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Loader data (DLLs) </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PRTL_USER_PROCESS_PARAMETERS ProcessParameters</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">// Command-line, environment variables</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ULONG NtGlobalFlag</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Debugging heap flags </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID ProcessHeap</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Default process heap </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="teb">TEB<a href="#teb" class="hash-link" aria-label="TEB的直接链接" title="TEB的直接链接" translate="no">​</a></h4>
<p>以下<code>volatility</code>插件从线程环境块提取信息：<code>threads</code>和<code>malfind</code>。 在下面的终端中，您可以找到这些模块针对的字段：</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">TEB STRUCTURE</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">_TEB</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID EnvironmentPointer</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Pointer to env block </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CLIENT_ID ClientId</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Thread + Process IDs </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID ThreadLocalStoragePointer</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// TLS base </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PPEB ProcessEnvironmentBlock</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Pointer to PEB </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ULONG LastErrorValue</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Last error value </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID StackBase</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Upper bound of thread stack </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID StackLimit</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Lower bound of thread stack </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID Win32ThreadInfo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// GUI subsystem data </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>哪个字段用于跟踪所有活动进程？ 仅输入字段名称。 </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ActiveProcessLinks</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 哪个字段用于存储进程的PID？ 仅输入字段名称。 </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">UniqueProcessId</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务4-新内存转储的初步分析">任务4 新内存转储的初步分析<a href="#任务4-新内存转储的初步分析" class="hash-link" aria-label="任务4 新内存转储的初步分析的直接链接" title="任务4 新内存转储的初步分析的直接链接" translate="no">​</a></h2>
<p>你在上一个任务中复习了Windows内存和进程的知识。 你已经准备好应对分析所提供内存转储的有趣挑战了。 在此任务中，你将启动分析虚拟机并验证内存转储的哈希值。 然后，你将使用 <code>volatility</code> 继续提取内存转储中的进程。 之后，你将分析结果并寻找可疑进程。 最后，你将记录你的发现。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="环境与设置">环境与设置<a href="#环境与设置" class="hash-link" aria-label="环境与设置的直接链接" title="环境与设置的直接链接" translate="no">​</a></h3>
<p>在你的调查过程中，你将使用一个安装了内存分析工具 <code>volatility</code> 版本3的Ubuntu Desktop主机。 我们已将完整命令（python3 vol.py）的别名设置为 <code>vol3</code> 来启动 <code>volatility</code>。 现在点击此任务顶部的 <code>启动机器</code> 按钮来启动虚拟机。 虚拟机将以分屏视图启动。 如果它没有显示出来，你可以按页面顶部的 <code>显示分屏视图</code> 按钮。</p>
<p>Ubuntu Desktop的默认安装附带了一些命令行工具，它们可以补充 <code>volatility</code> 并允许你更详细地解析分析结果。 这些工具包括 <code>strings</code>、<code>diff</code>、<code>grep</code>、<code>comm</code>、<code>awk</code> 等。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="验证内存转储">验证内存转储<a href="#验证内存转储" class="hash-link" aria-label="验证内存转储的直接链接" title="验证内存转储的直接链接" translate="no">​</a></h3>
<p>在分析虚拟机上打开一个shell并导航到 <code>/home/ubuntu</code>。 然后使用 <code>md5sum</code> 命令计算内存转储的MD5哈希值。 <strong>注意：你不需要输入此命令。 我们已经为你预先计算好了哈希值。 由于资源有限，计算MD5哈希值可能需要长达五分钟。</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Calculate MD5 Hash</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ md5sum THM-WIN-001_071528_07052025.mem </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> newhash.txt</span><br></span></code></pre></div></div>
<p>然后，将新计算的哈希值与从进行内存获取的同事那里收到的哈希值进行比较：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Compare Hashes</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">diff</span><span class="token plain"> acquisitionhash.txt newhash.txt</span><br></span></code></pre></div></div>
<p>如果上述命令没有显示输出，则哈希值相同。 现在你已经验证了内存转储的完整性，可以继续提取其内容了。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="提取进程">提取进程<a href="#提取进程" class="hash-link" aria-label="提取进程的直接链接" title="提取进程的直接链接" translate="no">​</a></h3>
<p><code>volatility</code> 附带多个模块，可以帮助你提取进程及其信息：</p>
<ul>
<li class=""><code>windows.pslist</code>：提取<strong>内存转储时处于活动状态的进程</strong>列表</li>
<li class=""><code>windows.psscan</code>：提取<strong>所有进程对象</strong>，包括已终止和已解除链接的进程</li>
<li class=""><code>windows.pstree</code>：提取<strong>内存转储时处于活动状态的进程</strong>列表，并可视化它们之间的父子关系</li>
<li class=""><code>windows.psxview</code>：使用多种进程检测技术来收集有关进程、线程、进程结构和句柄的信息，然后交叉引用和比较这些信息。</li>
</ul>
<p>导航到虚拟机并打开一个终端。 现在，输入以下命令从内存转储中提取活动进程并将其保存到文本文件中。 <strong>注意：由于内存转储的大小和资源有限，命令可能需要长达一分钟才能完成运行。</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Extract Processes</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ vol3 </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> THM-WIN-001_071528_07052025.mem windows.pslist </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> pslist.txt</span><br></span></code></pre></div></div>
<p>现在，使用 <code>cat</code> 命令显示 <code>pslist.txt</code> 的内容并分析输出。 这里有一个提示：将输出通过管道传递给 <code>less</code> 命令以获得可滚动的输出。 然后你可以<strong>按空格键滚动浏览输出</strong>。 你可以按 <code>q</code> 键退出。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Display Extracted Processes</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> pslist.txt </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">less</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> Framework </span><span class="token number" style="color:#36acaa">2.26</span><span class="token plain">.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PID </span><span class="token environment constant" style="color:#36acaa">PPID</span><span class="token plain"> ImageFileName Offset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">V</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> Threads Handles SessionId Wow64 CreateTime ExitTime File output</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">   System         0x990b2366a040 </span><span class="token number" style="color:#36acaa">138</span><span class="token plain"> - N/A False </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:48.000000 UTC N/A Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">92</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">   Registry       0x990b236dc080 </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> - N/A False </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:44.000000 UTC N/A Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">324</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">   smss.exe       0x990b2680e040 </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> - N/A False </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:48.000000 UTC N/A Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">440</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">420</span><span class="token plain"> csrss.exe      0x990b26cf0140 </span><span class="token number" style="color:#36acaa">12</span><span class="token plain"> - </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> False </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:48.000000 UTC N/A Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">516</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">508</span><span class="token plain"> csrss.exe      0x990b274bd080 </span><span class="token number" style="color:#36acaa">13</span><span class="token plain"> - </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> False </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:48.000000 UTC N/A Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">524</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">420</span><span class="token plain"> wininit.exe    0x990b2758a140 </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> - </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> False </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:48.000000 UTC N/A Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">592</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">508</span><span class="token plain"> winlogon.exe   0x990b275c00c0 </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> - </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> False </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:48.000000 UTC N/A Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED FOR READABILITY</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="大海捞针">大海捞针<a href="#大海捞针" class="hash-link" aria-label="大海捞针的直接链接" title="大海捞针的直接链接" translate="no">​</a></h3>
<p>你正在寻找与以下任一指标匹配的可疑进程：</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="可疑名称">可疑名称<a href="#可疑名称" class="hash-link" aria-label="可疑名称的直接链接" title="可疑名称的直接链接" translate="no">​</a></h4>
<p>攻击者喜欢使用域名抢注来伪装成合法进程。 例如：</p>
<ul>
<li class=""><code>scvhost.exe</code> 而不是 <code>svchost.exe</code></li>
<li class=""><code>explorere.exe</code> 而不是 <code>explorer.exe</code></li>
<li class=""><code>lsasss.exe</code> 而不是 <code>lsass.exe</code></li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="可疑路径">可疑路径<a href="#可疑路径" class="hash-link" aria-label="可疑路径的直接链接" title="可疑路径的直接链接" translate="no">​</a></h4>
<p>攻击者会使用与合法进程相同的进程名称，但这些进程位于不寻常的路径中。 例如：</p>
<ul>
<li class=""><code>svchost.exe</code> 从 <code>C:\Users\analyst\</code> 启动，而不是从 <code>C:\Windows\System32\</code></li>
<li class=""><code>cmd.exe</code> 从 <code>C:\TMP\</code> 启动，而不是从 <code>C:\Windows\System32\</code></li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="伪装">伪装<a href="#伪装" class="hash-link" aria-label="伪装的直接链接" title="伪装的直接链接" translate="no">​</a></h4>
<p>攻击者会使用模仿进程和系统服务的进程名称。 例如：</p>
<ul>
<li class=""><code>dockerupdater.exe</code></li>
<li class=""><code>defenderAV.exe</code></li>
<li class=""><code>pdfupdateservice.exe</code></li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="与基线比较">与基线比较<a href="#与基线比较" class="hash-link" aria-label="与基线比较的直接链接" title="与基线比较的直接链接" translate="no">​</a></h3>
<p>有时很难区分合法进程和恶意进程。 幸运的是，上一段中的进程列表并不那么广泛，但如果是的话，你可以使用以下方法来缩小需要检查的进程数量：</p>
<ul>
<li class="">确保你有一个在正常情况下主机上运行的进程基线。 例如，在正常工作时间</li>
<li class="">将 <code>windows.pslist</code> 输出与基线进行比较，以获得未包含在基线中的进程的候选列表</li>
<li class="">通过将进程与更新软件时运行的常见进程候选列表进行比较来过滤进程。 你可以检查任务计划程序来找到这些进程</li>
<li class="">调查剩余的进程</li>
</ul>
<p>继续在虚拟机中操作，输入以下命令将 <code>pslist.txt</code> 文件与位于 <code>~\baseline\</code> 的 <code>baseline.txt</code> 文件进行比较（注意：基线文件是从任务管理器中提取的，因此你需要先准备它）：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Comparing with Baseline</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">awk</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;NR &gt;3{print $2}&#x27;</span><span class="token plain"> baseline/baseline.txt </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sort</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">uniq</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> baseline_procs.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">awk</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;NR &gt;3{print $3}&#x27;</span><span class="token plain"> pslist.txt </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sort</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">uniq</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> current_procs.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">comm</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-13</span><span class="token plain"> baseline_procs.txt current_procs.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED FOR READABILITY</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WINWORD.EXE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ai.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">audiodg.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cmd.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fontdrvhost.ex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msdtc.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pdfupdater.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">smartscreen.ex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sppsvc.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">updater.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">userinit.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vm3dservice.ex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vmtoolsd.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">windows-update</span><br></span></code></pre></div></div>
<p>上面终端中包括 <code>awk</code> 的前两行准备要比较的文件：</p>
<ul>
<li class=""><code>awk &#x27;NR &gt;3{print $2}&#x27;</code> 将文件内容按列划分，排除前3行，然后打印第n列作为输出</li>
<li class=""><code>sort</code> 对从 <code>awk</code> 命令传递过来的值进行排序</li>
<li class=""><code>uniq &gt; *.txt</code> 过滤掉重复项，然后将数据保存到文本文件</li>
</ul>
<p><code>comm</code> 命令比较每个准备好的文件的内容并输出差异。 设置了标志 <code>-13</code>，以便只显示 <code>current_procs.txt</code> 中独有的进程。</p>
<p>上面终端中列出的结果需要先进行解释。 其中包含的一些进程是误报。 例如，这些是：</p>
<ul>
<li class="">在捕获基线时未运行的合法进程</li>
<li class=""><code>ImageFileName</code> 字段过长并被截断的进程。 此字段最多只能容纳16个字节。</li>
</ul>
<p>知道哪些进程是误报需要进行一些额外的研究。 以下进程已进入你的候选列表：</p>
<ul>
<li class=""><code>pdfupdater.exe</code></li>
<li class=""><code>windows-update.exe</code></li>
<li class=""><code>updater.exe</code></li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="分析笔记和后续步骤">分析笔记和后续步骤<a href="#分析笔记和后续步骤" class="hash-link" aria-label="分析笔记和后续步骤的直接链接" title="分析笔记和后续步骤的直接链接" translate="no">​</a></h3>
<p>你已经找到了三个需要进一步分析的可疑进程。 下表概述了这些可疑进程。</p>
<table><thead><tr><th style="text-align:left">ImageFileName</th><th style="text-align:left">PID</th><th style="text-align:left">时间戳</th></tr></thead><tbody><tr><td style="text-align:left">pdfupdater.exe</td><td style="text-align:left">3392</td><td style="text-align:left">2025-05-07 07:13:05.000000</td></tr><tr><td style="text-align:left">windows-update.exe</td><td style="text-align:left">10084</td><td style="text-align:left">2025-05-07 07:13:05.000000</td></tr><tr><td style="text-align:left">updater.exe</td><td style="text-align:left">10032</td><td style="text-align:left">2025-05-07 07:13:56.000000</td></tr></tbody></table>
<p>继续下一个任务，看看这些进程是否相互关联或与其他进程关联。 这可能帮助您发现其他最初不可疑但在新上下文中变得可疑的进程。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 拥有12个线程的csrss.exe进程的PID是什么？ 您可以使用<code>pslist.txt</code>文件来找到答案。 </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">440</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> PID为5672的进程的（内存）偏移量(V)是什么？ 您可以使用<code>pslist.txt</code>文件来找到答案。 </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">0x990b29293080</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务5-关联进程">任务5 关联进程<a href="#任务5-关联进程" class="hash-link" aria-label="任务5 关联进程的直接链接" title="任务5 关联进程的直接链接" translate="no">​</a></h2>
<p>在之前的任务中，您发现了多个独立的可疑进程。 在深入挖掘这些进程的内存之前，您应该首先揭示这些进程与其他进程之间是否存在任何关联。 这将帮助您找到其他潜在的可疑进程。 下面的终端显示了恶意进程树可能的样子：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">explorer.exe </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">PID: </span><span class="token number" style="color:#36acaa">1500</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── cmd.exe </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">PID: </span><span class="token number" style="color:#36acaa">2200</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                  ← Triggered by malicious LNK </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └── powershell.exe </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">PID: </span><span class="token number" style="color:#36acaa">2210</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">       ← Downloads and executes the payload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        └── svchost.exe </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">PID: </span><span class="token number" style="color:#36acaa">2220</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">      ← Masquerades as a system process</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            └── asyncrat.exe </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">PID: </span><span class="token number" style="color:#36acaa">2230</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> ← Remote Access Trojan </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">C2 beaconing</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>上面的示例是一个攻击链，其中asyncrat（一种常见的远程访问木马）在用户点击恶意LNK文件后被部署。 LNK文件生成一个命令行<code>cmd.exe</code>，然后启动PowerShell以下载并执行有效负载。 PowerShell反过来使用svchost.exe伪装成系统进程并生成<code>asyncrat.exe</code>。</p>
<p>继续使用虚拟机，输入以下命令以生成显示内存转储进程父子关系的树结构。 <strong>注意：由于内存转储的大小和资源有限，命令可能需要长达一分钟才能完成运行。</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Show Process Tree</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ vol3 </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> THM-WIN-001_071528_07052025.mem windows.pstree </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> processtree.txt</span><br></span></code></pre></div></div>
<p>使用<code>cat</code>命令显示的输出相当庞大。 您可以使用<code>cut</code>命令处理<code>processtree.txt</code>文件，仅显示PID、PPID和映像名称值。 输入以下命令来完成此操作：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Parse Process Tree</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">cut</span><span class="token plain"> -d</span><span class="token string" style="color:#e3116c">$&#x27;</span><span class="token string entity" style="color:#36acaa">\t</span><span class="token string" style="color:#e3116c">&#x27;</span><span class="token plain"> -f1,2,3 processtree.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PID             </span><span class="token environment constant" style="color:#36acaa">PPID</span><span class="token plain">    ImageFileName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">592</span><span class="token plain">             </span><span class="token number" style="color:#36acaa">508</span><span class="token plain">     winlogon.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* </span><span class="token number" style="color:#36acaa">5232</span><span class="token plain">          </span><span class="token number" style="color:#36acaa">592</span><span class="token plain">     userinit.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">** </span><span class="token number" style="color:#36acaa">5672</span><span class="token plain">         </span><span class="token number" style="color:#36acaa">5232</span><span class="token plain">    explorer.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*** </span><span class="token number" style="color:#36acaa">5952</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">5672</span><span class="token plain">    cmd.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**** </span><span class="token number" style="color:#36acaa">3144</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">5952</span><span class="token plain">    conhost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*** </span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">5672</span><span class="token plain">    WINWORD.EXE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**** </span><span class="token number" style="color:#36acaa">3392</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    pdfupdater.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">***** </span><span class="token number" style="color:#36acaa">2576</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">3392</span><span class="token plain">    conhost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">***** </span><span class="token number" style="color:#36acaa">10084</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">3392</span><span class="token plain">    windows-update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">****** </span><span class="token number" style="color:#36acaa">10032</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">10084</span><span class="token plain">   updater.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">******* </span><span class="token number" style="color:#36acaa">432</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">10032</span><span class="token plain">   cmd.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">******** </span><span class="token number" style="color:#36acaa">4592</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">432</span><span class="token plain">     conhost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">******** </span><span class="token number" style="color:#36acaa">6984</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">432</span><span class="token plain">     powershell.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**** </span><span class="token number" style="color:#36acaa">3932</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    ai.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*** </span><span class="token number" style="color:#36acaa">8936</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">5672</span><span class="token plain">    SecurityHealth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*** </span><span class="token number" style="color:#36acaa">9096</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">5672</span><span class="token plain">    msedge.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**** </span><span class="token number" style="color:#36acaa">8100</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">9096</span><span class="token plain">    msedge.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**** </span><span class="token number" style="color:#36acaa">9164</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">9096</span><span class="token plain">    msedge.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**** </span><span class="token number" style="color:#36acaa">3500</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">9096</span><span class="token plain">    msedge.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**** </span><span class="token number" style="color:#36acaa">7408</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">9096</span><span class="token plain">    msedge.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**** </span><span class="token number" style="color:#36acaa">9264</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">9096</span><span class="token plain">    msedge.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**** </span><span class="token number" style="color:#36acaa">4152</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">9096</span><span class="token plain">    msedge.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**** </span><span class="token number" style="color:#36acaa">7420</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">9096</span><span class="token plain">    msedge.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<p>为便于阅读，上述结果已进行编辑。 显示的结果包括您在之前任务中发现的相关进程。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="观察结果">观察结果<a href="#观察结果" class="hash-link" aria-label="观察结果的直接链接" title="观察结果的直接链接" translate="no">​</a></h3>
<p>现在定位您在任务3期间注意到的进程，并检查它们是否与其他进程相关。 从WINWORD.exe进程开始，您可以看到清晰的树结构。 我们将树转换为ASCII树结构以更清晰地显示。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PID         </span><span class="token environment constant" style="color:#36acaa">PPID</span><span class="token plain">    IMAGENAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">5672</span><span class="token plain">    WINWORD.EXE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── </span><span class="token number" style="color:#36acaa">3392</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    pdfupdater.exe    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── </span><span class="token number" style="color:#36acaa">2576</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">3392</span><span class="token plain">    conhost.exe    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └── </span><span class="token number" style="color:#36acaa">10084</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">3392</span><span class="token plain">    windows-update        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        └── </span><span class="token number" style="color:#36acaa">10032</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">10084</span><span class="token plain">   updater.exe            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            └── </span><span class="token number" style="color:#36acaa">432</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">10032</span><span class="token plain">   cmd.exe                </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ├── </span><span class="token number" style="color:#36acaa">4592</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">432</span><span class="token plain">     conhost.exe                </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                └── </span><span class="token number" style="color:#36acaa">6984</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">432</span><span class="token plain">     powershell.exe</span><br></span></code></pre></div></div>
<p>现在从底部开始记录观察结果：</p>
<ul>
<li class="">进程<code>powershell.exe</code>，其PID为... 其PPID为...</li>
<li class="">进程<code>conhost.exe</code>，其PID为... 其PPID为...</li>
<li class="">与PPID ...关联的进程 是<code>cmd.exe</code>，其PID为...</li>
<li class="">依此类推</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="分析笔记和后续步骤-1">分析笔记和后续步骤<a href="#分析笔记和后续步骤-1" class="hash-link" aria-label="分析笔记和后续步骤的直接链接" title="分析笔记和后续步骤的直接链接" translate="no">​</a></h3>
<table><thead><tr><th style="text-align:left">ImageFileName</th><th style="text-align:left">PID</th><th style="text-align:left">PPID</th><th style="text-align:left">时间戳</th></tr></thead><tbody><tr><td style="text-align:left">WINWORD.EXE</td><td style="text-align:left">5252</td><td style="text-align:left">5672</td><td style="text-align:left">2025-05-07 07:13:04.000000</td></tr><tr><td style="text-align:left">pdfupdater.exe</td><td style="text-align:left">3392</td><td style="text-align:left">5252</td><td style="text-align:left">2025-05-07 07:13:05.000000</td></tr><tr><td style="text-align:left">conhost.exe</td><td style="text-align:left">2576</td><td style="text-align:left">3392</td><td style="text-align:left">2025-05-07 07:13:05.000000</td></tr><tr><td style="text-align:left">windows-update.exe</td><td style="text-align:left">10084</td><td style="text-align:left">3392</td><td style="text-align:left">2025-05-07 07:13:05.000000</td></tr><tr><td style="text-align:left">updater.exe</td><td style="text-align:left">10032</td><td style="text-align:left">10084</td><td style="text-align:left">2025-05-07 07:13:56.000000</td></tr><tr><td style="text-align:left">cmd.exe</td><td style="text-align:left">432</td><td style="text-align:left">10032</td><td style="text-align:left">2025-05-07 07:14:36.000000</td></tr><tr><td style="text-align:left">conhost.exe</td><td style="text-align:left">4592</td><td style="text-align:left">432</td><td style="text-align:left">2025-05-07 07:14:36.000000</td></tr><tr><td style="text-align:left">powershell.exe</td><td style="text-align:left">6984</td><td style="text-align:left">432</td><td style="text-align:left">2025-05-07 07:14:39.000000</td></tr></tbody></table>
<p>从观察结果（见上表）中，我们可以得出结论：<code>updater.exe</code>进程是<code>windows-update.exe</code>的子进程，而<code>windows-update.exe</code>是<code>pdfupdater.exe</code>的子进程。 <code>pdfupdater.exe</code>进程是<code>WINWORD.exe</code>的子进程。 这个进程链看起来相当可疑：</p>
<ul>
<li class="">其中多个进程的名称中包含<code>update</code></li>
<li class=""><code>WINDWORD.exe</code>进程启动了<code>pdfupdater.exe</code>进程。 这意味着Microsoft Word正在更新一个与PDF相关的工具</li>
<li class="">然后<code>pdfupdater.exe</code>进程启动了<code>windows-update.exe</code>。 一个更新某个软件的工具不太可能同时启动<code>windows-update.exe</code>进程来更新Windows操作系统</li>
<li class="">最重要的是，<code>windows-update.exe</code>进程启动了<code>updater.exe</code>进程，这似乎暗示了又一次更新</li>
<li class=""><code>conhost.exe</code>进程的存在也表明这些进程似乎启动了网络连接</li>
</ul>
<p>仔细观察这些观察结果和备注，并将其与事实信息（如Windows、PDF工具和Microsoft Word更新过程的工作原理及其合法进程名称）进行比较，您可以得出结论：这个进程链极有可能是恶意的。</p>
<p>既然您已经发现了一个潜在的恶意链，您必须深入挖掘。 继续下一个任务，以发现已终止和隐藏的进程，并分析本任务中发现的可疑进程。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> services.exe（PID 664）进程的父ID（PPID）是什么？ 使用processtree.txt文件来回答问题。 </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">524</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 拥有PID 7788的进程的映像文件名是什么？ 使用processtree.txt文件来回答问题。 </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FTK Imager.exe</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务6-深入挖掘">任务6 深入挖掘<a href="#任务6-深入挖掘" class="hash-link" aria-label="任务6 深入挖掘的直接链接" title="任务6 深入挖掘的直接链接" translate="no">​</a></h2>
<p>到目前为止，您一直专注于发现和关联属于活动内存的进程。 <code>volatility</code>还可以扫描最近被终止、取消链接或被攻击者隐藏的进程。 攻击者经常采用不同的技术来隐藏进程、线程、驱动程序和注册表项。 您可以使用<code>volatitlity</code>模块<code>windows.psscan</code>和<code>windows.psxview</code>来获取所有进程结构的概览，包括那些不在活动进程链接结构中的进程。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="psscan">PSSCAN<a href="#psscan" class="hash-link" aria-label="PSSCAN的直接链接" title="PSSCAN的直接链接" translate="no">​</a></h3>
<p>继续使用虚拟机，输入下面显示的命令以扫描不属于活动进程列表的进程。 <strong>注意：由于内存转储的大小和资源有限，命令完成运行可能需要长达三分钟。</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">PSSCAN</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ vol3 </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> THM-WIN-001_071528_07052025.mem windows.psscan </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> psscan.txt</span><br></span></code></pre></div></div>
<p>您可以将<code>psscan</code>的结果与<code>pslist</code>的结果进行比较，以发现隐藏的进程。 在比较之前，您首先需要准备输出文件。 输入以下命令以从<code>psscan.txt</code>和<code>pslist.txt</code>文件中提取PID和进程名称，并将输出保存到新文件。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Prepare Files</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">awk</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;{print $1,$3}&#x27;</span><span class="token plain"> pslist.txt </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sort</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> pslist_processed.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">awk</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;{print $1,$3}&#x27;</span><span class="token plain"> psscan.txt </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sort</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> psscan_processed.txt</span><br></span></code></pre></div></div>
<p>然后，您可以比较两个文件以发现隐藏的进程：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Prepare Files</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">comm</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-23</span><span class="token plain"> psscan_processed.txt pslist_processed.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5548</span><span class="token plain"> sihost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5592</span><span class="token plain"> svchost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5736</span><span class="token plain"> svchost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5748</span><span class="token plain"> svchost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5752</span><span class="token plain"> taskhostw.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5828</span><span class="token plain"> svchost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5908</span><span class="token plain"> svchost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5972</span><span class="token plain"> ctfmon.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">8708</span><span class="token plain"> svchost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">9040</span><span class="token plain"> vmtoolsd.exe</span><br></span></code></pre></div></div>
<p>此比较的结果是良性的。 所有列出的进程都是在Windows主机上运行的常见进程。 例如，<code>svchost.exe</code> 是一个托管和运行 Windows 服务的常见进程。 您可以进行一些检查来验证 <code>svchost.exe</code> 确实是良性的：</p>
<ul>
<li class="">检查映像路径：如果它不在 <code>C:\Windows\System32\</code> 中，则很可疑</li>
<li class="">检查为此进程加载的 DLL：攻击者可以使用进程空洞化或 DLL 注入等技术来破坏合法进程</li>
<li class="">检查进程是否仍有活动线程：如果它有活动线程但未出现在 <code>pslist</code> 结果中，则很可疑。 可能是攻击者隐藏了该进程</li>
<li class="">如果活动进程没有任何线程，则被视为可疑。 每个活动进程应至少拥有 1 个线程。 攻击者可以使用技术来改变线程</li>
<li class="">检查 <code>Exit Time</code>：如果进程确实已终止，它应显示一个 <code>Exit Time</code>。 如果仍有与该进程关联的活动或孤立线程，则很可疑。</li>
<li class="">转储进程内存并进一步分析</li>
</ul>
<p>您稍后将探索其中一些检查。
PSXVIEW</p>
<p>现在，运行 windows.psxview 模块。 windows.psxview 是一种在一次操作中进行多项测试并交叉引用结果的好方法。 您应查找未在 pslist 结果中列出但在其他测试中列出的进程。 输入以下命令以运行 windows.psxview 模块。 注意：由于内存转储的大小和资源有限，命令完成运行可能需要长达三分钟。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="psxview">PSXVIEW<a href="#psxview" class="hash-link" aria-label="PSXVIEW的直接链接" title="PSXVIEW的直接链接" translate="no">​</a></h3>
<p>现在，运行 <code>windows.psxview</code> 模块。 <code>windows.psxview</code> 是一种在一次操作中进行多项测试并交叉引用结果的好方法。 您应查找未在 <code>pslist</code> 结果中列出但在其他测试中列出的进程。 输入以下命令以运行 <code>windows.psxview</code> 模块。 <strong>注意：由于内存转储的大小和资源有限，命令完成运行可能需要长达三分钟。</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">PSXVIEW</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ vol3 </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> THM-WIN-001_071528_07052025.mem windows.psxview </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> psxview.txt</span><br></span></code></pre></div></div>
<p>然后，您可以使用 <code>awk</code> 过滤结果并显示 <code>pslist</code> 测试等于 false 的所有行，如下所示：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Filter Results</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">awk</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;NR==3 || $4 == &quot;False&quot;&#x27;</span><span class="token plain"> psxview.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Offset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Virtual</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> Name            PID     pslist  psscan  thrdscan  csrss   Exit Time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xac80001ca080  svchost.exe     </span><span class="token number" style="color:#36acaa">5828</span><span class="token plain">    False   True    False     False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xac8000083080  svchost.exe     </span><span class="token number" style="color:#36acaa">5592</span><span class="token plain">    False   True    False     False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xac80000b90c0  vmtoolsd.exe    </span><span class="token number" style="color:#36acaa">9040</span><span class="token plain">    False   True    False     False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xac8000084080  svchost.exe     </span><span class="token number" style="color:#36acaa">5748</span><span class="token plain">    False   True    False     False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xac80001c6080  svchost.exe     </span><span class="token number" style="color:#36acaa">5908</span><span class="token plain">    False   True    False     False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xac80001d2080  ctfmon.exe      </span><span class="token number" style="color:#36acaa">5972</span><span class="token plain">    False   True    False     False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xac8000030080  svchost.exe     </span><span class="token number" style="color:#36acaa">5736</span><span class="token plain">    False   True    False     False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xac80000a1080  sihost.exe      </span><span class="token number" style="color:#36acaa">5548</span><span class="token plain">    False   True    False     False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x990b29bef080  svchost.exe     </span><span class="token number" style="color:#36acaa">8708</span><span class="token plain">    False   True    False     False   </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:13:16+00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xac8000031080  taskhostw.exe   </span><span class="token number" style="color:#36acaa">5752</span><span class="token plain">    False   True    False     False</span><br></span></code></pre></div></div>
<p>上面终端中的输出没有显示任何可能暗示攻击者隐藏恶意进程的明显内容。 然而，您永远无法 100% 确定。 如果您仍然对列出的进程感到怀疑，请应用 <strong>psscan 部分</strong> 中列出的相同检查。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="分析笔记和后续步骤-2">分析笔记和后续步骤<a href="#分析笔记和后续步骤-2" class="hash-link" aria-label="分析笔记和后续步骤的直接链接" title="分析笔记和后续步骤的直接链接" translate="no">​</a></h3>
<p>您未使用 volatility 模块 <code>psscan</code> 和 <code>psxview</code> 发现新进程。</p>
<p>在下一个任务中，您将专注于分析先前任务中发现的进程。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 拥有 0 个线程的进程数量是多少？ 使用 <code>psscan.txt</code> 文件回答问题。 </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">3</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 填写了退出时间的进程数量是多少？ 使用 <code>psxview.txt</code> 文件回答问题。 </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">3</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务-7-转储进程内存">任务 7 转储进程内存<a href="#任务-7-转储进程内存" class="hash-link" aria-label="任务 7 转储进程内存的直接链接" title="任务 7 转储进程内存的直接链接" translate="no">​</a></h2>
<p>在之前的任务中，您发现了一个潜在的恶意进程链。 根据收集到的信息，您只能得出结论：这些进程是相互关联的，并且该链从 <code>WINWORD.exe</code> 进程开始。 您现在应专注于通过转储其内存从进程中提取信息。</p>
<p><code>volatility</code> 包含多个模块来协助您完成此操作。 模块 <code>windows.dlllist</code> 和 <code>windows.dumpfiles</code> 应帮助您发现多个入侵指标。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="查找路径">查找路径<a href="#查找路径" class="hash-link" aria-label="查找路径的直接链接" title="查找路径的直接链接" translate="no">​</a></h3>
<p>使用 <code>windows.dlllist</code> 模块，您可以发现主可执行文件及其链接的 DLL 的路径。 继续使用虚拟机，在您在任务 5 中记录的进程上运行模块 <code>windows.dlllist</code>（<code>WINWORD.exe</code>、<code>pdfupdater.exe</code>、<code>updater.exe</code>、<code>windows-update</code>、<code>cmd.exe</code>、<code>conhost.exe</code>、<code>powershell.exe</code>）。 输入以下命令以转储 <code>WINWORD.exe</code> 进程。 <strong>注意：由于内存转储的大小和资源有限，命令完成运行可能需要长达两分钟。</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Check Results</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ vol3 </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> THM-WIN-001_071528_07052025.mem windows.dlllist </span><span class="token parameter variable" style="color:#36acaa">--pid</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5252</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> 5252_dlllist.txt</span><br></span></code></pre></div></div>
<p><strong>现在，对所有其他进程执行相同操作。</strong> 然后，使用 <code>cat</code> 检查每个文件，查找主可执行文件的路径，并将其记录下来。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Check Results</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> 5252_dlllist.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> Framework </span><span class="token number" style="color:#36acaa">2.26</span><span class="token plain">.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Progress:  </span><span class="token number" style="color:#36acaa">100.00</span><span class="token plain">               PDB scanning finished</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PID   Process Base  Size      Name                  Path                                                               LoadTime                File output</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">  WINWORD.EXE   0x670000  0x1ac000 WINWORD.EXE  C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Program Files </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft Office</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Root</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Office16</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">WINWORD.EXE  </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:13:04.00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED FOR READABILITY</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<p>现在，用新发现更新您已有的信息。</p>
<p><code>pdfupdater.exe</code>、<code>windows-update.exe</code> 和 <code>updater.exe</code> 进程似乎从异常位置启动。 当您专注于调查用户活动时，此信息将很有帮助。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="转储进程内存">转储进程内存<a href="#转储进程内存" class="hash-link" aria-label="转储进程内存的直接链接" title="转储进程内存的直接链接" translate="no">​</a></h3>
<p>到目前为止，您已发现多个可疑进程。 这种怀疑基于进程名称、具有多个更新进程的进程树以及从用户路径启动的进程。</p>
<p>您必须转储并分析进程的内存，以确认这些进程是恶意的。 然后，您可以提取可执行文件并运行 strings 命令，以快速查看是否存在任何恶意指标。 在大多数情况下，您会将可执行文件传递给恶意软件分析师进行进一步调查。 以下是转储 PID 为 5252 的进程的命令。 按照相同的步骤转储其他进程的内存；您可以排除 cmd.exe、PowerShell.exe 和 conhost.exe 进程。 其他 <code>volatility</code> 模块可以更好地分析这些进程。 <strong>注意：由于内存转储的大小和资源有限，命令完成运行可能需要长达一分钟。</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Dump Process Memory</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5252</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token builtin class-name">cd</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5252</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/5252$ vol3 </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">/THM-WIN-001_071528_07052025.mem windows.dumpfiles </span><span class="token parameter variable" style="color:#36acaa">--pid</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5252</span><br></span></code></pre></div></div>
<p>转储的文件都遵循相同的命名约定：<code>file.StartAddress.EndAddress.ImageSectionObject.filename.img</code> 或 <code>file.StartAddress.EndAddress.DataSectionObject.filename.dat</code>。</p>
<p>注意 ImageSectionObject 和 DataSectionObject 之间的区别。</p>
<table><thead><tr><th style="text-align:left">特性</th><th style="text-align:left">ImageSectionObject</th><th style="text-align:left">DataSectionObject</th></tr></thead><tbody><tr><td style="text-align:left">目的</td><td style="text-align:left">映射的可执行映像</td><td style="text-align:left">映射的数据</td></tr><tr><td style="text-align:left">典型内容</td><td style="text-align:left"><code>.exe</code>、<code>.dll</code>、注入的 PE 文件</td><td style="text-align:left">配置、日志、解压的有效载荷</td></tr><tr><td style="text-align:left">可执行？</td><td style="text-align:left">是</td><td style="text-align:left">通常否</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="查找内容">查找内容<a href="#查找内容" class="hash-link" aria-label="查找内容的直接链接" title="查找内容的直接链接" translate="no">​</a></h3>
<p>根据进程的不同，从进程转储的文件数量可能很大。 您应根据进程的上下文过滤特定扩展名。 例如：</p>
<ul>
<li class="">如果您转储 Microsoft Word 进程，搜索具有扩展名 <code>.docm</code>、<code>.dotm</code> 或 <code>.dotx</code> 的启用宏的文件会很有趣。 攻击者经常使用此类文件来执行 Visual Basic 代码并下载攻击的下一阶段。 MITRE 将此归类为 <a href="https://attack.mitre.org/techniques/T1059/005/" target="_blank" rel="noopener noreferrer" class="">T1059.005 – 命令和脚本解释器：Visual Basic</a></li>
<li class="">如果您有一个名称可疑的进程，请查找 <code>.exe</code> 和 <code>.dat</code> 文件。 使用 strings 命令快速检查任何恶意指标，如可疑函数名、URL、IP、系统命令等</li>
<li class="">如果您转储 PDF 阅读器进程，请查找 .pdf 文件。 使用 strings 命令快速检查任何恶意指标，如包含的 JavaScript。 MITRE将此归类为<a href="https://attack.mitre.org/techniques/T1059/007/" target="_blank" rel="noopener noreferrer" class="">T1059.007 – 命令和脚本解释器：JavaScript</a></li>
</ul>
<p>进程5252是Windows Word进程。 查找<code>.docm</code>或<code>.dotm</code>文件并记录您的发现。 注意：所有转储的文件都附加了扩展名<code>.img</code>。 您可以使用file命令验证文件的类型。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Find Macro Files</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5252</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-E</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;.docm|.dotm&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae077d0.0x990b2a3f5d70.SharedCacheMap.Normal.dotm.vacb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae077d0.0x990b2b916cd0.DataSectionObject.Normal.dotm.dat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae0ab60.0x990b28043a00.SharedCacheMap.cv-resume-test.docm.vacb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae0ab60.0x990b2a8b4b30.DataSectionObject.cv-resume-test.docm.dat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">/file.0x990b2ae077d0.0x990b2b916cd0.DataSectionObject.Normal.dotm.dat      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">/file.0x990b2ae077d0.0x990b2b916cd0.DataSectionObject.Normal.dotm.dat: Microsoft Word </span><span class="token number" style="color:#36acaa">2007</span><span class="token plain">+</span><br></span></code></pre></div></div>
<p>继续处理其他进程，重点查找<code>.exe</code>和<code>.dat</code>文件。 您可以跳过进程<code>cmd.exe</code>、<code>conhost.exe</code>和<code>PowerShell.exe</code>。 这些进程将在后续房间中进行分析。 您可以使用以下<code>grep</code>命令来筛选<code>.exe</code>和<code>.dat</code>文件。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Find Executables</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3392</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10084</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10032</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-E</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;.exe|.dat&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae26720.0x990b286fa140.ImageSectionObject.updater.exe.img</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2846e310.0x990b282f5b70.DataSectionObject.cversions.2.db.dat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae16230.0x990b29ad0270.ImageSectionObject.windows-update.exe.img</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae16230.0x990b2b92ce90.DataSectionObject.windows-update.exe.dat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae0ee90.0x990b2a466010.ImageSectionObject.pdfupdater.exe.img</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae0ee90.0x990b2b91f290.DataSectionObject.pdfupdater.exe.dat</span><br></span></code></pre></div></div>
<p>记录您找到的所有文件并更新您的发现。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="分析笔记和后续步骤-3">分析笔记和后续步骤<a href="#分析笔记和后续步骤-3" class="hash-link" aria-label="分析笔记和后续步骤的直接链接" title="分析笔记和后续步骤的直接链接" translate="no">​</a></h3>
<p>您已更详细地分析了可疑进程，并发现了多个情况：</p>
<ul>
<li class=""><code>updater.exe</code>、<code>pdfupdater.exe</code>和<code>windows-update.exe</code>的路径可疑。 它们都从用户文件夹启动</li>
<li class=""><code>WINWORD.EXE</code>进程转储包含两个启用宏的Word文件，名为<code>cv-resume-test.docm</code>和<code>normal.dotm</code>。 这些可能是恶意文件，需要进一步分析</li>
</ul>
<p>您还提取了<code>updater.exe</code>、<code>pdfupdater.exe</code>和<code>windows-update.exe</code>进程的可执行文件。 恶意软件分析师需要进一步分析这些可执行文件。
下表列出了发现结果。</p>
<table><thead><tr><th style="text-align:left">PID</th><th style="text-align:left">PID</th><th style="text-align:left">时间戳</th><th style="text-align:left">路径</th><th style="text-align:left">文件 - 可执行文件</th></tr></thead><tbody><tr><td style="text-align:left">5252</td><td style="text-align:left">5672</td><td style="text-align:left">2025-05-07 07:13:04.000000</td><td style="text-align:left">C:\Program Files (x86)\Microsoft Office\Root\Office16\WINWORD.EXE</td><td style="text-align:left">file.0x990b2ae0ab60.0x990b2a8b4b30.DataSectionObject.cv-resume-test.docm.dat<br>file.0x990b2ae077d0.0x990b2b916cd0.DataSectionObject.Normal.dotm.dat</td></tr><tr><td style="text-align:left">3392</td><td style="text-align:left">5252</td><td style="text-align:left">2025-05-07 07:13:05.000000</td><td style="text-align:left">C:\Users\operator\pdfupdater.exe</td><td style="text-align:left">file.0x990b2ae0ee90.0x990b2a466010.ImageSectionObject.pdfupdater.exe.img<br>file.0x990b2ae0ee90.0x990b2b91f290.DataSectionObject.pdfupdater.exe.dat</td></tr><tr><td style="text-align:left">2576</td><td style="text-align:left">3392</td><td style="text-align:left">2025-05-07 07:13:05.000000</td><td style="text-align:left">??\C:\Windows\system32\conhost.exe</td><td style="text-align:left">/</td></tr><tr><td style="text-align:left">10084</td><td style="text-align:left">3392</td><td style="text-align:left">2025-05-07 07:13:05.000000</td><td style="text-align:left">C:\Users\operator\AppData\Roaming\Microsoft\Windows\StartMenu\Programs\Startup\windows-update.exe</td><td style="text-align:left">file.0x990b2ae16230.0x990b29ad0270.ImageSectionObject.windows-update.exe.img<br>file.0x990b2ae16230.0x990b2b92ce90.DataSectionObject.windows-update.exe.dat</td></tr><tr><td style="text-align:left">10032</td><td style="text-align:left">10084</td><td style="text-align:left">2025-05-07 07:13:56.000000</td><td style="text-align:left">&quot;C:\Users\operator\Downloads\updater.exe&quot;</td><td style="text-align:left">file.0x990b2ae26720.0x990b286fa140.ImageSectionObject.updater.exe.img</td></tr><tr><td style="text-align:left">432</td><td style="text-align:left">10032</td><td style="text-align:left">2025-05-07 07:14:36.000000</td><td style="text-align:left">C:\Windows\system32\cmd.exe</td><td style="text-align:left">/</td></tr><tr><td style="text-align:left">4592</td><td style="text-align:left">432</td><td style="text-align:left">2025-05-07 07:14:36.000000</td><td style="text-align:left">??\C:\Windows\system32\conhost.exe</td><td style="text-align:left">/</td></tr><tr><td style="text-align:left">6984</td><td style="text-align:left">432</td><td style="text-align:left">2025-05-07 07:14:39.000000</td><td style="text-align:left">powershell</td><td style="text-align:left">/</td></tr></tbody></table>
<p>既然您已发现多个指向攻击的指标，您需要将提取的工件交给恶意软件分析师和/或威胁猎手进行进一步检查。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> PID为7788的进程路径是什么？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">C:\Program Files\AccessData\FTK Imager\FTK Imager.exe</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 转储PID为7788的进程。 表示可执行文件的转储文件名称是什么？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae1ed40.0x990b29954a20.ImageSectionObject.FTK Imager.exe.img</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务8-整合所有信息">任务8 整合所有信息<a href="#任务8-整合所有信息" class="hash-link" aria-label="任务8 整合所有信息的直接链接" title="任务8 整合所有信息的直接链接" translate="no">​</a></h2>
<p>在分析内存转储时，您发现了可能的入侵指标。 不过，其中一些指标需要进一步分析才能确定。 根据收集的工件和观察结果，可以重建部分杀伤链。 下表显示了所有收集到的信息。</p>
<table><thead><tr><th style="text-align:left">PID</th><th style="text-align:left">PID</th><th style="text-align:left">时间戳</th><th style="text-align:left">路径</th><th style="text-align:left">文件 - 可执行文件</th></tr></thead><tbody><tr><td style="text-align:left">5252</td><td style="text-align:left">5672</td><td style="text-align:left">2025-05-07 07:13:04.000000</td><td style="text-align:left">C:\Program Files (x86)\Microsoft Office\Root\Office16\WINWORD.EXE</td><td style="text-align:left">file.0x990b2ae0ab60.0x990b2a8b4b30.DataSectionObject.cv-resume-test.docm.dat<br>file.0x990b2ae077d0.0x990b2b916cd0.DataSectionObject.Normal.dotm.dat</td></tr><tr><td style="text-align:left">3392</td><td style="text-align:left">5252</td><td style="text-align:left">2025-05-07 07:13:05.000000</td><td style="text-align:left">C:\Users\operator\pdfupdater.exe</td><td style="text-align:left">file.0x990b2ae0ee90.0x990b2a466010.ImageSectionObject.pdfupdater.exe.img<br>file.0x990b2ae0ee90.0x990b2b91f290.DataSectionObject.pdfupdater.exe.dat</td></tr><tr><td style="text-align:left">2576</td><td style="text-align:left">3392</td><td style="text-align:left">2025-05-07 07:13:05.000000</td><td style="text-align:left">??\C:\Windows\system32\conhost.exe</td><td style="text-align:left">/</td></tr><tr><td style="text-align:left">10084</td><td style="text-align:left">3392</td><td style="text-align:left">2025-05-07 07:13:05.000000</td><td style="text-align:left">C:\Users\operator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\windows-update.exe</td><td style="text-align:left">file.0x990b2ae16230.0x990b29ad0270.ImageSectionObject.windows-update.exe.img<br>file.0x990b2ae16230.0x990b2b92ce90.DataSectionObject.windows-update.exe.dat</td></tr><tr><td style="text-align:left">10032</td><td style="text-align:left">10084</td><td style="text-align:left">2025-05-07 07:13:56.000000</td><td style="text-align:left">C:\Users\operator\Downloads\updater.exe</td><td style="text-align:left">file.0x990b2ae26720.0x990b286fa140.ImageSectionObject.updater.exe.img</td></tr><tr><td style="text-align:left">432</td><td style="text-align:left">10032</td><td style="text-align:left">2025-05-07 07:14:36.000000</td><td style="text-align:left">C:\Windows\system32\cmd.exe</td><td style="text-align:left">/</td></tr><tr><td style="text-align:left">4592</td><td style="text-align:left">432</td><td style="text-align:left">2025-05-07 07:14:36.000000</td><td style="text-align:left">??\C:\Windows\system32\conhost.exe</td><td style="text-align:left">/</td></tr><tr><td style="text-align:left">6984</td><td style="text-align:left">432</td><td style="text-align:left">2025-05-07 07:14:39.000000</td><td style="text-align:left">powershell</td><td style="text-align:left">/</td></tr></tbody></table>
<p><img decoding="async" loading="lazy" alt="基于收集信息的攻击链" src="/TryHackMe-CN/assets/images/image_20251234-213428-bd8fc0511e9363b2d42f53bef43d0868.png" width="1427" height="797" class="img_ev3q"></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="初始访问">初始访问<a href="#初始访问" class="hash-link" aria-label="初始访问的直接链接" title="初始访问的直接链接" translate="no">​</a></h3>
<p>现在，您只能推测攻击者进入系统的技术。 根据您收集的工件，攻击者很可能采用了<a href="https://attack.mitre.org/techniques/T1566/" target="_blank" rel="noopener noreferrer" class="">T1566 钓鱼</a>技术，将恶意启用宏的Word文档放入系统。 这需要通过分析用户在系统上的活动来确认。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="执行">执行<a href="#执行" class="hash-link" aria-label="执行的直接链接" title="执行的直接链接" translate="no">​</a></h3>
<p>第一个入侵指标始于<code>WINWORD.exe</code>进程打开一个名为<code>cv-resume-test.docm</code>或<code>normal.dotm</code>的启用宏的Word文件。 MITRE将此技术归类为<a href="https://attack.mitre.org/techniques/T1059/005/" target="_blank" rel="noopener noreferrer" class="">T1059.005 命令和脚本解释器：Visual Basic</a></p>
<p><code>cv-resume-text.docm</code>或<code>normal.dotm</code>文件很可能下载并启动名为<code>pdfupdater.exe</code>的第二阶段恶意软件。 对宏文件的进一步分析应能证实这一点。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="持久性">持久性<a href="#持久性" class="hash-link" aria-label="持久性的直接链接" title="持久性的直接链接" translate="no">​</a></h3>
<p>恶意软件pdfupdater.exe随后很可能下载另一个阶段<code>windows-update.exe</code>，该文件从<code>C:\Users\operator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\windows-update.exe</code>路径启动。 此路径通常包含操作系统加载时启动的进程或进程链接。 这可能是一个持久性指标。 MITRE将此归类为<a href="https://attack.mitre.org/techniques/T1037/005" target="_blank" rel="noopener noreferrer" class="">启动或登录初始化脚本：启动项</a>。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="命令与控制">命令与控制<a href="#命令与控制" class="hash-link" aria-label="命令与控制的直接链接" title="命令与控制的直接链接" translate="no">​</a></h3>
<p>观察到<code>windows-update.exe</code>可执行文件很可能具有持久性，这可能表明它充当C2客户端或反向shell。 对此可执行文件的进一步分析应能揭示其功能。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="未涵盖的攻击阶段">未涵盖的攻击阶段<a href="#未涵盖的攻击阶段" class="hash-link" aria-label="未涵盖的攻击阶段的直接链接" title="未涵盖的攻击阶段的直接链接" translate="no">​</a></h3>
<p>您已经发现了杀伤链中的多个阶段，但仍有一个可执行文件无法归入上述任何阶段。 目前，您只能推测updater.exe进程的作用。 一个合理的猜测是，由于它源自可能的C2进程<code>windows-update.exe</code>，它很可能包含MITRE战术，如<a href="https://attack.mitre.org/tactics/TA0010" target="_blank" rel="noopener noreferrer" class="">数据窃取</a>、<a href="https://attack.mitre.org/tactics/TA0040" target="_blank" rel="noopener noreferrer" class="">影响</a>、<a href="https://attack.mitre.org/tactics/TA0007" target="_blank" rel="noopener noreferrer" class="">发现</a>或<a href="https://attack.mitre.org/tactics/TA0008" target="_blank" rel="noopener noreferrer" class="">横向移动</a>。 对可执行文件的分析应能更清晰地揭示其功能。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="后续步骤">后续步骤<a href="#后续步骤" class="hash-link" aria-label="后续步骤的直接链接" title="后续步骤的直接链接" translate="no">​</a></h3>
<p>您已发现多个需要进一步分析的工件。 您应收集这些工件，计算其哈希值，然后将其交给威胁猎手或恶意软件分析师。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 可能被入侵的用户名称是什么？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">operator</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> MITRE战术命令与控制的ID是什么？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">TA0011</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务9-结论">任务9 结论<a href="#任务9-结论" class="hash-link" aria-label="任务9 结论的直接链接" title="任务9 结论的直接链接" translate="no">​</a></h2>
<p>本房间是深入分析内存转储系列三个房间中的第一个。 您经历了一个真实场景，并分析了内存转储，重点是提取进程及其信息。 您发现了一个潜在的攻击链和多个可疑工件。</p>
<p>分析进程仅仅是开始。 接下来的步骤是分析用户和网络活动。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 我已准备好应用新获得的技能！ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/TryHackMyOffsecBox/TryHackMe-CN/tree/main/packages/create-docusaurus/templates/shared/docs/Modules/Memory Analysis/windowsmemoryandprocs.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/TryHackMe-CN/docs/Modules/Memory Analysis/volatilityessentials"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Volatility基础</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryanduseractivity"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Windows内存与用户活动</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#任务-1-介绍" class="table-of-contents__link toc-highlight">任务 1 介绍</a><ul><li><a href="#学习目标" class="table-of-contents__link toc-highlight">学习目标</a></li><li><a href="#房间先决条件" class="table-of-contents__link toc-highlight">房间先决条件</a></li></ul></li><li><a href="#任务2场景信息" class="table-of-contents__link toc-highlight">任务2场景信息</a><ul><li><a href="#场景" class="table-of-contents__link toc-highlight">场景</a></li><li><a href="#事件信息thm-0001" class="table-of-contents__link toc-highlight">事件信息THM-0001</a></li><li><a href="#公司信息tryhatme" class="table-of-contents__link toc-highlight">公司信息TryHatMe</a></li></ul></li><li><a href="#任务3-windows进程架构" class="table-of-contents__link toc-highlight">任务3 Windows进程架构</a><ul><li><a href="#windows进程和线程" class="table-of-contents__link toc-highlight">Windows进程和线程</a></li><li><a href="#您可以从这些结构中提取哪些信息" class="table-of-contents__link toc-highlight">您可以从这些结构中提取哪些信息？</a></li></ul></li><li><a href="#任务4-新内存转储的初步分析" class="table-of-contents__link toc-highlight">任务4 新内存转储的初步分析</a><ul><li><a href="#环境与设置" class="table-of-contents__link toc-highlight">环境与设置</a></li><li><a href="#验证内存转储" class="table-of-contents__link toc-highlight">验证内存转储</a></li><li><a href="#提取进程" class="table-of-contents__link toc-highlight">提取进程</a></li><li><a href="#大海捞针" class="table-of-contents__link toc-highlight">大海捞针</a></li><li><a href="#与基线比较" class="table-of-contents__link toc-highlight">与基线比较</a></li><li><a href="#分析笔记和后续步骤" class="table-of-contents__link toc-highlight">分析笔记和后续步骤</a></li></ul></li><li><a href="#任务5-关联进程" class="table-of-contents__link toc-highlight">任务5 关联进程</a><ul><li><a href="#观察结果" class="table-of-contents__link toc-highlight">观察结果</a></li><li><a href="#分析笔记和后续步骤-1" class="table-of-contents__link toc-highlight">分析笔记和后续步骤</a></li></ul></li><li><a href="#任务6-深入挖掘" class="table-of-contents__link toc-highlight">任务6 深入挖掘</a><ul><li><a href="#psscan" class="table-of-contents__link toc-highlight">PSSCAN</a></li><li><a href="#psxview" class="table-of-contents__link toc-highlight">PSXVIEW</a></li><li><a href="#分析笔记和后续步骤-2" class="table-of-contents__link toc-highlight">分析笔记和后续步骤</a></li></ul></li><li><a href="#任务-7-转储进程内存" class="table-of-contents__link toc-highlight">任务 7 转储进程内存</a><ul><li><a href="#查找路径" class="table-of-contents__link toc-highlight">查找路径</a></li><li><a href="#转储进程内存" class="table-of-contents__link toc-highlight">转储进程内存</a></li><li><a href="#查找内容" class="table-of-contents__link toc-highlight">查找内容</a></li><li><a href="#分析笔记和后续步骤-3" class="table-of-contents__link toc-highlight">分析笔记和后续步骤</a></li></ul></li><li><a href="#任务8-整合所有信息" class="table-of-contents__link toc-highlight">任务8 整合所有信息</a><ul><li><a href="#初始访问" class="table-of-contents__link toc-highlight">初始访问</a></li><li><a href="#执行" class="table-of-contents__link toc-highlight">执行</a></li><li><a href="#持久性" class="table-of-contents__link toc-highlight">持久性</a></li><li><a href="#命令与控制" class="table-of-contents__link toc-highlight">命令与控制</a></li><li><a href="#未涵盖的攻击阶段" class="table-of-contents__link toc-highlight">未涵盖的攻击阶段</a></li><li><a href="#后续步骤" class="table-of-contents__link toc-highlight">后续步骤</a></li></ul></li><li><a href="#任务9-结论" class="table-of-contents__link toc-highlight">任务9 结论</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/TryHackMe-CN/docs">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/TryHackMyOffsecBox" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github - TryHackMyOffsecBox<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/CRONUS-Security" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github - CRONUS-Security<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 TryHackMyOffsecBox. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>