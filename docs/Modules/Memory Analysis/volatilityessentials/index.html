<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Modules/Memory Analysis/volatilityessentials" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Volatility基础 | TryHackMe-CN</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/volatilityessentials"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Volatility基础 | TryHackMe-CN"><meta data-rh="true" name="description" content="任务 1 介绍"><meta data-rh="true" property="og:description" content="任务 1 介绍"><link data-rh="true" rel="icon" href="/TryHackMe-CN/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/volatilityessentials"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/docs/Modules/Memory Analysis/volatilityessentials" hreflang="en"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/volatilityessentials" hreflang="zh"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/volatilityessentials" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"模块","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/"},{"@type":"ListItem","position":2,"name":"内存分析","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/"},{"@type":"ListItem","position":3,"name":"Volatility基础","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/volatilityessentials"}]}</script><link rel="alternate" type="application/rss+xml" href="/TryHackMe-CN/blog/rss.xml" title="TryHackMe-CN RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/TryHackMe-CN/blog/atom.xml" title="TryHackMe-CN Atom Feed"><link rel="stylesheet" href="/TryHackMe-CN/assets/css/styles.6c4c8a38.css">
<script src="/TryHackMe-CN/assets/js/runtime~main.0cf061d9.js" defer="defer"></script>
<script src="/TryHackMe-CN/assets/js/main.37b9f7f1.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/TryHackMe-CN/img/logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/TryHackMe-CN/"><div class="navbar__logo"><img src="/TryHackMe-CN/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/TryHackMe-CN/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">TryHackMe-CN</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/TryHackMe-CN/docs/Modules/">Tutorial</a><a class="navbar__item navbar__link" href="/TryHackMe-CN/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/volatilityessentials" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/TryHackMe-CN/docs/Modules/Memory Analysis/volatilityessentials" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh">简体中文</a></li></ul></div><a href="https://github.com/TryHackMyOffsecBox/TryHackMe-CN" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/TryHackMe-CN/docs/Modules/"><span title="模块" class="categoryLinkLabel_W154">模块</span></a><button aria-label="折叠侧边栏分类 &#x27;模块&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Attacking LLMs/"><span title="攻击大型语言模型" class="categoryLinkLabel_W154">攻击大型语言模型</span></a><button aria-label="展开侧边栏分类 &#x27;攻击大型语言模型&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Command Line/"><span title="命令行" class="categoryLinkLabel_W154">命令行</span></a><button aria-label="展开侧边栏分类 &#x27;命令行&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Container Security/"><span title="容器安全" class="categoryLinkLabel_W154">容器安全</span></a><button aria-label="展开侧边栏分类 &#x27;容器安全&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Host Evasions/"><span title="主机规避" class="categoryLinkLabel_W154">主机规避</span></a><button aria-label="展开侧边栏分类 &#x27;主机规避&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/"><span title="内存分析" class="categoryLinkLabel_W154">内存分析</span></a><button aria-label="折叠侧边栏分类 &#x27;内存分析&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/memoryanalysisintroduction"><span title="内存分析简介" class="linkLabel_WmDU">内存分析简介</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/memoryacquisition"><span title="内存获取" class="linkLabel_WmDU">内存获取</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/volatilityessentials"><span title="Volatility基础" class="linkLabel_WmDU">Volatility基础</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryandprocs"><span title="Windows内存与进程" class="linkLabel_WmDU">Windows内存与进程</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryanduseractivity"><span title="Windows内存与用户活动" class="linkLabel_WmDU">Windows内存与用户活动</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Microsoft Defender XDR/"><span title="Microsoft Defender XDR" class="categoryLinkLabel_W154">Microsoft Defender XDR</span></a><button aria-label="展开侧边栏分类 &#x27;Microsoft Defender XDR&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Starters/"><span title="入门挑战" class="categoryLinkLabel_W154">入门挑战</span></a><button aria-label="展开侧边栏分类 &#x27;入门挑战&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/TryHackMe-CN/docs/Networks/"><span title="网络" class="categoryLinkLabel_W154">网络</span></a><button aria-label="展开侧边栏分类 &#x27;网络&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/TryHackMe-CN/docs/"><span title="index" class="linkLabel_WmDU">index</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/TryHackMe-CN/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/TryHackMe-CN/docs/Modules/"><span>模块</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/TryHackMe-CN/docs/Modules/Memory Analysis/"><span>内存分析</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Volatility基础</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Volatility基础</h1></header>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务-1-介绍">任务 1 介绍<a href="#任务-1-介绍" class="hash-link" aria-label="任务 1 介绍的直接链接" title="任务 1 介绍的直接链接" translate="no">​</a></h2>
<p>In the previous room, <a href="https://tryhackme.com/room/memoryanalysisintroduction" target="_blank" rel="noopener noreferrer" class="">Memory Analysis Introduction</a>, we learnt about the vital nature of memory forensics in cyber security. We explored the structure of memory dumps, differentiated between RAM and disk forensics, and saw scenarios where memory analysis is essential.</p>
<p>Here, we shall begin looking at the practical aspects of memory forensics through tools, specifically Volatility.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="学习目标">学习目标<a href="#学习目标" class="hash-link" aria-label="学习目标的直接链接" title="学习目标的直接链接" translate="no">​</a></h3>
<ul>
<li class="">Getting familiar with the Volatility Framework</li>
<li class="">Navigate and utilise basic Volatility commands and plugins</li>
<li class="">Conduct forensic analysis to identify key artefacts such as running processes and loaded DLLs using Volatility</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="先决条件">先决条件<a href="#先决条件" class="hash-link" aria-label="先决条件的直接链接" title="先决条件的直接链接" translate="no">​</a></h3>
<ul>
<li class=""><a href="https://tryhackme.com/room/memoryanalysisintroduction" target="_blank" rel="noopener noreferrer" class="">内存分析简介</a></li>
<li class=""><a href="https://tryhackme.com/room/btwindowsinternals" target="_blank" rel="noopener noreferrer" class="">Core Windows Processes</a></li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Ready to learn about Volatility and memory analysis. </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-2-volatility-overview">Task 2 Volatility Overview<a href="#task-2-volatility-overview" class="hash-link" aria-label="Task 2 Volatility Overview的直接链接" title="Task 2 Volatility Overview的直接链接" translate="no">​</a></h2>
<p><a href="https://volatilityfoundation.org/the-volatility-framework/" target="_blank" rel="noopener noreferrer" class="">Volatility</a> is an open-source memory forensics framework that is cross-platform, modular, and extensible. The framework has undergone various iterations over the years, with the current version being Volatility 3. This version is superior to its predecessors as it abandoned static OS profiling in favour of dynamic symbol resolution, supporting newer operating systems, memory layouts, and complete insight into the runtime state of the system.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="architectural-overview">Architectural Overview<a href="#architectural-overview" class="hash-link" aria-label="Architectural Overview的直接链接" title="Architectural Overview的直接链接" translate="no">​</a></h3>
<p>Volatility 3 is made up of several key layers:</p>
<ul>
<li class=""><strong>Memory layers</strong>: These layers represent the hierarchy of address spaces, from raw memory to virtual address translations.</li>
<li class=""><strong>Symbol tables</strong>: The tables enable kernel and process structures to be interpreted through OS-specific debugging symbols.</li>
<li class=""><strong>Plugins</strong>: These are modular routines that leverage the underlying memory layers and symbol tables to extract artefacts of forensic interest. Later in the room, we shall look at some key plugins used.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="system-requirements-and-installation">System Requirements and Installation<a href="#system-requirements-and-installation" class="hash-link" aria-label="System Requirements and Installation的直接链接" title="System Requirements and Installation的直接链接" translate="no">​</a></h3>
<p>Volatility 3 requires Python 3.6 or later to run. Additionally, it benefits from various libraries such as <code>pefile</code>, <code>capstone</code>, and <code>yara-python</code> that allow us to process portable executables, perform memory disassembly, and use YARA rules in our analysis, respectively. The terminal output below shows how to install Volatility by cloning the <a href="https://github.com/volatilityfoundation/volatility3.git" target="_blank" rel="noopener noreferrer" class="">GitHub repository</a> and running it directly from the source.</p>
<p>Volatility has already been installed on the machine attached to this room and can be accessed under the <code>Desktop/volatility3</code> directory.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility Installation</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop$ </span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/volatilityfoundation/volatility3.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop$ </span><span class="token builtin class-name">cd</span><span class="token plain"> volatility3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-h</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> Framework </span><span class="token number" style="color:#36acaa">2.26</span><span class="token plain">.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">usage: vol.py </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-h</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-c CONFIG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--parallelism </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">processes,threads,off</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-e EXTEND</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-p PLUGIN_DIRS</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-s SYMBOL_DIRS</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-v</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-l LOG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-o OUTPUT_DIR</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-q</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-r RENDERER</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-f FILE</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--write-config</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--save-config SAVE_CONFIG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--clear-cache</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--cache-path CACHE_PATH</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--offline </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain"> URL</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--filters FILTERS</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--hide-columns </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">HIDE_COLUMNS </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--single-location SINGLE_LOCATION</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--stackers </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">STACKERS </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--single-swap-locations </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">SINGLE_SWAP_LOCATIONS </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              PLUGIN </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">An open-source memory forensics framework</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">options:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -h, </span><span class="token parameter variable" style="color:#36acaa">--help</span><span class="token plain">            Show this </span><span class="token builtin class-name">help</span><span class="token plain"> message and exit, </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> specific plugin options use </span><span class="token string" style="color:#e3116c">&#x27;vol.py  --help&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> CONFIG, </span><span class="token parameter variable" style="color:#36acaa">--config</span><span class="token plain"> CONFIG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        Load the configuration from a json </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------TRUNCATED--------</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Read the above and navigate to the Volatility directory. </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-3-memory-acquisition-and-analysis">Task 3 Memory Acquisition and Analysis<a href="#task-3-memory-acquisition-and-analysis" class="hash-link" aria-label="Task 3 Memory Acquisition and Analysis的直接链接" title="Task 3 Memory Acquisition and Analysis的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="memory-acquisition-methodologies">Memory Acquisition Methodologies<a href="#memory-acquisition-methodologies" class="hash-link" aria-label="Memory Acquisition Methodologies的直接链接" title="Memory Acquisition Methodologies的直接链接" translate="no">​</a></h3>
<p>Memory acquisition is a foundational step in forensics that must be performed in a manner that ensures we maintain the integrity of evidence. The process and the deployment environment used vary from one OS to another.</p>
<p>For Windows systems, the following tools can be used to conduct memory acquisition:</p>
<ul>
<li class=""><strong>DumpIt</strong>: captures a full physical memory image on 32/64‑bit Windows and automatically hashes the output.</li>
<li class=""><strong>WinPmem</strong>: Open‑source driver‑based tool that acquires RAM in RAW/ELF formats and embeds acquisition metadata for chain‑of‑custody.</li>
<li class=""><strong>Magnet RAM Capture</strong>: GUI‑driven collector that snapshots volatile memory on live Windows hosts while minimising footprint.</li>
<li class=""><strong>FTK Imager</strong>: The most common commercial tool that acquires memory and selected logical artefacts alongside disk imaging functions.</li>
</ul>
<p>For Linux and macOS systems, we can employ the services of the following tools:</p>
<ul>
<li class=""><strong>AVML</strong>: Lightweight Microsoft CLI utility that dumps Linux memory to a compressed ELF file without requiring a kernel module.</li>
<li class=""><strong>LiME</strong>: Loadable Kernel Module for Linux that captures full volatile memory over disk or network and supports ARM/x86 architectures.</li>
<li class=""><strong>OSXPmem</strong>: macOS‑specific fork of Pmem that creates raw memory images on Intel‑based Macs for subsequent Volatility analysis.</li>
</ul>
<p>Extracting memory from virtual environments can be done by collecting the virtual memory file from the host machine&#x27;s drive. Depending on the hypervisor in use, the output file will likely differ, and you would likely encounter the following examples:</p>
<ul>
<li class="">VMware - <code>.vmem</code></li>
<li class="">Hyper-V - <code>.bin</code></li>
<li class="">Parallels - <code>.mem</code></li>
<li class="">VirtualBox - <code>.sav</code> It is worth noting that this is a partial memory file.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="内存分析">内存分析<a href="#内存分析" class="hash-link" aria-label="内存分析的直接链接" title="内存分析的直接链接" translate="no">​</a></h3>
<p>To have a holistic and hands-on understanding of Volatility, we shall investigate a forensic case and use it to learn about the tool&#x27;s inner workings. The files for the analysis are found under the <code>Desktop/Investigations</code> directory.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="case-001">Case 001<a href="#case-001" class="hash-link" aria-label="Case 001的直接链接" title="Case 001的直接链接" translate="no">​</a></h4>
<p>Your SOC has informed you that they have gathered a memory dump from a quarantined endpoint thought to have been compromised by a banking trojan masquerading as an Adobe document. Your job is to use your knowledge of threat intelligence and reverse engineering to perform memory forensics on the infected host.</p>
<p>You have been informed of a suspicious IP in connection with the file <code>Investigation-1.vmem</code> that could be helpful: <code>41.168.5.140</code>.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="plugins">Plugins<a href="#plugins" class="hash-link" aria-label="Plugins的直接链接" title="Plugins的直接链接" translate="no">​</a></h4>
<p>Volatility uses plugins to request data to carry out analysis. Some of the most commonly used plugins include:</p>
<ul>
<li class=""><code>windows.info</code></li>
<li class=""><code>linux.info</code></li>
<li class=""><code>pslist</code></li>
<li class=""><code>pstree</code></li>
</ul>
<p>Let us look at these plugins, extracting information from our memory file. First, we can begin by obtaining operating system details from the image. In previous versions of Volatility, this information was identified as <strong>OS profiles</strong> and was extracted using the plugin <code>imageinfo</code>. However, OS profiles have been deprecated in the new version, and now we have the individual information plugins.</p>
<p>Given that our memory file was obtained from a Windows VM running on VMware, we can extract details about its profile with the command below:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility Windows Info</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> Framework </span><span class="token number" style="color:#36acaa">2.26</span><span class="token plain">.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WARNING  volatility3.framework.layers.vmware: No metadata </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> found alongside VMEM file. A VMSS or VMSN </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> may be required to correctly process a VMEM file. These should be placed </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> the same directory with the same </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> name, e.g. Investigation-1.vmem and Investigation-1.vmss.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Progress:  </span><span class="token number" style="color:#36acaa">100.00</span><span class="token plain">               PDB scanning finished                                                                                              </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Variable        Value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Kernel Base     0x804d7000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DTB     0x2fe000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Symbols file:///home/ubuntu/Desktop/volatility3/volatility3/symbols/windows/ntkrnlpa.pdb/30B5FB31AE7E4ACAABA750AA241FF331-1.json.xz</span><br></span></code></pre></div></div>
<p>We can extract the system version, architecture, symbol tables, and available memory layers from the details.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the build version of the host machine in Case 001? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">2600.xpsp.080413-2111</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> At what time was the memory file acquired in Case 001? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">2012-07-22 02:45:08</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-4-listing-processes-and-connections">Task 4 Listing Processes and Connections<a href="#task-4-listing-processes-and-connections" class="hash-link" aria-label="Task 4 Listing Processes and Connections的直接链接" title="Task 4 Listing Processes and Connections的直接链接" translate="no">​</a></h2>
<p>When we want to analyse details on processes and network connections from our memory file, Volatility supports different plugins, each with varying techniques used. Not all plugins mentioned here will produce a result from the memory file, as the capture may not have included processes or services that the plugins would enumerate.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="active-process-enumeration">Active Process Enumeration<a href="#active-process-enumeration" class="hash-link" aria-label="Active Process Enumeration的直接链接" title="Active Process Enumeration的直接链接" translate="no">​</a></h3>
<p>The most basic way of listing processes is by using <code>pslist</code>. This plugin enumerates active processes from the doubly-linked list that keeps track of processes in memory, equivalent to the process list in the task manager. The output from this plugin will include all current and terminated processes and their exit times.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility Process Enumeration</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.pslist</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="hidden-process-enumeration">Hidden Process Enumeration<a href="#hidden-process-enumeration" class="hash-link" aria-label="Hidden Process Enumeration的直接链接" title="Hidden Process Enumeration的直接链接" translate="no">​</a></h3>
<p>Some malware, typically rootkits, will, in an attempt to hide their processes, unlink themselves from the list. By unlinking themselves from the list, you will no longer see their processes when using <code>pslist</code>. To combat this evasion technique, we can use <code>psscan</code>. This technique of listing processes will locate processes by finding data structures that match <code>_EPROCESS</code>. While this technique can help with evasion countermeasures, it can also result in false positives; therefore, we must be careful.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility Process Enumeration</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.psscan</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="process-hierarchy-enumeration">Process Hierarchy Enumeration<a href="#process-hierarchy-enumeration" class="hash-link" aria-label="Process Hierarchy Enumeration的直接链接" title="Process Hierarchy Enumeration的直接链接" translate="no">​</a></h3>
<p>The third process plugin, <code>pstree</code>, does not offer any other kind of special techniques to help identify evasion like the last two plugins. However, this plugin will list all processes based on their parent process ID, using the same methods as <code>pslist</code>. This can be useful for an analyst to get a complete story of the processes and what may have occurred at the extraction time.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility Process Enumeration</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.pstree</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="file-registry-and-thread-enumeration">File, Registry, and Thread Enumeration<a href="#file-registry-and-thread-enumeration" class="hash-link" aria-label="File, Registry, and Thread Enumeration的直接链接" title="File, Registry, and Thread Enumeration的直接链接" translate="no">​</a></h3>
<p>Inspecting files and the registry is also vital during a memory forensic investigation. We can use the plugin <code>handles</code> to look into the details and handles of files and threads from a host.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility Files Inspecting</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.handles</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="network-connection-enumeration">Network Connection Enumeration<a href="#network-connection-enumeration" class="hash-link" aria-label="Network Connection Enumeration的直接链接" title="Network Connection Enumeration的直接链接" translate="no">​</a></h3>
<p>Now that we know how to identify processes, we also need to have a way to identify the network connections present at the time of extraction on the host machine. The <code>netstat</code> will attempt to identify all memory structures with a network connection.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility Network  Enumeration</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.netstat</span><br></span></code></pre></div></div>
<p>It is worth noting that this command in the current state of Volatility 3 can be very unstable, particularly around old Windows builds. To combat this, you can utilise other tools like <a href="https://tools.kali.org/forensics/bulk-extractor" target="_blank" rel="noopener noreferrer" class="">bulk_extractor</a> to extract a PCAP file from the memory file. Sometimes, this is preferred in network connections that you cannot identify from Volatility alone.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="tcpudp-socket-enumeration">TCP/UDP Socket Enumeration<a href="#tcpudp-socket-enumeration" class="hash-link" aria-label="TCP/UDP Socket Enumeration的直接链接" title="TCP/UDP Socket Enumeration的直接链接" translate="no">​</a></h3>
<p>We can also identify network sockets and their linked processes from a memory file. To do this, we can use the plugin <code>netscan</code>. This will recover active and closed TCP/UDP connections, associated process IDs, local and remote ports, and IPs using memory pool scanning.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility TCP/UDP Enumeration</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.netscan</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="dll-enumeration">DLL Enumeration<a href="#dll-enumeration" class="hash-link" aria-label="DLL Enumeration的直接链接" title="DLL Enumeration的直接链接" translate="no">​</a></h3>
<p>The last plugin we will cover is <code>dlllist</code>. This plugin will list all DLLs associated with processes at extraction time. This can be especially useful once you have analysed further and filtered the output to a specific DLL that might indicate a specific type of malware you believe to be on the system.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility DLL Enumeration</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.dlllist</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the absolute path to the active Adobe process? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">C:\Program Files\Adobe\Reader 9.0\Reader\Reader_sl.exe</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the parent process of this process in Case 001? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">explorer.exe</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the PID of the parent process? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1484</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> How many DLL files are used by the Adobe process that are outside the <code>system32</code> directory? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">3</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the name of the one KeyedEvent associated with the process&#x27;s handles? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CritSecOutOfMemoryEvent</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-5-volatility-hunting-and-detection-capabilities">Task 5 Volatility Hunting and Detection Capabilities<a href="#task-5-volatility-hunting-and-detection-capabilities" class="hash-link" aria-label="Task 5 Volatility Hunting and Detection Capabilities的直接链接" title="Task 5 Volatility Hunting and Detection Capabilities的直接链接" translate="no">​</a></h2>
<p>Advanced threats can execute solely in memory, avoiding disk artefacts. Volatility offers many plugins that can aid in your hunting and detection capabilities when hunting for injected code and malware, as well as applying custom detection rules via YARA.</p>
<p>Before going through this section, it is recommended that you have a basic understanding of how evasion techniques and various malware techniques are employed by adversaries, as well as how to hunt and detect them.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="malware-analysis">Malware Analysis<a href="#malware-analysis" class="hash-link" aria-label="Malware Analysis的直接链接" title="Malware Analysis的直接链接" translate="no">​</a></h3>
<p>The first plugin we will discuss, which is one of the most useful when hunting for code injection, is <code>malfind</code>. This plugin will attempt to detect injected processes and their PIDs along with the offset address and the infected area&#x27;s Hex, Ascii, and Disassembly views. The plugin works by scanning the heap and identifying processes that have the executable bit set <strong>RWE</strong> or <strong>RX</strong> and/or no memory-mapped file on disk (file-less malware).</p>
<p>Based on what <code>malfind</code> identifies, the injected area will change. An MZ header is an indicator of a Windows executable file. The injected area could also be directed towards shellcode, which requires further analysis.</p>
<p><img decoding="async" loading="lazy" alt="File structure of a Windows executable, showing the MZ header value." src="/TryHackMe-CN/assets/images/image_20251207-210748-050e85a68cfee8ec51dcc233adae6000.png" width="623" height="222" class="img_ev3q"></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility Malware Enumeration</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.malfind</span><br></span></code></pre></div></div>
<p>Another helpful plugin is <code>vadinfo</code>. This displays detailed information about virtual memory descriptors, which is useful when manually investigating suspicious memory regions and heap allocations.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility Malware Enumeration</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.vadinfo</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What processes in the Case 001 memory file contain a header that points to a Windows executable file? (Answer: process1,process2) </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">explorer.exe,reader_sl.exe</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-6-advanced-memory-forensics">Task 6 Advanced Memory Forensics<a href="#task-6-advanced-memory-forensics" class="hash-link" aria-label="Task 6 Advanced Memory Forensics的直接链接" title="Task 6 Advanced Memory Forensics的直接链接" translate="no">​</a></h2>
<p>Forensic analysts must be equipped to detect manipulation deep within the operating system when dealing with sophisticated threats such as kernel-mode rootkits. Rootkits are designed to conceal processes, files, drivers, and their presence by modifying kernel structures. This section focuses on a structured and practical exploration of these advanced evasion techniques, particularly within the Windows operating system, using Volatility 3.</p>
<p>Advanced adversaries often employ <strong>hooking</strong> — a technique that allows malicious software to intercept and potentially redirect system-level functions for evasion or persistence. Hooks are not inherently malicious; antivirus and debugging tools also use them legitimately. The analyst’s responsibility is to identify whether the presence of a hook aligns with expected system behaviour or represents malicious interference.</p>
<p>One of the most common hooking strategies is the <strong>System Service Descriptor Table (SSDT)</strong> hooks. These hooks are used to modify kernel system call table entries. They are prevalent in kernel-mode malware, with Volatility providing a corresponding plugin for analysis.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="ssdt-hook-detection">SSDT Hook Detection<a href="#ssdt-hook-detection" class="hash-link" aria-label="SSDT Hook Detection的直接链接" title="SSDT Hook Detection的直接链接" translate="no">​</a></h3>
<p>The Windows kernel uses the <strong>System Service Descriptor Table (SSDT)</strong> to resolve addresses for system calls. Rootkits often overwrite SSDT entries to redirect legitimate system calls (e.g., <code>NtCreateFile</code>) to their malicious counterparts.</p>
<p>Volatility 3’s <code>windows.ssdt</code> plugin enables analysts to inspect this table for any irregularities.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility SSDT Hook Enumeration</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.ssdt</span><br></span></code></pre></div></div>
<p><strong>Recommendation</strong>: Perform SSDT inspection <strong>after</strong> discovering suspicious kernel modules or abnormal process behaviour.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="kernel-module-enumeration">Kernel Module Enumeration<a href="#kernel-module-enumeration" class="hash-link" aria-label="Kernel Module Enumeration的直接链接" title="Kernel Module Enumeration的直接链接" translate="no">​</a></h3>
<p>The <code>windows.modules</code> plugin lists drivers and kernel modules currently loaded into memory. Each entry includes metadata such as base address, size, and file path.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility Kernel Module Enumeration</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.modules</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="driver-scanning">Driver Scanning<a href="#driver-scanning" class="hash-link" aria-label="Driver Scanning的直接链接" title="Driver Scanning的直接链接" translate="no">​</a></h3>
<p>While <code>windows.modules</code> lists known drivers, it can miss hidden or unlinked ones. The <code>windows.driverscan</code> plugin scans raw memory for DRIVER_OBJECT structures that may have been unlinked from standard lists.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility Kernel Module Enumeration</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.driverscan</span><br></span></code></pre></div></div>
<p><strong>Tip</strong>: Use this plugin if you suspect DKOM (Direct Kernel Object Manipulation) or rootkit behaviour.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the address for the <code>NtCreateFile</code> system call? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">0x8056e27c</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-7-practical-investigations">Task 7 Practical Investigations<a href="#task-7-practical-investigations" class="hash-link" aria-label="Task 7 Practical Investigations的直接链接" title="Task 7 Practical Investigations的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="case-002">Case 002<a href="#case-002" class="hash-link" aria-label="Case 002的直接链接" title="Case 002的直接链接" translate="no">​</a></h3>
<p>You have been informed that your corporation has been hit with a chain of ransomware that has been affecting corporations internationally. Your team has already recovered from the attack through backups. Your job is to perform post-incident analysis and identify which actors were at play and what occurred on your systems. You have received a raw memory dump from your team to begin your analysis.</p>
<p>The memory file is located in <code>~/Desktop/Investigations/Investigation-2.raw</code>.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What suspicious process is running at PID 740? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@WanaDecryptor@</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the full path of the suspicious binary in PID 740? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">C:\Intel\ivecuqmanpnirkt615\@WanaDecryptor@.exe</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the parent process of PID 740? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tasksche.exe</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> From our current information, what malware is present on the system? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Wannacry</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What plugin could be used to identify all files loaded from the malware working directory? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">windows.filescan</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-8-conclusion">Task 8 Conclusion<a href="#task-8-conclusion" class="hash-link" aria-label="Task 8 Conclusion的直接链接" title="Task 8 Conclusion的直接链接" translate="no">​</a></h2>
<p>We have only covered a very thin layer of memory forensics with Volatility, which can go much deeper when analysing the Windows, Mac, and Linux architectures. If you&#x27;re looking for a deep dive into memory forensics, I suggest reading <strong>The Art of Memory Forensics</strong>.</p>
<p>Additionally, the following is a list of worthy plugin mentions that you can be aware of and read more on:</p>
<ul>
<li class=""><code>windows.callbacks</code>: Malware may register malicious callbacks for process creation, image loading, or thread creation. We can use this plugin to inspect callback functions for unknown driver associations or non-standard modules.</li>
<li class=""><code>windows.driverirp</code>: This plugin examines IRP (I/O Request Packet) dispatch tables of drivers. Suspicious drivers may register no IRP functions or point to non-driver memory.</li>
<li class=""><code>windows.modscan</code>: This plugin scans for loaded kernel modules without relying on linked lists. It can be used to uncover stealth drivers that evade both <code>modules</code> and <code>driverscan</code>.</li>
<li class=""><code>windows.moddump</code>: This plugin allows analysts to extract suspicious drivers or modules from memory for static analysis. Further investigation with tools such as Ghidra or IDA can be done to reverse engineer dumped modules.</li>
<li class=""><code>windows.memmap</code>: This plugin can perform deeper analysis of injected code or memory artefacts, to extract memory regions from specific processes.</li>
<li class=""><code>yarascan</code>: This plugin will search for strings, patterns, and compound rules against a rule set by using a YARA file as an argument or listing rules within the command line.</li>
</ul>
<p>In the next room, <a href="https://tryhackme.com/room/memoryacquisition" target="_blank" rel="noopener noreferrer" class="">Memory Acquisition</a>, we will cover memory acquisition in detail, covering all the necessary techniques and approaches.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Read the above and continue learning! </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/TryHackMyOffsecBox/TryHackMe-CN/tree/main/packages/create-docusaurus/templates/shared/docs/Modules/Memory Analysis/volatilityessentials.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/TryHackMe-CN/docs/Modules/Memory Analysis/memoryacquisition"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">内存获取</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryandprocs"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Windows内存与进程</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#任务-1-介绍" class="table-of-contents__link toc-highlight">任务 1 介绍</a><ul><li><a href="#学习目标" class="table-of-contents__link toc-highlight">学习目标</a></li><li><a href="#先决条件" class="table-of-contents__link toc-highlight">先决条件</a></li></ul></li><li><a href="#task-2-volatility-overview" class="table-of-contents__link toc-highlight">Task 2 Volatility Overview</a><ul><li><a href="#architectural-overview" class="table-of-contents__link toc-highlight">Architectural Overview</a></li><li><a href="#system-requirements-and-installation" class="table-of-contents__link toc-highlight">System Requirements and Installation</a></li></ul></li><li><a href="#task-3-memory-acquisition-and-analysis" class="table-of-contents__link toc-highlight">Task 3 Memory Acquisition and Analysis</a><ul><li><a href="#memory-acquisition-methodologies" class="table-of-contents__link toc-highlight">Memory Acquisition Methodologies</a></li><li><a href="#内存分析" class="table-of-contents__link toc-highlight">内存分析</a></li></ul></li><li><a href="#task-4-listing-processes-and-connections" class="table-of-contents__link toc-highlight">Task 4 Listing Processes and Connections</a><ul><li><a href="#active-process-enumeration" class="table-of-contents__link toc-highlight">Active Process Enumeration</a></li><li><a href="#hidden-process-enumeration" class="table-of-contents__link toc-highlight">Hidden Process Enumeration</a></li><li><a href="#process-hierarchy-enumeration" class="table-of-contents__link toc-highlight">Process Hierarchy Enumeration</a></li><li><a href="#file-registry-and-thread-enumeration" class="table-of-contents__link toc-highlight">File, Registry, and Thread Enumeration</a></li><li><a href="#network-connection-enumeration" class="table-of-contents__link toc-highlight">Network Connection Enumeration</a></li><li><a href="#tcpudp-socket-enumeration" class="table-of-contents__link toc-highlight">TCP/UDP Socket Enumeration</a></li><li><a href="#dll-enumeration" class="table-of-contents__link toc-highlight">DLL Enumeration</a></li></ul></li><li><a href="#task-5-volatility-hunting-and-detection-capabilities" class="table-of-contents__link toc-highlight">Task 5 Volatility Hunting and Detection Capabilities</a><ul><li><a href="#malware-analysis" class="table-of-contents__link toc-highlight">Malware Analysis</a></li></ul></li><li><a href="#task-6-advanced-memory-forensics" class="table-of-contents__link toc-highlight">Task 6 Advanced Memory Forensics</a><ul><li><a href="#ssdt-hook-detection" class="table-of-contents__link toc-highlight">SSDT Hook Detection</a></li><li><a href="#kernel-module-enumeration" class="table-of-contents__link toc-highlight">Kernel Module Enumeration</a></li><li><a href="#driver-scanning" class="table-of-contents__link toc-highlight">Driver Scanning</a></li></ul></li><li><a href="#task-7-practical-investigations" class="table-of-contents__link toc-highlight">Task 7 Practical Investigations</a><ul><li><a href="#case-002" class="table-of-contents__link toc-highlight">Case 002</a></li></ul></li><li><a href="#task-8-conclusion" class="table-of-contents__link toc-highlight">Task 8 Conclusion</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/TryHackMe-CN/docs">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/TryHackMyOffsecBox" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github - TryHackMyOffsecBox<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/CRONUS-Security" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github - CRONUS-Security<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 TryHackMyOffsecBox. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>