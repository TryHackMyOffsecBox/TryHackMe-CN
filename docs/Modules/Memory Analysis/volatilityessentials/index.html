<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Modules/Memory Analysis/volatilityessentials" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Volatility基础 | TryHackMe-CN</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/volatilityessentials"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Volatility基础 | TryHackMe-CN"><meta data-rh="true" name="description" content="任务 1 介绍"><meta data-rh="true" property="og:description" content="任务 1 介绍"><link data-rh="true" rel="icon" href="/TryHackMe-CN/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/volatilityessentials"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/docs/Modules/Memory Analysis/volatilityessentials" hreflang="en"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/volatilityessentials" hreflang="zh"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/volatilityessentials" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"模块","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/"},{"@type":"ListItem","position":2,"name":"内存分析","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/"},{"@type":"ListItem","position":3,"name":"Volatility基础","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/volatilityessentials"}]}</script><link rel="alternate" type="application/rss+xml" href="/TryHackMe-CN/blog/rss.xml" title="TryHackMe-CN RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/TryHackMe-CN/blog/atom.xml" title="TryHackMe-CN Atom Feed"><link rel="stylesheet" href="/TryHackMe-CN/assets/css/styles.6c4c8a38.css">
<script src="/TryHackMe-CN/assets/js/runtime~main.c6e97409.js" defer="defer"></script>
<script src="/TryHackMe-CN/assets/js/main.63d06b47.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/TryHackMe-CN/img/logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/TryHackMe-CN/"><div class="navbar__logo"><img src="/TryHackMe-CN/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/TryHackMe-CN/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">TryHackMe-CN</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/TryHackMe-CN/docs/Modules/">Tutorial</a><a class="navbar__item navbar__link" href="/TryHackMe-CN/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/volatilityessentials" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/TryHackMe-CN/docs/Modules/Memory Analysis/volatilityessentials" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh">简体中文</a></li></ul></div><a href="https://github.com/TryHackMyOffsecBox/TryHackMe-CN" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/TryHackMe-CN/docs/Modules/"><span title="模块" class="categoryLinkLabel_W154">模块</span></a><button aria-label="折叠侧边栏分类 &#x27;模块&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Attacking LLMs/"><span title="攻击大型语言模型" class="categoryLinkLabel_W154">攻击大型语言模型</span></a><button aria-label="展开侧边栏分类 &#x27;攻击大型语言模型&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Command Line/"><span title="命令行" class="categoryLinkLabel_W154">命令行</span></a><button aria-label="展开侧边栏分类 &#x27;命令行&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Container Security/"><span title="容器安全" class="categoryLinkLabel_W154">容器安全</span></a><button aria-label="展开侧边栏分类 &#x27;容器安全&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Host Evasions/"><span title="主机规避" class="categoryLinkLabel_W154">主机规避</span></a><button aria-label="展开侧边栏分类 &#x27;主机规避&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/"><span title="内存分析" class="categoryLinkLabel_W154">内存分析</span></a><button aria-label="折叠侧边栏分类 &#x27;内存分析&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/memoryanalysisintroduction"><span title="内存分析简介" class="linkLabel_WmDU">内存分析简介</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/memoryacquisition"><span title="内存获取" class="linkLabel_WmDU">内存获取</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/volatilityessentials"><span title="Volatility基础" class="linkLabel_WmDU">Volatility基础</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryandprocs"><span title="Windows内存与进程" class="linkLabel_WmDU">Windows内存与进程</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryanduseractivity"><span title="Windows内存与用户活动" class="linkLabel_WmDU">Windows内存与用户活动</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryandnetwork"><span title="Windows内存与网络" class="linkLabel_WmDU">Windows内存与网络</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Microsoft Defender XDR/"><span title="Microsoft Defender XDR" class="categoryLinkLabel_W154">Microsoft Defender XDR</span></a><button aria-label="展开侧边栏分类 &#x27;Microsoft Defender XDR&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Starters/"><span title="入门挑战" class="categoryLinkLabel_W154">入门挑战</span></a><button aria-label="展开侧边栏分类 &#x27;入门挑战&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/TryHackMe-CN/docs/Networks/"><span title="网络" class="categoryLinkLabel_W154">网络</span></a><button aria-label="展开侧边栏分类 &#x27;网络&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/TryHackMe-CN/docs/"><span title="index" class="linkLabel_WmDU">index</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/TryHackMe-CN/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/TryHackMe-CN/docs/Modules/"><span>模块</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/TryHackMe-CN/docs/Modules/Memory Analysis/"><span>内存分析</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Volatility基础</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Volatility基础</h1></header>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务-1-介绍">任务 1 介绍<a href="#任务-1-介绍" class="hash-link" aria-label="任务 1 介绍的直接链接" title="任务 1 介绍的直接链接" translate="no">​</a></h2>
<p>在之前的房间<a href="https://tryhackme.com/room/memoryanalysisintroduction" target="_blank" rel="noopener noreferrer" class="">内存分析简介</a>中，我们了解了内存取证在网络安全中的关键性质。 我们探讨了内存转储的结构，区分了RAM和磁盘取证，并看到了内存分析至关重要的场景。</p>
<p>在这里，我们将开始通过工具（特别是Volatility）来了解内存取证的实践方面。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="学习目标">学习目标<a href="#学习目标" class="hash-link" aria-label="学习目标的直接链接" title="学习目标的直接链接" translate="no">​</a></h3>
<ul>
<li class="">熟悉Volatility框架</li>
<li class="">导航并使用基本的Volatility命令和插件</li>
<li class="">使用Volatility进行取证分析，以识别关键工件，如运行进程和加载的DLL</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="先决条件">先决条件<a href="#先决条件" class="hash-link" aria-label="先决条件的直接链接" title="先决条件的直接链接" translate="no">​</a></h3>
<ul>
<li class=""><a href="https://tryhackme.com/room/memoryanalysisintroduction" target="_blank" rel="noopener noreferrer" class="">内存分析简介</a></li>
<li class=""><a href="https://tryhackme.com/room/btwindowsinternals" target="_blank" rel="noopener noreferrer" class="">核心Windows进程</a></li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 准备好学习Volatility和内存分析。 </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务2-volatility概述">任务2 Volatility概述<a href="#任务2-volatility概述" class="hash-link" aria-label="任务2 Volatility概述的直接链接" title="任务2 Volatility概述的直接链接" translate="no">​</a></h2>
<p><a href="https://volatilityfoundation.org/the-volatility-framework/" target="_blank" rel="noopener noreferrer" class="">Volatility</a>是一个开源的、跨平台、模块化且可扩展的内存取证框架。 该框架多年来经历了多次迭代，当前版本为Volatility 3。 此版本优于其前身，因为它放弃了静态操作系统分析，转而采用动态符号解析，支持更新的操作系统、内存布局，并完全洞察系统的运行时状态。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="架构概述">架构概述<a href="#架构概述" class="hash-link" aria-label="架构概述的直接链接" title="架构概述的直接链接" translate="no">​</a></h3>
<p>Volatility 3由几个关键层组成：</p>
<ul>
<li class=""><strong>内存层</strong>：这些层表示地址空间的层次结构，从原始内存到虚拟地址转换。</li>
<li class=""><strong>符号表</strong>：这些表通过操作系统特定的调试符号来解释内核和进程结构。</li>
<li class=""><strong>插件</strong>：这些是模块化例程，利用底层内存层和符号表来提取取证感兴趣的工件。 稍后在房间中，我们将查看一些关键插件。</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="系统要求和安装">系统要求和安装<a href="#系统要求和安装" class="hash-link" aria-label="系统要求和安装的直接链接" title="系统要求和安装的直接链接" translate="no">​</a></h3>
<p>Volatility 3需要Python 3.6或更高版本才能运行。 此外，它受益于各种库，如<code>pefile</code>、<code>capstone</code>和<code>yara-python</code>，这些库允许我们分别处理可移植可执行文件、执行内存反汇编并在分析中使用YARA规则。 下面的终端输出显示了如何通过克隆<a href="https://github.com/volatilityfoundation/volatility3.git" target="_blank" rel="noopener noreferrer" class="">GitHub仓库</a>并从源代码直接运行来安装Volatility。</p>
<p>Volatility已安装在此房间连接的机器上，可在<code>Desktop/volatility3</code>目录下访问。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility Installation</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop$ </span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/volatilityfoundation/volatility3.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop$ </span><span class="token builtin class-name">cd</span><span class="token plain"> volatility3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-h</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> Framework </span><span class="token number" style="color:#36acaa">2.26</span><span class="token plain">.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">usage: vol.py </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-h</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-c CONFIG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--parallelism </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">processes,threads,off</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-e EXTEND</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-p PLUGIN_DIRS</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-s SYMBOL_DIRS</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-v</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-l LOG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-o OUTPUT_DIR</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-q</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-r RENDERER</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-f FILE</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--write-config</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--save-config SAVE_CONFIG</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--clear-cache</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--cache-path CACHE_PATH</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--offline </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain"> URL</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--filters FILTERS</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--hide-columns </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">HIDE_COLUMNS </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--single-location SINGLE_LOCATION</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--stackers </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">STACKERS </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--single-swap-locations </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">SINGLE_SWAP_LOCATIONS </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              PLUGIN </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">An open-source memory forensics framework</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">options:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -h, </span><span class="token parameter variable" style="color:#36acaa">--help</span><span class="token plain">            Show this </span><span class="token builtin class-name">help</span><span class="token plain"> message and exit, </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> specific plugin options use </span><span class="token string" style="color:#e3116c">&#x27;vol.py  --help&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> CONFIG, </span><span class="token parameter variable" style="color:#36acaa">--config</span><span class="token plain"> CONFIG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        Load the configuration from a json </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------TRUNCATED--------</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 阅读以上内容并导航到Volatility目录。 </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务3-内存获取和分析">任务3 内存获取和分析<a href="#任务3-内存获取和分析" class="hash-link" aria-label="任务3 内存获取和分析的直接链接" title="任务3 内存获取和分析的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="内存获取方法">内存获取方法<a href="#内存获取方法" class="hash-link" aria-label="内存获取方法的直接链接" title="内存获取方法的直接链接" translate="no">​</a></h3>
<p>内存取证是取证中的一个基础步骤，必须以确保我们保持证据完整性的方式执行。 所使用的流程和部署环境因操作系统而异。</p>
<p>对于Windows系统，可以使用以下工具进行内存获取：</p>
<ul>
<li class=""><strong>DumpIt</strong>：在32/64位Windows上捕获完整的物理内存镜像，并自动对输出进行哈希处理。</li>
<li class=""><strong>WinPmem</strong>：基于驱动的开源工具，以RAW/ELF格式获取RAM，并嵌入获取元数据以用于证据链。</li>
<li class=""><strong>Magnet RAM Capture</strong>：GUI驱动的收集器，在实时Windows主机上快照易失性内存，同时最小化占用空间。</li>
<li class=""><strong>FTK Imager</strong>：最常见的商业工具，在磁盘镜像功能的同时获取内存和选定的逻辑工件。</li>
</ul>
<p>对于Linux和macOS系统，我们可以使用以下工具的服务：</p>
<ul>
<li class=""><strong>AVML</strong>：轻量级Microsoft CLI实用程序，将Linux内存转储到压缩的ELF文件中，无需内核模块。</li>
<li class=""><strong>LiME</strong>：Linux的可加载内核模块，通过磁盘或网络捕获完整的易失性内存，并支持ARM/x86架构。</li>
<li class=""><strong>OSXPmem</strong>：macOS特定的Pmem分支，在基于Intel的Mac上创建原始内存镜像，用于后续的Volatility分析。</li>
</ul>
<p>从虚拟环境中提取内存可以通过从主机驱动器中收集虚拟内存文件来完成。 根据所使用的虚拟机管理程序，输出文件可能会有所不同，您可能会遇到以下示例：</p>
<ul>
<li class="">VMware - <code>.vmem</code></li>
<li class="">Hyper-V - <code>.bin</code></li>
<li class="">Parallels - <code>.mem</code></li>
<li class="">VirtualBox - <code>.sav</code> 值得注意的是，这是一个部分内存文件。</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="内存分析">内存分析<a href="#内存分析" class="hash-link" aria-label="内存分析的直接链接" title="内存分析的直接链接" translate="no">​</a></h3>
<p>为了全面且实践性地理解Volatility，我们将调查一个取证案例，并使用它来了解该工具的内部工作原理。 分析文件位于<code>Desktop/Investigations</code>目录下。</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="案例001">案例001<a href="#案例001" class="hash-link" aria-label="案例001的直接链接" title="案例001的直接链接" translate="no">​</a></h4>
<p>您的SOC通知您，他们已从一个隔离的端点收集了内存转储，该端点被认为已被伪装成Adobe文档的银行木马感染。 您的任务是利用威胁情报和逆向工程知识，对受感染主机进行内存取证。</p>
<p>您已被告知一个与文件<code>Investigation-1.vmem</code>相关的可疑IP，可能有用：<code>41.168.5.140</code>。</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="插件">插件<a href="#插件" class="hash-link" aria-label="插件的直接链接" title="插件的直接链接" translate="no">​</a></h4>
<p>Volatility使用插件来请求数据以进行分析。 一些最常用的插件包括：</p>
<ul>
<li class=""><code>windows.info</code></li>
<li class=""><code>linux.info</code></li>
<li class=""><code>pslist</code></li>
<li class=""><code>pstree</code></li>
</ul>
<p>让我们查看这些插件，从我们的内存文件中提取信息。 首先，我们可以从获取镜像中的操作系统详细信息开始。 在Volatility的先前版本中，此信息被识别为<strong>操作系统配置文件</strong>，并使用插件<code>imageinfo</code>提取。 然而，操作系统配置文件在新版本中已被弃用，现在我们有了单独的信息插件。</p>
<p>鉴于我们的内存文件是从运行在VMware上的Windows虚拟机获取的，我们可以使用以下命令提取其配置文件的详细信息：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility Windows Info</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> Framework </span><span class="token number" style="color:#36acaa">2.26</span><span class="token plain">.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WARNING  volatility3.framework.layers.vmware: No metadata </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> found alongside VMEM file. A VMSS or VMSN </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> may be required to correctly process a VMEM file. These should be placed </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> the same directory with the same </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> name, e.g. Investigation-1.vmem and Investigation-1.vmss.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Progress:  </span><span class="token number" style="color:#36acaa">100.00</span><span class="token plain">               PDB scanning finished                                                                                              </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Variable        Value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Kernel Base     0x804d7000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DTB     0x2fe000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Symbols file:///home/ubuntu/Desktop/volatility3/volatility3/symbols/windows/ntkrnlpa.pdb/30B5FB31AE7E4ACAABA750AA241FF331-1.json.xz</span><br></span></code></pre></div></div>
<p>我们可以从详细信息中提取系统版本、架构、符号表和可用的内存层。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 案例001中主机机器的构建版本是什么？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">2600.xpsp.080413-2111</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 案例001中内存文件是在什么时间获取的？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">2012-07-22 02:45:08</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务4-列出进程和连接">任务4 列出进程和连接<a href="#任务4-列出进程和连接" class="hash-link" aria-label="任务4 列出进程和连接的直接链接" title="任务4 列出进程和连接的直接链接" translate="no">​</a></h2>
<p>当我们想要分析内存文件中进程和网络连接的详细信息时，Volatility支持不同的插件，每个插件使用不同的技术。 并非此处提到的所有插件都会从内存文件中产生结果，因为捕获可能未包含插件将枚举的进程或服务。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="活动进程枚举">活动进程枚举<a href="#活动进程枚举" class="hash-link" aria-label="活动进程枚举的直接链接" title="活动进程枚举的直接链接" translate="no">​</a></h3>
<p>列出进程的最基本方法是使用<code>pslist</code>。 此插件从跟踪内存中进程的双向链表中枚举活动进程，相当于任务管理器中的进程列表。 此插件的输出将包括所有当前和已终止的进程及其退出时间。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility Process Enumeration</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.pslist</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="隐藏进程枚举">隐藏进程枚举<a href="#隐藏进程枚举" class="hash-link" aria-label="隐藏进程枚举的直接链接" title="隐藏进程枚举的直接链接" translate="no">​</a></h3>
<p>一些恶意软件（通常是rootkit）会尝试隐藏其进程，从列表中取消链接自身。 通过从列表中取消链接自身，使用<code>pslist</code>时将不再看到它们的进程。 为了对抗这种规避技术，我们可以使用<code>psscan</code>。 这种列出进程的技术将通过查找匹配<code>_EPROCESS</code>的数据结构来定位进程。 虽然这种技术可以帮助对抗规避措施，但也可能导致误报；因此，我们必须小心。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility Process Enumeration</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.psscan</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="进程层次枚举">进程层次枚举<a href="#进程层次枚举" class="hash-link" aria-label="进程层次枚举的直接链接" title="进程层次枚举的直接链接" translate="no">​</a></h3>
<p>第三个进程插件<code>pstree</code>不提供任何其他特殊技术来帮助识别规避，如最后两个插件。 然而，此插件将根据其父进程ID列出所有进程，使用与<code>pslist</code>相同的方法。 这对于分析师获取进程的完整情况以及提取时可能发生的情况非常有用。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility Process Enumeration</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.pstree</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="文件注册表和线程枚举">文件、注册表和线程枚举<a href="#文件注册表和线程枚举" class="hash-link" aria-label="文件、注册表和线程枚举的直接链接" title="文件、注册表和线程枚举的直接链接" translate="no">​</a></h3>
<p>在内存取证调查期间，检查文件和注册表也至关重要。 我们可以使用 <code>handles</code> 插件来查看主机中文件和线程的详细信息及句柄。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility Files Inspecting</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.handles</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="网络连接枚举">网络连接枚举<a href="#网络连接枚举" class="hash-link" aria-label="网络连接枚举的直接链接" title="网络连接枚举的直接链接" translate="no">​</a></h3>
<p>既然我们知道了如何识别进程，我们也需要一种方法来识别主机提取时存在的网络连接。 <code>netstat</code> 将尝试识别所有具有网络连接的内存结构。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility Network  Enumeration</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.netstat</span><br></span></code></pre></div></div>
<p>值得注意的是，在 Volatility 3 的当前状态下，此命令可能非常不稳定，尤其是在旧的 Windows 构建版本中。 为了解决这个问题，你可以使用其他工具，如 <a href="https://tools.kali.org/forensics/bulk-extractor" target="_blank" rel="noopener noreferrer" class="">bulk_extractor</a>，从内存文件中提取 PCAP 文件。 有时，对于无法仅从 Volatility 识别的网络连接，这更可取。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="tcpudp-套接字枚举">TCP/UDP 套接字枚举<a href="#tcpudp-套接字枚举" class="hash-link" aria-label="TCP/UDP 套接字枚举的直接链接" title="TCP/UDP 套接字枚举的直接链接" translate="no">​</a></h3>
<p>我们还可以从内存文件中识别网络套接字及其关联的进程。 为此，我们可以使用 <code>netscan</code> 插件。 这将通过内存池扫描恢复活动和已关闭的 TCP/UDP 连接、关联的进程 ID、本地和远程端口以及 IP。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility TCP/UDP Enumeration</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.netscan</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="dll-枚举">DLL 枚举<a href="#dll-枚举" class="hash-link" aria-label="DLL 枚举的直接链接" title="DLL 枚举的直接链接" translate="no">​</a></h3>
<p>我们将介绍的最后一个插件是 <code>dlllist</code>。 此插件将列出提取时与进程关联的所有 DLL。 一旦你进一步分析并将输出过滤到可能指示你认为系统上存在的特定类型恶意软件的特定 DLL 时，这可能特别有用。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility DLL Enumeration</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.dlllist</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 活动 Adobe 进程的绝对路径是什么？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">C:\Program Files\Adobe\Reader 9.0\Reader\Reader_sl.exe</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 在案例 001 中，此进程的父进程是什么？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">explorer.exe</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 父进程的 PID 是什么？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1484</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Adobe 进程使用了多少个位于 <code>system32</code> 目录之外的 DLL 文件？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">3</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 与进程句柄关联的一个 KeyedEvent 的名称是什么？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CritSecOutOfMemoryEvent</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务5-volatility-狩猎与检测能力">任务5 Volatility 狩猎与检测能力<a href="#任务5-volatility-狩猎与检测能力" class="hash-link" aria-label="任务5 Volatility 狩猎与检测能力的直接链接" title="任务5 Volatility 狩猎与检测能力的直接链接" translate="no">​</a></h2>
<p>高级威胁可以仅在内存中执行，避免磁盘痕迹。 Volatility 提供了许多插件，可以在狩猎注入代码和恶意软件时，以及通过 YARA 应用自定义检测规则时，帮助提升你的狩猎和检测能力。</p>
<p>在阅读本节之前，建议你对对手如何采用规避技术和各种恶意软件技术，以及如何狩猎和检测它们有基本的了解。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="恶意软件分析">恶意软件分析<a href="#恶意软件分析" class="hash-link" aria-label="恶意软件分析的直接链接" title="恶意软件分析的直接链接" translate="no">​</a></h3>
<p>我们将讨论的第一个插件是 <code>malfind</code>，它是狩猎代码注入时最有用的插件之一。 此插件将尝试检测注入的进程及其 PID，以及偏移地址和感染区域的十六进制、ASCII 和反汇编视图。 该插件通过扫描堆并识别设置了可执行位 <strong>RWE</strong> 或 <strong>RX</strong> 和/或磁盘上没有内存映射文件（无文件恶意软件）的进程来工作。</p>
<p>根据 <code>malfind</code> 识别的内容，注入的区域会发生变化。 MZ 头是 Windows 可执行文件的指示器。 注入的区域也可能指向需要进一步分析的 shellcode。</p>
<p><img decoding="async" loading="lazy" alt="Windows 可执行文件的文件结构，显示 MZ 头值。" src="/TryHackMe-CN/assets/images/image_20251207-210748-050e85a68cfee8ec51dcc233adae6000.png" width="623" height="222" class="img_ev3q"></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility Malware Enumeration</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.malfind</span><br></span></code></pre></div></div>
<p>另一个有用的插件是 <code>vadinfo</code>。 这显示了虚拟内存描述符的详细信息，在手动调查可疑内存区域和堆分配时非常有用。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility Malware Enumeration</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.vadinfo</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 案例 001 内存文件中的哪些进程包含指向 Windows 可执行文件的头？ (答案: process1,process2) </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">explorer.exe,reader_sl.exe</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务6-高级内存取证">任务6 高级内存取证<a href="#任务6-高级内存取证" class="hash-link" aria-label="任务6 高级内存取证的直接链接" title="任务6 高级内存取证的直接链接" translate="no">​</a></h2>
<p>取证分析师在处理诸如内核模式 rootkit 等复杂威胁时，必须能够检测操作系统深处的操纵。 Rootkit 旨在通过修改内核结构来隐藏进程、文件、驱动程序及其存在。 本节重点使用 Volatility 3，对这些高级规避技术，特别是在 Windows 操作系统内，进行结构化和实践性的探索。</p>
<p>高级对手经常采用 <strong>挂钩</strong> —— 一种允许恶意软件拦截并可能重定向系统级功能以实现规避或持久性的技术。 挂钩本身并非恶意；防病毒和调试工具也合法地使用它们。 分析师的责任是识别挂钩的存在是否符合预期的系统行为，还是代表恶意干扰。</p>
<p>最常见的挂钩策略之一是 <strong>系统服务描述符表 (SSDT)</strong> 挂钩。 这些挂钩用于修改内核系统调用表条目。 它们在内核模式恶意软件中很普遍，Volatility 提供了相应的插件进行分析。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="ssdt-挂钩检测">SSDT 挂钩检测<a href="#ssdt-挂钩检测" class="hash-link" aria-label="SSDT 挂钩检测的直接链接" title="SSDT 挂钩检测的直接链接" translate="no">​</a></h3>
<p>Windows 内核使用 <strong>系统服务描述符表 (SSDT)</strong> 来解析系统调用的地址。 Rootkit 经常覆盖 SSDT 条目，将合法的系统调用（例如 <code>NtCreateFile</code>）重定向到其恶意对应项。</p>
<p>Volatility 3 的 <code>windows.ssdt</code> 插件使分析师能够检查此表是否存在任何异常。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility SSDT Hook Enumeration</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.ssdt</span><br></span></code></pre></div></div>
<p><strong>建议</strong>：在发现可疑内核模块或异常进程行为 <strong>之后</strong> 执行 SSDT 检查。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="内核模块枚举">内核模块枚举<a href="#内核模块枚举" class="hash-link" aria-label="内核模块枚举的直接链接" title="内核模块枚举的直接链接" translate="no">​</a></h3>
<p><code>windows.modules</code> 插件列出了当前加载到内存中的驱动程序和内核模块。 每个条目包括基地址、大小和文件路径等元数据。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility Kernel Module Enumeration</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.modules</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="驱动程序扫描">驱动程序扫描<a href="#驱动程序扫描" class="hash-link" aria-label="驱动程序扫描的直接链接" title="驱动程序扫描的直接链接" translate="no">​</a></h3>
<p>虽然 <code>windows.modules</code> 列出了已知的驱动程序，但它可能会遗漏隐藏或未链接的驱动程序。 <code>windows.driverscan</code> 插件扫描原始内存中可能已从标准列表中取消链接的 DRIVER_OBJECT 结构。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Volatility Kernel Module Enumeration</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ~/Desktop/Investigations/Investigation-1.vmem windows.driverscan</span><br></span></code></pre></div></div>
<p><strong>提示</strong>：如果你怀疑 DKOM（直接内核对象操纵）或 rootkit 行为，请使用此插件。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> <code>NtCreateFile</code> 系统调用的地址是什么？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">0x8056e27c</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务7-实践调查">任务7 实践调查<a href="#任务7-实践调查" class="hash-link" aria-label="任务7 实践调查的直接链接" title="任务7 实践调查的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="案例-002">案例 002<a href="#案例-002" class="hash-link" aria-label="案例 002的直接链接" title="案例 002的直接链接" translate="no">​</a></h3>
<p>你被告知你的公司遭受了一系列影响国际公司的勒索软件攻击。 你的团队已经通过备份从攻击中恢复。 你的工作是进行事后分析，并确定哪些行为者参与其中以及你的系统上发生了什么。 你已收到团队提供的原始内存转储以开始分析。</p>
<p>内存文件位于 <code>~/Desktop/Investigations/Investigation-2.raw</code>。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> PID 740 正在运行什么可疑进程？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@WanaDecryptor@</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> PID 740 中可疑二进制文件的完整路径是什么？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">C:\Intel\ivecuqmanpnirkt615\@WanaDecryptor@.exe</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> PID 740 的父进程是什么？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tasksche.exe</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 根据我们当前的信息，系统上存在什么恶意软件？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Wannacry</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 可以使用什么插件来识别从恶意软件工作目录加载的所有文件？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">windows.filescan</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务8结论">任务8结论<a href="#任务8结论" class="hash-link" aria-label="任务8结论的直接链接" title="任务8结论的直接链接" translate="no">​</a></h2>
<p>我们只涵盖了使用 Volatility 进行内存取证的一个非常浅的层面，在分析 Windows、Mac 和 Linux 架构时，它可以深入得多。 如果你想深入了解内存取证，我建议阅读 <strong>《内存取证的艺术》</strong>。</p>
<p>此外，以下是一些值得提及的插件列表，你可以了解并进一步阅读：</p>
<ul>
<li class=""><code>windows.callbacks</code>：恶意软件可能会为进程创建、映像加载或线程创建注册恶意回调。 我们可以使用此插件来检查未知驱动程序关联或非标准模块的回调函数。</li>
<li class=""><code>windows.driverirp</code>：此插件检查驱动程序的 IRP（I/O 请求包）调度表。 可疑驱动程序可能不注册任何 IRP 函数或指向非驱动程序内存。</li>
<li class=""><code>windows.modscan</code>：此插件扫描已加载的内核模块，而不依赖链表。 它可用于发现逃避<code>modules</code>和<code>driverscan</code>的隐形驱动程序。</li>
<li class=""><code>windows.moddump</code>：此插件允许分析人员从内存中提取可疑驱动程序或模块进行静态分析。 可以使用Ghidra或IDA等工具进一步调查，对转储的模块进行逆向工程。</li>
<li class=""><code>windows.memmap</code>：此插件可以对注入代码或内存工件进行更深入的分析，从特定进程中提取内存区域。</li>
<li class=""><code>yarascan</code>：此插件将使用YARA文件作为参数或在命令行中列出规则，根据规则集搜索字符串、模式和复合规则。</li>
</ul>
<p>在下一个房间<a href="https://tryhackme.com/room/memoryacquisition" target="_blank" rel="noopener noreferrer" class="">内存获取</a>中，我们将详细介绍内存获取，涵盖所有必要的技术和方法。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 阅读以上内容并继续学习！ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/TryHackMyOffsecBox/TryHackMe-CN/tree/main/packages/create-docusaurus/templates/shared/docs/Modules/Memory Analysis/volatilityessentials.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/TryHackMe-CN/docs/Modules/Memory Analysis/memoryacquisition"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">内存获取</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryandprocs"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Windows内存与进程</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#任务-1-介绍" class="table-of-contents__link toc-highlight">任务 1 介绍</a><ul><li><a href="#学习目标" class="table-of-contents__link toc-highlight">学习目标</a></li><li><a href="#先决条件" class="table-of-contents__link toc-highlight">先决条件</a></li></ul></li><li><a href="#任务2-volatility概述" class="table-of-contents__link toc-highlight">任务2 Volatility概述</a><ul><li><a href="#架构概述" class="table-of-contents__link toc-highlight">架构概述</a></li><li><a href="#系统要求和安装" class="table-of-contents__link toc-highlight">系统要求和安装</a></li></ul></li><li><a href="#任务3-内存获取和分析" class="table-of-contents__link toc-highlight">任务3 内存获取和分析</a><ul><li><a href="#内存获取方法" class="table-of-contents__link toc-highlight">内存获取方法</a></li><li><a href="#内存分析" class="table-of-contents__link toc-highlight">内存分析</a></li></ul></li><li><a href="#任务4-列出进程和连接" class="table-of-contents__link toc-highlight">任务4 列出进程和连接</a><ul><li><a href="#活动进程枚举" class="table-of-contents__link toc-highlight">活动进程枚举</a></li><li><a href="#隐藏进程枚举" class="table-of-contents__link toc-highlight">隐藏进程枚举</a></li><li><a href="#进程层次枚举" class="table-of-contents__link toc-highlight">进程层次枚举</a></li><li><a href="#文件注册表和线程枚举" class="table-of-contents__link toc-highlight">文件、注册表和线程枚举</a></li><li><a href="#网络连接枚举" class="table-of-contents__link toc-highlight">网络连接枚举</a></li><li><a href="#tcpudp-套接字枚举" class="table-of-contents__link toc-highlight">TCP/UDP 套接字枚举</a></li><li><a href="#dll-枚举" class="table-of-contents__link toc-highlight">DLL 枚举</a></li></ul></li><li><a href="#任务5-volatility-狩猎与检测能力" class="table-of-contents__link toc-highlight">任务5 Volatility 狩猎与检测能力</a><ul><li><a href="#恶意软件分析" class="table-of-contents__link toc-highlight">恶意软件分析</a></li></ul></li><li><a href="#任务6-高级内存取证" class="table-of-contents__link toc-highlight">任务6 高级内存取证</a><ul><li><a href="#ssdt-挂钩检测" class="table-of-contents__link toc-highlight">SSDT 挂钩检测</a></li><li><a href="#内核模块枚举" class="table-of-contents__link toc-highlight">内核模块枚举</a></li><li><a href="#驱动程序扫描" class="table-of-contents__link toc-highlight">驱动程序扫描</a></li></ul></li><li><a href="#任务7-实践调查" class="table-of-contents__link toc-highlight">任务7 实践调查</a><ul><li><a href="#案例-002" class="table-of-contents__link toc-highlight">案例 002</a></li></ul></li><li><a href="#任务8结论" class="table-of-contents__link toc-highlight">任务8结论</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/TryHackMe-CN/docs">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/TryHackMyOffsecBox" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github - TryHackMyOffsecBox<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/CRONUS-Security" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github - CRONUS-Security<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 TryHackMyOffsecBox. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>