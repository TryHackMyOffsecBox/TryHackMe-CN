<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Modules/Memory Analysis/memoryacquisition" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">内存获取 | TryHackMe-CN</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/memoryacquisition"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="内存获取 | TryHackMe-CN"><meta data-rh="true" name="description" content="任务 1 介绍"><meta data-rh="true" property="og:description" content="任务 1 介绍"><link data-rh="true" rel="icon" href="/TryHackMe-CN/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/memoryacquisition"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/docs/Modules/Memory Analysis/memoryacquisition" hreflang="en"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/memoryacquisition" hreflang="zh"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/memoryacquisition" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"模块","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/"},{"@type":"ListItem","position":2,"name":"内存分析","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/"},{"@type":"ListItem","position":3,"name":"内存获取","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/memoryacquisition"}]}</script><link rel="alternate" type="application/rss+xml" href="/TryHackMe-CN/blog/rss.xml" title="TryHackMe-CN RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/TryHackMe-CN/blog/atom.xml" title="TryHackMe-CN Atom Feed"><link rel="stylesheet" href="/TryHackMe-CN/assets/css/styles.6c4c8a38.css">
<script src="/TryHackMe-CN/assets/js/runtime~main.07dcbee3.js" defer="defer"></script>
<script src="/TryHackMe-CN/assets/js/main.02822218.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/TryHackMe-CN/img/logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/TryHackMe-CN/"><div class="navbar__logo"><img src="/TryHackMe-CN/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/TryHackMe-CN/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">TryHackMe-CN</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/TryHackMe-CN/docs/Modules/">Tutorial</a><a class="navbar__item navbar__link" href="/TryHackMe-CN/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/memoryacquisition" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/TryHackMe-CN/docs/Modules/Memory Analysis/memoryacquisition" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh">简体中文</a></li></ul></div><a href="https://github.com/TryHackMyOffsecBox/TryHackMe-CN" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/TryHackMe-CN/docs/Modules/"><span title="模块" class="categoryLinkLabel_W154">模块</span></a><button aria-label="折叠侧边栏分类 &#x27;模块&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Attacking LLMs/"><span title="攻击大型语言模型" class="categoryLinkLabel_W154">攻击大型语言模型</span></a><button aria-label="展开侧边栏分类 &#x27;攻击大型语言模型&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Command Line/"><span title="命令行" class="categoryLinkLabel_W154">命令行</span></a><button aria-label="展开侧边栏分类 &#x27;命令行&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Container Security/"><span title="容器安全" class="categoryLinkLabel_W154">容器安全</span></a><button aria-label="展开侧边栏分类 &#x27;容器安全&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Host Evasions/"><span title="主机规避" class="categoryLinkLabel_W154">主机规避</span></a><button aria-label="展开侧边栏分类 &#x27;主机规避&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/"><span title="内存分析" class="categoryLinkLabel_W154">内存分析</span></a><button aria-label="折叠侧边栏分类 &#x27;内存分析&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/memoryanalysisintroduction"><span title="内存分析简介" class="linkLabel_WmDU">内存分析简介</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/memoryacquisition"><span title="内存获取" class="linkLabel_WmDU">内存获取</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/volatilityessentials"><span title="Volatility Essentials" class="linkLabel_WmDU">Volatility Essentials</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryandprocs"><span title="Windows Memory &amp; Processes" class="linkLabel_WmDU">Windows Memory &amp; Processes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryanduseractivity"><span title="Windows Memory &amp; User Activity" class="linkLabel_WmDU">Windows Memory &amp; User Activity</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Microsoft Defender XDR/"><span title="Microsoft Defender XDR" class="categoryLinkLabel_W154">Microsoft Defender XDR</span></a><button aria-label="展开侧边栏分类 &#x27;Microsoft Defender XDR&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Starters/"><span title="入门挑战" class="categoryLinkLabel_W154">入门挑战</span></a><button aria-label="展开侧边栏分类 &#x27;入门挑战&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/TryHackMe-CN/docs/Networks/"><span title="网络" class="categoryLinkLabel_W154">网络</span></a><button aria-label="展开侧边栏分类 &#x27;网络&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/TryHackMe-CN/docs/"><span title="index" class="linkLabel_WmDU">index</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/TryHackMe-CN/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/TryHackMe-CN/docs/Modules/"><span>模块</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/TryHackMe-CN/docs/Modules/Memory Analysis/"><span>内存分析</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">内存获取</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>内存获取</h1></header>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务-1-介绍">任务 1 介绍<a href="#任务-1-介绍" class="hash-link" aria-label="任务 1 介绍的直接链接" title="任务 1 介绍的直接链接" translate="no">​</a></h2>
<p>在分析内存之前，您必须先获取它。 这涉及将易失性内存的内容复制到非易失性存储中（《内存取证的艺术》）。 内存分析的有效性取决于内存获取过程的质量——准确捕获内存与解释它同样重要。 在本房间中，我们将讨论在内存获取之前、期间和之后需要考虑的所有变量。 这些变量包括工具、时机、格式、环境等。 然后，您将继续在Windows、Linux和Hypervisor上有效创建符合取证要求的内存映像。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="学习目标">学习目标<a href="#学习目标" class="hash-link" aria-label="学习目标的直接链接" title="学习目标的直接链接" translate="no">​</a></h3>
<ul>
<li class="">Create a forensically sound memory image on Windows</li>
<li class="">Create a forensically sound memory image on Linux</li>
<li class="">Create a forensically sound memory image on a hypervisor</li>
<li class="">Create a forensically sound memory image in a cloud environment</li>
<li class="">Understand and apply best practices during the process of acquisition</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="房间先决条件">房间先决条件<a href="#房间先决条件" class="hash-link" aria-label="房间先决条件的直接链接" title="房间先决条件的直接链接" translate="no">​</a></h3>
<ul>
<li class=""><a href="https://tryhackme.com/room/memoryanalysisintroduction" target="_blank" rel="noopener noreferrer" class="">Memory Analysis Introduction</a></li>
<li class=""><a href="https://tryhackme.com/module/windows-fundamentals" target="_blank" rel="noopener noreferrer" class="">Windows Fundamentals</a></li>
<li class=""><a href="https://tryhackme.com/module/linux-fundamentals" target="_blank" rel="noopener noreferrer" class="">Linux基础</a></li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Are you ready to capture memory? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-2-techniques-tools-and-best-practices">Task 2 Techniques, Tools and, Best Practices<a href="#task-2-techniques-tools-and-best-practices" class="hash-link" aria-label="Task 2 Techniques, Tools and, Best Practices的直接链接" title="Task 2 Techniques, Tools and, Best Practices的直接链接" translate="no">​</a></h2>
<p>The memory acquisition process does not start when you capture an image of the RAM and transfer it to a non-volatile storage. It starts well before that as a sequence of well-defined choices you have outlined in your incident response plan. This outline should detail decisions on:</p>
<ul>
<li class="">Which acquisition techniques to use</li>
<li class="">Which tools to use</li>
<li class="">Timing</li>
<li class="">What part of the memory to focus on</li>
<li class="">Ensuring integrity</li>
</ul>
<p>This task will cover each of these essential considerations.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="selecting-the-right-memory-part">Selecting the Right Memory Part<a href="#selecting-the-right-memory-part" class="hash-link" aria-label="Selecting the Right Memory Part的直接链接" title="Selecting the Right Memory Part的直接链接" translate="no">​</a></h3>
<p>Before you acquire memory on a system, you must decide what part of the memory is of forensic value. This is decided on a case-to-case basis and will be affected by the IOAs and IOCs you observed. Consider the following examples:</p>
<ul>
<li class="">
<p><strong>Unusual resource usage</strong>: You notice that a common process has been using an unusual amount of CPU and memory. You decide to take an image of the processes (also known as a process dump). In this case, a full memory dump would take too long and include too much forensic noise, impeding analysis.</p>
</li>
<li class="">
<p><strong>Malware infection</strong>: You discovered a malware-infected host and found evidence in the firewall logs that the host has an active C2 connection. You decide to take a full memory capture to aid your investigation.</p>
</li>
<li class="">
<p><strong>System shut down</strong>: You detected signs of fraud on an employee’s system. To avoid tipping off the employee, you decide to take a memory capture during the lunch pause. The system in question is powered off. Luckily, due to configured policies, the system went into hibernation instead, and you can acquire the <code>hiberfil.sys</code> file for analysis.</p>
</li>
</ul>
<p>In the table below, you can find an overview of the type of memory dumps you can take, their content, and use cases. Note that the <code>pagefile</code>, <code>Hibernation File</code>, and <code>VM Memory file</code> are not direct memory dumps. They are files that exist on a disk after performing a certain type of action. The pagefile is filled up with the memory of processes that are suspended or were recently terminated; the hibernation file is created as a result of the host system being put in hibernation mode, and the VM memory file is created when the VM its state is saved or snapshotted.</p>
<table><thead><tr><th style="text-align:left">类型</th><th style="text-align:left">Captures</th><th style="text-align:left">用例</th></tr></thead><tbody><tr><td style="text-align:left"><strong>Full Memory Dump</strong></td><td style="text-align:left">Entire physical memory (RAM)</td><td style="text-align:left">Full forensic analysis, malware behavior, valuable for CTI as well</td></tr><tr><td style="text-align:left"><strong>Process Dump / Core Dump</strong></td><td style="text-align:left">Memory of a single process (heap, stack, code, modules)</td><td style="text-align:left">Detect malware injection, behavior analysis</td></tr><tr><td style="text-align:left"><strong>Memory Region Dump</strong></td><td style="text-align:left">Specific region of a process (e.g., stack, heap, injected code)</td><td style="text-align:left">Focused on extracting malware or shellcode</td></tr><tr><td style="text-align:left"><strong>Pagefile/swapfile</strong></td><td style="text-align:left">Swapped-out virtual memory ( <code>pagefile.sys</code> - <code>\swapfile</code>)</td><td style="text-align:left">Collect memory from recent terminated/suspended processes</td></tr><tr><td style="text-align:left"><strong>Hibernation File Dump (Only Windows)</strong></td><td style="text-align:left">RAM snapshot saved during sleep (<code>hiberfil.sys</code>)</td><td style="text-align:left">Full memory capture from hibernated systems (e.g., laptops). Use when live memory is not available</td></tr><tr><td style="text-align:left"><strong>VM Memory Dump</strong></td><td style="text-align:left">Volatile memory of a virtual machine</td><td style="text-align:left">Safe malware testing, replayable incident analysis</td></tr></tbody></table>
<p>In the next tasks, you will perform multiple of these types of captures on Windows and Linux.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="choosing-the-appropriate-file-format">Choosing the Appropriate File Format<a href="#choosing-the-appropriate-file-format" class="hash-link" aria-label="Choosing the Appropriate File Format的直接链接" title="Choosing the Appropriate File Format的直接链接" translate="no">​</a></h3>
<p>There is no standard format when it comes to memory images. So, you must choose a format compatible with the tool you will use for analysis. The memory dump format will largely depend on the platform you target and the tool you use. Below, we list the most common formats.</p>
<ul>
<li class=""><code>.raw</code> and <code>.mem</code>: This format is a raw physical memory dump supported on most Operating Systems like macOS, Windows, and Linux. It is also the preferred format for ensuring compatibility with most analysis tools</li>
<li class=""><code>.dmp</code>: This is the Windows built-in format for a memory dump. Windows includes multiple types of <code>.dmp</code> files, which in most cases, need to be configured first. You will explore this in the task ‘Memory acquisition for Windows’</li>
<li class="">VM formats (<code>.vmem</code>, <code>.vmsn</code>, <code>.vmss</code>, <code>.bin</code>, <code>.sav</code>): These files represent the memory state of a Virtual Machine after taking a snapshot or suspending it in a hypervisor like VMware, Hyper-V, or VirtualBox. Note that you need to convert the <code>.sav</code>  file to be usable in analysis</li>
<li class=""><code>.core</code>: This is a process-level memory dump formatted in ELF in Linux using the <code>gcore</code> tool. This type of file is also created when a process crashes</li>
<li class="">Expert Witness Format: This format is generated using the Encase tool, which is an industry-standard for advanced forensic analysis</li>
<li class=""><code>.lime</code>: This memory capture file is a structured full memory dump created with the LiME (Linux Memory Extractor) tool</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="choosing-the-acquisition-technique">Choosing the Acquisition Technique<a href="#choosing-the-acquisition-technique" class="hash-link" aria-label="Choosing the Acquisition Technique的直接链接" title="Choosing the Acquisition Technique的直接链接" translate="no">​</a></h3>
<p>There are multiple ways you can acquire memory on a system. Depending on your use case, you will choose one over the other. Let’s have a look at which methods you can use.</p>
<ul>
<li class=""><strong>Local</strong>: You take an external storage device, plug it into the target machine, and then run the tools to acquire the memory. This method requires physical access to the target system</li>
<li class=""><strong>Remote</strong>: You run the tools to acquire the memory and then transfer the memory capture over the network. This method is ideal for when you have to target machines that are not easily accessed in person, such as physical servers without any keyboard or monitor attached or systems in another location than your primary work location</li>
<li class=""><strong>Hardware</strong>: You have installed a dedicated PCIe card that allows you to acquire memory without accessing the OS</li>
<li class=""><strong>RAM freezing</strong>: RAM is volatile, and the content disappears in mere seconds after cutting the power. A technique involves freezing the RAM, which allows the RAM content to be retained for a longer time. Depending on the freezing method, this would allow you enough time to move the RAM modules to another system with a dedicated OS that enables a memory dump of the RAM modules</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="important-considerations">Important considerations<a href="#important-considerations" class="hash-link" aria-label="Important considerations的直接链接" title="Important considerations的直接链接" translate="no">​</a></h4>
<ul>
<li class="">You need administrator privileges to be able to acquire a complete memory dump</li>
<li class="">When transferring the acquired memory remotely, there is always a risk that the receiving system gets compromised as well. This can be due to the nature of the malware or the attacker taking the opportunity to move laterally</li>
<li class="">When using local storage, there is also a possibility that the storage gets compromised. Use a disposable system to do the initial analysis</li>
<li class="">A hardware card is a costly option for memory acquisition. Ensure the cost matches the importance of the system</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="tools">Tools<a href="#tools" class="hash-link" aria-label="Tools的直接链接" title="Tools的直接链接" translate="no">​</a></h3>
<p>Selecting the right tool for the right job is a key factor in determining the quality of the memory capture. No tool fits all use cases, so it is important to consider the available options carefully. You should consider the following factors:</p>
<ul>
<li class="">Integrity</li>
<li class="">Compatibility</li>
<li class="">Speed and scalability</li>
<li class="">Compliance</li>
<li class="">Cost</li>
<li class="">Forensic noise introduced</li>
</ul>
<p>Below are some of the most commonly used tools.</p>
<table><thead><tr><th style="text-align:left">Commercial tools</th><th style="text-align:left">Free tools</th></tr></thead><tbody><tr><td style="text-align:left">EnCase Forensic</td><td style="text-align:left">FTK Imager</td></tr><tr><td style="text-align:left">CaptureGUARD (PCIe &amp; ExpressCard)</td><td style="text-align:left">Magnet RAM Capture</td></tr><tr><td style="text-align:left">F-Response</td><td style="text-align:left">DumpIt</td></tr><tr><td style="text-align:left">Cellebrite UFED</td><td style="text-align:left">WinPmem/LinuxPmem</td></tr><tr><td style="text-align:left">PCILeech</td><td style="text-align:left">LiMe</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="timing-your-memory-capture">Timing Your Memory Capture<a href="#timing-your-memory-capture" class="hash-link" aria-label="Timing Your Memory Capture的直接链接" title="Timing Your Memory Capture的直接链接" translate="no">​</a></h3>
<p>Timing is of utmost importance when taking a memory capture. The content of the RAM is continuously changing, meaning a memory capture only contains the content of that moment in time. Proper timing allows you to maximize the success of capturing valuable forensic evidence. The following scenarios demonstrate the importance of timing:</p>
<ul>
<li class=""><strong>Lateral movement</strong>:  You identified a host likely used as an entry point for lateral movement. You decide to monitor it, and when you notice suspicious activity, you immediately take a memory capture, resulting in actionable forensic evidence like remote sessions running, compromised user credentials, and much more.</li>
<li class=""><strong>Fileless malware</strong>: You detected a common process on a system that shows irregular behavior. You decide to take a memory capture to analyze it. Because of your quick decision, you found a malicious PowerShell script, active C2 IP addresses, and the attacker’s next-stage payloads.</li>
<li class=""><strong>Evidence destruction</strong>: You notice the strange behavior of a user on his system. The user has copied sensitive documents to his local system. You send a message to the user to ask about this behavior. The user suddenly appears offline, so you check his system in person. When you arrive at the user’s desk, you notice that the user’s system is just booting up again. The user said something weird was happening with his system, so he rebooted it. Unfortunately, you lost the opportunity to gather potential evidence of exfiltration.</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="other-considerations">Other considerations<a href="#other-considerations" class="hash-link" aria-label="Other considerations的直接链接" title="Other considerations的直接链接" translate="no">​</a></h4>
<ul>
<li class="">Attackers are often active during certain hours and will try to remove evidence when discovered and run their malware completely in memory</li>
<li class="">Try to avoid taking a capture during periods when the memory is changing fast, such as during bootup, virus scans, backups, and more</li>
</ul>
<p>Conclusion</p>
<p>YYou have discovered the essential considerations you need to consider when acquiring memory. These consideration actually form the memory acquisition process. In the following tasks, when acquiring memory, you will repeatedly need to make decisions based on them.
You will need to provide an answer to:</p>
<ul>
<li class=""><strong>What part</strong> of the memory do I need to acquire?</li>
<li class=""><strong>Which tool</strong> and/or technique will I use to acquire the memory?</li>
<li class=""><strong>When</strong> will I capture the memory?</li>
<li class="">How will I ensure <strong>integrity</strong>?</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Memory acquisition process" src="/TryHackMe-CN/assets/images/image_20251123-092328-8f59780c89ff0d8a26faa534ecaed5f3.png" width="1536" height="1024" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the file name that contains the memory of a hibernated Windows system? The answer is in the format: filename.extension </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hiberfil.sys</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Which tool can you use to obtain a process memory dump on a linux host? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gcore</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-3-memory-acquisition-on-windows">Task 3 Memory Acquisition on Windows<a href="#task-3-memory-acquisition-on-windows" class="hash-link" aria-label="Task 3 Memory Acquisition on Windows的直接链接" title="Task 3 Memory Acquisition on Windows的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="简介">简介<a href="#简介" class="hash-link" aria-label="简介的直接链接" title="简介的直接链接" translate="no">​</a></h3>
<p>Acquiring memory on a Windows host is straightforward. You can apply the steps listed in the previous task: what, when, tools, and integrity. During this task, you will focus on acquiring the following memory dumps during regular business hours:</p>
<ul>
<li class="">Full memory capture with the <code>FTK imager</code> tool</li>
<li class="">Process memory dump with the <code>procdump.exe</code> tool that is part of the <code>SysinternalsSuite</code></li>
<li class="">Configure Windows to generate a small memory dump when the system crashes</li>
</ul>
<p>The formatting of the memory dumps should be compatible with the memory analysis tool you will use later on. For this task and the next ones, you need to ensure compatibility with  <code>volatility</code>. The choice for <code>volatility</code> is simple. It is a free tool with many great features, and it can process multiple formats of memory dumps, including:</p>
<ul>
<li class="">Raw/Padded Physical Memory</li>
<li class="">Firewire (IEEE 1394)</li>
<li class="">Expert Witness (EWF)</li>
<li class="">32- and 64-bit Windows Crash Dump</li>
<li class="">32- and 64-bit Windows Hibernation</li>
<li class="">32- and 64-bit MachO files</li>
<li class="">Virtualbox Core Dumps</li>
<li class="">VMware Saved State (.vmss) and Snapshot (.vmsn)</li>
<li class="">HPAK Format (FastDump)</li>
<li class="">LiME (Linux Memory Extractor)</li>
<li class="">QEMU VM memory dumps</li>
</ul>
<p>After each memory capture, you need to generate an MD5 hash of the memory capture to <strong>ensure integrity</strong>. Integrity is critical throughout the memory forensics process. Multiple parties will likely analyze the memory capture, which can introduce unwanted changes contaminating its forensic value. Therefore, you should always create a copy of the memory capture and use that for analysis. You can use a hash to ensure the copy is identical to the original.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="full-memory-capture">Full Memory Capture<a href="#full-memory-capture" class="hash-link" aria-label="Full Memory Capture的直接链接" title="Full Memory Capture的直接链接" translate="no">​</a></h3>
<p>Go to the VM, navigate to the desktop, and double-click the FTK imager icon to start the FTK imager tool.</p>
<p>Now follow these steps to take a memory capture:</p>
<ul>
<li class="">Click File =&gt; Capture Memory</li>
<li class="">Enter the destination path to save the memory capture. Ideally, this should be an external storage device with enough disk space to accommodate the memory capture. For this exercise, give in the path <code>C:\Users\administrator\Documents\Full Memory Capture</code></li>
<li class="">Give the capture file a fitting name. Ideally, you use the name pattern defined in the memory process outline in your IR playbook. For this exercise, you can use the <code>Hostname_Date.mem</code> format as the filename:  <code>FS-ANALYSIS_07April2025.mem</code></li>
<li class="">Choose whether to include the page file or not. <strong>Note: The page file can be large, depending on your system configuration</strong></li>
<li class="">Click on <code>Capture Memory</code></li>
</ul>
<p><img decoding="async" loading="lazy" alt="Full Memory Dump on Windows" src="/TryHackMe-CN/assets/images/66c44fd9733427ea1181ad58-1744118959741-b79d43abf10110d2f10c61fffc07955c.gif" width="1304" height="1340" class="img_ev3q"></p>
<p>Once the process is complete, you need to ensure the integrity of the captured file:</p>
<ul>
<li class="">Open a PowerShell window as Administrator</li>
<li class="">Give in the command <code>Get-FileHash</code> with the required parameters as shown in the terminal below. Depending on which algorithm you select, it can take a few minutes before the hash is generated. Your memory process outline should also define which hashing algorithm to use</li>
<li class="">Note down the hash value. Where to note it should be described in your memory process outline. <code>Note: The calculated hash values of this example and yours will be different, which is expected as the memory content continuously changes</code></li>
</ul>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Full Memory Capture - Hash</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PS C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Administrator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Documents</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Get-FileHash </span><span class="token parameter variable" style="color:#36acaa">-Path</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;C:\Users\Administrator\Documents\Full Memory Capture\FS-ANALYSIS-07April2025.mem&#x27;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Algorithm</span><span class="token plain"> MD5 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Algorithm Hash Path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MD5 42CD44244B8ED77CCF89ECAA6C3F957A C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Administrator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Documents</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Full Memory Capture</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">FS-ANALYSIS-07April2025.mem</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="process-memory-dump">Process Memory Dump<a href="#process-memory-dump" class="hash-link" aria-label="Process Memory Dump的直接链接" title="Process Memory Dump的直接链接" translate="no">​</a></h3>
<p>Continuing with the VM, open a new PowerShell terminal with administrator privileges and navigate to the path <code>C:\TMP\SysinternalsSuite\</code>.</p>
<p>The SysInternals suite contains a tool called <code>procdump64.exe</code>, which you can use to dump the memory contents of a selected process. You can do this either manually or based on a <strong>trigger</strong> like high CPU usage.</p>
<p>You will focus on manually dumping the <code>lsass.exe</code> process. This process manages authentication, tokens, credentials, and more. Threat actors often target the <code>lsass.exe</code> process using <strong>Mimikatz</strong>. Enter the following command to dump the content of the <code>lsass.exe</code> process:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Process Dump</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PS C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">TMP</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SysinternalsSuite</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> .</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">procdump64.exe </span><span class="token parameter variable" style="color:#36acaa">-ma</span><span class="token plain"> lsass.exe C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">TMP </span><span class="token parameter variable" style="color:#36acaa">-accepteula</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ProcDump v11.0 - Sysinternals process dump utility</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Copyright </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">C</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2009</span><span class="token plain">-2022 Mark Russinovich and Andrew Richards</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sysinternals - www.sysinternals.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">13</span><span class="token plain">:45:44</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Dump </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> initiated: C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">TMP</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">lsass.exe_250408_134544.dmp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">13</span><span class="token plain">:45:44</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Dump </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> writing: Estimated dump </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> size is </span><span class="token number" style="color:#36acaa">47</span><span class="token plain"> MB.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">13</span><span class="token plain">:45:44</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Dump </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> complete: </span><span class="token number" style="color:#36acaa">47</span><span class="token plain"> MB written </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.5</span><span class="token plain"> seconds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">13</span><span class="token plain">:45:45</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Dump count reached.</span><br></span></code></pre></div></div>
<p>Have a closer look at the options included in the command:</p>
<ul>
<li class=""><code>-ma</code> : This flag sets the type of dump to contain the process’s full memory content. The default option is a minidump (<code>-mm</code>), which only contains basic information about the process. The minidump is useful for crashes but not for malware analysis or extracting credentials. There are other flags available as well. Use the <code>.\procdump.exe -h</code> command to display them</li>
<li class=""><code>lsass.exe</code> : This is the process you will dump the memory of</li>
<li class=""><code>C:\TMP</code> : The memory dump is saved in this directory</li>
</ul>
<p>The default name for the file dump is <code>PROCESSNAME_YYMMDD_HHMMSS.dmp</code>. You can leave this as is for this exercise. Usually, you would adjust the name to match what is in your memory outline in the IR playbook.</p>
<p>Now that you have created a memory dump of the <code>lsass.exe</code> process, you need to ensure its integrity. Enter the following command to calculate an MD5 hash of the memory capture. Adjust the filename to reflect your memory capture.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Calculate Hash</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PS C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">TMP</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SysinternalsSuite</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">  Get-FileHash </span><span class="token parameter variable" style="color:#36acaa">-Path</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;C:\TMP\lsass.exe_250408_082640.dmp&#x27;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-Algorithm</span><span class="token plain"> MD5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Algorithm Hash Path       </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MD5 9DF3963A62B01D3151CB6B824C8DE6D1 C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">TMP</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">lsass.exe_250408_082640.dmp</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="crash-dump">Crash Dump<a href="#crash-dump" class="hash-link" aria-label="Crash Dump的直接链接" title="Crash Dump的直接链接" translate="no">​</a></h3>
<p>Windows includes configuration options for what should happen when it crashes. These options determine whether to take a memory dump, which type to take, where to save it, and whether to overwrite the existing memory dump.</p>
<p>From a forensic perspective, a memory dump from a system crash is also usable information. For example, a malicious process could cause your system to crash. Follow the steps below to configure a memory dump after system failure.</p>
<ul>
<li class="">Right-click the Windows logo in the taskbar and click <code>run</code></li>
<li class="">Enter <code>sysdm.cpl</code> to open the <code>System Properties</code> control panel item</li>
<li class="">Navigate to the <code>Advanced</code> tab and click <code>Settings...</code> under the <code>Startup and Recovery</code> section</li>
<li class="">Configure the memory dump in the <code>System failure</code> - <code>Write debugging information</code> section. Which dump to choose will depend on your use case.</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Memory Dump Options" src="/TryHackMe-CN/assets/images/66c44fd9733427ea1181ad58-1744030888437-0fbd08c829bc24b2cf23b44e3d008565.gif" width="1304" height="1340" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Start notepad.exe on the VM and use the procdump64.exe tool to write a &#x27;triage&#x27; dump file of the process. Ensure that the dump file&#x27;s name is formatted like PROCESSNAME_PID_YYMMDD_HHMMSS.dmp. Enter the complete command below. Note: Use PowerShell so to syntax is correct. No need to include the <code>-accepteula</code> flag </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">.\procdump64.exe -mt notepad.exe PROCESSNAME_PID_YYMMDD_HHMMSS.dmp</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Which two tools can you use to extract or dump memory artifacts of the lsass.exe process? Enter the answers in alphabetic order and separated by a comma. For example: volatility,procmon.exe </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mimikatz,procdump64.exe</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Before moving on to the next task, power off the VM. </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-4-memory-acquisition-on-linux">Task 4 Memory Acquisition on Linux<a href="#task-4-memory-acquisition-on-linux" class="hash-link" aria-label="Task 4 Memory Acquisition on Linux的直接链接" title="Task 4 Memory Acquisition on Linux的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="简介-1">简介<a href="#简介-1" class="hash-link" aria-label="简介的直接链接" title="简介的直接链接" translate="no">​</a></h3>
<p>Acquiring memory on a Linux host is a straightforward process. You need to decide on the same steps as on a Windows host.</p>
<p>During this task, you will focus on the following memory captures during business hours:</p>
<ul>
<li class="">Full memory capture with the <code>LiME</code> tool</li>
<li class="">Process memory dump with the <code>gcore</code> tool that is part of the <code>GNU Debugger</code></li>
<li class="">Configure Ubuntu to generate a memory dump when the system crashes</li>
</ul>
<p>Like the previous task, you need to ensure compatibility with <code>volatility</code>. After each memory capture, you need to generate an MD5 hash of the memory capture to ensure integrity.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="full-memory-capture-1">Full Memory Capture<a href="#full-memory-capture-1" class="hash-link" aria-label="Full Memory Capture的直接链接" title="Full Memory Capture的直接链接" translate="no">​</a></h3>
<p>In this task, you will use the <code>LiME</code> tool to take a full memory capture. This tool isn&#x27;t included by default on most Linux systems. Since the VM has no internet access, <strong>we&#x27;ve pre-installed the tool for you</strong>. If you&#x27;re trying this on your machine, here&#x27;s how you would install it manually:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Install LiME</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># first install necessary dependencies</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-y</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> build-essential linux-headers-</span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable function" style="color:#d73a49">uname</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable parameter variable" style="color:#36acaa">-r</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Clone the LiME repository</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/504ensicsLabs/LiME.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> LiME/src</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># compile LiME for use in kernel</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">make</span><br></span></code></pre></div></div>
<p>Continuing with the VM, open a terminal window and enter the following command to take a full memory capture:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Take Memory Dump</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token builtin class-name">cd</span><span class="token plain"> LiME/src</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/LiME/src$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> insmod lime-6.8.0-1027-aws.ko </span><span class="token string" style="color:#e3116c">&quot;path=/tmp/ubuntu-150000-22042025.lime format=lime&quot;</span><br></span></code></pre></div></div>
<p>Let&#x27;s take a closer look at the options included in the command:</p>
<ul>
<li class=""><code>sudo insmod lime-6.8.0-1027-aws.ko</code>: The <code>insmod</code> command loads the LiME tool (<code>lime.ko</code>) in the kernel. This is necessary so LiME can do a full memory capture</li>
<li class=""><code>path=/tmp/ubuntu-150000-22042025.lime</code>: This is the directory where the memory dump is saved and the memory dump its name. The naming template used is <code>HOSTNAME-HHMMSS-DDMMYYYY.lime</code> . You can alter the name to fit your requirements</li>
<li class=""><code>format=lime</code>: This command sets the memory dump&#x27;s format to <code>.lime</code>. Ensure this is compatible with your memory analysis tools</li>
</ul>
<p>If you want to change any of the above parameters or include additional parameters you can reference the help page on <a href="https://github.com/504ensicsLabs/LiME" target="_blank" rel="noopener noreferrer" class="">the official GitHub</a> of the LiME tool.</p>
<p>Once the process is complete, you need to ensure the integrity of the captured file and <strong>unload the LiME tool</strong>:</p>
<ul>
<li class="">Enter the command <code>md5sum</code> with the required parameters as shown in the terminal below. Depending on which algorithm you select, it can take a few minutes before the hash is generated. Your memory process outline should also define which hashing algorithm to use</li>
<li class="">Note down the hash value. Where to note it should be described in your memory process outline. <strong>Note: The calculated hash values of this example and yours will differ, which is expected as the memory content continuously changes</strong></li>
<li class="">Finish by entering the <code>sudo rmmod lime</code> command to unload LiME from the kernel. <strong>Note: Each time you want to capture the memory, you must first run this command to unload any previous LiME modules</strong></li>
</ul>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">MD5 Hash</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/LiME/src$ md5sum tmp/ubuntu-150000-22042025.lime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0ef7140f0c0cabd6c4ef76c708f2324f  /tmp/ubuntu-150000-22042025.lime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/LiME/src$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> rmmod lime</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="process-memory-dump-1">Process Memory dump<a href="#process-memory-dump-1" class="hash-link" aria-label="Process Memory dump的直接链接" title="Process Memory dump的直接链接" translate="no">​</a></h3>
<p>Continuing with the VM, open a new terminal and enter the following commands to dump the memory of the <code>bash</code> process:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Process Dump with gcore</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> aux </span><span class="token operator" style="color:#393A34">|</span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">bash</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Search the PID number of the bash process</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu      </span><span class="token number" style="color:#36acaa">6506</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">0.2</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">5892</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">4096</span><span class="token plain"> pts/0    Ss   Apr11   </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00 </span><span class="token function" style="color:#d73a49">bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu     </span><span class="token number" style="color:#36acaa">34136</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">0.1</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">3528</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">1792</span><span class="token plain"> pts/0    S+   </span><span class="token number" style="color:#36acaa">13</span><span class="token plain">:57   </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00 </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--color</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">auto </span><span class="token function" style="color:#d73a49">bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> gcore </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> /tmp/</span><span class="token environment constant" style="color:#36acaa">BASH</span><span class="token plain">-130000-10042025 </span><span class="token number" style="color:#36acaa">6506</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Dump the memory of the bash process using gcore</span><br></span></code></pre></div></div>
<p>Now that you have created a memory dump of the <code>bash</code> process, you need to ensure its integrity. Enter the following command to calculate an MD5 hash of the memory capture. Adjust the filename to reflect your memory capture.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Process Dump with gcore</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ md5sum /tmp/</span><span class="token environment constant" style="color:#36acaa">BASH</span><span class="token plain">-130000-10042025.6506 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">b1baa84b8f1e725f1a45795465ba710c  /tmp/</span><span class="token environment constant" style="color:#36acaa">BASH</span><span class="token plain">-130000-10042025.6506</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="crash-dump-1">Crash dump<a href="#crash-dump-1" class="hash-link" aria-label="Crash dump的直接链接" title="Crash dump的直接链接" translate="no">​</a></h3>
<p>Similar to Windows you can configure Linux to do a memory dump when a process or the kernel crashes. The configuration is however not as straightforward as Windows. It will depend on the host its type of distribution and kernel.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="kernel-crash-dump">Kernel crash dump<a href="#kernel-crash-dump" class="hash-link" aria-label="Kernel crash dump的直接链接" title="Kernel crash dump的直接链接" translate="no">​</a></h4>
<p>As stated in the <strong>Official documentation</strong> of Ubuntu, the kernel crash dump is enabled by default starting from Ubuntu version 24.10. The VM in this task has Ubuntu version 24.04, so you must enable the kernel crash dump yourself. Due to the limited connectivity of the VM, <strong>we have done the configuration ourselves</strong>. We entered the following commands and added explanatory comments (with # delimiter) to the terminal window below:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Enable kdump</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># check status kernel crash dump utility</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /proc/cmdline </span><span class="token comment" style="color:#999988;font-style:italic"># This command verifies if the kernel crash dump is enabled or not. If a line similar to &#x27;crashkernel=384M-2G:64M,2G-:128M&#x27; is present, it is enabled. You don&#x27;t need to execute the following commands in this case.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Install kdump (This is the kernel crash dump utitlity)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> kdump-tools </span><span class="token parameter variable" style="color:#36acaa">-y</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Reboot to enable the kdump tool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-reboot</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Verify if the kdump tool is running</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> kdump-config show </span><span class="token comment" style="color:#999988;font-style:italic"># You can enter this command yourself on the VM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DUMP_MODE: kdump</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">USE_KDUMP: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># 1 means that kdump is in use</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KDUMP_COREDIR: /var/crash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">crashkernel addr: 0x69000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/lib/kdump/vmlinuz: symbolic </span><span class="token function" style="color:#d73a49">link</span><span class="token plain"> to /boot/vmlinuz-6.8.0-1027-aws</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kdump initrd:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/lib/kdump/initrd.img: symbolic </span><span class="token function" style="color:#d73a49">link</span><span class="token plain"> to /var/lib/kdump/initrd.img-6.8.0-1027-aws</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">current state: ready to kdump </span><span class="token comment" style="color:#999988;font-style:italic"># kdump is able to dump</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">crashkernel suggested size: 371M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kexec command:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/sbin/kexec </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> --command-line</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;BOOT_IMAGE=/boot/vmlinuz-6.8.0-1027-aws root=PARTUUID=da63a61e-01 ro console=tty1 console=ttyS0 nvme_core.io_timeout=4294967295 panic=-1 reset_devices systemd.unit=kdump-tools-dump.service nr_cpus=1 irqpoll usbcore.nousb&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--initrd</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/var/lib/kdump/initrd.img /var/lib/kdump/vmlinuz</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="process-crash-dump">Process crash dump<a href="#process-crash-dump" class="hash-link" aria-label="Process crash dump的直接链接" title="Process crash dump的直接链接" translate="no">​</a></h4>
<p>On most Linux distributions, process crash dumps are disabled by default. There are different ways to enable automated or partial crash dumps depending on the Linux flavor.</p>
<p>In this task, you will focus on Ubuntu Desktop, that the VM is running. To cover all processes on Ubuntu Desktop, you need to configure 2 options:</p>
<ul>
<li class="">Crash dump for systemd-managed processes</li>
<li class="">Crash dump for interactive sessions and user processes</li>
</ul>
<p>Start by entering the following commands to configure the crash dump for systemd-managed processes:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Process crash dump</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> /etc/systemd/system.conf.d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">nano</span><span class="token plain"> /etc/systemd/system.conf.d/core-dumps.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Add the following lines to the core-dumps.conf file and enter CTRL+o to save the file, then exit the editor by entering CTRL+x</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Manager</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">DefaultLimitCORE</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">infinity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Now reload the systemd service</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> systemctl daemon-reexec</span><br></span></code></pre></div></div>
<p>Now, continue configuring the crash dump for the user processes and interactive sessions. The commands below will ensure the configuration persists. Enter the following commands:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Process crash dump</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Enable process dumps</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token builtin class-name">ulimit</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> unlimited</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Open the config file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">nano</span><span class="token plain"> /etc/sysctl.d/60-core-pattern.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#Add the following lines to set naming template</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kernel.core_pattern </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> /var/crash/core.%e.%p.%t</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fs.suid_dumpable </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Create the /var/crash folder and assign permissions if it does not exist yet</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> /var/crash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1777</span><span class="token plain"> /var/crash</span><br></span></code></pre></div></div>
<p>The above approach works for both Ubuntu Desktop and Server editions.</p>
<p>Ubuntu Desktop also comes enabled with a crash dump utility named <code>apport</code>. This service catches core dumps from crashing processes, decides whether to act on it, and then creates a <code>.crash file</code> which includes:</p>
<ul>
<li class="">Stack trace</li>
<li class="">Process info</li>
<li class="">Loaded libraries</li>
<li class="">Partial memory content, not the full core dump</li>
</ul>
<p>The crash files are saved in the <code>/var/crash</code> directory.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Modify the following command to ensure the memory dump is in the .raw format and is accessible over TCP port 5555: <code>sudo insmod lime-6.8.0-1027-aws.ko &quot;path=/tmp/memdump.lime format=lime&quot;</code> </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo insmod lime-6.8.0-1027-aws.ko &quot;path=tcp:5555 format=raw&quot;</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> LiME includes a parameter to create a hash immediately after capturing the memory. Modify the following command and ensure a MD5 hash is calculated: <code>sudo insmod lime-6.8.0-1027-aws.ko &quot;path=/tmp/memdump.lime format=lime&quot;</code> </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo insmod lime-6.8.0-1027-aws.ko &quot;path=/tmp/memdump.lime format=lime digest=md5&quot;</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-5-memory-acquisition-on-virtual-machines-and-cloud-environments">Task 5 Memory Acquisition on Virtual Machines and Cloud Environments<a href="#task-5-memory-acquisition-on-virtual-machines-and-cloud-environments" class="hash-link" aria-label="Task 5 Memory Acquisition on Virtual Machines and Cloud Environments的直接链接" title="Task 5 Memory Acquisition on Virtual Machines and Cloud Environments的直接链接" translate="no">​</a></h2>
<p>Similar to the two previous tasks, you must make some decisions regarding the memory acquisition process. For this task, you will focus on getting a memory dump from hypervisors and cloud platforms during regular business hours.
You will then choose the right tool or method for the right job. There are two ways to acquire memory from hypervisors and cloud platforms:</p>
<ul>
<li class="">Login into the VM and use the techniques seen in the previous tasks</li>
<li class="">Use the built-in tools of the hypervisor or cloud platform to extract memory without interacting directly with the VM. This can be done via the GUI or the command line</li>
</ul>
<p>In this task, you will focus on number two where possible. You will learn the methods to acquire a memory dump on the most common hypervisors and cloud platforms, including:</p>
<ul>
<li class="">Microsoft Hyper-V</li>
<li class="">VMware vSphere</li>
<li class="">VirtualBox</li>
<li class="">KVM</li>
<li class="">Cloud platforms</li>
</ul>
<p>You will focus on providing a memory dump that is compatible with <code>volatility</code>.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="acquiring-a-memory-dump-on-hypervisors">Acquiring a Memory Dump on hypervisors<a href="#acquiring-a-memory-dump-on-hypervisors" class="hash-link" aria-label="Acquiring a Memory Dump on hypervisors的直接链接" title="Acquiring a Memory Dump on hypervisors的直接链接" translate="no">​</a></h3>
<p>The method for acquiring a memory dump from a hosted VM is similar for each flavor of hypervisor.</p>
<p><strong>First</strong>, you need to take a snapshot or pause the VM. <strong>Then</strong>, you can take a copy of the memory state file that each hypervisor creates when snapshotting or pausing a VM. Depending on the flavor of hypervisor you will need to convert the memory state file to be compatible with <code>volatility</code>.</p>
<p><strong>Note: There are alternative methods to acquire memory. This task will focus on using the built-in tools and/or utilities when available.</strong></p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="microsoft-hyper-v">Microsoft Hyper-V<a href="#microsoft-hyper-v" class="hash-link" aria-label="Microsoft Hyper-V的直接链接" title="Microsoft Hyper-V的直接链接" translate="no">​</a></h4>
<p>Acquiring memory on a Hyper-V hosted VM can be done with the native functions of Hyper-V. You can choose to use either the GUI or the PowerShell command line. The terminal below shows the process using PowerShell. The steps for GUI and PowerShell are virtually the same:</p>
<ul>
<li class="">Save the VM or take a checkpoint via the GUI or PowerShell cmdlet ( <code>Checkpoint-VM</code> or <code>Save-VM</code> )</li>
<li class="">Navigate to where the snapshots are stored and copy the <code>.vmrs</code> file, which contains the RAM content</li>
<li class="">Calculate the hash to ensure integrity when analyzing the memory dump later on</li>
<li class="">Use the <code>volatility windows.hyperv</code> plugin to process the file</li>
</ul>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Memory dump Hyper-v</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PS C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">administrator</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> get-vm </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> FT VMId, VMName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VMId VMName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c5f1b464-ffea-4904-bc7b-974c74b10159 Ubuntu </span><span class="token number" style="color:#36acaa">22.04</span><span class="token plain"> LTS</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PS C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">administrator</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> get-vm </span><span class="token parameter variable" style="color:#36acaa">-Id</span><span class="token plain"> c5f1b464-ffea-4904-bc7b-974c74b10159 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Checkpoint-VM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PS C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">administrator</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Get-VMSnapshot </span><span class="token parameter variable" style="color:#36acaa">-VMName</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Ubuntu 22.04 LTS&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">FT Id,Name,Path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PS C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">administrator</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">cp</span><span class="token plain"> C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">ProgramData</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Hyper-V</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Snapshots</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">97DBBAE5-3F91-4E5E-B177-FBB970E8703E.VMRS C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">temp</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">hostname-17-04-2025.VMRS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PS C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">administrator</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Get-FileHash </span><span class="token parameter variable" style="color:#36acaa">-Algorithm</span><span class="token plain"> MD5 </span><span class="token parameter variable" style="color:#36acaa">-Path</span><span class="token plain"> C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">temp</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">hostname-17-04-2025.VMRS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Algorithm Hash Path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MD5           E1BA77075C7C832CC96E43DB8E8F98E8   C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">temp</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">hostname-17-04-2025.VMRS</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="vsphere">vSphere<a href="#vsphere" class="hash-link" aria-label="vSphere的直接链接" title="vSphere的直接链接" translate="no">​</a></h4>
<p>In <code>vSphere</code>,you can use the built-in tools (vCenter server + vSphere client) to take a snapshot of the VM. You can use either the GUI or the ESXCLI tool. The steps to acquire the memory are similar:</p>
<ul>
<li class="">Take a snapshot of the VM</li>
<li class="">Navigate to the datastore where the VM is located and copy the <code>.vmsn file</code></li>
<li class="">Calculate a hash to ensure integrity</li>
<li class=""><code>volatility</code> supports the processing of <code>.vmsn files</code>, so you don&#x27;t need to convert them</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Memory dump in the vCenter GUI" src="/TryHackMe-CN/assets/images/66c44fd9733427ea1181ad58-1745337491450-96277d4490c06f32ddde2cb51a5e8dbb.gif" width="1755" height="924" class="img_ev3q"></p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="kvm">KVM<a href="#kvm" class="hash-link" aria-label="KVM的直接链接" title="KVM的直接链接" translate="no">​</a></h4>
<p>The easiest way to acquire a memory dump of a VM hosted on KVM is to use the command line utility. The steps are similar to other hypervisors:</p>
<ul>
<li class="">First, find the name of the VM. Use the <code>virsh list</code> command to list all VMs</li>
<li class="">Then, dump the memory of the VM by entering <code>virsh dump vmname /path/to/dupm.raw --memory-only</code></li>
<li class="">Lastly, create a hash of the memory dump file <code>md5sum memdump.raw</code></li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="virtualbox">VirtualBox<a href="#virtualbox" class="hash-link" aria-label="VirtualBox的直接链接" title="VirtualBox的直接链接" translate="no">​</a></h4>
<p>The recommended way to acquire the memory of a VM hosted on VirtualBox is by using the <code>VBoxManage</code> tool. On a Windows installation, you can find this command line utility in the installation path of Virtualbox E.g. <code>C:\Program Files\Oracle\VirtualBox</code> . Follow the next steps to take a memory dump of the VM:</p>
<ul>
<li class="">List the VMs running and find the name of the VM</li>
<li class="">Take a dump with the <code>debugvm</code> command</li>
<li class="">Calculate a hash to ensure the integrity of the file later down the analysis process</li>
<li class=""><code>Volatility</code> supports the processing of <code>.elf files</code> , so you don&#x27;t need to convert them</li>
</ul>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Memory Dump</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PS C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Program Files</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Oracle</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">VirtualBox</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> .</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">VBoxManage.exe list runningvms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&quot;Kali_purple&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">9a969c90-7ab0-4b9b-893d-48c70fa42ee5</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PS C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Program Files</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Oracle</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">VirtualBox</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> .</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">VBoxManage.exe debugvm </span><span class="token string" style="color:#e3116c">&quot;Kali_purple&quot;</span><span class="token plain"> dumpvmcore </span><span class="token parameter variable" style="color:#36acaa">--filename</span><span class="token plain"> C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">temp</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">kali_memdump.elf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PS C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Program Files</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Oracle</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">VirtualBox</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Get-FileHash </span><span class="token parameter variable" style="color:#36acaa">-Algorithm</span><span class="token plain"> MD5 </span><span class="token parameter variable" style="color:#36acaa">-Path</span><span class="token plain"> C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">temp</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">kali_memdump.elf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Algorithm Hash Path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MD5             1833B5B07C8E43A6E011919934AFB049           C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">temp</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">kali_memdump.elf</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="acquiring-a-memory-dump-on-cloud-platforms">Acquiring a Memory Dump on Cloud Platforms<a href="#acquiring-a-memory-dump-on-cloud-platforms" class="hash-link" aria-label="Acquiring a Memory Dump on Cloud Platforms的直接链接" title="Acquiring a Memory Dump on Cloud Platforms的直接链接" translate="no">​</a></h3>
<p>Unlike hypervisors, the process of acquiring a memory dump from a VM hosted on a cloud platform like Azure or AWS is not straightforward. Neither platform comes with a built-in tool to accommodate taking a memory dump. In this case, you won&#x27;t be able to avoid interacting with the VM directly. One of the main reasons why Cloud providers don&#x27;t offer this tooling is due to the shared nature of the hardware resources.</p>
<p>The recommended way to acquire memory dumps from a VM hosted on a cloud platform is to follow the steps specific to each OS that we discussed in tasks three and four.</p>
<p>There is, however, an alternate method that is used in some scenarios. This method involves the following steps:</p>
<ul>
<li class="">Configure a full memory crash dump on the host</li>
<li class="">Trigger a manual crash via the cloud platform</li>
<li class="">Detach the disk where the crash dump was saved</li>
<li class="">Connect the disk as a read-only data disk to an analysis VM hosted within the same, or different tenant.</li>
<li class="">Extra step: Export the disk so it can be used in a different tenant</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="special-mention-for-azure">Special Mention for Azure<a href="#special-mention-for-azure" class="hash-link" aria-label="Special Mention for Azure的直接链接" title="Special Mention for Azure的直接链接" translate="no">​</a></h4>
<p>Microsoft released a tool named Acquire Volatile Memory for Linux (AVML) to make the process of acquiring volatile memory on VMs hosted on Azure. One of the main advantages of this tool is that it does not require any installation or kernel loading. It can just be run as a stand-alone binary. <strong>Note: The tool is only intended to acquire memory on Linux distributions.</strong></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Conclusion的直接链接" title="Conclusion的直接链接" translate="no">​</a></h3>
<p>In this task you learned how to capture memory on a Windows host, a Linux host, a VM hosted on a hypervisor,and a VM hosted on a hypervisor or cloud platform. You noted multiple ways to get a memory dump, either via the GUI or a command-line utility. Last, you observed was that cloud platforms don&#x27;t offer any built-in tools to take a memory dump without interacting with the VM.</p>
<p>Taking a memory dump isn&#x27;t exactly rocket science, but there are some things mentioned in the previous tasks to take into account:</p>
<ul>
<li class="">Timing</li>
<li class="">Make sure you have administrator rights on the target host</li>
<li class="">Use a tool that fits your needs</li>
<li class="">Define a proper naming convention for the memory dumps</li>
<li class="">Ensure integrity by hashing</li>
<li class="">Take note of the filename and its hash so you can refer to it later</li>
<li class="">Ensure all the above are part of your process outline in the IR playbook</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the name of the command line utility you use to take a memory dump on the VirtualBox hypervisor? Use the format filename.extension for answering. </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vboxmanage.exe</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Which command do you use to create a snapshot in Hyper-V? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CheckPoint-VM</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-6-challenges-with-memory-acquisition">Task 6 Challenges with Memory Acquisition<a href="#task-6-challenges-with-memory-acquisition" class="hash-link" aria-label="Task 6 Challenges with Memory Acquisition的直接链接" title="Task 6 Challenges with Memory Acquisition的直接链接" translate="no">​</a></h2>
<p>Memory acquisition does come with some challenges. Take the following difficulties into account before starting the process of memory acquisition:</p>
<ul>
<li class=""><strong>Anti-forensic techniques</strong>: An attacker can employ anti-forensic techniques to impede proper memory acquisition. E.g., encrypting memory content, interfering with acquisition tools, and more</li>
<li class=""><strong>Timing</strong>: It is essential to get the timing right when acquiring memory. As mentioned in task two, memory is volatile, and its content is continuously changing. Keep an eye on the Indicators of Attack and Compromise to choose the right timing</li>
<li class=""><strong>(Physical) Accessibility</strong>: To do a memory capture, you need to have access to the system, locally or remotely. Sometimes, servers are in data centers that are not accessible without proper verification. Ensure that the correct people have the correct access rights</li>
<li class=""><strong>No admin rights</strong>: To do a full memory capture, you must have administrator rights. This can be on the host level, domain level, or resource group in the cloud platform</li>
<li class=""><strong>Lack of an Information Security Management System (ISMS)</strong>: Before even thinking of forensics, you must have a proper ISMS in place. An important part of an ISMS that lists essential information required for memory acquisition is <strong>Asset Management</strong>. It helps you know each asset&#x27;s:<!-- -->
<ul>
<li class="">Details (Hostname, IP, OS, users, physical location)</li>
<li class="">Criticality</li>
<li class="">Operating hours</li>
<li class="">Baseline configuration</li>
<li class="">Baseline behavior</li>
<li class="">And more</li>
</ul>
</li>
<li class=""><strong>No transparent incident response process</strong>: Failing to take all of the topics in task two into account will impede you in doing proper memory acquisition. Ensure to include the memory acquisition process in your incident response plan</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What process describes keeping track of all hosts and their information? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Asset Management</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> A threat actor shuts down the target system after successfully exfiltrating data. What term can we use to categorize this action? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">anti-forensic techniques</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务-7-结论">任务 7 结论<a href="#任务-7-结论" class="hash-link" aria-label="任务 7 结论的直接链接" title="任务 7 结论的直接链接" translate="no">​</a></h2>
<p>As you have discovered, completing all the tasks in this room, there is more than meets the eye to acquiring a forensically sound memory dump. You learned that there are multiple things you need to take into account before taking a memory dump:</p>
<ul>
<li class="">What part of the memory to capture</li>
<li class="">When to capture the memory</li>
<li class="">How to capture the memory</li>
</ul>
<p>You learned how to take various memory dumps from Ubuntu, Windows, hypervisors, and cloud platforms. You ended the room with an overview of the various challenges of memory acquisition.</p>
<p>Now that you know how to acquire memory, the next step is analyzing it. Continue with the next room in this module to find out how to analyze a memory dump using tools like <code>volatility</code>.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Ready to apply your new skills? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/TryHackMyOffsecBox/TryHackMe-CN/tree/main/packages/create-docusaurus/templates/shared/docs/Modules/Memory Analysis/memoryacquisition.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/TryHackMe-CN/docs/Modules/Memory Analysis/memoryanalysisintroduction"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">内存分析简介</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/TryHackMe-CN/docs/Modules/Memory Analysis/volatilityessentials"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Volatility Essentials</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#任务-1-介绍" class="table-of-contents__link toc-highlight">任务 1 介绍</a><ul><li><a href="#学习目标" class="table-of-contents__link toc-highlight">学习目标</a></li><li><a href="#房间先决条件" class="table-of-contents__link toc-highlight">房间先决条件</a></li></ul></li><li><a href="#task-2-techniques-tools-and-best-practices" class="table-of-contents__link toc-highlight">Task 2 Techniques, Tools and, Best Practices</a><ul><li><a href="#selecting-the-right-memory-part" class="table-of-contents__link toc-highlight">Selecting the Right Memory Part</a></li><li><a href="#choosing-the-appropriate-file-format" class="table-of-contents__link toc-highlight">Choosing the Appropriate File Format</a></li><li><a href="#choosing-the-acquisition-technique" class="table-of-contents__link toc-highlight">Choosing the Acquisition Technique</a></li><li><a href="#tools" class="table-of-contents__link toc-highlight">Tools</a></li><li><a href="#timing-your-memory-capture" class="table-of-contents__link toc-highlight">Timing Your Memory Capture</a></li></ul></li><li><a href="#task-3-memory-acquisition-on-windows" class="table-of-contents__link toc-highlight">Task 3 Memory Acquisition on Windows</a><ul><li><a href="#简介" class="table-of-contents__link toc-highlight">简介</a></li><li><a href="#full-memory-capture" class="table-of-contents__link toc-highlight">Full Memory Capture</a></li><li><a href="#process-memory-dump" class="table-of-contents__link toc-highlight">Process Memory Dump</a></li><li><a href="#crash-dump" class="table-of-contents__link toc-highlight">Crash Dump</a></li></ul></li><li><a href="#task-4-memory-acquisition-on-linux" class="table-of-contents__link toc-highlight">Task 4 Memory Acquisition on Linux</a><ul><li><a href="#简介-1" class="table-of-contents__link toc-highlight">简介</a></li><li><a href="#full-memory-capture-1" class="table-of-contents__link toc-highlight">Full Memory Capture</a></li><li><a href="#process-memory-dump-1" class="table-of-contents__link toc-highlight">Process Memory dump</a></li><li><a href="#crash-dump-1" class="table-of-contents__link toc-highlight">Crash dump</a></li></ul></li><li><a href="#task-5-memory-acquisition-on-virtual-machines-and-cloud-environments" class="table-of-contents__link toc-highlight">Task 5 Memory Acquisition on Virtual Machines and Cloud Environments</a><ul><li><a href="#acquiring-a-memory-dump-on-hypervisors" class="table-of-contents__link toc-highlight">Acquiring a Memory Dump on hypervisors</a></li><li><a href="#acquiring-a-memory-dump-on-cloud-platforms" class="table-of-contents__link toc-highlight">Acquiring a Memory Dump on Cloud Platforms</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></li><li><a href="#task-6-challenges-with-memory-acquisition" class="table-of-contents__link toc-highlight">Task 6 Challenges with Memory Acquisition</a></li><li><a href="#任务-7-结论" class="table-of-contents__link toc-highlight">任务 7 结论</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/TryHackMe-CN/docs">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/TryHackMyOffsecBox" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github - TryHackMyOffsecBox<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/CRONUS-Security" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github - CRONUS-Security<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 TryHackMyOffsecBox. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>