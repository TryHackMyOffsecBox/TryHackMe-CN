<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Modules/Command Line/Windows PowerShell" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Windows PowerShell | TryHackMe-CN</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Command Line/Windows PowerShell"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Windows PowerShell | TryHackMe-CN"><meta data-rh="true" name="description" content="任务 1 简介"><meta data-rh="true" property="og:description" content="任务 1 简介"><link data-rh="true" rel="icon" href="/TryHackMe-CN/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Command Line/Windows PowerShell"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/docs/Modules/Command Line/Windows PowerShell" hreflang="en"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Command Line/Windows PowerShell" hreflang="zh"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Command Line/Windows PowerShell" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"模块","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/"},{"@type":"ListItem","position":2,"name":"命令行","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Command Line/"},{"@type":"ListItem","position":3,"name":"Windows PowerShell","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Command Line/Windows PowerShell"}]}</script><link rel="alternate" type="application/rss+xml" href="/TryHackMe-CN/blog/rss.xml" title="TryHackMe-CN RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/TryHackMe-CN/blog/atom.xml" title="TryHackMe-CN Atom Feed"><link rel="stylesheet" href="/TryHackMe-CN/assets/css/styles.6c4c8a38.css">
<script src="/TryHackMe-CN/assets/js/runtime~main.ae094ceb.js" defer="defer"></script>
<script src="/TryHackMe-CN/assets/js/main.4139ffc9.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/TryHackMe-CN/img/logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/TryHackMe-CN/"><div class="navbar__logo"><img src="/TryHackMe-CN/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/TryHackMe-CN/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">TryHackMe-CN</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/TryHackMe-CN/docs/Modules/">Tutorial</a><a class="navbar__item navbar__link" href="/TryHackMe-CN/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/TryHackMe-CN/en/docs/Modules/Command Line/Windows PowerShell" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/TryHackMe-CN/docs/Modules/Command Line/Windows PowerShell" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh">简体中文</a></li></ul></div><a href="https://github.com/TryHackMyOffsecBox/TryHackMe-CN" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/TryHackMe-CN/docs/Modules/"><span title="模块" class="categoryLinkLabel_W154">模块</span></a><button aria-label="折叠侧边栏分类 &#x27;模块&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Attacking LLMs/"><span title="攻击大型语言模型" class="categoryLinkLabel_W154">攻击大型语言模型</span></a><button aria-label="展开侧边栏分类 &#x27;攻击大型语言模型&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/TryHackMe-CN/docs/Modules/Command Line/"><span title="命令行" class="categoryLinkLabel_W154">命令行</span></a><button aria-label="折叠侧边栏分类 &#x27;命令行&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Command Line/Windows Command Line"><span title="Windows 命令行" class="linkLabel_WmDU">Windows 命令行</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/TryHackMe-CN/docs/Modules/Command Line/Windows PowerShell"><span title="Windows PowerShell" class="linkLabel_WmDU">Windows PowerShell</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Command Line/Linux Shells"><span title="Linux Shells" class="linkLabel_WmDU">Linux Shells</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Container Security/"><span title="容器安全" class="categoryLinkLabel_W154">容器安全</span></a><button aria-label="展开侧边栏分类 &#x27;容器安全&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Host Evasions/"><span title="主机规避" class="categoryLinkLabel_W154">主机规避</span></a><button aria-label="展开侧边栏分类 &#x27;主机规避&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Memory Analysis/"><span title="内存分析" class="categoryLinkLabel_W154">内存分析</span></a><button aria-label="展开侧边栏分类 &#x27;内存分析&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Microsoft Defender XDR/"><span title="Microsoft Defender XDR" class="categoryLinkLabel_W154">Microsoft Defender XDR</span></a><button aria-label="展开侧边栏分类 &#x27;Microsoft Defender XDR&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Starters/"><span title="入门挑战" class="categoryLinkLabel_W154">入门挑战</span></a><button aria-label="展开侧边栏分类 &#x27;入门挑战&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/TryHackMe-CN/docs/Networks/"><span title="网络" class="categoryLinkLabel_W154">网络</span></a><button aria-label="展开侧边栏分类 &#x27;网络&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/TryHackMe-CN/docs/"><span title="index" class="linkLabel_WmDU">index</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/TryHackMe-CN/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/TryHackMe-CN/docs/Modules/"><span>模块</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/TryHackMe-CN/docs/Modules/Command Line/"><span>命令行</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Windows PowerShell</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Windows PowerShell</h1></header>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务-1-简介">任务 1 简介<a href="#任务-1-简介" class="hash-link" aria-label="任务 1 简介的直接链接" title="任务 1 简介的直接链接" translate="no">​</a></h2>
<p>你好！ 如果你在这里，要么是听说了 PowerShell 的神奇之处想了解更多，要么是从命令行模块的第一个房间——<a class="" href="/TryHackMe-CN/docs/Modules/Command Line/Windows Command Line">Windows 命令行</a>航行过来的。 无论如何，您即将踏上一段探索这个强大shell奇迹的旅程，学习如何使用它来揭示任何Windows系统的秘密。 那么，上船！</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="学习目标">学习目标<a href="#学习目标" class="hash-link" aria-label="学习目标的直接链接" title="学习目标的直接链接" translate="no">​</a></h3>
<p>这是命令行模块中的第二个房间。 这是一个关于PowerShell的介绍性房间，PowerShell是历史上第二个为Windows操作系统构建的命令行实用程序。</p>
<ul>
<li class="">了解什么是 PowerShell 及其功能。</li>
<li class="">理解 PowerShell 语言的基本结构。</li>
<li class="">学习并运行一些基本的 PowerShell 命令。</li>
<li class="">理解 PowerShell 在网络安全行业中的许多应用。</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="房间先决条件">房间先决条件<a href="#房间先决条件" class="hash-link" aria-label="房间先决条件的直接链接" title="房间先决条件的直接链接" translate="no">​</a></h3>
<p>在接近这个房间之前，建议你已理解 Windows 和 AD 基础模块以及 Windows 命令行房间中的概念。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 起锚，升帆——是时候起航了！ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务-2-什么是-powershell">任务 2 什么是 PowerShell<a href="#任务-2-什么是-powershell" class="hash-link" aria-label="任务 2 什么是 PowerShell的直接链接" title="任务 2 什么是 PowerShell的直接链接" translate="no">​</a></h2>
<p>来自官方 Microsoft <a href="https://learn.microsoft.com/en-us/powershell/scripting/overview?view=powershell-7.4" target="_blank" rel="noopener noreferrer" class="">页面</a>：“PowerShell 是一个跨平台的任务自动化解决方案，由命令行 shell、脚本语言和配置管理框架组成。”</p>
<p>PowerShell 是微软设计的一个强大工具，用于任务自动化和配置管理。 它结合了命令行界面和基于.NET框架构建的脚本语言。 与较旧的基于文本的命令行工具不同，PowerShell是面向对象的，这意味着它可以处理复杂的数据类型并更有效地与系统组件交互。 最初仅限Windows使用，PowerShell最近已扩展到支持macOS和Linux，使其成为跨不同操作系统的IT专业人员的多功能选择。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="powershell-简史">PowerShell 简史<a href="#powershell-简史" class="hash-link" aria-label="PowerShell 简史的直接链接" title="PowerShell 简史的直接链接" translate="no">​</a></h3>
<p>PowerShell 的开发是为了克服 Windows 中现有命令行工具和脚本环境的局限性。 在21世纪初，随着Windows在复杂企业环境中的使用日益增多，像<code>cmd.exe</code>和批处理文件这样的传统工具在自动化和管理这些系统方面显得不足。 微软需要一个能够处理更复杂管理任务并与Windows现代API交互的工具。</p>
<p>微软工程师Jeffrey Snover意识到Windows和Unix处理系统操作的方式不同——Windows使用结构化数据和API，而Unix将所有内容视为文本文件。 这种差异使得将Unix工具移植到Windows不切实际。 Snover的解决方案是开发一种面向对象的方法，将脚本编写的简单性与.NET框架的强大功能相结合。 PowerShell于2006年发布，通过操作对象，使管理员能够更有效地自动化任务，提供与Windows系统的更深层次集成。</p>
<p>随着IT环境发展到包括各种操作系统，对多功能自动化工具的需求日益增长。 2016 年，微软通过发布 PowerShell Core 做出回应，这是一个开源且跨平台的版本，可在 Windows、macOS 和 Linux 上运行。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="powershell-中的力量">PowerShell 中的力量<a href="#powershell-中的力量" class="hash-link" aria-label="PowerShell 中的力量的直接链接" title="PowerShell 中的力量的直接链接" translate="no">​</a></h3>
<p>要完全掌握 PowerShell 的力量，我们首先需要理解在此上下文中什么是<strong>对象</strong>。</p>
<p>在编程中，<strong>对象</strong>代表具有<strong>属性</strong>（特征）和<strong>方法</strong>（动作）的项。 例如，一个 <code>car</code> 对象可能具有像 <code>Color</code>、<code>Model</code> 和 <code>FuelLevel</code> 这样的属性，以及像 <code>Drive()</code>、<code>HonkHorn()</code> 和 <code>Refuel()</code> 这样的方法。</p>
<p>类似地，在 PowerShell 中，对象是封装数据和功能的基本单元，使得管理和操作信息更容易。 PowerShell中的对象可以包含文件名、用户名或大小作为数据（<strong>属性</strong>），并携带函数（<strong>方法</strong>），例如复制文件或停止进程。</p>
<p>传统命令 shell 的基本命令是基于文本的，这意味着它们以纯文本形式处理和输出数据。 相反，当在PowerShell中运行<strong>cmdlet</strong>（发音为command-let）时，它会返回保留其属性和方法的对象。 这允许更强大和灵活的数据操作，因为这些对象不需要额外的文本解析。</p>
<p>我们将在接下来的部分中探索更多关于 PowerShell 的 cmdlet 及其功能。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 我们称用于开发 PowerShell 的高级方法为什么？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">object-oriented</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务-3-powershell-基础">任务 3 PowerShell 基础<a href="#任务-3-powershell-基础" class="hash-link" aria-label="任务 3 PowerShell 基础的直接链接" title="任务 3 PowerShell 基础的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="启动-powershell">启动 PowerShell<a href="#启动-powershell" class="hash-link" aria-label="启动 PowerShell的直接链接" title="启动 PowerShell的直接链接" translate="no">​</a></h3>
<p>PowerShell 可以通过几种方式启动，具体取决于你的需求和环境。 如果你从图形界面（GUI）在 Windows 系统上工作，这些是启动它的一些可能方式：</p>
<ul>
<li class=""><strong>开始菜单</strong>：在 Windows 开始菜单搜索栏中输入 <code>powershell</code>，然后从结果中点击 <code>Windows PowerShell</code> 或 <code>PowerShell</code>。</li>
<li class=""><strong>运行对话框</strong>：按 <code>Win + R</code> 打开 <code>运行</code> 对话框，输入 <code>powershell</code>，然后按 <code>Enter</code>。</li>
<li class=""><strong>文件资源管理器</strong>：导航到任何文件夹，然后在地址栏中输入 <code>powershell</code>，并按 <code>Enter</code>。 这将在该特定目录中打开 PowerShell。 这将在该特定目录中打开PowerShell。</li>
<li class=""><strong>任务管理器</strong>：打开任务管理器，转到 <code>文件 &gt; 运行新任务</code>，输入 <code>powershell</code>，然后按 <code>Enter</code>。</li>
</ul>
<p>或者，可以通过在命令提示符（<code>cmd.exe</code>）中输入 <code>powershell</code> 并按 <code>Enter</code> 来启动 PowerShell。</p>
<p>在我们的情况下，我们只能访问目标 VM 的命令提示符，这是我们将使用的方法。</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">captain@THEBLACKPEARL C:\Users\captain&gt;powershell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Windows PowerShell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Copyright </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">C</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> Microsoft Corporation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> All rights reserved</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Install the latest PowerShell </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> new features and improvements! https:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">aka</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ms/PSWindows</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain&gt; </span><br></span></code></pre></div></div>
<p>PowerShell 启动后，我们在当前工作目录中看到一个 <code>PS</code>（代表 <code>PowerShell</code>）提示符。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="基本语法动词-名词">基本语法：动词-名词<a href="#基本语法动词-名词" class="hash-link" aria-label="基本语法：动词-名词的直接链接" title="基本语法：动词-名词的直接链接" translate="no">​</a></h3>
<p>如前所述，PowerShell 命令被称为 <code>cmdlets</code>（发音为 <code>command-lets</code>）。 它们比传统的Windows命令强大得多，并允许更高级的数据操作。</p>
<p>Cmdlets 遵循一致的 <code>动词-名词</code> 命名约定。 这种结构使得理解每个cmdlet的功能变得容易。 <code>Verb</code>描述动作，而<code>Noun</code>指定执行动作的对象。 例如：</p>
<ul>
<li class=""><code>Get-Content</code>：检索（获取）文件的内容并在控制台中显示。</li>
<li class=""><code>Set-Location</code>：更改（设置）当前工作目录。</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="基本-cmdlets">基本 Cmdlets<a href="#基本-cmdlets" class="hash-link" aria-label="基本 Cmdlets的直接链接" title="基本 Cmdlets的直接链接" translate="no">​</a></h3>
<p>要列出当前 PowerShell 会话中所有可执行的 cmdlet、函数、别名和脚本，我们可以使用 <code>Get-Command</code>。 它是发现可以使用哪些命令的基本工具。</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain&gt; </span><span class="token function" style="color:#d73a49">Get-Command</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CommandType     Name                                               Version    Source </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">     </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">                                               </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">    </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Alias           </span><span class="token function" style="color:#d73a49">Add-AppPackage</span><span class="token plain">                                     2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0    Appx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Alias           </span><span class="token function" style="color:#d73a49">Add-AppPackageVolume</span><span class="token plain">                               2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0    Appx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Alias           </span><span class="token function" style="color:#d73a49">Add-AppProvisionedPackage</span><span class="token plain">                          3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0        Dism</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">Function</span><span class="token plain">        A:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">Function</span><span class="token plain">        </span><span class="token function" style="color:#d73a49">Add-BCDataCacheExtension</span><span class="token plain">                           1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0    BranchCache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">Function</span><span class="token plain">        </span><span class="token function" style="color:#d73a49">Add-DnsClientDohServerAddress</span><span class="token plain">                      1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0    DnsClient</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cmdlet          </span><span class="token function" style="color:#d73a49">Add-AppxPackage</span><span class="token plain">                                    2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0    Appx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cmdlet          </span><span class="token function" style="color:#d73a49">Add-AppxProvisionedPackage</span><span class="token plain">                         3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0        Dism</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cmdlet          </span><span class="token function" style="color:#d73a49">Add-AppxVolume</span><span class="token plain">                                     2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0    Appx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<p>对于 cmdlet 检索的每个 <code>CommandInfo</code> 对象，一些基本信息（属性）显示在控制台上。 可以根据显示的属性值过滤命令列表。 例如，如果我们只想显示类型为“function”的可用命令，我们可以使用<code>-CommandType &quot;Function&quot;</code>，如下所示：</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain&gt; </span><span class="token function" style="color:#d73a49">Get-Command</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">CommandType </span><span class="token string" style="color:#e3116c">&quot;Function&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CommandType     Name                                               Version    Source</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">     </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">                                               </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">    </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">Function</span><span class="token plain">        A:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">Function</span><span class="token plain">        </span><span class="token function" style="color:#d73a49">Add-BCDataCacheExtension</span><span class="token plain">                           1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0    BranchCache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">Function</span><span class="token plain">        </span><span class="token function" style="color:#d73a49">Add-DnsClientDohServerAddress</span><span class="token plain">                      1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0    DnsClient</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">Function</span><span class="token plain">        </span><span class="token function" style="color:#d73a49">Add-DnsClientNrptRule</span><span class="token plain">                              1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0    DnsClient</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<p>我们将在后续任务中学习更高效地筛选cmdlet输出的方法。</p>
<p>我们工具箱中另一个必不可少的cmdlet是<code>Get-Help</code>：它提供有关cmdlet的详细信息，包括用法、参数和示例。 这是学习如何使用PowerShell命令的首选cmdlet。</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain&gt; </span><span class="token function" style="color:#d73a49">Get-Help</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Get-Date</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Get-Date</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SYNOPSIS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Gets the current date and time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SYNTAX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Get-Date</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Date</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> &lt;System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DateTime&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Day &lt;System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Int32&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">DisplayHint </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Date </span><span class="token punctuation" style="color:#393A34">|</span><span class="token plain"> Time </span><span class="token punctuation" style="color:#393A34">|</span><span class="token plain"> DateTime</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Format &lt;System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">String&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Hour &lt;System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Int32&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Millisecond &lt;System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Int32&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Minute &lt;System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Int32&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Month &lt;System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Int32&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Second &lt;System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Int32&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Year &lt;System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Int32&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">&lt;CommonParameters&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Get-Date</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Date</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> &lt;System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DateTime&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Day &lt;System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Int32&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">DisplayHint </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Date </span><span class="token punctuation" style="color:#393A34">|</span><span class="token plain"> Time </span><span class="token punctuation" style="color:#393A34">|</span><span class="token plain"> DateTime</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Hour &lt;System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Int32&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Millisecond &lt;System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Int32&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Minute &lt;System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Int32&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Month &lt;System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Int32&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Second &lt;System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Int32&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">UFormat &lt;System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">String&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Year &lt;System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Int32&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">&lt;CommonParameters&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DESCRIPTION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        The `</span><span class="token function" style="color:#d73a49">Get-Date</span><span class="token plain">` cmdlet gets a DateTime object that represents the current date or a date that you specify</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> `</span><span class="token function" style="color:#d73a49">Get-Date</span><span class="token plain">` can format the date and time in several </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">NET and UNIX formats</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> You can use `</span><span class="token function" style="color:#d73a49">Get-Date</span><span class="token plain">` to generate a date or time character string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> and then send the string to other cmdlets or programs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        `</span><span class="token function" style="color:#d73a49">Get-Date</span><span class="token plain">` uses the current culture settings of the operating system to determine how the output is formatted</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> To view your computer&#x27;s settings</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> use `</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">Get-Culture</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DateTimeFormat`</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RELATED LINKS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Online Version: https:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">learn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">microsoft</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com/powershell/module/microsoft</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">powershell</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">utility/</span><span class="token function" style="color:#d73a49">get-date</span><span class="token plain">?view=powershell-5</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">1&amp;WT</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mc_id=</span><span class="token function" style="color:#d73a49">ps</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">gethelp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">ForEach-Object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Get-Culture</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Get-Member</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">New-Item</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">New-TimeSpan</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Set-Date</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Set-Culture</span><span class="token plain"> xref:International</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Set-Culture</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REMARKS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    To see the examples</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">type</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;get-help Get-Date -examples&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">For</span><span class="token plain"> more information</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">type</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;get-help Get-Date -detailed&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">For</span><span class="token plain"> technical information</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">type</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;get-help Get-Date -full&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">For</span><span class="token plain"> online help</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">type</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;get-help Get-Date -online&quot;</span><span class="token punctuation" style="color:#393A34">.</span><br></span></code></pre></div></div>
<p>如上所示，<code>Get-Help</code>告知我们可以通过在基本语法后附加一些选项来获取有关cmdlet的其他有用信息。 例如，通过将<code>-examples</code>附加到上面显示的命令，我们将看到所选cmdlet可以使用的常见方式列表。</p>
<p>为了让IT专业人员更容易过渡，PowerShell包含了许多传统Windows命令的别名——即cmdlet的快捷方式或替代名称。 对于已熟悉其他命令行工具的用户来说，<code>Get-Alias</code> 是必不可少的，它列出了所有可用的别名。 例如，<code>dir</code>是<code>Get-ChildItem</code>的别名，<code>cd</code>是<code>Set-Location</code>的别名。</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain&gt; </span><span class="token function" style="color:#d73a49">Get-Alias</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CommandType     Name                                               Version    Source </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">     </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">                                               </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">    </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Alias           </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">&gt; </span><span class="token function" style="color:#d73a49">ForEach-Object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Alias           ? </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">&gt; </span><span class="token function" style="color:#d73a49">Where-Object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Alias           </span><span class="token function" style="color:#d73a49">ac</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">&gt; </span><span class="token function" style="color:#d73a49">Add-Content</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Alias           asnp </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">&gt; </span><span class="token function" style="color:#d73a49">Add-PSSnapin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Alias           </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">&gt; </span><span class="token function" style="color:#d73a49">Get-Content</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Alias           cd </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">&gt; </span><span class="token function" style="color:#d73a49">Set-Location</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Alias           CFS </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">&gt; </span><span class="token function" style="color:#d73a49">ConvertFrom-String</span><span class="token plain">                          3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0    Microsoft</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PowerShell</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Utility</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Alias           </span><span class="token function" style="color:#d73a49">chdir</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">&gt; </span><span class="token function" style="color:#d73a49">Set-Location</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Alias           </span><span class="token function" style="color:#d73a49">clc</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">&gt; </span><span class="token function" style="color:#d73a49">Clear-Content</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Alias           clear </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">&gt; </span><span class="token function" style="color:#d73a49">Clear-Host</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="在哪里查找和下载cmdlets">在哪里查找和下载Cmdlets<a href="#在哪里查找和下载cmdlets" class="hash-link" aria-label="在哪里查找和下载Cmdlets的直接链接" title="在哪里查找和下载Cmdlets的直接链接" translate="no">​</a></h3>
<p>PowerShell的另一个强大功能是通过从在线存储库下载额外的cmdlet来扩展其功能。</p>
<p><strong>注意</strong>：请注意，本节列出的cmdlet需要有效的互联网连接来查询在线存储库。 附加的机器无法访问互联网，因此这些命令在此环境中无法工作。</p>
<p>要在PowerShell Gallery等在线存储库中搜索模块（cmdlet集合），我们可以使用<code>Find-Module</code>。 有时，如果我们不知道模块的确切名称，搜索具有相似名称的模块可能很有用。 我们可以通过过滤<code>Name</code>属性并在模块的部分名称后附加通配符（<code>*</code>）来实现这一点，使用以下标准PowerShell语法：<code>Cmdlet -Property &quot;pattern*&quot;</code>。</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain&gt; </span><span class="token function" style="color:#d73a49">Find-Module</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Name </span><span class="token string" style="color:#e3116c">&quot;PowerShell*&quot;</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Version    Name                                Repository           Description </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">    </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">                                </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">           </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">4</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">7      powershell-yaml                     PSGallery            Powershell module </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> serializing and deserializing YAML</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">5      PowerShellGet                       PSGallery            PowerShell module with commands </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> discovering</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> installing</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> updating and publishing the PowerShell artifacts like Modules</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DSC Resources</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Role Capabilities and Scripts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">                                                   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">80</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0   PowerShell</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">InvokeWinGet      PSGallery            Module to Invoke WinGet and parse the output in PSOjects</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">17</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0     PowerShellForGitHub                 PSGallery            PowerShell wrapper </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> GitHub API  </span><br></span></code></pre></div></div>
<p>一旦识别出模块，就可以使用<code>Install-Module</code>从存储库下载并安装它们，使模块中包含的新cmdlet可供使用。</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain&gt; </span><span class="token function" style="color:#d73a49">Install-Module</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Name </span><span class="token string" style="color:#e3116c">&quot;PowerShellGet&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Untrusted repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">You are installing the modules </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> an untrusted repository</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">If</span><span class="token plain"> you trust this repository</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> change its InstallationPolicy value by running the </span><span class="token function" style="color:#d73a49">Set-PSRepository</span><span class="token plain"> cmdlet</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> Are you sure you want to install the modules </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;PSGallery&#x27;</span><span class="token plain">?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token namespace" style="opacity:0.7">[Y]</span><span class="token plain"> Yes  </span><span class="token namespace" style="opacity:0.7">[A]</span><span class="token plain"> Yes to All  </span><span class="token namespace" style="opacity:0.7">[N]</span><span class="token plain"> No  </span><span class="token namespace" style="opacity:0.7">[L]</span><span class="token plain"> No to All  </span><span class="token namespace" style="opacity:0.7">[S]</span><span class="token plain"> Suspend  </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">?</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Help </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">default is </span><span class="token string" style="color:#e3116c">&quot;N&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">: </span><br></span></code></pre></div></div>
<p>有了这些基本工具，我们现在可以开始探索PowerShell的功能了。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 如何检索以动词<code>Remove</code><strong>开头</strong>的命令列表？ [为了这个问题，避免在答案中使用引号（&quot;或&#x27;）] </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Get-Command -Name Remove*</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 哪个cmdlet的传统对应别名是<code>echo</code>？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Write-Output</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 获取cmdlet <code>New-LocalUser</code>的一些示例用法的命令是什么？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Get-Help New-LocalUser -examples</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务4-导航文件系统和处理文件">任务4 导航文件系统和处理文件<a href="#任务4-导航文件系统和处理文件" class="hash-link" aria-label="任务4 导航文件系统和处理文件的直接链接" title="任务4 导航文件系统和处理文件的直接链接" translate="no">​</a></h2>
<p>PowerShell提供了一系列用于导航文件系统和管理文件的cmdlet，其中许多在传统Windows CLI中有对应命令。</p>
<p>类似于命令提示符中的<code>dir</code>命令（或类Unix系统中的<code>ls</code>），<code>Get-ChildItem</code>列出使用<code>-Path</code>参数指定的位置中的文件和目录。 它可以用于探索目录并查看其内容。 如果未指定<code>Path</code>，cmdlet将显示当前工作目录的内容。</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain&gt; </span><span class="token function" style="color:#d73a49">Get-ChildItem</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Directory: C:\Users\captain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mode                 LastWriteTime         Length Name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">                 </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">         </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d-r-</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">          5/8/2021   9:15 AM                Desktop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d-r-</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">          9/4/2024  10:58 AM                Documents</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d-r-</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">          5/8/2021   9:15 AM                Downloads</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d-r-</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">          5/8/2021   9:15 AM                Favorites</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d-r-</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">          5/8/2021   9:15 AM                Links</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d-r-</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">          5/8/2021   9:15 AM                Music</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d-r-</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">          5/8/2021   9:15 AM                Pictures</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d-</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">          5/8/2021   9:15 AM                Saved Games</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d-r-</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">          5/8/2021   9:15 AM                Videos</span><br></span></code></pre></div></div>
<p>要导航到不同的目录，我们可以使用<code>Set-Location</code> cmdlet。 它更改当前目录，将我们带到指定路径，类似于命令提示符中的<code>cd</code>命令。</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain&gt; </span><span class="token function" style="color:#d73a49">Set-Location</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Path </span><span class="token string" style="color:#e3116c">&quot;.\Documents&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain\Documents&gt; </span><br></span></code></pre></div></div>
<p>虽然传统的Windows CLI使用单独的命令来创建和管理不同的项目（如目录和文件），但PowerShell通过提供一组统一的cmdlet来处理文件和目录的创建和管理，简化了这一过程。</p>
<p>要在PowerShell中创建项目，我们可以使用<code>New-Item</code>。 我们需要指定项的路径及其类型（无论是文件还是目录）。</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain\Documents&gt; </span><span class="token function" style="color:#d73a49">New-Item</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Path </span><span class="token string" style="color:#e3116c">&quot;.\captain-cabin\captain-wardrobe&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">ItemType </span><span class="token string" style="color:#e3116c">&quot;Directory&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Directory: C:\Users\captain\Documents\captain-cabin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mode                 LastWriteTime         Length Name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">                 </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">         </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d-</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">          9/4/2024  12:20 PM                captain-wardrobe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain\Documents&gt; </span><span class="token function" style="color:#d73a49">New-Item</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Path </span><span class="token string" style="color:#e3116c">&quot;.\captain-cabin\captain-wardrobe\captain-boots.txt&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">ItemType </span><span class="token string" style="color:#e3116c">&quot;File&quot;</span><span class="token plain">     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Directory: C:\Users\captain\Documents\captain-cabin\captain-wardrobe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mode                 LastWriteTime         Length Name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">                 </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">         </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain">a-</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">          9/4/2024  11:46 AM              0 captain-boots</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt  </span><br></span></code></pre></div></div>
<p>类似地，<code>Remove-Item</code> cmdlet可删除目录和文件，而在Windows CLI中我们有单独的命令<code>rmdir</code>和<code>del</code>。</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain\Documents&gt; </span><span class="token function" style="color:#d73a49">Remove-Item</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Path </span><span class="token string" style="color:#e3116c">&quot;.\captain-cabin\captain-wardrobe\captain-boots.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain\Documents&gt; </span><span class="token function" style="color:#d73a49">Remove-Item</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Path </span><span class="token string" style="color:#e3116c">&quot;.\captain-cabin\captain-wardrobe&quot;</span><span class="token plain"> </span><br></span></code></pre></div></div>
<p>我们可以分别使用<code>Copy-Item</code>（相当于<code>copy</code>）和<code>Move-Item</code>（相当于<code>move</code>）来复制或移动文件和目录。</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain\Documents&gt; </span><span class="token function" style="color:#d73a49">Copy-Item</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Path </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">\captain-cabin\captain-hat</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Destination </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">\captain-cabin\captain-hat2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain\Documents&gt; </span><span class="token function" style="color:#d73a49">Get-ChildItem</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Path </span><span class="token string" style="color:#e3116c">&quot;.\captain-cabin\&quot;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Directory: C:\Users\captain\Documents\captain-cabin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mode                 LastWriteTime         Length Name </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">                 </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">         </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d-</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">          9/4/2024  12:50 PM                captain-wardrobe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain">a-</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">          9/4/2024  12:50 PM              0 captain-boots</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain">a-</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">          9/4/2024  12:14 PM            264 captain-hat</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain">a-</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">          9/4/2024  12:14 PM            264 captain-hat2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain">a-</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">          9/4/2024  12:37 PM           2116 ship-flag</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt </span><br></span></code></pre></div></div>
<p>最后，要读取并显示文件内容，我们可以使用 <code>Get-Content</code> cmdlet，其功能类似于命令提示符中的 <code>type</code> 命令（或类 Unix 系统中的 <code>cat</code> 命令）。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 你可以使用哪个 cmdlet 来替代传统的 Windows 命令 <code>type</code>？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Get-Content</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 你会使用哪个 PowerShell 命令来显示 &quot;C:\Users&quot; 目录的内容？ [为了这个问题，避免在答案中使用引号（&quot;或&#x27;）] </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Get-ChildItem -Path C:\Users</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 上一个问题中描述的命令显示了几个项目？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">4</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务-5-管道过滤和排序数据">任务 5 管道、过滤和排序数据<a href="#任务-5-管道过滤和排序数据" class="hash-link" aria-label="任务 5 管道、过滤和排序数据的直接链接" title="任务 5 管道、过滤和排序数据的直接链接" translate="no">​</a></h2>
<p><code>Piping</code>是命令行环境中使用的一种技术，允许将一个命令的输出用作另一个命令的输入。 这创建了一个操作序列，其中数据从一个命令流向下一个命令。 由<code>|</code>符号表示，管道在Windows CLI中广泛使用，如本模块前面介绍的那样，以及在基于Unix的shell中。</p>
<p>在 PowerShell 中，管道更加强大，因为它传递的是 <strong>对象</strong> 而不仅仅是文本。 这些对象不仅携带数据，还携带描述数据并与数据交互的属性和方法。</p>
<p>例如，如果你想获取目录中的文件列表，然后按大小排序，可以在 PowerShell 中使用以下命令：</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain\Documents\captain-cabin&gt; </span><span class="token function" style="color:#d73a49">Get-ChildItem</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Sort-Object</span><span class="token plain"> Length</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Directory: C:\Users\captain\Documents\captain-cabin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mode                 LastWriteTime         Length Name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">                 </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">         </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain">a-</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">          9/4/2024  12:50 PM              0 captain-boots</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain">a-</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">          9/4/2024  12:14 PM            264 captain-hat2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain">a-</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">          9/4/2024  12:14 PM            264 captain-hat</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain">a-</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">          9/4/2024  12:37 PM           2116 ship-flag</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d-</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">          9/4/2024  12:50 PM                captain-wardrobe</span><br></span></code></pre></div></div>
<p>这里，<code>Get-ChildItem</code> 检索文件（作为对象），管道（<code>|</code>）将这些文件对象发送到 <code>Sort-Object</code>，然后按它们的 <code>Length</code>（大小）属性进行排序。 这种基于对象的方法允许更详细和灵活的命令序列。</p>
<p>在上面的示例中，我们利用了 <code>Sort-Object</code> cmdlet 来根据指定属性对对象进行排序。 除了排序，PowerShell提供了一组cmdlet，当与管道结合使用时，允许高级数据操作和分析。</p>
<p>要根据指定条件过滤对象，仅返回符合标准的对象，我们可以使用 <code>Where-Object</code> cmdlet。 例如，要仅列出目录中的<code>.txt</code>文件，我们可以使用：</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain\Documents\captain-cabin&gt; </span><span class="token function" style="color:#d73a49">Get-ChildItem</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Where-Object</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Property </span><span class="token string" style="color:#e3116c">&quot;Extension&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-eq</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;.txt&quot;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Directory: C:\Users\captain\Documents\captain-cabin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mode                 LastWriteTime         Length Name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">                 </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">         </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain">a-</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">          9/4/2024  12:50 PM              0 captain-boots</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain">a-</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">          9/4/2024  12:14 PM            264 captain-hat</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain">a-</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">          9/4/2024  12:14 PM            264 captain-hat2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain">a-</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">          9/4/2024  12:37 PM           2116 ship-flag</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt</span><br></span></code></pre></div></div>
<p>这里，<code>Where-Object</code> 通过文件的 <code>Extension</code> 属性进行过滤，确保仅列出扩展名等于（<code>-eq</code>）<code>.txt</code> 的文件。</p>
<p>运算符 <code>-eq</code>（即 &quot;<strong>等于</strong>&quot;）是一组 <strong>比较运算符</strong> 的一部分，这些运算符与其他脚本语言（例如 Bash、Python）共享。 为了展示PowerShell过滤的潜力，我们从该列表中挑选了一些最有用的运算符：</p>
<ul>
<li class=""><code>-ne</code>：&quot;<strong>不等于</strong>&quot;。 此运算符可用于根据指定条件从结果中排除对象。</li>
<li class=""><code>-gt</code>：&quot;<strong>大于</strong>&quot;。 此运算符将仅过滤超过指定值的对象。 需要注意的是，这是一个严格比较，意味着等于指定值的对象将被排除在结果之外。</li>
<li class=""><code>-ge</code>：&quot;<strong>大于或等于</strong>&quot;。 这是前一个运算符的非严格版本。 <code>-gt</code>和<code>-eq</code>的组合。</li>
<li class=""><code>-lt</code>：&quot;<strong>小于</strong>&quot;。 与其对应项&quot;大于&quot;一样，这是一个严格运算符。 它将仅包括严格低于某个值的对象。</li>
<li class=""><code>-le</code>：&quot;<strong>小于或等于</strong>&quot;。 就像其对应项<code>-ge</code>一样，这是前一个运算符的非严格版本。 <code>-lt</code>和<code>-eq</code>的组合。</li>
</ul>
<p>下面，另一个示例显示对象也可以通过选择匹配（<code>-like</code>）指定模式的属性进行过滤：</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain\Documents\captain-cabin&gt; </span><span class="token function" style="color:#d73a49">Get-ChildItem</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Where-Object</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Property </span><span class="token string" style="color:#e3116c">&quot;Name&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-like</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ship*&quot;</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Directory: C:\Users\captain\Documents\captain-cabin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mode                 LastWriteTime         Length Name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">                 </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">         </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain">a-</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">          9/4/2024  12:37 PM           2116 ship-flag</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt</span><br></span></code></pre></div></div>
<p>下一个过滤 cmdlet <code>Select-Object</code> 用于从对象中选择特定属性或限制返回的对象数量。 它对于优化输出以仅显示所需细节非常有用。</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain\Documents\captain-cabin&gt; </span><span class="token function" style="color:#d73a49">Get-ChildItem</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Select-Object</span><span class="token plain"> Name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">Length </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name              Length</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">              </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">captain-wardrobe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">captain-boots</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">captain-hat</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt   264</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">captain-hat2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt  264</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ship-flag</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt     2116</span><br></span></code></pre></div></div>
<p>cmdlet管道可以通过添加更多命令来扩展，因为该功能不仅限于在两个cmdlet之间进行管道传输。 作为练习，尝试构建一个 cmdlet 管道来排序和过滤输出，目标是显示 <code>C:\Users\captain\Documents\captain-cabin</code> 目录中最大的文件。</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 点击此处查看可能的解决方案。 不要作弊！ </summary><div><div class="collapsibleContent_i85q"><div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">Get-ChildItem</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Sort-Object</span><span class="token plain"> Length </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Descending </span><span class="token punctuation" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Select-Object</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">First 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Directory: C:\Users\captain\Documents\captain-cabin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mode                 LastWriteTime         Length Name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">                 </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">         </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain">a-</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">          9/4/2024  12:37 PM           2116 ship-flag</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt</span><br></span></code></pre></div></div></div></div></details>
<p>这组过滤cmdlet中的最后一个是<code>Select-String</code>。 此 cmdlet 在文件中搜索文本模式，类似于基于 Unix 系统中的 <code>grep</code> 或 Windows 命令提示符中的 <code>findstr</code>。 它通常用于在日志文件或文档中查找特定内容。</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain\Documents\captain-cabin&gt; </span><span class="token function" style="color:#d73a49">Select-String</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Path </span><span class="token string" style="color:#e3116c">&quot;.\captain-hat.txt&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Pattern </span><span class="token string" style="color:#e3116c">&quot;hat&quot;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">captain-hat</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt:8:Don&#x27;t touch my hat!</span><br></span></code></pre></div></div>
<p><code>Select-String</code> cmdlet 完全支持使用正则表达式（regex）。 此高级功能允许在文件内进行复杂模式匹配，使其成为搜索和分析文本数据的强大工具。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 你将如何检索当前目录中大小大于 100 的项目？ [为了这个问题，避免在答案中使用引号（&quot;或&#x27;）] </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Get-ChildItem | Where-Object -Property Length -gt 100</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务6-系统和网络信息">任务6 系统和网络信息<a href="#任务6-系统和网络信息" class="hash-link" aria-label="任务6 系统和网络信息的直接链接" title="任务6 系统和网络信息的直接链接" translate="no">​</a></h2>
<p>PowerShell的创建是为了满足日益增长的对强大自动化和管理工具的需求，以帮助系统管理员和IT专业人员。 因此，它提供了一系列cmdlet，允许检索有关系统配置和网络设置的详细信息。</p>
<p><code>Get-ComputerInfo</code> cmdlet检索全面的系统信息，包括操作系统信息、硬件规格、BIOS详细信息等。 它在单个命令中提供整个系统配置的快照。 其传统对应项<code>systeminfo</code>仅检索相同细节的一小部分。</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain&gt; </span><span class="token function" style="color:#d73a49">Get-ComputerInfo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WindowsBuildLabEx                                       : 20348</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">859</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">amd64fre</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fe_release_svc_prod2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">220707-1832</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WindowsCurrentVersion                                   : 6</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WindowsEditionId                                        : ServerDatacenter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WindowsInstallationType                                 : Server Core</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WindowsInstallDateFromRegistry                          : 4/23/2024 6:36:29 PM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WindowsProductId                                        : 00454-60000-00001-AA763</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WindowsProductName                                      : Windows Server 2022 Datacenter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<p>对于管理用户帐户和理解机器的安全配置至关重要，Get-LocalUser列出系统上的所有本地用户帐户。 默认输出显示每个用户的用户名、帐户状态和描述。</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain&gt; </span><span class="token function" style="color:#d73a49">Get-LocalUser</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name               Enabled Description </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">               </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Administrator      True    Built-in account </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> administering the computer/domain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">captain            True    The beloved captain of this pirate ship</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DefaultAccount     False   A user account managed by the system</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Guest              False   Built-in account </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> guest access to the computer/domain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WDAGUtilityAccount False   A user account managed and used by the system </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> Windows Defender Application Guard scenarios</span><span class="token punctuation" style="color:#393A34">.</span><br></span></code></pre></div></div>
<p>类似于传统的<code>ipconfig</code>命令，以下两个cmdlet可用于检索有关系统网络配置的详细信息。</p>
<p><code>Get-NetIPConfiguration</code>提供有关系统上网络接口的详细信息，包括IP地址、DNS服务器和网关配置。</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain&gt; </span><span class="token function" style="color:#d73a49">Get-NetIPConfiguration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">InterfaceAlias       : Ethernet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">InterfaceIndex       : 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">InterfaceDescription : Amazon Elastic Network Adapter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NetProfile</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Name      : Network 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPv4Address          : 10</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">10</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">178</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">209</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPv6DefaultGateway   :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPv4DefaultGateway   : 10</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">10</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DNSServer            : 10</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">2</span><br></span></code></pre></div></div>
<p>如果我们需要有关分配给网络接口的IP地址的具体详细信息，<code>Get-NetIPAddress</code> cmdlet将显示系统上配置的所有IP地址的详细信息，包括当前未激活的地址。</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain&gt; </span><span class="token function" style="color:#d73a49">Get-NetIPAddress</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPAddress         : fe80::3fef:360c:304:64e%5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">InterfaceIndex    : 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">InterfaceAlias    : Ethernet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AddressFamily     : IPv6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">Type</span><span class="token plain">              : Unicast</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PrefixLength      : 64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PrefixOrigin      : WellKnown</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SuffixOrigin      : Link</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AddressState      : Preferred</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ValidLifetime     : Infinite </span><span class="token punctuation" style="color:#393A34">(</span><span class="token namespace" style="opacity:0.7">[TimeSpan]</span><span class="token plain">::MaxValue</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PreferredLifetime : Infinite </span><span class="token punctuation" style="color:#393A34">(</span><span class="token namespace" style="opacity:0.7">[TimeSpan]</span><span class="token plain">::MaxValue</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SkipAsSource      : False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PolicyStore       : ActiveStore</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPAddress         : ::1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">InterfaceIndex    : 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">InterfaceAlias    : Loopback Pseudo-Interface 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AddressFamily     : IPv6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPAddress         : 10</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">10</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">178</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">209</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">InterfaceIndex    : 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">InterfaceAlias    : Ethernet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AddressFamily     : IPv4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPAddress         : 127</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">InterfaceIndex    : 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">InterfaceAlias    : Loopback Pseudo-Interface 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AddressFamily     : IPv4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<p>这些cmdlet使IT专业人员能够直接从命令行快速访问关键系统和网络信息，从而更轻松地监控和管理本地和远程机器。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>除了您当前用户和默认的&quot;Administrator&quot;帐户外，目标机器上还有哪个其他用户已启用？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">p1r4t3</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>这个家伙毫不顾及我们敬爱的船长，将他的帐户隐藏在其他帐户中！ 他如此直白地将其作为账户描述的口号是什么？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">A merry life and a short one.</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 现在是一个将所有内容整合起来的小挑战。 我们刚刚在本地用户中发现的这个可疑家伙在 &quot;C:\Users&quot; 目录中有他自己的主文件夹。
你能导航文件系统并找到这个海盗家中隐藏的宝藏吗？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">THM{p34rlInAsh3ll}</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务7-实时系统分析">任务7 实时系统分析<a href="#任务7-实时系统分析" class="hash-link" aria-label="任务7 实时系统分析的直接链接" title="任务7 实时系统分析的直接链接" translate="no">​</a></h2>
<p>为了收集更高级的系统信息，特别是关于动态方面的信息，如运行进程、服务和活动网络连接，我们可以利用一组超越静态机器详细信息的cmdlet。</p>
<p><code>Get-Process</code>提供所有当前运行进程的详细视图，包括CPU和内存使用情况，使其成为监控和故障排除的强大工具。</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain&gt; </span><span class="token function" style="color:#d73a49">Get-Process</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Handles  NPM</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">K</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    PM</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">K</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">      WS</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">K</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">     CPU</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">     Id  </span><span class="token function" style="color:#d73a49">SI</span><span class="token plain"> ProcessName </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">    </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">     </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">     </span><span class="token operator" style="color:#393A34">--</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">--</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     67       5      872        500       0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">06   2340   0 AggregatorHost</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     55       5      712       2672       0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">02   3024   0 AM_Delta_Patch_1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">417</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">483</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    309      13    18312       1256       0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">52   1524   0 amazon-ssm-agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     78       6     4440        944       0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">02    516   0 cmd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     94       7     1224       1744       0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">31    568   0 conhost</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<p>类似地，<code>Get-Service</code>允许检索有关机器上服务状态的信息，例如哪些服务正在运行、已停止或已暂停。 它被系统管理员广泛用于故障排除，也被法证分析师用于搜寻系统中安装的异常服务。</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain&gt; </span><span class="token function" style="color:#d73a49">Get-Service</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Status   Name               DisplayName                           </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">               </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stopped  Amazon EC2Launch   Amazon EC2Launch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Running  AmazonSSMAgent     Amazon SSM Agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stopped  AppIDSvc           Application Identity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Running  BFE                Base Filtering Engine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Running  CertPropSvc        Certificate Propagation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stopped  ClipSVC            Client License Service </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ClipSVC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<p>要监控活跃的网络连接，<code>Get-NetTCPConnection</code> 显示当前的 TCP 连接，提供对本地和远程端点的洞察。 这个cmdlet在事件响应或恶意软件分析任务中特别方便，因为它可以发现隐藏的后门或指向攻击者控制服务器的已建立连接。</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain&gt; </span><span class="token function" style="color:#d73a49">Get-NetTCPConnection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LocalAddress        LocalPort RemoteAddress       RemotePort State       AppliedSetting OwningProcess </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">        </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">       </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">       </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">::                  22        ::                  0          Listen                     1444          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">10</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">10</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">178</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">209       49695     199</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">232</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">26</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">172      80         TimeWait                   0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0             49668     0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0             0          Listen                     424</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0             49667     0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0             0          Listen                     652</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0             49666     0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0             0          Listen                     388</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0             49665     0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0             0          Listen                     560</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0             49664     0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0             0          Listen                     672           </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0             3389      0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0             0          Listen                     980</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">10</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">10</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">178</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">209       139       0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0             0          Listen                     4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0             135       0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0             0          Listen                     908</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">10</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">10</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">178</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">209       22        10</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">14</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">87</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">60         53523      Established Internet       1444</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0             22        0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">0             0          Listen                     1444</span><br></span></code></pre></div></div>
<p>此外，我们将提到<code>Get-FileHash</code>作为一个有用的cmdlet，用于生成文件哈希，这在事件响应、威胁狩猎和恶意软件分析中特别有价值，因为它有助于验证文件完整性并检测潜在的篡改。</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain\Documents\captain-cabin&gt; </span><span class="token function" style="color:#d73a49">Get-FileHash</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Path </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">\ship-flag</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Algorithm       Hash                      Path </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">       </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain">                      </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SHA256          54D2EC3C12BF3D</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">       C:\Users\captain\Documents\captain-cabin\ship-flag</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt</span><br></span></code></pre></div></div>
<p>这些cmdlet共同提供了一套全面的工具，用于实时系统监控和分析，对事件响应者和威胁猎人特别有用。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 在之前的任务中，你在目标机器中找到了一个精心隐藏的奇妙宝藏。 包含它的文件的哈希值是什么？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">71FC5EC11C2497A32F8F08E61399687D90ABE6E204D2964DF589543A613F3E08</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>默认情况下，<code>Get-NetTCPConnection</code>检索的哪个属性包含有关启动连接的进程的信息？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">OwningProcess</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 是时候进行另一个小挑战了。 这艘海盗船上安装了一些重要服务，以确保船长总能安全航行。 但有些东西没有按预期工作，船长想知道原因。 经过调查，他们终于发现了真相：该服务已被篡改！ 之前那个可疑的家伙修改了服务的 <code>DisplayName</code> 以反映他自己的口号，与他放在用户描述中的相同。 有了这些信息以及你到目前为止积累的 PowerShell 知识，你能找到服务名称吗？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">THM{p34rlInAsh3ll}</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务8-脚本编写">任务8 脚本编写<a href="#任务8-脚本编写" class="hash-link" aria-label="任务8 脚本编写的直接链接" title="任务8 脚本编写的直接链接" translate="no">​</a></h2>
<p><strong>脚本编写</strong>是编写和执行文本文件（称为脚本）中包含的一系列命令的过程，用于自动化通常在PowerShell等shell中手动执行的任务。</p>
<p>简单来说，脚本编写就像给计算机一个待办事项列表，脚本中的每一行都是计算机将自动执行的任务。 这节省了时间，减少了出错的机会，并允许执行过于复杂或繁琐而无法手动完成的任务。 随着你对 shell 和脚本编写的了解加深，你会发现脚本是管理系统、处理数据等的强大工具。</p>
<p>学习PowerShell脚本编写超出了本房间的范围。 然而，我们必须理解，它的强大使其成为所有网络安全角色中的关键技能。</p>
<ul>
<li class="">对于<strong>蓝队</strong>专业人员，如事件响应者、恶意软件分析师和威胁猎人，PowerShell脚本可以自动化许多不同的任务，包括日志分析、检测异常和提取入侵指标（IOC）。 这些脚本也可用于逆向工程恶意代码（恶意软件）或自动扫描系统以寻找入侵迹象。</li>
<li class="">对于<strong>红队</strong>，包括渗透测试人员和道德黑客，PowerShell脚本可以自动化系统枚举、执行远程命令和制作混淆脚本以绕过防御等任务。 它与所有类型系统的深度集成使其成为模拟攻击和测试系统抵御现实世界威胁能力的强大工具。</li>
<li class="">在网络安全背景下，<strong>系统管理员</strong>受益于PowerShell脚本编写，用于自动化完整性检查、管理系统配置和保护网络，尤其是在远程或大规模环境中。 PowerShell 脚本可以设计用于强制执行安全策略、监控系统健康状况并自动响应安全事件，从而增强整体安全态势。</li>
</ul>
<p>无论是用于防御还是进攻，PowerShell脚本编写都是网络安全工具包中的基本能力。</p>
<p>在结束这个关于脚本编写的任务之前，我们不能不提到<code>Invoke-Command</code> cmdlet。</p>
<p><code>Invoke-Command</code> 对于在远程系统上执行命令至关重要，使其成为系统管理员、安全工程师和渗透测试人员的基础工具。 <code>Invoke-Command</code> 实现了高效的远程管理，并结合脚本编写，实现了跨多台机器的任务自动化。 它也可用于在渗透测试人员（或攻击者）参与期间在目标系统上执行有效载荷或命令。</p>
<p>让我们通过查阅<code>Get-Help</code>的&quot;示例&quot;页面来了解这个强大cmdlet的一些示例用法：</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">PS</span><span class="token plain"> C:\Users\captain&gt; </span><span class="token function" style="color:#d73a49">Get-Help</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Invoke-Command</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">examples</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Invoke-Command</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SYNOPSIS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Runs commands on local and remote computers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> Example 1: Run a script on a server </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Invoke-Command</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">FilePath c:\scripts\test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ps1 </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">ComputerName Server01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    The FilePath parameter specifies a script that is located on the local computer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> The script runs on the remote computer and the results are returned to the local computer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> Example 2: Run a command on a remote server </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Invoke-Command</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">ComputerName Server01 </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Credential Domain01\User01 </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">ScriptBlock </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Get-Culture</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    The ComputerName parameter specifies the name of the remote computer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> The Credential parameter is used to run the command in the security context of Domain01\User01</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> a user who has permission to run commands</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> The ScriptBlock parameter specifies the command to be run on the remote computer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    In response</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> PowerShell requests the password and an authentication method </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> the User01 account</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> It then runs the command on the Server01 computer and returns the result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<p><code>Get-Help</code> &quot;示例&quot;页面提供并报告的前两个示例足以理解<code>Invoke-Command</code> cmdlet的简单性和强大功能。</p>
<p>第一个示例展示了如何非常轻松地将cmdlet与任何自定义脚本结合，以自动化远程计算机上的任务。</p>
<p>第二个示例证明我们不需要知道如何编写脚本即可受益于<code>Invoke-Command</code>的强大功能。 实际上，通过附加 <code>-ScriptBlock { ... }</code>参数附加到cmdlet的语法中，我们可以在远程计算机上执行任何命令（或命令序列）。 结果将与我们直接在远程计算机本地的 PowerShell 会话中键入命令相同。 结果将与我们直接在远程计算机本地的 PowerShell 会话中键入命令相同。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 在名为&quot;RoyalFortune&quot;的远程计算机上执行<code>Get-Service</code>命令的语法是什么？ 假设你无需提供凭据即可建立连接。 [为了这个问题，请避免在答案中使用引号（&quot; 或 &#x27;）] </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Invoke-Command -ComputerName RoyalFortune -ScriptBlock {Get-Service}</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务9-结论">任务9 结论<a href="#任务9-结论" class="hash-link" aria-label="任务9 结论的直接链接" title="任务9 结论的直接链接" translate="no">​</a></h2>
<p>干得好，伙计们！ 干得好，伙计们！ 您已成功驾驭了PowerShell的险恶水域，在&quot;黑珍珠号&quot;上发现了隐藏的宝藏和难以捉摸的服务。</p>
<p>有了这些工具，您已装备齐全，可以探索任何Windows系统中最受保护的角落。</p>
<p>记住，真正的海盗永远不会停止寻找宝藏——所以继续磨练您的技能，谁知道在下次冒险中您会发现什么珍珠？ 在那之前，愿你的 cmdlet 锋利，脚本迅捷。 顺风航行，狩猎愉快！</p>
<p>要继续构建您的命令行技能，请继续学习模块中的下一个房间：<a class="" href="/TryHackMe-CN/docs/Modules/Command Line/Linux Shells">Linux命令行</a>。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 我已准备好进入下一次冒险！ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/TryHackMyOffsecBox/TryHackMe-CN/tree/main/packages/create-docusaurus/templates/shared/docs/Modules/Command Line/Windows PowerShell.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/TryHackMe-CN/docs/Modules/Command Line/Windows Command Line"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Windows 命令行</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/TryHackMe-CN/docs/Modules/Command Line/Linux Shells"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Linux Shells</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#任务-1-简介" class="table-of-contents__link toc-highlight">任务 1 简介</a><ul><li><a href="#学习目标" class="table-of-contents__link toc-highlight">学习目标</a></li><li><a href="#房间先决条件" class="table-of-contents__link toc-highlight">房间先决条件</a></li></ul></li><li><a href="#任务-2-什么是-powershell" class="table-of-contents__link toc-highlight">任务 2 什么是 PowerShell</a><ul><li><a href="#powershell-简史" class="table-of-contents__link toc-highlight">PowerShell 简史</a></li><li><a href="#powershell-中的力量" class="table-of-contents__link toc-highlight">PowerShell 中的力量</a></li></ul></li><li><a href="#任务-3-powershell-基础" class="table-of-contents__link toc-highlight">任务 3 PowerShell 基础</a><ul><li><a href="#启动-powershell" class="table-of-contents__link toc-highlight">启动 PowerShell</a></li><li><a href="#基本语法动词-名词" class="table-of-contents__link toc-highlight">基本语法：动词-名词</a></li><li><a href="#基本-cmdlets" class="table-of-contents__link toc-highlight">基本 Cmdlets</a></li><li><a href="#在哪里查找和下载cmdlets" class="table-of-contents__link toc-highlight">在哪里查找和下载Cmdlets</a></li></ul></li><li><a href="#任务4-导航文件系统和处理文件" class="table-of-contents__link toc-highlight">任务4 导航文件系统和处理文件</a></li><li><a href="#任务-5-管道过滤和排序数据" class="table-of-contents__link toc-highlight">任务 5 管道、过滤和排序数据</a></li><li><a href="#任务6-系统和网络信息" class="table-of-contents__link toc-highlight">任务6 系统和网络信息</a></li><li><a href="#任务7-实时系统分析" class="table-of-contents__link toc-highlight">任务7 实时系统分析</a></li><li><a href="#任务8-脚本编写" class="table-of-contents__link toc-highlight">任务8 脚本编写</a></li><li><a href="#任务9-结论" class="table-of-contents__link toc-highlight">任务9 结论</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/TryHackMe-CN/docs">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/TryHackMyOffsecBox" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github - TryHackMyOffsecBox<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/CRONUS-Security" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github - CRONUS-Security<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 TryHackMyOffsecBox. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>