<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Modules/Container Security/Intro to Docker" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Docker入门 | TryHackMe-CN</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Container Security/Intro to Docker"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Docker入门 | TryHackMe-CN"><meta data-rh="true" name="description" content="任务1 介绍"><meta data-rh="true" property="og:description" content="任务1 介绍"><link data-rh="true" rel="icon" href="/TryHackMe-CN/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Container Security/Intro to Docker"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/docs/Modules/Container Security/Intro to Docker" hreflang="en"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Container Security/Intro to Docker" hreflang="zh"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Container Security/Intro to Docker" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"模块","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/"},{"@type":"ListItem","position":2,"name":"容器安全","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Container Security/"},{"@type":"ListItem","position":3,"name":"Docker入门","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Container Security/Intro to Docker"}]}</script><link rel="alternate" type="application/rss+xml" href="/TryHackMe-CN/blog/rss.xml" title="TryHackMe-CN RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/TryHackMe-CN/blog/atom.xml" title="TryHackMe-CN Atom Feed"><link rel="stylesheet" href="/TryHackMe-CN/assets/css/styles.6c4c8a38.css">
<script src="/TryHackMe-CN/assets/js/runtime~main.1acfc641.js" defer="defer"></script>
<script src="/TryHackMe-CN/assets/js/main.a5756b4e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/TryHackMe-CN/img/logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/TryHackMe-CN/"><div class="navbar__logo"><img src="/TryHackMe-CN/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/TryHackMe-CN/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">My Site</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/TryHackMe-CN/docs/Modules/">Tutorial</a><a class="navbar__item navbar__link" href="/TryHackMe-CN/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/TryHackMe-CN/en/docs/Modules/Container Security/Intro to Docker" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/TryHackMe-CN/docs/Modules/Container Security/Intro to Docker" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh">简体中文</a></li></ul></div><a href="https://github.com/TryHackMyOffsecBox/TryHackMe-CN" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/TryHackMe-CN/docs/Modules/"><span title="模块" class="categoryLinkLabel_W154">模块</span></a><button aria-label="折叠侧边栏分类 &#x27;模块&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/docs/Modules/Command Line/"><span title="命令行" class="categoryLinkLabel_W154">命令行</span></a><button aria-label="展开侧边栏分类 &#x27;命令行&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/TryHackMe-CN/docs/Modules/Container Security/"><span title="容器安全" class="categoryLinkLabel_W154">容器安全</span></a><button aria-label="折叠侧边栏分类 &#x27;容器安全&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Container Security/Intro to Containerisation"><span title="容器化入门" class="linkLabel_WmDU">容器化入门</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/TryHackMe-CN/docs/Modules/Container Security/Intro to Docker"><span title="Docker入门" class="linkLabel_WmDU">Docker入门</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Container Security/Intro to Kubernetes"><span title="Intro to Kubernetes" class="linkLabel_WmDU">Intro to Kubernetes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Container Security/Container Vulnerabilities"><span title="Container Vulnerabilities" class="linkLabel_WmDU">Container Vulnerabilities</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/docs/Modules/Container Security/Container Hardening"><span title="Container Hardening" class="linkLabel_WmDU">Container Hardening</span></a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/TryHackMe-CN/docs/Networks/"><span title="网络" class="categoryLinkLabel_W154">网络</span></a><button aria-label="展开侧边栏分类 &#x27;网络&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/TryHackMe-CN/docs/"><span title="index" class="linkLabel_WmDU">index</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/TryHackMe-CN/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/TryHackMe-CN/docs/Modules/"><span>模块</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/TryHackMe-CN/docs/Modules/Container Security/"><span>容器安全</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Docker入门</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Docker入门</h1></header>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务1-介绍">任务1 介绍<a href="#任务1-介绍" class="hash-link" aria-label="任务1 介绍的直接链接" title="任务1 介绍的直接链接" translate="no">​</a></h2>
<p>在本房间中，您将获得首次动手部署和与Docker容器交互的实践经验。</p>
<p>具体来说，在本房间结束时，您将熟悉以下内容：</p>
<ul>
<li class="">让您开始使用Docker的基本语法</li>
<li class="">运行和部署您的第一个容器</li>
<li class="">了解Docker容器如何使用镜像进行分发</li>
<li class="">使用Dockerfile创建您自己的镜像</li>
<li class="">Dockerfile如何用于构建容器，使用Docker Compose编排多个容器</li>
<li class="">将房间中获得的知识应用到最后的实践环节中。</li>
</ul>
<p><strong>请注意</strong>：强烈建议您至少熟悉基本的Linux语法（例如运行命令、移动文件以及熟悉文件系统结构的外观）。 如果您已完成<a href="https://tryhackme.com/module/linux-fundamentals" target="_blank" rel="noopener noreferrer" class="">Linux基础模块</a>，您将为本房间做好充分准备！</p>
<p>此外，重要的是要记住您需要互联网连接来拉取Docker镜像。  如果您是免费用户并希望在本房间中练习命令，您需要在您自己的环境中进行。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 在继续下一个任务之前完成此问题。 </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务2-基本docker语法">任务2 基本Docker语法<a href="#任务2-基本docker语法" class="hash-link" aria-label="任务2 基本Docker语法的直接链接" title="任务2 基本Docker语法的直接链接" translate="no">​</a></h2>
<p>Docker起初可能看起来令人不知所措。 然而，这些命令非常直观，通过一些练习，您很快就能成为Docker专家。</p>
<p>Docker的语法可以分为四个主要类别：</p>
<ul>
<li class="">运行容器</li>
<li class="">管理和检查容器</li>
<li class="">管理Docker镜像</li>
<li class="">Docker守护进程统计信息和信息</li>
</ul>
<p>我们将在本任务中分解这些类别中的每一个。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="管理docker镜像">管理Docker镜像<a href="#管理docker镜像" class="hash-link" aria-label="管理Docker镜像的直接链接" title="管理Docker镜像的直接链接" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="docker-pull">Docker Pull<a href="#docker-pull" class="hash-link" aria-label="Docker Pull的直接链接" title="Docker Pull的直接链接" translate="no">​</a></h4>
<p>在我们运行Docker容器之前，我们首先需要一个镜像。 回顾&quot;<a href="https://tryhackme.com/room/introtocontainerisation" target="_blank" rel="noopener noreferrer" class="">容器化入门</a>&quot;房间，镜像是容器应执行什么的指令。 运行一个什么都不做的容器是没有用的！</p>
<p>在本房间中，我们将使用Nginx镜像在容器内运行一个Web服务器。 在下载镜像之前，让我们分解下载镜像所需的命令和语法。 可以使用<code>docker pull</code>命令并提供镜像名称来下载镜像。</p>
<p>例如，<code>docker pull nginx</code>。 Docker必须知道从哪里获取此镜像（例如从我们将在后续任务中介绍的存储库）。</p>
<p>继续我们上面的示例，让我们下载这个Nginx镜像！</p>
<p><strong>请注意</strong>，此命令将无法在本房间连接的实践机器上运行，因为需要互联网访问。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">A terminal showing the downloading of the </div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cmnatic@thm:~$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> pull nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Using default tag: latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">latest: Pulling from library/nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- omitted </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> brevity --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Status: Downloaded newer image </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> nginx:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cmnatic@thm:~$</span><br></span></code></pre></div></div>
<p>通过运行此命令，我们正在下载标题为&quot;nginx&quot;的镜像的最新版本。 镜像有这些称为标签的标记。 这些标签用于引用镜像的变体。 例如，镜像可以具有相同的名称但不同的标签以指示不同的版本。 我在下面的表格中提供了一个如何使用标签的示例：</p>
<table><thead><tr><th style="text-align:center">Docker镜像</th><th style="text-align:center">标签</th><th style="text-align:center">命令示例</th><th style="text-align:center">解释</th></tr></thead><tbody><tr><td style="text-align:center">ubuntu</td><td style="text-align:center">latest</td><td style="text-align:center">docker pull ubuntu <br> <strong>- 等同于 -</strong> <br> docker pull ubuntu<!-- -->:latest</td><td style="text-align:center">此命令将拉取&quot;ubuntu&quot;镜像的最新版本。 如果未指定标签，Docker将假定您需要&quot;latest&quot;版本。<br>值得记住的是，您并不总是需要&quot;latest&quot;。 这个镜像字面上是&quot;最新的&quot;，因为它将包含最近的更改。 这可能会修复或破坏您的容器。</td></tr><tr><td style="text-align:center">ubuntu</td><td style="text-align:center">22.04</td><td style="text-align:center">docker pull ubuntu:22.04</td><td style="text-align:center">此命令将拉取&quot;ubuntu&quot;镜像的&quot;22.04 (Jammy)&quot;版本。</td></tr><tr><td style="text-align:center">ubuntu</td><td style="text-align:center">20.04</td><td style="text-align:center">docker pull ubuntu:20.04</td><td style="text-align:center">此命令将拉取&quot;ubuntu&quot;镜像的&quot;20.04 (Focal)&quot;版本。</td></tr><tr><td style="text-align:center">ubuntu</td><td style="text-align:center">18.04</td><td style="text-align:center">docker pull ubuntu:18.04</td><td style="text-align:center">此命令将拉取&quot;ubuntu&quot;镜像的&quot;18.04 (Bionic)&quot;版本。</td></tr></tbody></table>
<p>指定标签时，必须在镜像名称和标签之间包含冒号<code>:</code>，例如<code>ubuntu:22.04</code>（镜像:标签）。 不要忘记标签 - 我们将在未来的任务中再次讨论这些！</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="docker-image-xyz">Docker Image x/y/z<a href="#docker-image-xyz" class="hash-link" aria-label="Docker Image x/y/z的直接链接" title="Docker Image x/y/z的直接链接" translate="no">​</a></h3>
<p><code>docker image</code>命令与适当的选项允许我们管理本地系统上的镜像。 要列出可用选项，我们可以简单地执行<code>docker image</code>来查看我们可以做什么。 我已经在下面的终端中为您完成了此操作：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">A terminal showing the various arguments we can provide with [docker image]</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cmnatic@thm:~$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Usage:  </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> image COMMAND</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Manage images</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Commands:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  build       Build an image from a Dockerfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">history</span><span class="token plain">     Show the </span><span class="token function" style="color:#d73a49">history</span><span class="token plain"> of an image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">import</span><span class="token plain">      Import the contents from a tarball to create a filesystem image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  inspect     Display detailed information on one or </span><span class="token function" style="color:#d73a49">more</span><span class="token plain"> images</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  load        Load an image from a </span><span class="token function" style="color:#d73a49">tar</span><span class="token plain"> archive or STDIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain">          List images</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  prune       Remove unused images</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pull        Pull an image or a repository from a registry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  push        Push an image or a repository to a registry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">rm</span><span class="token plain">          Remove one or </span><span class="token function" style="color:#d73a49">more</span><span class="token plain"> images</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  save        Save one or </span><span class="token function" style="color:#d73a49">more</span><span class="token plain"> images to a </span><span class="token function" style="color:#d73a49">tar</span><span class="token plain"> archive </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">streamed to STDOUT by default</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  tag         Create a tag TARGET_IMAGE that refers to SOURCE_IMAGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Run </span><span class="token string" style="color:#e3116c">&#x27;docker image COMMAND --help&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">more</span><span class="token plain"> information on a command.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cmnatic@thm:~$</span><br></span></code></pre></div></div>
<p>在本房间中，我们仅将涵盖docker镜像的以下选项：</p>
<ul>
<li class="">pull（我们上面已经完成了！）</li>
<li class="">ls（列出镜像）</li>
<li class="">rm（删除镜像）</li>
<li class="">build（我们将在&quot;构建您的第一个容器&quot;任务中介绍）</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="docker-image-ls">Docker Image ls<a href="#docker-image-ls" class="hash-link" aria-label="Docker Image ls的直接链接" title="Docker Image ls的直接链接" translate="no">​</a></h3>
<p>此命令允许我们列出存储在本地系统上的所有镜像。 我们可以使用此命令来验证镜像是否已正确下载，并查看有关它的更多信息（例如标签、镜像创建时间和镜像大小）。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">A terminal listing the Docker images that are stored on the host operating system</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cmnatic@thm:~$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> image </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REPOSITORY   TAG       IMAGE ID       CREATED       SIZE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu       </span><span class="token number" style="color:#36acaa">22.04</span><span class="token plain">     2dc39ba059dc   </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> days ago   </span><span class="token number" style="color:#36acaa">77</span><span class="token plain">.8MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nginx        latest    2b7d6430f78d   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> weeks ago   142MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cmnatic@thm:~$</span><br></span></code></pre></div></div>
<p>例如，在上面的终端中，我们可以看到系统上两个镜像的一些信息：</p>
<table><thead><tr><th style="text-align:center">存储库</th><th style="text-align:center">标签</th><th style="text-align:center">镜像ID</th><th style="text-align:center">创建时间</th><th style="text-align:center">大小</th></tr></thead><tbody><tr><td style="text-align:center">ubuntu</td><td style="text-align:center">22.04</td><td style="text-align:center">2dc39ba059dc</td><td style="text-align:center">10 天前</td><td style="text-align:center">77.8MB</td></tr><tr><td style="text-align:center">nginx</td><td style="text-align:center">latest</td><td style="text-align:center">2b7d6430f78d</td><td style="text-align:center">2 周前</td><td style="text-align:center">142MB</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="docker-镜像-rm">Docker 镜像 rm<a href="#docker-镜像-rm" class="hash-link" aria-label="Docker 镜像 rm的直接链接" title="Docker 镜像 rm的直接链接" translate="no">​</a></h3>
<p>如果我们想从系统中删除一个镜像，我们可以使用 <code>docker image rm</code> 以及名称（或镜像 ID）。 在以下示例中，我将删除标签为 &quot;22.04&quot; 的 &quot;ubuntu&quot; 镜像。 我的命令将是 <code>docker image rm ubuntu:22.04</code>：</p>
<p>记住要包含镜像名称的标签很重要。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">A terminal displaying the untagging of an image</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cmnatic@thm:~$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> image </span><span class="token function" style="color:#d73a49">rm</span><span class="token plain"> ubuntu:22.04</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Untagged: ubuntu:22.04</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Untagged: ubuntu@sha256:20fa2d7bb4de7723f542be5923b06c4d704370f0390e4ae9e1c833c8785644c1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Deleted: sha256:2dc39ba059dcd42ade30aae30147b5692777ba9ff0779a62ad93a74de02e3e1f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Deleted: sha256:7f5cbd8cc787c8d628630756bcc7240e6c96b876c2882e6fc980a8b60cdfa274</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cmnatic@thm:~$</span><br></span></code></pre></div></div>
<p>如果我们运行 <code>docker image ls</code>，我们会看到该镜像不再列出：</p>
<div class="language-SHELL language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cmnatic@thm:~$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> image </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REPOSITORY   TAG       IMAGE ID       CREATED       SIZE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nginx        latest    2b7d6430f78d   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> weeks ago   142MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cmnatic@thm:~$</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 如果我们想 <code>pull</code> 一个 Docker 镜像，我们的命令会是什么样子？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker pull</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 如果我们想列出运行 Docker 的设备上的所有镜像，我们的命令会是什么样子？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker image ls</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 假设我们想拉取镜像 &quot;tryhackme&quot;（不带引号）；我们的命令会是什么样子？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker pull tryhackme</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 假设我们想拉取标签为 &quot;1337&quot;（不带引号）的 &quot;tryhackme&quot; 镜像。 我们的命令会是什么样子？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker pull tryhackme:1337</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务-3-运行你的第一个容器">任务 3 运行你的第一个容器<a href="#任务-3-运行你的第一个容器" class="hash-link" aria-label="任务 3 运行你的第一个容器的直接链接" title="任务 3 运行你的第一个容器的直接链接" translate="no">​</a></h2>
<p>Docker run 命令从镜像创建运行中的容器。 这是运行 Dockerfile 中的命令（以及我们在运行时的输入）的地方。 因此，这必须是你首先学习的一些语法。</p>
<p>该命令的工作方式如下：<code>docker run [OPTIONS] IMAGE_NAME [COMMAND] [ARGUMENTS...]</code> 括号中的选项对于容器运行不是必需的。</p>
<p>Docker 容器可以使用各种选项运行 - 取决于我们将如何使用容器。 本任务将解释你可能想使用的一些最常见选项。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="首先简单运行一个容器">首先，简单运行一个容器<a href="#首先简单运行一个容器" class="hash-link" aria-label="首先，简单运行一个容器的直接链接" title="首先，简单运行一个容器的直接链接" translate="no">​</a></h3>
<p>让我们回顾运行 Docker 容器所需的语法：docker run [OPTIONS] IMAGE_NAME [COMMAND] [ARGUMENTS...] 。 在此示例中，我将配置容器运行：</p>
<ul>
<li class="">一个名为 &quot;helloworld&quot; 的镜像</li>
<li class="">通过在 [OPTIONS] 命令中提供 <code>-it</code> 开关来&quot;交互式&quot;运行。 这将允许我们直接与容器交互。</li>
<li class="">我将在容器内生成一个 shell，通过提供 <code>/bin/bash</code> 作为 [COMMAND] 部分。 此参数是你放置要在容器内运行的命令（如文件、应用程序或 shell！）的地方。</li>
</ul>
<p>因此，要实现上述目标，我的命令将如下所示：<code>docker run -it helloworld /bin/bash</code></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">A terminal showing a container being launched in &#x27;interactive&#x27; mode</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cmnatic@thm-intro-to-docker:~$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run </span><span class="token parameter variable" style="color:#36acaa">-it</span><span class="token plain"> helloworld /bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@30eff5ed7492:/</span><span class="token comment" style="color:#999988;font-style:italic">#</span><br></span></code></pre></div></div>
<p>我们可以验证我们已成功启动 shell，因为我们的提示符将更改为另一个用户帐户和主机名。 容器的主机名是容器 ID（可以通过使用 <code>docker ps</code> 找到）。 例如，在上面的终端中，我们的用户名和主机名是 <code>root@30eff5ed7492</code></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="运行容器继续">运行容器...继续<a href="#运行容器继续" class="hash-link" aria-label="运行容器...继续的直接链接" title="运行容器...继续的直接链接" translate="no">​</a></h3>
<p>如前所述，Docker 容器可以使用各种选项运行。 容器的目的和 Dockerfile 中设置的指令（我们将在后面的任务中讨论）决定了我们需要使用哪些选项来运行容器。 首先，我将你可能需要运行 Docker 容器的一些最常见选项放入下表中。</p>
<table><thead><tr><th style="text-align:center">[选项]</th><th style="text-align:center">解释</th><th style="text-align:center">相关 Dockerfile 指令</th><th style="text-align:center">示例</th></tr></thead><tbody><tr><td style="text-align:center">-d</td><td style="text-align:center">此参数告诉容器以&quot;分离&quot;模式启动。 这意味着容器将在后台运行。</td><td style="text-align:center">N/A</td><td style="text-align:center"><code>docker run -d helloworld</code></td></tr><tr><td style="text-align:center">-it</td><td style="text-align:center">此参数有两个部分。 &quot;i&quot; 表示以交互方式运行，&quot;t&quot; 告诉 Docker 在容器内运行 shell。 如果我们希望在容器运行后直接与其交互，我们将使用此选项。</td><td style="text-align:center">N/A</td><td style="text-align:center"><code>docker run -it helloworld</code></td></tr><tr><td style="text-align:center">-v</td><td style="text-align:center">此参数是&quot;Volume&quot;的缩写，告诉 Docker 将主机操作系统的目录或文件挂载到容器内的位置。 这些文件存储的位置在 Dockerfile 中定义</td><td style="text-align:center">VOLUME</td><td style="text-align:center"><code>docker run -v /host/os/directory:/container/directory helloworld</code></td></tr><tr><td style="text-align:center">-p</td><td style="text-align:center">此参数告诉 Docker 将主机操作系统上的端口绑定到容器中暴露的端口。 如果你在容器中运行应用程序或服务（如 Web 服务器）并希望通过导航到 IP 地址访问该应用程序/服务，你将使用此指令。</td><td style="text-align:center">EXPOSE</td><td style="text-align:center"><code>docker run -p 80:80 webserver</code></td></tr><tr><td style="text-align:center">--rm</td><td style="text-align:center">此参数告诉 Docker 在容器完成运行其被指示执行的任何操作后删除容器。</td><td style="text-align:center">N/A</td><td style="text-align:center"><code>docker run --rm helloworld</code></td></tr><tr><td style="text-align:center">--name</td><td style="text-align:center">此参数让我们为容器起一个友好、易记的名称。 当容器在没有此选项的情况下运行时，名称是两个随机单词。 我们可以使用此选项根据容器运行的应用程序来命名容器。</td><td style="text-align:center">N/A</td><td style="text-align:center"><code>docker run --name helloworld</code></td></tr></tbody></table>
<p>这些只是我们在运行容器时可以提供的一些参数。 同样，我们需要运行的大多数参数将由容器的构建方式决定。 然而，诸如 <code>--rm</code> 和 <code>--name</code> 等参数将指示 Docker 如何运行容器。 其他参数包括（但不限于！）：</p>
<ul>
<li class="">告诉 Docker 容器应使用哪个网络适配器</li>
<li class="">容器应具有哪些功能的访问权限。 这在 TryHackMe 上的 &quot;<a href="https://tryhackme.com/room/dockerrodeo" target="_blank" rel="noopener noreferrer" class="">Docker Rodeo</a>&quot; 房间中有介绍。</li>
<li class="">将值存储到环境变量中</li>
</ul>
<p>如果您希望探索更多这些参数，我强烈建议阅读 <a href="https://docs.docker.com/engine/reference/run/" target="_blank" rel="noopener noreferrer" class="">Docker run 文档</a>。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="列出正在运行的容器">列出正在运行的容器<a href="#列出正在运行的容器" class="hash-link" aria-label="列出正在运行的容器的直接链接" title="列出正在运行的容器的直接链接" translate="no">​</a></h3>
<p>要列出正在运行的容器，我们可以使用 docker ps 命令。 此命令将列出当前正在运行的容器 - 如下所示：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">A terminal showing a list of running containers and their information</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cmnatic@thm:~/intro-to-docker$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CONTAINER ID   IMAGE                           COMMAND        CREATED        STATUS      PORTS     NAMES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">a913a8f6e30f   cmnatic/helloworld:latest   </span><span class="token string" style="color:#e3116c">&quot;sleep&quot;</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> months ago   Up </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> days   </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0:8000-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">8000</span><span class="token plain">/tcp   helloworld</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cmnatic@thm:~/intro-to-docker$</span><br></span></code></pre></div></div>
<p>此命令还将显示有关容器的信息，包括：</p>
<ul>
<li class="">容器的 ID</li>
<li class="">容器正在运行什么命令</li>
<li class="">容器何时创建</li>
<li class="">容器已运行多长时间</li>
<li class="">映射了哪些端口</li>
<li class="">容器的名称</li>
</ul>
<p><strong>提示</strong>：要列出所有容器（包括已停止的），您可以使用 <code>docker ps -a</code>：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">A terminal showing a list of ALL containers and their information</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cmnatic@thm:~/intro-to-docker$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-a</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CONTAINER ID   IMAGE                             COMMAND                  CREATED             STATUS     PORTS    NAMES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00ba1eed0826   gobuster:cmnatic                  </span><span class="token string" style="color:#e3116c">&quot;./gobuster dir -url…&quot;</span><span class="token plain">   an hour ago   Exited an hour ago practical_khayyam</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 如果我们想要以<strong>交互式</strong>方式运行容器，我们的命令会是什么样子？<br><strong>注意</strong>：假设我们在此处未指定任何镜像。 </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker run -it</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 如果我们想要以&quot;<strong>分离</strong>&quot;模式运行容器，我们的命令会是什么样子？<br><strong>注意</strong>：假设我们在此处未指定任何镜像。 </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker run -d</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 假设我们想要运行一个容器，该容器将运行<strong>并</strong>在端口 80 上绑定一个 Web 服务器。 我们的命令会是什么样子？<br><strong>注意</strong>：假设我们在此处未指定任何镜像。 </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker run -p 80:80</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 我们如何列出所有正在运行的容器？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker ps</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 现在，我们如何列出所有容器（包括已停止的）？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker ps -a</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务-4-dockerfile-简介">任务 4 Dockerfile 简介<a href="#任务-4-dockerfile-简介" class="hash-link" aria-label="任务 4 Dockerfile 简介的直接链接" title="任务 4 Dockerfile 简介的直接链接" translate="no">​</a></h2>
<p>Dockerfile 在 Docker 中扮演着至关重要的角色。 Dockerfile 是一个格式化的文本文件，本质上充当了容器应执行操作的指令手册，并最终组装成一个 Docker 镜像。</p>
<p>您使用 Dockerfile 来包含容器构建时应执行的命令。 要开始使用 Dockerfile，我们需要了解一些基本的语法和指令。 Dockerfile 的格式如下：</p>
<p><code>INSTRUCTION argument</code></p>
<p>首先，让我们介绍一些基本指令：</p>
<table><thead><tr><th style="text-align:center">指令</th><th style="text-align:center">描述</th><th style="text-align:center">示例</th></tr></thead><tbody><tr><td style="text-align:center">FROM</td><td style="text-align:center">此指令为容器设置构建阶段，并设置基础镜像（操作系统）。 所有 Dockerfile 都必须以此开头。</td><td style="text-align:center"><code>FROM ubuntu</code></td></tr><tr><td style="text-align:center">RUN</td><td style="text-align:center">此指令将在新层中执行容器内的命令。</td><td style="text-align:center"><code>RUN whoami</code></td></tr><tr><td style="text-align:center">COPY</td><td style="text-align:center">此指令将文件从本地系统复制到容器中的工作目录（语法类似于 cp 命令）。</td><td style="text-align:center"><code>COPY /home/cmnatic/myfolder/app/</code></td></tr><tr><td style="text-align:center">WORKDIR</td><td style="text-align:center">此指令设置容器的工作目录。 （类似于在 Linux 上使用 cd）。</td><td style="text-align:center"><code>WORKDIR /</code> <br>（设置为容器文件系统的根目录）</td></tr><tr><td style="text-align:center">CMD</td><td style="text-align:center">此指令确定容器启动时运行什么命令（您可以使用此指令来启动服务或应用程序）。</td><td style="text-align:center"><code>CMD /bin/sh -c script.sh</code></td></tr><tr><td style="text-align:center">EXPOSE</td><td style="text-align:center">此指令用于告诉运行容器的人在运行容器时应发布哪个端口。</td><td style="text-align:center"><code>EXPOSE 80</code> <br>（告诉运行容器的人发布到端口 80，即 docker run -p 80:80）</td></tr></tbody></table>
<p>既然我们了解了构成 Dockerfile 的核心指令，让我们来看一个 Dockerfile 的实际示例。 但首先，我将解释我希望容器做什么：</p>
<ol>
<li class="">使用 &quot;Ubuntu&quot;（版本 22.04）操作系统作为基础。</li>
<li class="">将工作目录设置为容器的根目录。</li>
<li class="">创建文本文件 &quot;helloworld.txt&quot;。</li>
</ol>
<div class="language-dockerfile codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># THIS IS A COMMENT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Use Ubuntu 22.04 as the base operating system of the container</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">FROM</span><span class="token instruction"> ubuntu:22.04</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Set the working directory to the root of the container</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">WORKDIR</span><span class="token instruction"> / </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Create helloworld.txt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">RUN</span><span class="token instruction"> touch helloworld.txt</span><br></span></code></pre></div></div>
<p>请记住，您可以通过 <code>RUN</code> 指令运行的命令将取决于您在 <code>FROM</code> 指令中使用的操作系统。 （在此示例中，我选择了 Ubuntu。 重要的是要记住，容器中使用的操作系统通常非常精简。 也就是说，不要期望一开始就有某个命令（即使是像 curl、ping 等命令也可能需要安装。）</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="构建您的第一个容器">构建您的第一个容器<a href="#构建您的第一个容器" class="hash-link" aria-label="构建您的第一个容器的直接链接" title="构建您的第一个容器的直接链接" translate="no">​</a></h3>
<p>一旦我们有了 Dockerfile，我们就可以使用 <code>docker build</code> 命令创建一个镜像。 此命令需要一些信息：</p>
<ol>
<li class="">您是否想自己命名镜像（我们将使用 <code>-t</code>（标签）参数）。</li>
<li class="">您将要给镜像起的名称。</li>
<li class="">您希望构建的 Dockerfile 的位置。</li>
</ol>
<p>我将提供场景，然后解释相关命令。 假设我们想要构建一个镜像 - 让我们填写上面列出的两个必需信息：</p>
<ol>
<li class="">我们将自己命名它，因此我们将使用 <code>-t</code> 参数。</li>
<li class="">我们想要命名该镜像。</li>
<li class="">Dockerfile 位于我们当前的工作目录（<code>.</code>）中。</li>
</ol>
<p>我们将要构建的 Dockerfile 如下：</p>
<div class="language-dockerfile codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Use Ubuntu 22.04 as the base operating system of the container</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">FROM</span><span class="token instruction"> ubuntu:22.04</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Set the working directory to the root of the container</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">WORKDIR</span><span class="token instruction"> / </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Create helloworld.txt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">RUN</span><span class="token instruction"> touch helloworld.txt</span><br></span></code></pre></div></div>
<p>命令将如下所示：<code>docker build -t helloworld .</code>（我们使用点号告诉 Docker 在我们的工作目录中查找）。 如果我们正确填写了命令，我们将看到 Docker 开始构建镜像：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">A terminal showing the building process of the </div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cmnatic@thm:~$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> build </span><span class="token parameter variable" style="color:#36acaa">-t</span><span class="token plain"> helloworld </span><span class="token builtin class-name">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sending build context to Docker daemon  </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">.778MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Step </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/3 </span><span class="token builtin class-name">:</span><span class="token plain"> FROM ubuntu:22.04</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">22.04</span><span class="token plain">: Pulling from library/ubuntu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2b55860d4c66: Pull complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Digest: sha256:20fa2d7bb4de7723f542be5923b06c4d704370f0390e4ae9e1c833c8785644c1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Status: Downloaded newer image </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> ubuntu:22.04</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ---</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> 2dc39ba059dc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Step </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">/3 </span><span class="token builtin class-name">:</span><span class="token plain"> WORKDIR /</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ---</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Running </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> 64d497097f8a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Removing intermediate container 64d497097f8a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ---</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> d6bd1253fd4e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Step </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">/3 </span><span class="token builtin class-name">:</span><span class="token plain"> RUN </span><span class="token function" style="color:#d73a49">touch</span><span class="token plain"> helloworld.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ---</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Running </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> 54e94c9774be</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Removing intermediate container 54e94c9774be</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ---</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> 4b11fc80fdd5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Successfully built 4b11fc80fdd5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Successfully tagged helloworld:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cmnatic@thm:~$</span><br></span></code></pre></div></div>
<p>太好了！ 看起来成功了。 现在让我们使用 <code>docker image ls</code> 来查看这个镜像是否已构建：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Using the </div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cmnatic@thm:~$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> image </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REPOSITORY   TAG       IMAGE ID       CREATED         SIZE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helloworld   latest    4b11fc80fdd5   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> minutes ago   </span><span class="token number" style="color:#36acaa">77</span><span class="token plain">.8MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu       </span><span class="token number" style="color:#36acaa">22.04</span><span class="token plain">     2dc39ba059dc   </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> days ago     </span><span class="token number" style="color:#36acaa">77</span><span class="token plain">.8MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cmnatic@thm:~$</span><br></span></code></pre></div></div>
<p>注意：您在 Dockerfile 的 <code>FROM</code> 指令中列出的任何基础操作系统也将被下载。 这就是为什么我们可以看到两个镜像：</p>
<ol>
<li class="">helloworld（我们的镜像）。</li>
<li class="">ubuntu（我们镜像中使用的基础操作系统）。</li>
</ol>
<p>您现在将能够在容器中使用此镜像。 请参考“运行您的第一个容器”任务以提醒您如何启动容器。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="升级我们的-dockerfile">升级我们的 Dockerfile<a href="#升级我们的-dockerfile" class="hash-link" aria-label="升级我们的 Dockerfile的直接链接" title="升级我们的 Dockerfile的直接链接" translate="no">​</a></h3>
<p>让我们升级我们的 Dockerfile。 到目前为止，我们的容器只会创建一个文件 - 这不太有用！ 在下面的 Dockerfile 中，我将：</p>
<ol>
<li class="">使用 Ubuntu 22.04 作为容器的基础操作系统。</li>
<li class="">安装“apache2” Web 服务器。</li>
<li class="">添加一些网络配置。 由于这是一个 Web 服务器，我们需要能够通过网络以某种方式连接到容器。 我将通过使用 <code>EXPOSE</code> 指令并告诉容器暴露端口 80 来实现这一点。</li>
<li class="">告诉容器在启动时启动“apache2”服务。 容器没有像 <code>systemd</code> 这样的服务管理器（这是设计使然 - 在同一容器中运行多个应用程序是不良实践。 例如，这个容器用于 apache2 Web 服务器 - 并且仅用于 apache2 Web 服务器）。</li>
</ol>
<div class="language-dockerfile codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># THIS IS A COMMENT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">FROM</span><span class="token instruction"> ubuntu:22.04</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Update the APT repository to ensure we get the latest version of apache2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">RUN</span><span class="token instruction"> apt-get update -y </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Install apache2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">RUN</span><span class="token instruction"> apt-get install apache2 -y</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Tell the container to expose port 80 to allow us to connect to the web server</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">EXPOSE</span><span class="token instruction"> 80 </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Tell the container to run the apache2 service</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">CMD</span><span class="token instruction"> [</span><span class="token instruction string" style="color:#e3116c">&quot;apache2ctl&quot;</span><span class="token instruction">, </span><span class="token instruction string" style="color:#e3116c">&quot;-D&quot;</span><span class="token instruction">,</span><span class="token instruction string" style="color:#e3116c">&quot;FOREGROUND&quot;</span><span class="token instruction">]</span><br></span></code></pre></div></div>
<p>作为参考，构建此镜像的命令将是 <code>docker build -t webserver .</code>（假设 Dockerfile 位于您运行命令的同一目录中）。 一旦使用适当的选项启动容器（<code>docker run -d --name webserver -p 80:80 webserver</code>），我们可以在浏览器中导航到我们本地机器的 IP 地址！</p>
<p><img decoding="async" loading="lazy" alt="apache2 的默认登录页面，可用于确认服务正在运行" src="/TryHackMe-CN/assets/images/image_20251144-144442-dd886dcf7e22bf75eecb126a98f29528.png" width="717" height="814" class="img_ev3q"></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="优化我们的-dockerfile">优化我们的 Dockerfile<a href="#优化我们的-dockerfile" class="hash-link" aria-label="优化我们的 Dockerfile的直接链接" title="优化我们的 Dockerfile的直接链接" translate="no">​</a></h3>
<p>Docker 确实是一门艺术 - 而且它不止于 Dockerfiles！ 首先，我们需要问自己为什么优化我们的 Dockerfile 至关重要？ 臃肿的 Dockerfiles 难以阅读和维护，并且通常使用大量不必要的存储！ 例如，您可以减小 docker 镜像的大小（并减少构建时间！） 使用几种方式：</p>
<ol>
<li class="">仅安装必要的软件包。 容器的一个优点是它们从一开始就几乎是空的 - 我们完全自由地决定我们想要什么。</li>
<li class="">删除缓存文件（例如 APT 缓存或与工具一起安装的文档）。 容器内的代码只会执行一次（在构建时！），因此我们不需要存储任何东西供以后使用。</li>
<li class="">在我们的 <code>FROM</code> 指令中使用最小的基础操作系统。 尽管像 Ubuntu 这样的容器操作系统已经相当精简，但考虑使用更精简的版本（即 <code>ubuntu:22.04-minimal</code>）。 或者，例如，使用 Alpine（可以小到 5.59MB！）。</li>
<li class="">最小化层数 - 我将在下面进一步解释这一点。</li>
</ol>
<p>每个指令（即 <code>FROM</code>、<code>RUN</code> 等） 都在其自己的层中运行。 层会增加构建时间！ 目标是尽可能减少层数。 例如，尝试将 <code>RUN</code> 的命令链接在一起，如下所示：</p>
<p><strong>之前：</strong></p>
<div class="language-dockerfile codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token instruction keyword" style="color:#00009f">FROM</span><span class="token instruction"> ubuntu:latest</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">RUN</span><span class="token instruction"> apt-get update -y</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">RUN</span><span class="token instruction"> apt-get upgrade -y</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">RUN</span><span class="token instruction"> apt-get install apache2 -y</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">RUN</span><span class="token instruction"> apt-get install net-tools -y</span><br></span></code></pre></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">A terminal showing five layers of a Dockerfile being built</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cmnatic@thm:~$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> build </span><span class="token parameter variable" style="color:#36acaa">-t</span><span class="token plain"> before </span><span class="token builtin class-name">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token parameter variable" style="color:#36acaa">--omitted</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> brevity--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Step </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">/5 </span><span class="token builtin class-name">:</span><span class="token plain"> RUN </span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> update </span><span class="token parameter variable" style="color:#36acaa">-y</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ---</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Using cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ---</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> 446962612d20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Step </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">/5 </span><span class="token builtin class-name">:</span><span class="token plain"> RUN </span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> upgrade </span><span class="token parameter variable" style="color:#36acaa">-y</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ---</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Running </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> 8bed81c695f4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token parameter variable" style="color:#36acaa">--omitted</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> brevity--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cmnatic@thm:~$</span><br></span></code></pre></div></div>
<p><strong>之后：</strong></p>
<div class="language-dockerfile codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token instruction keyword" style="color:#00009f">FROM</span><span class="token instruction"> ubuntu:latest</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token instruction keyword" style="color:#00009f">RUN</span><span class="token instruction"> apt-get update -y &amp;&amp; apt-get upgrade -y &amp;&amp; apt-get install apache2 -y &amp;&amp; apt-get install net-tools</span><br></span></code></pre></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">A terminal showing two layers of a Dockerfile being built</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cmnatic@thm:~$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> build </span><span class="token parameter variable" style="color:#36acaa">-t</span><span class="token plain"> after </span><span class="token builtin class-name">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sending build context to Docker daemon   </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">.78MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Step </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/2 </span><span class="token builtin class-name">:</span><span class="token plain"> FROM ubuntu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ---</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> 2dc39ba059dc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Step </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">/2 </span><span class="token builtin class-name">:</span><span class="token plain"> RUN </span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> update </span><span class="token parameter variable" style="color:#36acaa">-y</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> upgrade </span><span class="token parameter variable" style="color:#36acaa">-y</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> apache2 </span><span class="token parameter variable" style="color:#36acaa">-y</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> net-tools</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ---</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Running </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> a4d4943bcf04</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token parameter variable" style="color:#36acaa">--omitted</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> brevity--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cmnatic@thm:~$</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="一个插图显示命令已被压缩为两个层。" src="/TryHackMe-CN/assets/images/image_20251147-144702-ff56c1542ea0843f462bcc3d78fb3295.png" width="800" height="114" class="img_ev3q"></p>
<p>请注意，现在只有两个构建步骤（这将是两个层，使构建更快）。 这只是 Dockerfile 的一个小例子，因此构建时间不会如此剧烈，但在更大的 Dockerfiles 中 - 减少层数将在构建期间带来显著的性能提升。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 我们将使用什么指令来指定容器应使用的基础镜像？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FROM</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 我们将使用什么指令来告诉容器运行命令？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">RUN</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 我们将使用什么 docker 命令来使用 Dockerfile 构建镜像？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">build</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 假设我们想命名这个镜像；我们将使用什么参数？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-t</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务-5-docker-compose-简介">任务 5 Docker Compose 简介<a href="#任务-5-docker-compose-简介" class="hash-link" aria-label="任务 5 Docker Compose 简介的直接链接" title="任务 5 Docker Compose 简介的直接链接" translate="no">​</a></h2>
<p>让我们首先了解 Docker Compose 是什么以及为什么值得理解。 到目前为止，我们只单独与容器交互。 总之，Docker Compose 允许多个容器（或应用程序）在需要时相互交互，同时彼此隔离运行。</p>
<p>您可能已经注意到 Docker 到目前为止的一个问题。 通常，应用程序需要额外的服务才能运行，而我们无法在单个容器中做到这一点。 例如，现代 - 动态 - 网站使用诸如数据库和 Web 服务器之类的服务。 为了本任务的目的，我们将每个应用程序视为一个“微服务”。</p>
<p>虽然我们可以单独启动多个容器或“微服务”并连接它们，但逐个操作既繁琐又低效。 Docker Compose 允许我们将这些“微服务”创建为一个单一的“服务”。</p>
<p>此插图展示了不同之处在部署容器时 - 通过 Docker Compose 与 Docker：</p>
<p><img decoding="async" loading="lazy" alt="一个蓝色框（代表一台计算机）带有 docker 的标题，与另一组蓝色框（代表一台计算机）隔离。" src="/TryHackMe-CN/assets/images/image_20251151-145132-4b180d1a717073985691f21e3ff97617.png" width="682" height="490" class="img_ev3q"></p>
<p>在我们演示 Docker Compose 之前，让我们先介绍使用 Docker Compose 的基础知识。</p>
<ol>
<li class="">我们需要安装 Docker Compose（它默认不随 Docker 提供）。 安装它超出了本房间的范围，因为它根据您的操作系统和其他因素而变化。 您可以在此处查看安装文档。</li>
<li class="">我们需要一个有效的 docker-compose.yml 文件 - 我们稍后会谈到这一点。</li>
<li class="">对使用 Docker Compose 构建和管理容器的基础理解。</li>
</ol>
<p>我已将一些基本的 Docker Compose 命令放入下表中：</p>
<table><thead><tr><th style="text-align:center">命令</th><th style="text-align:center">解释</th><th style="text-align:center">示例</th></tr></thead><tbody><tr><td style="text-align:center">up</td><td style="text-align:center">此命令将（重新）创建/构建并启动 compose 文件中指定的容器。</td><td style="text-align:center"><code>docker-compose up</code></td></tr><tr><td style="text-align:center">start</td><td style="text-align:center">此命令将启动（但要求容器已构建）compose 文件中指定的容器。</td><td style="text-align:center"><code>docker-compose start</code></td></tr><tr><td style="text-align:center">down</td><td style="text-align:center">此命令将停止并 <code>删除</code> compose 文件中指定的容器。</td><td style="text-align:center"><code>docker-compose down</code></td></tr><tr><td style="text-align:center">stop</td><td style="text-align:center">此命令将停止（<code>不</code>删除）compose 文件中指定的容器。</td><td style="text-align:center"><code>docker-compose stop</code></td></tr><tr><td style="text-align:center">build</td><td style="text-align:center">此命令将构建（但不会启动）compose 文件中指定的容器。</td><td style="text-align:center"><code>docker-compose build</code></td></tr></tbody></table>
<p><strong>注意</strong>：这些只是部分可能的命令。 查看 <a href="https://docs.docker.com/compose/reference/" target="_blank" rel="noopener noreferrer" class="">compose 文档</a> 了解所有可能的选项。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="docker-compose-展示">Docker Compose 展示<a href="#docker-compose-展示" class="hash-link" aria-label="Docker Compose 展示的直接链接" title="Docker Compose 展示的直接链接" translate="no">​</a></h3>
<p>既然如此，让我们看看如何自己使用 Docker Compose。 在此场景中，我假设以下要求：</p>
<ol>
<li class="">在 Apache 上运行的电子商务网站</li>
<li class="">此电子商务网站将客户信息存储在 MySQL 数据库中</li>
</ol>
<p>现在，我们可以通过以下方式手动运行这两个容器：</p>
<ol>
<li class="">创建两个容器之间的网络：<code>docker network create ecommerce</code></li>
<li class="">运行 Apache2 Web 服务器容器：<code>docker run -p 80:80 --name webserver --net ecommerce webserver</code></li>
<li class="">运行 MySQL 数据库服务器：<code>docker run --name database --net ecommerce webserver</code></li>
</ol>
<p><img decoding="async" loading="lazy" alt="显示使用 docker compose 启动的两个容器的图示。 请注意它们无法相互通信" src="/TryHackMe-CN/assets/images/image_20251154-145446-770fc33ae617aad6ff456959c693ea78.png" width="494" height="628" class="img_ev3q"></p>
<p>图示显示两个容器彼此独立运行，无法相互通信。</p>
<p>……但我们想每次都这样做吗？ 或者如果我们决定扩展并涉及多个 Web 服务器呢？ 我们想为每个容器每次都这样做吗？ 我当然不想。</p>
<p>相反，我们可以通过 <code>docker-compose up</code> 使用 Docker Compose 一起运行这些容器，这为我们提供了以下优势：</p>
<ol>
<li class="">一个简单的命令即可运行两者</li>
<li class="">这两个容器已联网在一起，因此我们无需配置网络。</li>
<li class="">极其便携。 我们可以将 docker-compose.yml 文件与他人共享，他们可以在不了解各个容器工作原理的情况下获得完全相同的设置。</li>
<li class="">易于维护和更改。 我们不必担心特定容器使用（可能过时的）镜像。</li>
</ol>
<p><img decoding="async" loading="lazy" alt="img" src="/TryHackMe-CN/assets/images/image_20251156-145632-0f1491c80a0d310f0f25172f2af8bbf3.png" width="462" height="550" class="img_ev3q"></p>
<p>显示两个容器作为组合服务部署的图示。 这两个容器可以相互通信。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="docker-composeyml-文件-101">Docker-compose.yml 文件 101<a href="#docker-composeyml-文件-101" class="hash-link" aria-label="Docker-compose.yml 文件 101的直接链接" title="Docker-compose.yml 文件 101的直接链接" translate="no">​</a></h3>
<p>一个文件统治所有。 docker-compose.yml 文件的格式与 Dockerfile 不同。 重要的是要注意 YAML 需要缩进（良好的做法是使用两个空格且必须保持一致！）。 首先，在我们创建 docker-compose.yml 文件之前，我将展示一些您需要学习的新指令，以便能够编写 docker-compose.yml 文件：</p>
<table><thead><tr><th style="text-align:center">Instruction</th><th style="text-align:center">Explanation</th><th style="text-align:center">Example</th></tr></thead><tbody><tr><td style="text-align:center">version</td><td style="text-align:center">这位于文件顶部，用于标识 docker-compose.yml 是为哪个版本的 Compose 编写的。</td><td style="text-align:center"><code>&#x27;3.3&#x27;</code></td></tr><tr><td style="text-align:center">services</td><td style="text-align:center">此指令标记要管理的容器的开始。</td><td style="text-align:center"><code>services:</code></td></tr><tr><td style="text-align:center">name (replace value)</td><td style="text-align:center">此指令是您定义容器及其配置的地方。 &quot;name&quot; 需要替换为您要定义的实际容器名称，例如 &quot;webserver&quot; 或 &quot;database&quot;。</td><td style="text-align:center"><code>webserver</code></td></tr><tr><td style="text-align:center">build</td><td style="text-align:center">此指令定义包含此容器/服务的 Dockerfile 的目录。 （您需要使用此指令或 image 指令）。</td><td style="text-align:center"><code>./webserver</code></td></tr><tr><td style="text-align:center">ports</td><td style="text-align:center">此指令将端口发布到暴露的端口（这取决于镜像/Dockerfile）。</td><td style="text-align:center"><code>&#x27;80:80&#x27;</code></td></tr><tr><td style="text-align:center">volumes</td><td style="text-align:center">此指令列出应从主机操作系统挂载到容器中的目录。</td><td style="text-align:center"><code>&#x27;./home/cmnatic/webserver/:/var/www/html&#x27;</code></td></tr><tr><td style="text-align:center">environment</td><td style="text-align:center">此指令用于传递环境变量（不安全），例如密码、用户名、时区配置等。</td><td style="text-align:center"><code>MYSQL_ROOT_PASSWORD=helloworld</code></td></tr><tr><td style="text-align:center">image</td><td style="text-align:center">此指令定义容器应使用哪个镜像构建（您需要使用此指令或 build 指令）。</td><td style="text-align:center"><code>mysql:latest</code></td></tr><tr><td style="text-align:center">networks</td><td style="text-align:center">此指令定义容器将成为哪些网络的一部分。 容器可以是多个网络的一部分（例如，一个 Web 服务器只能联系一个数据库，但数据库可以联系多个 Web 服务器）。</td><td style="text-align:center"><code>ecommerce</code></td></tr></tbody></table>
<p><strong>注意</strong>：这些只是部分可能的指令。 查看 <a href="https://docs.docker.com/compose/compose-file/" target="_blank" rel="noopener noreferrer" class="">compose 文件</a> 文档了解所有可能的指令。</p>
<p>既然如此，让我们看看我们的第一个 docker-compose.yml 文件。 此 docker-compose.yml 文件假设以下内容：</p>
<ol>
<li class="">我们将从前面提到的场景中运行一个Web服务器（名为web）。</li>
<li class="">我们将从前面提到的场景中运行一个数据库服务器（名为database）。</li>
<li class="">Web服务器将使用其Dockerfile构建，但我们将为数据库服务器（MySQL）使用一个已构建的镜像。</li>
<li class="">容器将被联网以相互通信（网络名为ecommerce）。</li>
<li class="">我们的目录列表如下所示：</li>
<li class="">docker-compose.yml</li>
<li class="">web/Dockerfile</li>
</ol>
<p>这是我们的docker-compose.yml文件的样子（提醒一下，注意缩进至关重要）：</p>
<div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;3.3&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">services</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">web</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">build</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ./web</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">networks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ecommerce</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;80:80&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">database</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> mysql</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">networks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ecommerce</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">environment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> MYSQL_DATABASE=ecommerce</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> MYSQL_USERNAME=root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> MYSQL_ROOT_PASSWORD=helloword</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">networks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ecommerce</span><span class="token punctuation" style="color:#393A34">:</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 我想使用<code>docker-compose</code>来启动一系列容器。 什么参数允许我这样做？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">up</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 我想使用<code>docker-compose</code>来删除这一系列容器。 什么参数允许我这样做？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">down</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> <code>docker-compose</code>使用的.yml文件的名称是什么？ <br><strong>注意</strong>：对于这个问题，你需要在答案中包含.yml文件扩展名</summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose.yml</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务6-docker套接字简介">任务6 Docker套接字简介<a href="#任务6-docker套接字简介" class="hash-link" aria-label="任务6 Docker套接字简介的直接链接" title="任务6 Docker套接字简介的直接链接" translate="no">​</a></h2>
<p>本任务将解释Docker如何在操作系统和容器之间进行交互。 当你安装Docker时，会安装两个程序：</p>
<ol>
<li class="">Docker客户端</li>
<li class="">Docker服务器</li>
</ol>
<p>Docker采用客户端/服务器模型工作。 具体来说，这两个程序相互通信，构成了我们所熟知和喜爱的Docker。 Docker使用一种称为套接字的东西来实现这种通信。 套接字是操作系统的一个基本特性，允许数据通信。</p>
<p>例如，在使用聊天程序时，可能有两个套接字：</p>
<ol>
<li class="">一个用于存储你正在发送的消息的套接字</li>
<li class="">一个用于存储某人正在发送给你的消息的套接字。</li>
</ol>
<p>程序将与这两个套接字交互，以存储或检索其中的数据！ 套接字可以是网络连接，也可以是表示为文件的形式。 关于套接字，重要的是要知道它们允许进程间通信（IPC）。 这仅仅意味着操作系统上的进程可以相互通信！</p>
<p>在Docker的上下文中，Docker服务器实际上只是一个API。 Docker服务器使用此API来<strong>监听</strong>请求，而Docker客户端使用该API来<strong>发送</strong>请求。</p>
<p>例如，我们来看这个命令：<strong>docker run helloworld</strong>。 Docker客户端将请求Docker服务器使用镜像&quot;helloworld&quot;运行一个容器。 现在，虽然这个解释相当基础，但它是Docker工作原理的基本前提。</p>
<p>让我们看下面的图表来展示这个过程：</p>
<p><img decoding="async" loading="lazy" alt="说明使用操作系统上的docker.sock文件进行Docker交互的流程" src="/TryHackMe-CN/assets/images/image_20251105-150556-3b1e44318190a28e190a9ccfbe411e99.png" width="453" height="742" class="img_ev3q"></p>
<p>有趣的是，正因为如此，我们可以使用像curl或Postman这样的API开发工具与Docker服务器交互。 但是，使用这些超出了本房间的范围。</p>
<p>最后，重要的是要注意，正因为如此，运行Docker的主机可以被配置为处理从另一台设备发送的命令。 如果配置不当，这是一个极其危险的漏洞，因为这意味着有人可以远程停止、启动和访问Docker容器。 尽管如此，在某些用例中，Docker的这个特性非常有用！ 我们将在后续房间中更详细地介绍这一点！</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 术语&quot;IPC&quot;代表什么？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Interprocess Communication</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Docker服务器可以等同于什么技术？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">API</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="任务7-实践">任务7 实践<a href="#任务7-实践" class="hash-link" aria-label="任务7 实践的直接链接" title="任务7 实践的直接链接" translate="no">​</a></h2>
<p>通过按下绿色的&quot;<code>Start Machine</code>&quot;按钮来部署附加到此任务的虚拟机。 完全加载后，虚拟机将以分屏视图出现在你的网页浏览器中。 如果你没有看到虚拟机，请点击此页面顶部附近右上角的蓝色&quot;<code>Show Split View</code>&quot;按钮。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>回答以下问题</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 连接到机器。 当前正在运行的容器的名称是什么？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cloudisland</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 使用Docker启动一个带有&quot;webserver&quot;镜像的Web服务器（不带引号）。 你需要<code>使用端口80运行容器</code>。<br>启动容器后，尝试在你的浏览器中连接到<a href="https://LAB_WEB_URL.p.thmlabs.com/" target="_blank" rel="noopener noreferrer" class="">https://LAB_WEB_URL.p.thmlabs.com/</a>。 标志是什么？ </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">THM{WEBSERVER_CONTAINER}</span><br></span></code></pre></div></div></div></div></details></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Modules/Container Security/Intro to Docker.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/TryHackMe-CN/docs/Modules/Container Security/Intro to Containerisation"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">容器化入门</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/TryHackMe-CN/docs/Modules/Container Security/Intro to Kubernetes"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Intro to Kubernetes</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#任务1-介绍" class="table-of-contents__link toc-highlight">任务1 介绍</a></li><li><a href="#任务2-基本docker语法" class="table-of-contents__link toc-highlight">任务2 基本Docker语法</a><ul><li><a href="#管理docker镜像" class="table-of-contents__link toc-highlight">管理Docker镜像</a></li><li><a href="#docker-image-xyz" class="table-of-contents__link toc-highlight">Docker Image x/y/z</a></li><li><a href="#docker-image-ls" class="table-of-contents__link toc-highlight">Docker Image ls</a></li><li><a href="#docker-镜像-rm" class="table-of-contents__link toc-highlight">Docker 镜像 rm</a></li></ul></li><li><a href="#任务-3-运行你的第一个容器" class="table-of-contents__link toc-highlight">任务 3 运行你的第一个容器</a><ul><li><a href="#首先简单运行一个容器" class="table-of-contents__link toc-highlight">首先，简单运行一个容器</a></li><li><a href="#运行容器继续" class="table-of-contents__link toc-highlight">运行容器...继续</a></li><li><a href="#列出正在运行的容器" class="table-of-contents__link toc-highlight">列出正在运行的容器</a></li></ul></li><li><a href="#任务-4-dockerfile-简介" class="table-of-contents__link toc-highlight">任务 4 Dockerfile 简介</a><ul><li><a href="#构建您的第一个容器" class="table-of-contents__link toc-highlight">构建您的第一个容器</a></li><li><a href="#升级我们的-dockerfile" class="table-of-contents__link toc-highlight">升级我们的 Dockerfile</a></li><li><a href="#优化我们的-dockerfile" class="table-of-contents__link toc-highlight">优化我们的 Dockerfile</a></li></ul></li><li><a href="#任务-5-docker-compose-简介" class="table-of-contents__link toc-highlight">任务 5 Docker Compose 简介</a><ul><li><a href="#docker-compose-展示" class="table-of-contents__link toc-highlight">Docker Compose 展示</a></li><li><a href="#docker-composeyml-文件-101" class="table-of-contents__link toc-highlight">Docker-compose.yml 文件 101</a></li></ul></li><li><a href="#任务6-docker套接字简介" class="table-of-contents__link toc-highlight">任务6 Docker套接字简介</a></li><li><a href="#任务7-实践" class="table-of-contents__link toc-highlight">任务7 实践</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/TryHackMe-CN/docs">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/TryHackMe-CN/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>