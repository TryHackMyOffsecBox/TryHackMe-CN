"use strict";(self.webpackChunktryhackme_cn=self.webpackChunktryhackme_cn||[]).push([[8452],{2259:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image_20251242-204239-c8d815645075f11212bd6abd4a0ffb55.png"},4386:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image_20251244-204438-f2432b45a752ba846120ec37ef7a81f5.png"},6024:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"Modules/Memory Analysis/windowsmemoryandprocs","title":"Windows Memory & Processes","description":"Task 1 Introduction","source":"@site/docs/Modules/Memory Analysis/windowsmemoryandprocs.md","sourceDirName":"Modules/Memory Analysis","slug":"/Modules/Memory Analysis/windowsmemoryandprocs","permalink":"/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryandprocs","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/TryHackMe-CN/tree/main/packages/create-docusaurus/templates/shared/docs/Modules/Memory Analysis/windowsmemoryandprocs.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Volatility Essentials","permalink":"/TryHackMe-CN/docs/Modules/Memory Analysis/volatilityessentials"},"next":{"title":"Windows Memory & User Activity","permalink":"/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryanduseractivity"}}');var i=s(4848),l=s(8453);const r={sidebar_position:3},o="Windows Memory & Processes",a={},d=[{value:"Task 1 Introduction",id:"task-1-introduction",level:2},{value:"Learning Objectives",id:"learning-objectives",level:3},{value:"Room Prerequisites",id:"room-prerequisites",level:3},{value:"Task 2 Scenario Information",id:"task-2-scenario-information",level:2},{value:"Scenario",id:"scenario",level:3},{value:"Information Incident THM-0001",id:"information-incident-thm-0001",level:3},{value:"Company Information TryHatMe",id:"company-information-tryhatme",level:3},{value:"Network Map",id:"network-map",level:4},{value:"Task 3 Windows Process Architecture",id:"task-3-windows-process-architecture",level:2},{value:"Windows Processes and Threads",id:"windows-processes-and-threads",level:3},{value:"How Do These Structures Relate?",id:"how-do-these-structures-relate",level:4},{value:"What Information Can You Extract From These Structures?",id:"what-information-can-you-extract-from-these-structures",level:3},{value:"EPROCESS",id:"eprocess",level:4},{value:"ETHREAD",id:"ethread",level:4},{value:"PEB",id:"peb",level:4},{value:"TEB",id:"teb",level:4},{value:"Task 4 Initial Triage of a New Memory Dump",id:"task-4-initial-triage-of-a-new-memory-dump",level:2},{value:"Environment and Setup",id:"environment-and-setup",level:3},{value:"Verifying the Memory Dump",id:"verifying-the-memory-dump",level:3},{value:"Extract Processes",id:"extract-processes",level:3},{value:"Finding a Needle in a Haystack",id:"finding-a-needle-in-a-haystack",level:3},{value:"Suspicious Name",id:"suspicious-name",level:4},{value:"Suspicious Path",id:"suspicious-path",level:4},{value:"Masquerading",id:"masquerading",level:4},{value:"Comparing With a Baseline",id:"comparing-with-a-baseline",level:3},{value:"Analysis Notes and Next Steps",id:"analysis-notes-and-next-steps",level:3},{value:"Task 5 Linking Processes",id:"task-5-linking-processes",level:2},{value:"Observations",id:"observations",level:3},{value:"Analysis Notes and Next Steps",id:"analysis-notes-and-next-steps-1",level:3},{value:"Task 6 Digging Deeper",id:"task-6-digging-deeper",level:2},{value:"PSSCAN",id:"psscan",level:3},{value:"PSXVIEW",id:"psxview",level:3},{value:"Analysis Notes and Next Steps",id:"analysis-notes-and-next-steps-2",level:3},{value:"Task 7 Dumping the Process Memory",id:"task-7-dumping-the-process-memory",level:2},{value:"Finding the Path",id:"finding-the-path",level:3},{value:"Dump Process Memory",id:"dump-process-memory",level:3},{value:"What to Look For",id:"what-to-look-for",level:3},{value:"Analysis Notes and Next Steps",id:"analysis-notes-and-next-steps-3",level:3},{value:"Task 8 Putting It All Together",id:"task-8-putting-it-all-together",level:2},{value:"Initial Access",id:"initial-access",level:3},{value:"Execution",id:"execution",level:3},{value:"Persistence",id:"persistence",level:3},{value:"Command and Control",id:"command-and-control",level:3},{value:"Attack Phases Not Accounted For",id:"attack-phases-not-accounted-for",level:3},{value:"What&#39;s Next",id:"whats-next",level:3},{value:"Task 9 Conclusion",id:"task-9-conclusion",level:2}];function c(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components},{Details:n}=t;return n||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"windows-memory--processes",children:"Windows Memory & Processes"})}),"\n",(0,i.jsx)(t.h2,{id:"task-1-introduction",children:"Task 1 Introduction"}),"\n",(0,i.jsx)(t.p,{children:"Knowing how to analyze memory is an essential skill for a forensic analyst. Attackers often run their malware completely in memory without leaving any traces on the storage. Analyzing memory is slightly more complex than storage and requires a structured approach. Luckily, tools like Volatility and Redline can help extract information from memory. These tools don't automate the whole process of memory analysis. It is still up to the forensic analyst to extract the correct information and link it together."}),"\n",(0,i.jsx)(t.p,{children:"This room is the first in a set of three. It will guide you through analyzing a full memory dump of a Windows host and extracting information from its processes. If the host is indeed compromised, you will need to piece together the scope of the attack and the attack chain."}),"\n",(0,i.jsx)(t.h3,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Extract processes and process information from a memory dump using Volatility"}),"\n",(0,i.jsx)(t.li,{children:"Analyze the extracted information"}),"\n",(0,i.jsx)(t.li,{children:"Report findings"}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"room-prerequisites",children:"Room Prerequisites"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://tryhackme.com/room/volatility",children:"Volatility"})}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"https://tryhackme.com/module/windows-fundamentals",children:"Windows Fundamentals"})," module"]}),"\n"]}),"\n",(0,i.jsx)(t.admonition,{title:"Answer the questions below",type:"info",children:(0,i.jsxs)(n,{children:[(0,i.jsx)("summary",{children:" Ready to start analyzing your first memory dump? "}),(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-plaintext",children:"No answer needed\n"})})]})}),"\n",(0,i.jsx)(t.h2,{id:"task-2-scenario-information",children:"Task 2 Scenario Information"}),"\n",(0,i.jsx)(t.h3,{id:"scenario",children:"Scenario"}),"\n",(0,i.jsx)(t.p,{children:"You are part of the incident response team handling an incident at TryHatMe - a company that exclusively sells hats online. You are tasked with analyzing a full memory dump of a potentially compromised Windows host. Before you, another analyst had already taken a full memory dump and gathered all the necessary information from the TryHatMe IT support team. You are a bit nervous since this is your first case, but don't worry; a senior analyst will guide you."}),"\n",(0,i.jsx)(t.h3,{id:"information-incident-thm-0001",children:"Information Incident THM-0001"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["On May 5th, 2025, at 07:30 CET, TryHatMe initiated its incident response plan and escalated the incident to us. After an initial triage, our team found a Windows host that was potentially compromised. The details of the host are as follows:","\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Hostname: WIN-001"}),"\n",(0,i.jsx)(t.li,{children:"OS: Windows 1022H 10.0.19045"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["At 07:45 CET, our analyst Steve Stevenson took a full memory dump of the Windows host and made a hash to ensure its integrity. The memory dump details are:","\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Name: ",(0,i.jsx)(t.code,{children:"THM-WIN-001_071528_07052025.dmp"})]}),"\n",(0,i.jsxs)(t.li,{children:["MD5-hash: ",(0,i.jsx)(t.code,{children:"78535fc49ab54fed57919255709ae650"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"company-information-tryhatme",children:"Company Information TryHatMe"}),"\n",(0,i.jsx)(t.h4,{id:"network-map",children:"Network Map"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Network Map of the TryHatMe Company",src:s(2259).A+"",width:"5084",height:"3320"})}),"\n",(0,i.jsx)(t.admonition,{title:"Answer the questions below",type:"info",children:(0,i.jsxs)(n,{children:[(0,i.jsx)("summary",{children:" I went through the case details and am ready to find out more. "}),(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-plaintext",children:"No answer needed\n"})})]})}),"\n",(0,i.jsx)(t.h2,{id:"task-3-windows-process-architecture",children:"Task 3 Windows Process Architecture"}),"\n",(0,i.jsxs)(t.p,{children:["You might wonder where to start analyzing the memory dump. Let's start with a high-level overview of the key structures of processes on a Windows host. These structures are essential to understand where tools like ",(0,i.jsx)(t.code,{children:"volatility"})," extract their information."]}),"\n",(0,i.jsx)(t.h3,{id:"windows-processes-and-threads",children:"Windows Processes and Threads"}),"\n",(0,i.jsx)(t.p,{children:"There are four structures that Windows uses to create and manage processes:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"EPROCESS"})," is the representation of a process in the ",(0,i.jsx)(t.strong,{children:"kernel"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"ETHREAD"})," is the representation of a thread in the ",(0,i.jsx)(t.strong,{children:"kernel"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Process Environment Block (PEB)"})," holds the process-wide configuration and runtime data and is located in the ",(0,i.jsx)(t.strong,{children:"user space"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Thread Environment Block (TEB)"})," holds the thread-specific configuration and other information, including Thread Local Storage (TLS), exception handling data, and information about the stack, and is located in the ",(0,i.jsx)(t.strong,{children:"user space"})]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Windows Process Architecture",src:s(4386).A+"",width:"1261",height:"289"})}),"\n",(0,i.jsx)(t.h4,{id:"how-do-these-structures-relate",children:"How Do These Structures Relate?"}),"\n",(0,i.jsxs)(t.p,{children:["When Windows creates a process, it executes the function ",(0,i.jsx)(t.code,{children:"CreateProcess()"}),". This function initiates the process start-up and consists of the following steps:"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Flowchart of Windows Process Creation",src:s(6499).A+"",width:"305",height:"959"})}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["The kernel creates an EPROCESS and ETHREAD object and links them together. EPROCESS has a field called ",(0,i.jsx)(t.code,{children:"ThreadListHead"})," that keeps track of all its threads"]}),"\n",(0,i.jsxs)(t.li,{children:["The virtual memory is initialized:","\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"The process is assigned a virtual address space (in user mode)\nThe image (EXE) is mapped into memory\nSpace is allocated for the PEB and TEB\nProcess parameters are created"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["The PEB and TEB are initialized.","\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"EPROCESS includes a pointer to the PEB"}),"\n",(0,i.jsx)(t.li,{children:"ETHREAD includes a pointer to the TEB"}),"\n",(0,i.jsx)(t.li,{children:"TEB includes a redundant pointer to the PEB"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["The thread context is set but remains suspended. This thread context includes:","\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Start address of the program"}),"\n",(0,i.jsx)(t.li,{children:"Stack pointer"}),"\n",(0,i.jsx)(t.li,{children:"Instruction pointer"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.li,{children:"The process is created but is still suspended"}),"\n",(0,i.jsx)(t.li,{children:"The primary thread of the process is resumed. This is the actual start of the process"}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"what-information-can-you-extract-from-these-structures",children:"What Information Can You Extract From These Structures?"}),"\n",(0,i.jsxs)(t.p,{children:["Tools like ",(0,i.jsx)(t.code,{children:"volatility"})," understand a process's architecture and can extract and relate data from these structures. Specific ",(0,i.jsx)(t.code,{children:"volatility"})," modules will target certain fields of these structures. Below, you can find an overview of interesting fields for each structure. ",(0,i.jsx)(t.strong,{children:"Note: Only the relevant fields are listed for each structure. The other fields have been omitted."})]}),"\n",(0,i.jsx)(t.h4,{id:"eprocess",children:"EPROCESS"}),"\n",(0,i.jsxs)(t.p,{children:["The following ",(0,i.jsx)(t.code,{children:"volatility"})," plugins extract information from EPROCESS: ",(0,i.jsx)(t.code,{children:"pslist"}),", ",(0,i.jsx)(t.code,{children:"pstree"}),", ",(0,i.jsx)(t.code,{children:"psscan"}),", ",(0,i.jsx)(t.code,{children:"malfind"}),", ",(0,i.jsx)(t.code,{children:"getsids"}),", ",(0,i.jsx)(t.code,{children:"handles"}),", ",(0,i.jsx)(t.code,{children:"dlllist"}),", ",(0,i.jsx)(t.code,{children:"cmdline"}),", ",(0,i.jsx)(t.code,{children:"envars"})," and ",(0,i.jsx)(t.code,{children:"ldrmodules"}),". In the terminal below, you can find the fields these modules target:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-c",metastring:'title="EPROCESS STRUCTURE"',children:"struct _EPROCESS { \n    HANDLE UniqueProcessId; // PID (Process ID) \n    LIST_ENTRY ActiveProcessLinks; // Link in active process list (Used to keep track of all active processes) \n    UCHAR ImageFileName[15]; // Short process name LARGE_INTEGER CreateTime; // Process creation time \n    LARGE_INTEGER ExitTime; // Exit time if terminated \n    PPEB Peb; // Pointer to user-mode PEB \n    HANDLE InheritedFromUniqueProcessId; // Parent PID \n    LIST_ENTRY ThreadListHead; // List of ETHREADs \n    PHANDLE_TABLE ObjectTable; // Handle table (points to opened files) \n    PVOID SectionObject; // Executable image mapping \n    PVOID VadRoot; // VAD tree for memory mapping PACCESS_TOKEN Token; // Security information \n}\n"})}),"\n",(0,i.jsx)(t.h4,{id:"ethread",children:"ETHREAD"}),"\n",(0,i.jsxs)(t.p,{children:["The following ",(0,i.jsx)(t.code,{children:"volatility"})," plugins extract information from ETHREAD: ",(0,i.jsx)(t.code,{children:"threads"}),", ",(0,i.jsx)(t.code,{children:"ldrmodules"}),", ",(0,i.jsx)(t.code,{children:"apihooks"})," and ",(0,i.jsx)(t.code,{children:"malfind"}),". In the terminal below, you can find the fields these modules target:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-c",metastring:'title="THREAD STRUCTURE"',children:"struct _ETHREAD { \n    CLIENT_ID Cid; // Thread and Process IDs \n    LARGE_INTEGER CreateTime; // Thread creation time \n    LARGE_INTEGER ExitTime; // Thread exit time \n    PVOID StartAddress; // Kernel-level entry point \n    PVOID Win32StartAddress; // User-mode entry point \n    LIST_ENTRY ThreadListEntry; // Link in EPROCESS's thread list \n    PTEB Teb; // Pointer to TEB \n    ULONG ThreadState; // Thread execution state \n    ULONG WaitReason; // Reason for being blocked \n}\n"})}),"\n",(0,i.jsx)(t.h4,{id:"peb",children:"PEB"}),"\n",(0,i.jsxs)(t.p,{children:["The following ",(0,i.jsx)(t.code,{children:"volatility"})," plugins extract information from the Process Environment Block: ",(0,i.jsx)(t.code,{children:"cmdline"}),", ",(0,i.jsx)(t.code,{children:"envars"}),", ",(0,i.jsx)(t.code,{children:"ldrmodules"})," and ",(0,i.jsx)(t.code,{children:"malfind"}),". In the terminal below, you can find the fields these modules target:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-c",metastring:'title="PEB STRUCTURE"',children:"struct _PEB { \n    BOOLEAN BeingDebugged; // Debug flag\n    PVOID ImageBaseAddress; // Base address of executable \n    PPEB_LDR_DATA Ldr; // Loader data (DLLs) \n    PRTL_USER_PROCESS_PARAMETERS ProcessParameters;// Command-line, environment variables\n    ULONG NtGlobalFlag; // Debugging heap flags \n    PVOID ProcessHeap; // Default process heap \n}\n"})}),"\n",(0,i.jsx)(t.h4,{id:"teb",children:"TEB"}),"\n",(0,i.jsxs)(t.p,{children:["The following ",(0,i.jsx)(t.code,{children:"volatility"})," plugins extract information from the Thread Environment Block: ",(0,i.jsx)(t.code,{children:"threads"})," and ",(0,i.jsx)(t.code,{children:"malfind"}),". In the terminal below, you can find the fields these modules target:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-c",metastring:'title="TEB STRUCTURE"',children:"struct _TEB { \n    PVOID EnvironmentPointer; // Pointer to env block \n    CLIENT_ID ClientId; // Thread + Process IDs \n    PVOID ThreadLocalStoragePointer; // TLS base \n    PPEB ProcessEnvironmentBlock; // Pointer to PEB \n    ULONG LastErrorValue; // Last error value \n    PVOID StackBase; // Upper bound of thread stack \n    PVOID StackLimit; // Lower bound of thread stack \n    PVOID Win32ThreadInfo; // GUI subsystem data \n}\n"})}),"\n",(0,i.jsxs)(t.admonition,{title:"Answer the questions below",type:"info",children:[(0,i.jsxs)(n,{children:[(0,i.jsx)("summary",{children:" What field is used to keep track of all the active processes? Only enter the fields' name. "}),(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-plaintext",children:"ActiveProcessLinks\n"})})]}),(0,i.jsxs)(n,{children:[(0,i.jsx)("summary",{children:" What field is used to store the PID of a process? Only enter the fields' name. "}),(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-plaintext",children:"UniqueProcessId\n"})})]})]}),"\n",(0,i.jsx)(t.h2,{id:"task-4-initial-triage-of-a-new-memory-dump",children:"Task 4 Initial Triage of a New Memory Dump"}),"\n",(0,i.jsxs)(t.p,{children:["You refreshed your knowledge of Windows memory and processes in the previous task. You are ready to tackle the fun challenge of analyzing the provided memory dump. During this task, you will start up the analysis VM and verify the hash of the memory dump. Then, you will continue extracting the processes in the memory dump using ",(0,i.jsx)(t.code,{children:"volatility"}),". After that, you will analyze the results and look for suspicious processes. Last, you will note down your findings."]}),"\n",(0,i.jsx)(t.h3,{id:"environment-and-setup",children:"Environment and Setup"}),"\n",(0,i.jsxs)(t.p,{children:["During your investigation, you will use an Ubuntu Desktop host with the memory analysis tool ",(0,i.jsx)(t.code,{children:"volatility"})," version 3. We have assigned the alias ",(0,i.jsx)(t.code,{children:"vol3"})," to the full command (python3 vol.py) to start ",(0,i.jsx)(t.code,{children:"volatility"}),". Start the VM now by clicking the ",(0,i.jsx)(t.code,{children:"Start Machine"})," button at the top of this task. The VM will start in split view. In case it\u2019s not showing up, you can press the ",(0,i.jsx)(t.code,{children:"Show Split View"})," button at the top of the page."]}),"\n",(0,i.jsxs)(t.p,{children:["The default installation of Ubuntu Desktop comes with command-line utilities that supplement ",(0,i.jsx)(t.code,{children:"volatility"})," and allow you to parse the analysis results in additional detail. These tools include ",(0,i.jsx)(t.code,{children:"strings"}),", ",(0,i.jsx)(t.code,{children:"diff"}),", ",(0,i.jsx)(t.code,{children:"grep"}),", ",(0,i.jsx)(t.code,{children:"comm"}),", ",(0,i.jsx)(t.code,{children:"awk"}),", and more."]}),"\n",(0,i.jsx)(t.h3,{id:"verifying-the-memory-dump",children:"Verifying the Memory Dump"}),"\n",(0,i.jsxs)(t.p,{children:["Open a shell on the analysis VM and navigate to ",(0,i.jsx)(t.code,{children:"/home/ubuntu"}),". Then use the ",(0,i.jsx)(t.code,{children:"md5sum"})," command to calculate the MD5 hash of the memory dump. ",(0,i.jsx)(t.strong,{children:"Note: You don't need to enter the command. We have already pre-calculated the hash for you. Due to restrained resources it could take up to five minutes to calculate an MD5 hash."})]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",metastring:'title="Calculate MD5 Hash"',children:"ubuntu@tryhackme:~$ md5sum THM-WIN-001_071528_07052025.mem > newhash.txt\n"})}),"\n",(0,i.jsx)(t.p,{children:"Then, compare the newly calculated hash with the hash that you received from your colleague who did the memory acquisition:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",metastring:'title="Compare Hashes"',children:"ubuntu@tryhackme:~$ diff acquisitionhash.txt newhash.txt\n"})}),"\n",(0,i.jsx)(t.p,{children:"If the above command shows no output, the hashes are the same. Now that you have verified the integrity of the memory dump, you can proceed with extracting its content."}),"\n",(0,i.jsx)(t.h3,{id:"extract-processes",children:"Extract Processes"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"volatility"})," comes with multiple modules that can help you extract processes and their information:"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"windows.pslist"}),": extract a list of the ",(0,i.jsx)(t.strong,{children:"active processes at the time of the memory dump"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"windows.psscan"}),": extract ",(0,i.jsx)(t.strong,{children:"all process objects"}),", including terminated and unlinked processes"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"windows.pstree"}),": extracts a list of the ",(0,i.jsx)(t.strong,{children:"active processes at the time of the memory dump"})," and visualizes the parent-child relationships between them"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"windows.psxview"}),": uses multiple process detection techniques to gather information about processes, threads, process structures, and handles, then cross-reference and compare this information."]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["Navigate to the VM and open a terminal. Now, enter the commands below to extract the active processes from the memory dump and save them in a text file. ",(0,i.jsx)(t.strong,{children:"Note: Due to size of the memory dump and limited resources, it can take up to a minute until the command finishes running."})]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",metastring:'title="Extract Processes"',children:"ubuntu@tryhackme:~$ vol3 -f THM-WIN-001_071528_07052025.mem windows.pslist > pslist.txt\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Now, use ",(0,i.jsx)(t.code,{children:"cat"})," to display the content of ",(0,i.jsx)(t.code,{children:"pslist.txt"})," and analyze the output. Here is a tip: pipe the output to the command ",(0,i.jsx)(t.code,{children:"less"})," to get a scrollable output. You can then ",(0,i.jsx)(t.strong,{children:"press space to scroll through the output"}),". You can press ",(0,i.jsx)(t.code,{children:"q"})," to exit."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",metastring:'title="Display Extracted Processes"',children:"ubuntu@tryhackme:~$ cat pslist.txt | less\nVolatility 3 Framework 2.26.2\nPID PPID ImageFileName Offset(V) Threads Handles SessionId Wow64 CreateTime ExitTime File output\n        \n4   0   System         0x990b2366a040 138 - N/A False 2025-05-07 07:08:48.000000 UTC N/A Disabled\n92  4   Registry       0x990b236dc080 4 - N/A False 2025-05-07 07:08:44.000000 UTC N/A Disabled\n324 4   smss.exe       0x990b2680e040 2 - N/A False 2025-05-07 07:08:48.000000 UTC N/A Disabled\n440 420 csrss.exe      0x990b26cf0140 12 - 0 False 2025-05-07 07:08:48.000000 UTC N/A Disabled\n516 508 csrss.exe      0x990b274bd080 13 - 1 False 2025-05-07 07:08:48.000000 UTC N/A Disabled\n524 420 wininit.exe    0x990b2758a140 1 - 0 False 2025-05-07 07:08:48.000000 UTC N/A Disabled\n592 508 winlogon.exe   0x990b275c00c0 6 - 1 False 2025-05-07 07:08:48.000000 UTC N/A Disabled\n        \n[REDACTED FOR READABILITY]\n"})}),"\n",(0,i.jsx)(t.h3,{id:"finding-a-needle-in-a-haystack",children:"Finding a Needle in a Haystack"}),"\n",(0,i.jsx)(t.p,{children:"You are looking for suspicious processes that match one of the indicators below:"}),"\n",(0,i.jsx)(t.h4,{id:"suspicious-name",children:"Suspicious Name"}),"\n",(0,i.jsx)(t.p,{children:"Attackers like to use typosquatting to masquerade as a legitimate process. For example:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"scvhost.exe"})," instead of ",(0,i.jsx)(t.code,{children:"svchost.exe"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"explorere.exe"})," instead of ",(0,i.jsx)(t.code,{children:"explorer.exe"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"lsasss.exe"})," instead of ",(0,i.jsx)(t.code,{children:"lsass.exe"})]}),"\n"]}),"\n",(0,i.jsx)(t.h4,{id:"suspicious-path",children:"Suspicious Path"}),"\n",(0,i.jsx)(t.p,{children:"Attackers will use process names identical to legitimate processes, but the processes are located in an unusual path. For example:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"svchost.exe"})," starting from ",(0,i.jsx)(t.code,{children:"C:\\Users\\analyst\\"})," instead of ",(0,i.jsx)(t.code,{children:"C:\\Windows\\System32\\"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"cmd.exe"})," starting from ",(0,i.jsx)(t.code,{children:"C:\\TMP\\"})," instead of ",(0,i.jsx)(t.code,{children:"C:\\Windows\\System32\\"})]}),"\n"]}),"\n",(0,i.jsx)(t.h4,{id:"masquerading",children:"Masquerading"}),"\n",(0,i.jsx)(t.p,{children:"Attackers will use process names that mimic processes and system services. For example:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"dockerupdater.exe"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"defenderAV.exe"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"pdfupdateservice.exe"})}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"comparing-with-a-baseline",children:"Comparing With a Baseline"}),"\n",(0,i.jsx)(t.p,{children:"It is sometimes difficult to distinguish between legitimate and malicious processes. The process list in the previous paragraph is luckily not so extensive, but if it were, you could use the following method to narrow down the number of processes to go through:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Ensure you have a baseline of the processes that run on a host in normal circumstances. For example, during regular business hours"}),"\n",(0,i.jsxs)(t.li,{children:["Compare the ",(0,i.jsx)(t.code,{children:"windows.pslist"})," output with the baseline to get a shortlist of processes that were not included in the baseline"]}),"\n",(0,i.jsx)(t.li,{children:"Filter the processes by comparing them to a shortlist of common processes that run when updating software. You can check the task scheduler to find these processes"}),"\n",(0,i.jsx)(t.li,{children:"Investigate the leftover processes"}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["Continue with the VM and enter the following commands to compare the ",(0,i.jsx)(t.code,{children:"pslist.txt"})," file to the ",(0,i.jsx)(t.code,{children:"baseline.txt"})," file located in ",(0,i.jsx)(t.code,{children:"~\\baseline\\"})," (Note: the baseline file was extracted from the Task Manager, so you need to prepare it first):"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",metastring:'title="Comparing with Baseline"',children:"ubuntu@tryhackme:~$ awk 'NR >3{print $2}' baseline/baseline.txt | sort | uniq > baseline_procs.txt\nubuntu@tryhackme:~$ awk 'NR >3{print $3}' pslist.txt | sort | uniq > current_procs.txt\nubuntu@tryhackme:~$ comm -13 baseline_procs.txt current_procs.txt\n[REDACTED FOR READABILITY]\nWINWORD.EXE\nai.exe\naudiodg.exe\ncmd.exe\nfontdrvhost.ex\nmsdtc.exe\npdfupdater.exe\nsmartscreen.ex\nsppsvc.exe\nupdater.exe\nuserinit.exe\nvm3dservice.ex\nvmtoolsd.exe\nwindows-update\n"})}),"\n",(0,i.jsxs)(t.p,{children:["The first two lines including ",(0,i.jsx)(t.code,{children:"awk"})," in the terminal above prepare the files to be compared:"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"awk 'NR >3{print $2}'"})," divides the files content in columns excluding the first 3 lines and then prints the n-th column as output"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"sort"})," sorts the values that were passed along from the ",(0,i.jsx)(t.code,{children:"awk"})," command"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"uniq > *.txt"})," filters out duplicates and then saves the data to a text file"]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"comm"})," command compares the content of each prepared file and outputs the difference. The flags ",(0,i.jsx)(t.code,{children:"-13"})," are set so only the processes unique to ",(0,i.jsx)(t.code,{children:"current_procs.txt"})," are displayed."]}),"\n",(0,i.jsx)(t.p,{children:"The results listed in the terminal above need to be interpreted first. Some of the processes included are false positives. These are, for example:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Legitimate processes that were not running at the time of capturing the baseline"}),"\n",(0,i.jsxs)(t.li,{children:["Processes where the ",(0,i.jsx)(t.code,{children:"ImageFileName"})," field was too long and was truncated. This field can only accommodate 16 bytes."]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Knowing which processes are false positives requires some additional research. The processes below have made it onto your shortlist:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"pdfupdater.exe"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"windows-update.exe"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"updater.exe"})}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"analysis-notes-and-next-steps",children:"Analysis Notes and Next Steps"}),"\n",(0,i.jsx)(t.p,{children:"You have found three suspicious processes that require further analysis. The table below gives an overview of these suspicious processes."}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"ImageFileName"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"PID"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Timestamp"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"pdfupdater.exe"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"3392"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:13:05.000000"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"windows-update.exe"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"10084"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:13:05.000000"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"updater.exe"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"10032"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:13:56.000000"})]})]})]}),"\n",(0,i.jsx)(t.p,{children:"Continue to the next task and see if these processes are linked to each other or other processes. This might help you uncover other processes that were not initially suspicious but are now suspicious within a new context."}),"\n",(0,i.jsxs)(t.admonition,{title:"Answer the questions below",type:"info",children:[(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[" What is the PID of the csrss.exe process that has 12 threads? You can use the ",(0,i.jsx)(t.code,{children:"pslist.txt"})," file to find the answer. "]}),(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-plaintext",children:"440\n"})})]}),(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[" What is the (memory) Offset(V) of the process with PID 5672? You can use the ",(0,i.jsx)(t.code,{children:"pslist.txt"})," file to find the answer. "]}),(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-plaintext",children:"0x990b29293080\n"})})]})]}),"\n",(0,i.jsx)(t.h2,{id:"task-5-linking-processes",children:"Task 5 Linking Processes"}),"\n",(0,i.jsx)(t.p,{children:"In the previous task, you found multiple separate suspicious processes. Before digging deeper into the memory of these processes, you should first uncover if there is any link between these processes and others. This will help you find other potentially suspicious processes. The terminal below shows what a malicious process tree could look like:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",children:"explorer.exe (PID: 1500)\n\u2514\u2500\u2500 cmd.exe (PID: 2200)                  \u2190 Triggered by malicious LNK file\n    \u2514\u2500\u2500 powershell.exe (PID: 2210)       \u2190 Downloads and executes the payload\n        \u2514\u2500\u2500 svchost.exe (PID: 2220)      \u2190 Masquerades as a system process\n            \u2514\u2500\u2500 asyncrat.exe (PID: 2230) \u2190 Remote Access Trojan (C2 beaconing)\n"})}),"\n",(0,i.jsxs)(t.p,{children:["The example above is an attack chain in which asyncrat, a common Remote Access Trojan, was deployed after a user clicked on a malicious LNK file. The LNK file spawns a command line, ",(0,i.jsx)(t.code,{children:"cmd.exe"}),", which then launches PowerShell to download and execute a payload. PowerShell, in turn, uses svchost.exe to masquerade as a system process and spawns ",(0,i.jsx)(t.code,{children:"asyncrat.exe"}),"."]}),"\n",(0,i.jsxs)(t.p,{children:["Continuing with the VM, enter the following command to generate a tree structure that shows the memory dump's process parent-child relationships. ",(0,i.jsx)(t.strong,{children:"Note: Due to size of the memory dump and limited resources, it can take up to a minute until the command finishes running."})]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",metastring:'title="Show Process Tree"',children:"ubuntu@tryhackme:~$ vol3 -f THM-WIN-001_071528_07052025.mem windows.pstree > processtree.txt\n"})}),"\n",(0,i.jsxs)(t.p,{children:["The output shown with the ",(0,i.jsx)(t.code,{children:"cat"})," command is quite overwhelming. You can use the ",(0,i.jsx)(t.code,{children:"cut"})," command to process the ",(0,i.jsx)(t.code,{children:"processtree.txt"})," file and only display the PID, PIDD, and image name values. Enter the following command to accomplish this:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",metastring:'title="Parse Process Tree"',children:"ubuntu@tryhackme:~$ cut -d$'\\t' -f1,2,3 processtree.txt\nPID             PPID    ImageFileName\n[REDACTED]\n592             508     winlogon.exe\n* 5232          592     userinit.exe\n** 5672         5232    explorer.exe\n*** 5952        5672    cmd.exe\n**** 3144       5952    conhost.exe\n*** 5252        5672    WINWORD.EXE\n**** 3392       5252    pdfupdater.exe\n***** 2576      3392    conhost.exe\n***** 10084     3392    windows-update\n****** 10032    10084   updater.exe\n******* 432     10032   cmd.exe\n******** 4592   432     conhost.exe\n******** 6984   432     powershell.exe\n**** 3932       5252    ai.exe\n*** 8936        5672    SecurityHealth\n*** 9096        5672    msedge.exe\n**** 8100       9096    msedge.exe\n**** 9164       9096    msedge.exe\n**** 3500       9096    msedge.exe\n**** 7408       9096    msedge.exe\n**** 9264       9096    msedge.exe\n**** 4152       9096    msedge.exe\n**** 7420       9096    msedge.exe\n[REDACTED]\n"})}),"\n",(0,i.jsx)(t.p,{children:"The results above have been redacted for readability. The results shown include the processes of interest you discovered in the previous task."}),"\n",(0,i.jsx)(t.h3,{id:"observations",children:"Observations"}),"\n",(0,i.jsx)(t.p,{children:"Now locate the processes you noted during task 3 and check if they relate to other processes. Starting from the WINWORD.exe process, you can see a clear tree structure. We converted the tree to an ASCII tree structure to show it more clearly."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",children:"PID         PPID    IMAGENAME\n5252        5672    WINWORD.EXE\n\u2514\u2500\u2500 3392       5252    pdfupdater.exe    \n    \u251c\u2500\u2500 2576      3392    conhost.exe    \n    \u2514\u2500\u2500 10084     3392    windows-update        \n        \u2514\u2500\u2500 10032    10084   updater.exe            \n            \u2514\u2500\u2500 432     10032   cmd.exe                \n                \u251c\u2500\u2500 4592   432     conhost.exe                \n                \u2514\u2500\u2500 6984   432     powershell.exe\n"})}),"\n",(0,i.jsx)(t.p,{children:"Now note down the observations starting from the bottom:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["The process ",(0,i.jsx)(t.code,{children:"powershell.exe"})," with the PID ... has the PPID ..."]}),"\n",(0,i.jsxs)(t.li,{children:["The process ",(0,i.jsx)(t.code,{children:"conhost.exe"})," with the PID ... has the PPID ..."]}),"\n",(0,i.jsxs)(t.li,{children:["The process linked to PPID ... is ",(0,i.jsx)(t.code,{children:"cmd.exe"})," and has the PID ..."]}),"\n",(0,i.jsx)(t.li,{children:"And so on"}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"analysis-notes-and-next-steps-1",children:"Analysis Notes and Next Steps"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"ImageFileName"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"PID"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"PPID"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Timestamp"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"WINWORD.EXE"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"5252"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"5672"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:13:04.000000"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"pdfupdater.exe"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"3392"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"5252"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:13:05.000000"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"conhost.exe"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2576"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"3392"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:13:05.000000"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"windows-update.exe"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"10084"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"3392"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:13:05.000000"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"updater.exe"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"10032"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"10084"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:13:56.000000"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"cmd.exe"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"432"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"10032"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:14:36.000000"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"conhost.exe"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"4592"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"432"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:14:36.000000"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"powershell.exe"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"6984"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"432"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:14:39.000000"})]})]})]}),"\n",(0,i.jsxs)(t.p,{children:["From the observations (see table above), we can conclude that the ",(0,i.jsx)(t.code,{children:"updater.exe"})," process is a child process of ",(0,i.jsx)(t.code,{children:"windows-update.exe"}),", a child process of ",(0,i.jsx)(t.code,{children:"pdfupdater.exe"}),". The ",(0,i.jsx)(t.code,{children:"pdfupdater.exe"})," process is a child of ",(0,i.jsx)(t.code,{children:"WINWORD.exe"}),". This chain of processes seems quite suspicious:"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Multiple of these processes have the name ",(0,i.jsx)(t.code,{children:"update"})," in them"]}),"\n",(0,i.jsxs)(t.li,{children:["The ",(0,i.jsx)(t.code,{children:"WINDWORD.exe"})," process launches the ",(0,i.jsx)(t.code,{children:"pdfupdater.exe"})," process. This would mean that Microsoft Word is updating a tool related to PDF"]}),"\n",(0,i.jsxs)(t.li,{children:["The ",(0,i.jsx)(t.code,{children:"pdfupdater.exe"})," process then launches the ",(0,i.jsx)(t.code,{children:"windows-update.exe"}),". It is highly unlikely that a tool that would update one software would also launch the ",(0,i.jsx)(t.code,{children:"windows-update.exe"})," process to update the Windows OS"]}),"\n",(0,i.jsxs)(t.li,{children:["To top it off, the ",(0,i.jsx)(t.code,{children:"windows-update.exe"})," process launches the ",(0,i.jsx)(t.code,{children:"updater.exe"})," process, which seems to hint at yet another update"]}),"\n",(0,i.jsxs)(t.li,{children:["The presence of the ",(0,i.jsx)(t.code,{children:"conhost.exe"})," process also indicates that these processes seem to initiate a network connection"]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Looking closely at these observations and remarks and comparing them with factual information like how the Windows, PDF tool, and Microsoft Word update process works and their legitimate process names, you can conclude that this chain of processes is highly likely malicious."}),"\n",(0,i.jsx)(t.p,{children:"Now that you have found a potential malicious chain, you must dig deeper. Proceed to the next task to uncover terminated and hidden processes and analyze the suspicious processes found in this task."}),"\n",(0,i.jsxs)(t.admonition,{title:"Answer the questions below",type:"info",children:[(0,i.jsxs)(n,{children:[(0,i.jsx)("summary",{children:" What is the parentID (PPID) of the services.exe (PID 664) process? Use the processtree.txt file to answer the question. "}),(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-plaintext",children:"524\n"})})]}),(0,i.jsxs)(n,{children:[(0,i.jsx)("summary",{children:" What is the ImageFileName of the process that has the PID 7788? Use the processtree.txt file to answer the question. "}),(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-plaintext",children:"FTK Imager.exe\n"})})]})]}),"\n",(0,i.jsx)(t.h2,{id:"task-6-digging-deeper",children:"Task 6 Digging Deeper"}),"\n",(0,i.jsxs)(t.p,{children:["Until now, you have focused on uncovering and linking processes that were part of the active memory. ",(0,i.jsx)(t.code,{children:"volatility"})," can also scan for processes that were recently terminated, unlinked, or hidden by an attacker. Attackers often employ different techniques to hide processes, threads, drivers, and registry keys. You can use the ",(0,i.jsx)(t.code,{children:"volatitlity"})," modules ",(0,i.jsx)(t.code,{children:"windows.psscan"})," and ",(0,i.jsx)(t.code,{children:"windows.psxview"})," to get an overview of all process structures, including those not in the active process links structure."]}),"\n",(0,i.jsx)(t.h3,{id:"psscan",children:"PSSCAN"}),"\n",(0,i.jsxs)(t.p,{children:["Continuing with the VM, enter the command shown below to scan for processes that were not part of the active processes list. ",(0,i.jsx)(t.strong,{children:"Note: Due to size of the memory dump and limited resources, it can take up to three minutes until the command finishes running."})]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",metastring:'title="PSSCAN"',children:"ubuntu@tryhackme:~$ vol3 -f THM-WIN-001_071528_07052025.mem windows.psscan > psscan.txt\n"})}),"\n",(0,i.jsxs)(t.p,{children:["You can compare the results of ",(0,i.jsx)(t.code,{children:"psscan"})," with the results of ",(0,i.jsx)(t.code,{children:"pslist"})," to uncover hidden processes. You first need to prepare the output files before comparing them. Enter the following commands to extract the PID and process name from the ",(0,i.jsx)(t.code,{children:"psscan.txt"})," and ",(0,i.jsx)(t.code,{children:"pslist.txt"})," files and save the output to a new file."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",metastring:'title="Prepare Files"',children:"ubuntu@tryhackme:~$ awk '{print $1,$3}' pslist.txt | sort > pslist_processed.txt\nubuntu@tryhackme:~$ awk '{print $1,$3}' psscan.txt | sort > psscan_processed.txt\n"})}),"\n",(0,i.jsx)(t.p,{children:"Then, you can compare both files to uncover hidden processes:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",metastring:'title="Prepare Files"',children:"ubuntu@tryhackme:~$ comm -23 psscan_processed.txt pslist_processed.txt\n5548 sihost.exe\n5592 svchost.exe\n5736 svchost.exe\n5748 svchost.exe\n5752 taskhostw.exe\n5828 svchost.exe\n5908 svchost.exe\n5972 ctfmon.exe\n8708 svchost.exe\n9040 vmtoolsd.exe\n"})}),"\n",(0,i.jsxs)(t.p,{children:["The results of this comparison are benign. All the listed processes are common processes that run on a Windows host. For example, ",(0,i.jsx)(t.code,{children:"svchost.exe"})," is a common process that hosts and runs Windows services. There are a few checks you can do to verify that ",(0,i.jsx)(t.code,{children:"svchost.exe"})," is indeed benign:"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Check the image path: If it is not located in ",(0,i.jsx)(t.code,{children:"C:\\Windows\\System32\\"}),", it is suspicious"]}),"\n",(0,i.jsx)(t.li,{children:"Check the DLLs loaded for this process: Attackers can use techniques like process hollowing or DLL injection to compromise a legitimate process"}),"\n",(0,i.jsxs)(t.li,{children:["Check if the process still has active threads: If it does have active threads but it doesn't appear in the ",(0,i.jsx)(t.code,{children:"pslist"})," results, it is suspicious. It could be that an attacker is hiding the process"]}),"\n",(0,i.jsx)(t.li,{children:"If an active process does not have any threads, it is considered suspicious. Every active process should have at least 1 thread. Attackers can use techniques to alter the threads"}),"\n",(0,i.jsxs)(t.li,{children:["Check the ",(0,i.jsx)(t.code,{children:"Exit Time"}),": If the process really is terminated, it should display an ",(0,i.jsx)(t.code,{children:"Exit Time"}),". If there are still active or orphaned threads linked to that process, it is suspicious."]}),"\n",(0,i.jsx)(t.li,{children:"Dump the process memory and analyze it further"}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"You will explore some of these checks later on.\nPSXVIEW"}),"\n",(0,i.jsx)(t.p,{children:"Now, run the windows.psxview module. windows.psxview is a great way to do multiple tests in one and cross-reference the results. You should look for the processes that are not listed in the results of pslist but are listed in the other tests. Enter the following command to run the windows.psxview module. Note: Due to size of the memory dump and limited resources, it can take up to three minutes until the command finishes running."}),"\n",(0,i.jsx)(t.h3,{id:"psxview",children:"PSXVIEW"}),"\n",(0,i.jsxs)(t.p,{children:["Now, run the ",(0,i.jsx)(t.code,{children:"windows.psxview"})," module. ",(0,i.jsx)(t.code,{children:"windows.psxview"})," is a great way to do multiple tests in one and cross-reference the results. You should look for the processes that are not listed in the results of ",(0,i.jsx)(t.code,{children:"pslist"})," but are listed in the other tests. Enter the following command to run the ",(0,i.jsx)(t.code,{children:"windows.psxview"})," module. ",(0,i.jsx)(t.strong,{children:"Note: Due to size of the memory dump and limited resources, it can take up to three minutes until the command finishes running."})]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",metastring:'title="PSXVIEW"',children:"ubuntu@tryhackme:~$ vol3 -f THM-WIN-001_071528_07052025.mem windows.psxview > psxview.txt\n"})}),"\n",(0,i.jsxs)(t.p,{children:["You can then use ",(0,i.jsx)(t.code,{children:"awk"})," to filter the results and display all the lines where the ",(0,i.jsx)(t.code,{children:"pslist"})," test equals false, as shown below:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",metastring:'title="Filter Results"',children:"ubuntu@tryhackme:~$ awk 'NR==3 || $4 == \"False\"' psxview.txt\nOffset(Virtual) Name            PID     pslist  psscan  thrdscan  csrss   Exit Time\n0xac80001ca080  svchost.exe     5828    False   True    False     False\n0xac8000083080  svchost.exe     5592    False   True    False     False\n0xac80000b90c0  vmtoolsd.exe    9040    False   True    False     False\n0xac8000084080  svchost.exe     5748    False   True    False     False\n0xac80001c6080  svchost.exe     5908    False   True    False     False\n0xac80001d2080  ctfmon.exe      5972    False   True    False     False\n0xac8000030080  svchost.exe     5736    False   True    False     False\n0xac80000a1080  sihost.exe      5548    False   True    False     False\n0x990b29bef080  svchost.exe     8708    False   True    False     False   2025-05-07 07:13:16+00:00\n0xac8000031080  taskhostw.exe   5752    False   True    False     False\n"})}),"\n",(0,i.jsxs)(t.p,{children:["The output in the terminal above doesn't show anything obvious that could hint at an attacker hiding a malicious process. However, you can never be 100% sure. If you are still suspicious of the listed processes, apply the same checks listed in the ",(0,i.jsx)(t.strong,{children:"psscan section"}),"."]}),"\n",(0,i.jsx)(t.h3,{id:"analysis-notes-and-next-steps-2",children:"Analysis Notes and Next Steps"}),"\n",(0,i.jsxs)(t.p,{children:["You did not uncover new processes using the volatility modules ",(0,i.jsx)(t.code,{children:"psscan"})," and ",(0,i.jsx)(t.code,{children:"psxview"}),"."]}),"\n",(0,i.jsx)(t.p,{children:"In the next task, you will focus on analyzing the processes uncovered in the previous tasks."}),"\n",(0,i.jsxs)(t.admonition,{title:"Answer the questions below",type:"info",children:[(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[" What is the number of processes that have 0 Threads? Use the ",(0,i.jsx)(t.code,{children:"psscan.txt"})," file to answer the question. "]}),(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-plaintext",children:"3\n"})})]}),(0,i.jsxs)(n,{children:[(0,i.jsxs)("summary",{children:[" What is the number of processes that have the Exit Time filled in? Use the ",(0,i.jsx)(t.code,{children:"psxview.txt"})," file to answer the question. "]}),(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-plaintext",children:"3\n"})})]})]}),"\n",(0,i.jsx)(t.h2,{id:"task-7-dumping-the-process-memory",children:"Task 7 Dumping the Process Memory"}),"\n",(0,i.jsxs)(t.p,{children:["During the previous tasks, you uncovered a potentially malicious chain of processes. From the information gathered, you could only conclude that these processes are linked and that the chain starts from the ",(0,i.jsx)(t.code,{children:"WINWORD.exe"})," process. You should focus now on extracting information from processes by dumping their memory."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"volatility"})," includes several modules to assist you with this. The modules ",(0,i.jsx)(t.code,{children:"windows.dlllist"})," and ",(0,i.jsx)(t.code,{children:"windows.dumpfiles"})," should help you uncover several indicators of compromise."]}),"\n",(0,i.jsx)(t.h3,{id:"finding-the-path",children:"Finding the Path"}),"\n",(0,i.jsxs)(t.p,{children:["Using the ",(0,i.jsx)(t.code,{children:"windows.dlllist"})," module, you can uncover the path of the main executable and its linked DLLs. Continuing with the VM, run the module ",(0,i.jsx)(t.code,{children:"windows.dlllist"})," on the processes you noted in task 5 ( ",(0,i.jsx)(t.code,{children:"WINWORD.exe"}),", ",(0,i.jsx)(t.code,{children:"pdfupdater.exe"}),", ",(0,i.jsx)(t.code,{children:"updater.exe"}),", ",(0,i.jsx)(t.code,{children:"windows-update"}),", ",(0,i.jsx)(t.code,{children:"cmd.exe"}),", ",(0,i.jsx)(t.code,{children:"conhost.exe"}),", ",(0,i.jsx)(t.code,{children:"powershell.exe"}),"). Enter the following commands to dump the ",(0,i.jsx)(t.code,{children:"WINWORD.exe"})," process. ",(0,i.jsx)(t.strong,{children:"Note: Due to size of the memory dump and limited resources, it can take up to two minutes until the command finishes running."})]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",metastring:'title="Check Results"',children:"ubuntu@tryhackme:~$ vol3 -f THM-WIN-001_071528_07052025.mem windows.dlllist --pid 5252 > 5252_dlllist.txt\n"})}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Now, do the same for all other processes."})," Then, check every file with ",(0,i.jsx)(t.code,{children:"cat"}),", look for the path of the main executable, and note it down."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",metastring:'title="Check Results"',children:"ubuntu@tryhackme:~$ cat 5252_dlllist.txt\nVolatility 3 Framework 2.26.2\nProgress:  100.00               PDB scanning finished\nPID   Process Base  Size      Name                  Path                                                               LoadTime                File output\n5252  WINWORD.EXE   0x670000  0x1ac000 WINWORD.EXE  C:\\Program Files (x86)\\Microsoft Office\\Root\\Office16\\WINWORD.EXE  2025-05-07 07:13:04.00\n        \n[REDACTED FOR READABILITY]\n"})}),"\n",(0,i.jsx)(t.p,{children:"Now, update the information you already have with the new findings."}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"pdfupdater.exe"}),", ",(0,i.jsx)(t.code,{children:"windows-update.exe"}),", and ",(0,i.jsx)(t.code,{children:"updater.exe"})," processes seem to start at unusual locations. This information will be helpful when you focus on investigating user activity."]}),"\n",(0,i.jsx)(t.h3,{id:"dump-process-memory",children:"Dump Process Memory"}),"\n",(0,i.jsx)(t.p,{children:"You have uncovered multiple suspicious processes until now. This suspicion is based on process names, a process tree with multiple update processes, and processes that start from a user path."}),"\n",(0,i.jsxs)(t.p,{children:["You must dump and analyze the processes' memory to confirm that these processes are malicious. You can then extract the executable and run the strings command to see if any malicious indicators are present quickly. In most cases, you will pass the executable to a malware analyst for further investigation. Below, are the commands to dump the process with PID 5252. Follow the same steps to dump the memory of the other processes; you can exclude the cmd.exe, PowerShell.exe, and conhost.exe processes. Other ",(0,i.jsx)(t.code,{children:"volatility"})," modules can analyze these processes better. ",(0,i.jsx)(t.strong,{children:"Note: Due to size of the memory dump and limited resources, it can take up to one minute until the command finishes running."})]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",metastring:'title="Dump Process Memory"',children:"ubuntu@tryhackme:~$ mkdir 5252\nubuntu@tryhackme:~$ cd 5252\nubuntu@tryhackme:~/5252$ vol3 -f ../THM-WIN-001_071528_07052025.mem windows.dumpfiles --pid 5252\n"})}),"\n",(0,i.jsxs)(t.p,{children:["The dumped files all follow the same naming convention: ",(0,i.jsx)(t.code,{children:"file.StartAddress.EndAddress.ImageSectionObject.filename.img"})," or ",(0,i.jsx)(t.code,{children:"file.StartAddress.EndAddress.DataSectionObject.filename.dat"}),"."]}),"\n",(0,i.jsx)(t.p,{children:"Note the differences between ImageSectionObject and DataSectionObject."}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Feature"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"ImageSectionObject"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"DataSectionObject"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Purpose"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Mapped executable image"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Mapped data"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Typical content"}),(0,i.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,i.jsx)(t.code,{children:".exe"}),", ",(0,i.jsx)(t.code,{children:".dll"}),", injected PE files"]}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Configs, logs, unpacked payloads"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Executable?"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Usually no"})]})]})]}),"\n",(0,i.jsx)(t.h3,{id:"what-to-look-for",children:"What to Look For"}),"\n",(0,i.jsx)(t.p,{children:"Depending on the process, the number of files dumped from a process can be large. You should filter for specific extensions depending on the context of the process. For example:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["If you dump the Microsoft Word process, searching for macro-enabled files with the extension ",(0,i.jsx)(t.code,{children:".docm"}),", ",(0,i.jsx)(t.code,{children:".dotm"}),", or ",(0,i.jsx)(t.code,{children:".dotx"})," is interesting. Attackers often use these kinds of files to execute Visual Basic code and download the next stage of the attack. MITRE classifies this as ",(0,i.jsx)(t.a,{href:"https://attack.mitre.org/techniques/T1059/005/",children:"T1059.005 \u2013 Command and Scripting Interpreter: Visual Basic"})]}),"\n",(0,i.jsxs)(t.li,{children:["If you have a suspiciously named process, look for a ",(0,i.jsx)(t.code,{children:".exe"})," and a ",(0,i.jsx)(t.code,{children:".dat"})," file. Use the strings command to quickly check for any malicious indicators like suspicious function names, URLs, IPs, system commands, and more"]}),"\n",(0,i.jsxs)(t.li,{children:["If you dump a PDF reader process, look for .pdf files. Use the strings command to check for any malicious indicators like included JavaScript quickly. MITRE classifies this as ",(0,i.jsx)(t.a,{href:"https://attack.mitre.org/techniques/T1059/007/",children:"T1059.007 \u2013 Command and Scripting Interpreter: JavaScript"})]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["The process 5252 is the Windows Word process. Look for ",(0,i.jsx)(t.code,{children:".docm"})," or ",(0,i.jsx)(t.code,{children:".dotm"})," files and note your findings. Note: All the dumped files have the extension ",(0,i.jsx)(t.code,{children:".img"})," appended. You can verify the type of the file by using the file command."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",metastring:'title="Find Macro Files"',children:'ubuntu@tryhackme:~$ ls 5252 | grep -E ".docm|.dotm" -i\nfile.0x990b2ae077d0.0x990b2a3f5d70.SharedCacheMap.Normal.dotm.vacb\nfile.0x990b2ae077d0.0x990b2b916cd0.DataSectionObject.Normal.dotm.dat\nfile.0x990b2ae0ab60.0x990b28043a00.SharedCacheMap.cv-resume-test.docm.vacb\nfile.0x990b2ae0ab60.0x990b2a8b4b30.DataSectionObject.cv-resume-test.docm.dat\n                \nubuntu@tryhackme:~$ file 5252/file.0x990b2ae077d0.0x990b2b916cd0.DataSectionObject.Normal.dotm.dat      \n5252/file.0x990b2ae077d0.0x990b2b916cd0.DataSectionObject.Normal.dotm.dat: Microsoft Word 2007+\n'})}),"\n",(0,i.jsxs)(t.p,{children:["Continue with the other processes and focus on finding ",(0,i.jsx)(t.code,{children:".exe"})," and ",(0,i.jsx)(t.code,{children:".dat"})," files. You can skip the processes ",(0,i.jsx)(t.code,{children:"cmd.exe"}),", ",(0,i.jsx)(t.code,{children:"conhost.exe"}),", and ",(0,i.jsx)(t.code,{children:"PowerShell.exe"}),". These processes will be analyzed in the next rooms. You can use the following ",(0,i.jsx)(t.code,{children:"grep"})," command to filter for ",(0,i.jsx)(t.code,{children:".exe"})," and ",(0,i.jsx)(t.code,{children:".dat"})," files."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",metastring:'title="Find Executables"',children:'ubuntu@tryhackme:~$ ls 3392 10084 10032 | grep -E ".exe|.dat" -i\nfile.0x990b2ae26720.0x990b286fa140.ImageSectionObject.updater.exe.img\nfile.0x990b2846e310.0x990b282f5b70.DataSectionObject.cversions.2.db.dat\nfile.0x990b2ae16230.0x990b29ad0270.ImageSectionObject.windows-update.exe.img\nfile.0x990b2ae16230.0x990b2b92ce90.DataSectionObject.windows-update.exe.dat\nfile.0x990b2ae0ee90.0x990b2a466010.ImageSectionObject.pdfupdater.exe.img\nfile.0x990b2ae0ee90.0x990b2b91f290.DataSectionObject.pdfupdater.exe.dat\n'})}),"\n",(0,i.jsx)(t.p,{children:"Take note of all the files you find and update your findings."}),"\n",(0,i.jsx)(t.h3,{id:"analysis-notes-and-next-steps-3",children:"Analysis Notes and Next Steps"}),"\n",(0,i.jsx)(t.p,{children:"You have analyzed the suspicious processes in more detail and uncovered multiple things:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["The paths of the ",(0,i.jsx)(t.code,{children:"updater.exe"}),", ",(0,i.jsx)(t.code,{children:"pdfupdater.exe"}),", and ",(0,i.jsx)(t.code,{children:"windows-update.exe"})," are suspicious. All of them start in user folders"]}),"\n",(0,i.jsxs)(t.li,{children:["The ",(0,i.jsx)(t.code,{children:"WINWORD.EXE"})," process dump included two macro-enabled word files named ",(0,i.jsx)(t.code,{children:"cv-resume-test.docm"})," and ",(0,i.jsx)(t.code,{children:"normal.dotm"}),". These could be malicious files and need to be analyzed further"]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["You also extracted the executables of the ",(0,i.jsx)(t.code,{children:"updater.exe"}),", ",(0,i.jsx)(t.code,{children:"pdfupdater.exe"}),", and ",(0,i.jsx)(t.code,{children:"windows-update.exe"})," processes. The malware analyst needs to analyze these executables further.\nThe table below lists the findings."]}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"PID"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"PIDD"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Timestamp"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Path"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Files - Executables"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"5252"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"5672"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:13:04.000000"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"C:\\Program Files (x86)\\Microsoft Office\\Root\\Office16\\WINWORD.EXE"}),(0,i.jsxs)(t.td,{style:{textAlign:"left"},children:["file.0x990b2ae0ab60.0x990b2a8b4b30.DataSectionObject.cv-resume-test.docm.dat",(0,i.jsx)("br",{}),"file.0x990b2ae077d0.0x990b2b916cd0.DataSectionObject.Normal.dotm.dat"]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"3392"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"5252"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:13:05.000000"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"C:\\Users\\operator\\pdfupdater.exe"}),(0,i.jsxs)(t.td,{style:{textAlign:"left"},children:["file.0x990b2ae0ee90.0x990b2a466010.ImageSectionObject.pdfupdater.exe.img",(0,i.jsx)("br",{}),"file.0x990b2ae0ee90.0x990b2b91f290.DataSectionObject.pdfupdater.exe.dat"]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2576"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"3392"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:13:05.000000"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"??\\C:\\Windows\\system32\\conhost.exe"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"/"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"10084"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"3392"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:13:05.000000"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"C:\\Users\\operator\\AppData\\Roaming\\Microsoft\\Windows\\StartMenu\\Programs\\Startup\\windows-update.exe"}),(0,i.jsxs)(t.td,{style:{textAlign:"left"},children:["file.0x990b2ae16230.0x990b29ad0270.ImageSectionObject.windows-update.exe.img",(0,i.jsx)("br",{}),"file.0x990b2ae16230.0x990b2b92ce90.DataSectionObject.windows-update.exe.dat"]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"10032"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"10084"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:13:56.000000"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:'"C:\\Users\\operator\\Downloads\\updater.exe"'}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"file.0x990b2ae26720.0x990b286fa140.ImageSectionObject.updater.exe.img"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"432"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"10032"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:14:36.000000"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"C:\\Windows\\system32\\cmd.exe"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"/"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"4592"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"432"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:14:36.000000"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"??\\C:\\Windows\\system32\\conhost.exe"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"/"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"6984"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"432"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:14:39.000000"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"powershell"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"/"})]})]})]}),"\n",(0,i.jsx)(t.p,{children:"Now that you have uncovered multiple indicators that point toward an attack, you need to hand the extracted artifacts to the malware analyst and/or threat hunter for further inspection."}),"\n",(0,i.jsxs)(t.admonition,{title:"Answer the questions below",type:"info",children:[(0,i.jsxs)(n,{children:[(0,i.jsx)("summary",{children:" What is the path of the process with PID 7788? "}),(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-plaintext",children:"C:\\Program Files\\AccessData\\FTK Imager\\FTK Imager.exe\n"})})]}),(0,i.jsxs)(n,{children:[(0,i.jsx)("summary",{children:" Dump the process with PID 7788. What is the name of the dumped file that represents the executable? "}),(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-plaintext",children:"file.0x990b2ae1ed40.0x990b29954a20.ImageSectionObject.FTK Imager.exe.img\n"})})]})]}),"\n",(0,i.jsx)(t.h2,{id:"task-8-putting-it-all-together",children:"Task 8 Putting It All Together"}),"\n",(0,i.jsx)(t.p,{children:"While analyzing the memory dump, you have uncovered possible indicators of compromise. Although, some of these indicators need to be analyzed further to be certain. With the artifacts gathered and observations made, it is possible to recreate a part of the kill chain. The table below shows all the gathered information."}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"PID"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"PIDD"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Timestamp"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Path"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Files - Executables"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"5252"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"5672"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:13:04.000000"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"C:\\Program Files (x86)\\Microsoft Office\\Root\\Office16\\WINWORD.EXE"}),(0,i.jsxs)(t.td,{style:{textAlign:"left"},children:["file.0x990b2ae0ab60.0x990b2a8b4b30.DataSectionObject.cv-resume-test.docm.dat",(0,i.jsx)("br",{}),"file.0x990b2ae077d0.0x990b2b916cd0.DataSectionObject.Normal.dotm.dat"]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"3392"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"5252"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:13:05.000000"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"C:\\Users\\operator\\pdfupdater.exe"}),(0,i.jsxs)(t.td,{style:{textAlign:"left"},children:["file.0x990b2ae0ee90.0x990b2a466010.ImageSectionObject.pdfupdater.exe.img",(0,i.jsx)("br",{}),"file.0x990b2ae0ee90.0x990b2b91f290.DataSectionObject.pdfupdater.exe.dat"]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2576"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"3392"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:13:05.000000"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"??\\C:\\Windows\\system32\\conhost.exe"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"/"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"10084"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"3392"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:13:05.000000"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"C:\\Users\\operator\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\windows-update.exe"}),(0,i.jsxs)(t.td,{style:{textAlign:"left"},children:["file.0x990b2ae16230.0x990b29ad0270.ImageSectionObject.windows-update.exe.img",(0,i.jsx)("br",{}),"file.0x990b2ae16230.0x990b2b92ce90.DataSectionObject.windows-update.exe.dat"]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"10032"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"10084"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:13:56.000000"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"C:\\Users\\operator\\Downloads\\updater.exe"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"file.0x990b2ae26720.0x990b286fa140.ImageSectionObject.updater.exe.img"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"432"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"10032"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:14:36.000000"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"C:\\Windows\\system32\\cmd.exe"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"/"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"4592"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"432"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:14:36.000000"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"??\\C:\\Windows\\system32\\conhost.exe"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"/"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"6984"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"432"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"2025-05-07 07:14:39.000000"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"powershell"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"/"})]})]})]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Attack Chain Based on The Collected Information",src:s(9762).A+"",width:"1427",height:"797"})}),"\n",(0,i.jsx)(t.h3,{id:"initial-access",children:"Initial Access"}),"\n",(0,i.jsxs)(t.p,{children:["Now, you can only speculate about the attacker's technique to get into the system. Based on the artifacts you have gathered, it is likely that the attacker employed the technique ",(0,i.jsx)(t.a,{href:"https://attack.mitre.org/techniques/T1566/",children:"T1566 Phishing"})," to get a malicious macro-enabled Word document onto the system. This needs to be confirmed by analyzing the user's activity on the system."]}),"\n",(0,i.jsx)(t.h3,{id:"execution",children:"Execution"}),"\n",(0,i.jsxs)(t.p,{children:["The first indicator of compromise starts with the ",(0,i.jsx)(t.code,{children:"WINWORD.exe"})," process opening a macro-enabled Word file named ",(0,i.jsx)(t.code,{children:"cv-resume-test.docm"})," or ",(0,i.jsx)(t.code,{children:"normal.dotm"}),". MITRE categorizes this technique as ",(0,i.jsx)(t.a,{href:"https://attack.mitre.org/techniques/T1059/005/",children:"T1059.005 Command and Scripting Interpreter: Visual Basic"})]}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"cv-resume-text.docm"})," or ",(0,i.jsx)(t.code,{children:"normal.dotm"})," file likely downloads and launches a second-stage malware named ",(0,i.jsx)(t.code,{children:"pdfupdater.exe"}),". Further analysis of the macro files should confirm this."]}),"\n",(0,i.jsx)(t.h3,{id:"persistence",children:"Persistence"}),"\n",(0,i.jsxs)(t.p,{children:["The malware pdfupdater.exe then likely downloads another stage, ",(0,i.jsx)(t.code,{children:"windows-update.exe"}),", which starts from the ",(0,i.jsx)(t.code,{children:"C:\\Users\\operator\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\windows-update.exe"})," path. This path typically houses processes or links to processes that start when the OS is loaded. This could be an indicator of persistence. MITRE categorizes this as ",(0,i.jsx)(t.a,{href:"https://attack.mitre.org/techniques/T1037/005",children:"Boot or Logon Initialization Scripts: Startup Items"}),"."]}),"\n",(0,i.jsx)(t.h3,{id:"command-and-control",children:"Command and Control"}),"\n",(0,i.jsxs)(t.p,{children:["The observation that the ",(0,i.jsx)(t.code,{children:"windows-update.exe"})," executable is likely persistent could indicate that it serves as a C2 client or reverse shell. Further analysis of this executable should shed some light on its functions."]}),"\n",(0,i.jsx)(t.h3,{id:"attack-phases-not-accounted-for",children:"Attack Phases Not Accounted For"}),"\n",(0,i.jsxs)(t.p,{children:["You already have uncovered multiple phases in the kill chain, but there is still one executable that you couldn't place in any of the above phases. For now, you can only speculate about what the updater.exe process does. An educated guess would be that because it originates from the likely C2 process ",(0,i.jsx)(t.code,{children:"windows-update.exe"}),", it likely will include MITRE tactics like ",(0,i.jsx)(t.a,{href:"https://attack.mitre.org/tactics/TA0010",children:"Exfiltration"}),", ",(0,i.jsx)(t.a,{href:"https://attack.mitre.org/tactics/TA0040",children:"Impact"}),", ",(0,i.jsx)(t.a,{href:"https://attack.mitre.org/tactics/TA0007",children:"Discovery"}),", or ",(0,i.jsx)(t.a,{href:"https://attack.mitre.org/tactics/TA0008",children:"Lateral Movement"}),". Analysis of the executable should bring more clarity on its functions."]}),"\n",(0,i.jsx)(t.h3,{id:"whats-next",children:"What's Next"}),"\n",(0,i.jsx)(t.p,{children:"You have uncovered multiple artifacts that need further analysis. You should collect these artifacts, hash them, and then pass them to the threat hunter or malware analyst."}),"\n",(0,i.jsxs)(t.admonition,{title:"Answer the questions below",type:"info",children:[(0,i.jsxs)(n,{children:[(0,i.jsx)("summary",{children:" What is the name of the likely compromised user? "}),(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-plaintext",children:"operator\n"})})]}),(0,i.jsxs)(n,{children:[(0,i.jsx)("summary",{children:" What is the ID assigned to the MITRE Tactic Command and Control? "}),(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-plaintext",children:"TA0011\n"})})]})]}),"\n",(0,i.jsx)(t.h2,{id:"task-9-conclusion",children:"Task 9 Conclusion"}),"\n",(0,i.jsx)(t.p,{children:"This room was the first in a series of three that dives into analyzing a memory dump. You went through a real-life scenario and analyzed a memory dump with a focus on extracting processes and their information. You uncovered a potential attack chain and multiple suspicious artifacts."}),"\n",(0,i.jsx)(t.p,{children:"Analyzing processes is only the beginning. The next steps are analyzing user and network activity."}),"\n",(0,i.jsx)(t.admonition,{title:"Answer the questions below",type:"info",children:(0,i.jsxs)(n,{children:[(0,i.jsx)("summary",{children:" I am ready to apply my newly obtained skills! "}),(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-plaintext",children:"No answer needed\n"})})]})})]})}function h(e={}){const{wrapper:t}={...(0,l.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},6499:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image_20251246-204639-82c61acd9b7749a61b5552357e23b636.png"},8453:(e,t,s)=>{s.d(t,{R:()=>r,x:()=>o});var n=s(6540);const i={},l=n.createContext(i);function r(e){const t=n.useContext(l);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),n.createElement(l.Provider,{value:t},e.children)}},9762:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/image_20251234-213428-bd8fc0511e9363b2d42f53bef43d0868.png"}}]);