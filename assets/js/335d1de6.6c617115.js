"use strict";(self.webpackChunktryhackme_cn=self.webpackChunktryhackme_cn||[]).push([[9088],{2387:(e,i,n)=>{n.d(i,{A:()=>t});const t=n.p+"assets/images/image_20251214-231442-dbad4cbff310260e5f6ba80e4330f849.png"},2710:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"Modules/Attacking LLMs/modelpoisoning","title":"Data Integrity & Model Poisoning","description":"Task 1 Introduction","source":"@site/docs/Modules/Attacking LLMs/modelpoisoning.md","sourceDirName":"Modules/Attacking LLMs","slug":"/Modules/Attacking LLMs/modelpoisoning","permalink":"/TryHackMe-CN/docs/Modules/Attacking LLMs/modelpoisoning","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/TryHackMe-CN/tree/main/packages/create-docusaurus/templates/shared/docs/Modules/Attacking LLMs/modelpoisoning.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"\u5927\u578b\u8bed\u8a00\u6a21\u578b\u8f93\u51fa\u5904\u7406\u4e0e\u9690\u79c1\u98ce\u9669","permalink":"/TryHackMe-CN/docs/Modules/Attacking LLMs/outputhandlingandprivacyrisks"},"next":{"title":"\u547d\u4ee4\u884c","permalink":"/TryHackMe-CN/docs/Modules/Command Line/"}}');var s=n(4848),a=n(8453);const r={sidebar_position:2},o="Data Integrity & Model Poisoning",l={},d=[{value:"Task 1 Introduction",id:"task-1-introduction",level:2},{value:"Learning Objectives",id:"learning-objectives",level:3},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Task 2 Supply Chain Attack",id:"task-2-supply-chain-attack",level:2},{value:"How It Occurs",id:"how-it-occurs",level:3},{value:"Major Real-World Cases",id:"major-real-world-cases",level:3},{value:"Common Examples",id:"common-examples",level:3},{value:"Task 3 Model Poisoning",id:"task-3-model-poisoning",level:2},{value:"Prerequisite of Model Poisoning",id:"prerequisite-of-model-poisoning",level:3},{value:"Cheat Sheet for Pentesters",id:"cheat-sheet-for-pentesters",level:3},{value:"Attack Process",id:"attack-process",level:3},{value:"Task 4 Model Poisoning - Challenge",id:"task-4-model-poisoning---challenge",level:2},{value:"Task 5 Mitigation Measures",id:"task-5-mitigation-measures",level:2},{value:"Task 6 Conclusion",id:"task-6-conclusion",level:2}];function c(e){const i={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components},{Details:t}=i;return t||function(e,i){throw new Error("Expected "+(i?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.header,{children:(0,s.jsx)(i.h1,{id:"data-integrity--model-poisoning",children:"Data Integrity & Model Poisoning"})}),"\n",(0,s.jsx)(i.h2,{id:"task-1-introduction",children:"Task 1 Introduction"}),"\n",(0,s.jsx)(i.p,{children:"Modern AI systems depend heavily on the quality and trustworthiness of their data and model components. When attackers compromise training data or model parameters, they can inject hidden vulnerabilities, manipulate predictions, or bias outputs. In this room, you'll explore how these attacks work and how to detect and mitigate them using practical techniques."}),"\n",(0,s.jsx)(i.h3,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Understand how compromised datasets or model components can lead to security risks."}),"\n",(0,s.jsx)(i.li,{children:"Examine common ways adversaries use to introduce malicious inputs during training or fine-tuning."}),"\n",(0,s.jsx)(i.li,{children:"Assess vulnerabilities in externally sourced datasets, pre-trained models, and third-party libraries."}),"\n",(0,s.jsx)(i.li,{children:"Practice model poisoning through the eyes of an attacker."}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsx)(i.p,{children:"Data integrity and model poisoning are specialised threats within the broader field of machine learning security. To get the most out of this room, you should have a foundational understanding of how machine learning models are trained and deployed, as well as the basics of data preprocessing and model evaluation. Additionally, you should be familiar with general security principles related to supply chain and input validation."}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"https://tryhackme.com/room/aimlsecuritythreats",children:"AI/ML Security Threats"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"https://tryhackme.com/room/idadversarialattacks",children:"Detecting Adversarial Attacks"})}),"\n"]}),"\n",(0,s.jsx)(i.admonition,{title:"Answer the questions below",type:"info",children:(0,s.jsxs)(t,{children:[(0,s.jsx)("summary",{children:" I have successfully started the machine. "}),(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-plaintext",children:"No answer needed\n"})})]})}),"\n",(0,s.jsx)(i.h2,{id:"task-2-supply-chain-attack",children:"Task 2 Supply Chain Attack"}),"\n",(0,s.jsxs)(i.p,{children:["In this task, we will explore how attackers exploit the supply chain (termed LLM03 in the ",(0,s.jsx)(i.a,{href:"https://genai.owasp.org/llmrisk/llm032025-supply-chain/",children:"OWASP GenAI Security Project"}),") to attack LLMs. In the context of LLM, the supply chain refers to all the external components, datasets, model weights, adapters, libraries, and infrastructure that go into training, fine-tuning, or deploying an LLM. Because many of these pieces come from third parties or open-source repositories, they create a broad attack surface where malicious actors can tamper with inputs long before a model reaches production."]}),"\n",(0,s.jsx)(i.h3,{id:"how-it-occurs",children:"How It Occurs"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:'Attackers tamper with or "poison" external components used by LLM systems like pre-trained model weights, fine-tuning adapters, datasets, or third-party libraries.'}),"\n",(0,s.jsx)(i.li,{children:"Weak provenance (e.g., poor source documentation and lack of integrity verification) makes detection harder. Attackers can disguise malicious components so that they pass standard benchmarks yet introduce hidden backdoors."}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"An image of an AI response being poisoned through an untrusted data source",src:n(5949).A+"",width:"818",height:"572"})}),"\n",(0,s.jsx)(i.h3,{id:"major-real-world-cases",children:"Major Real-World Cases"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"PoisonGPT / GPT-J-6B Compromised Version"}),": Researchers modified an open-source model (GPT-J-6B) to include misinformation behaviour (spread fake news) while keeping it performing well on standard benchmarks. The malicious version was uploaded to Hugging Face under a name meant to look like a trusted one (typosquatting/impersonation). The modified model passed many common evaluation benchmarks almost identically to the unmodified one, so detection via standard evaluation was nearly impossible."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.a,{href:"https://arxiv.org/abs/2401.15883",children:"Backdooring Pre-trained Models with Embedding Indistinguishability"}),": In this academic work, adversaries embed backdoors into pre-trained models, allowing downstream tasks to inherit the malicious behaviour. These backdoors are designed so that the poisoned embeddings are nearly indistinguishable from clean ones before and after fine-tuning. The experiment successfully triggered the backdoor under various conditions, highlighting how supply chain poisoning in the model weights can propagate."]}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"common-examples",children:"Common Examples"}),"\n",(0,s.jsxs)(i.table,{children:[(0,s.jsx)(i.thead,{children:(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.th,{style:{textAlign:"left"},children:"Threat Type"}),(0,s.jsx)(i.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsxs)(i.tbody,{children:[(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{style:{textAlign:"left"},children:"Vulnerable or outdated packages/libraries"}),(0,s.jsx)(i.td,{style:{textAlign:"left"},children:"Using old versions of ML frameworks, data pipelines, or dependencies with known vulnerabilities can allow attackers to gain entry or inject malicious behaviour. E.g., a compromised PyTorch or TensorFlow component used in fine-tuning or data preprocessing."})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{style:{textAlign:"left"},children:"Malicious pre-trained models or adapters"}),(0,s.jsx)(i.td,{style:{textAlign:"left"},children:"A provider or attacker publishes a model or adapter that appears legitimate, but includes hidden malicious behaviour or bias. When downstream users use them without verifying integrity, they inherit the threat."})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{style:{textAlign:"left"},children:"Stealthy backdoor/trigger insertion"}),(0,s.jsx)(i.td,{style:{textAlign:"left"},children:'The insertion of triggers that only activate under certain conditions, remaining dormant otherwise, so they evade regular testing. For example, "hidden triggers" in model parameters or in embeddings, which only manifest when a specific token or pattern is used.'})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{style:{textAlign:"left"},children:"Collaborative/merged models"}),(0,s.jsx)(i.td,{style:{textAlign:"left"},children:"Components may come from different sources, with models being merged (from multiple contributors) or using shared pipelines. Attackers may target weak links (e.g. a library or adapter) in the pipeline to introduce malicious code or backdoors."})]})]})]}),"\n",(0,s.jsxs)(i.admonition,{title:"Answer the questions below",type:"info",children:[(0,s.jsxs)(t,{children:[(0,s.jsx)("summary",{children:" What is the name of the website where the malicious version of GPT-J-6B was uploaded? "}),(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-plaintext",children:"Hugging Face\n"})})]}),(0,s.jsxs)(t,{children:[(0,s.jsxs)("summary",{children:[" What term refers to all the ",(0,s.jsx)(i.strong,{children:"external"})," components, datasets, model weights, adapters, libraries, and infrastructure used to train, fine-tune, or deploy an LLM? "]}),(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-plaintext",children:"Supply Chain\n"})})]})]}),"\n",(0,s.jsx)(i.h2,{id:"task-3-model-poisoning",children:"Task 3 Model Poisoning"}),"\n",(0,s.jsx)(i.p,{children:"Model poisoning is an adversarial technique where attackers deliberately inject malicious or manipulated data during a model\u2019s training or retraining cycle. The goal is to bias the model\u2019s behaviour, degrade its performance, or embed hidden backdoors that can be triggered later. Unlike prompt injection, this targets the model weights, making the compromise persistent."}),"\n",(0,s.jsx)(i.h3,{id:"prerequisite-of-model-poisoning",children:"Prerequisite of Model Poisoning"}),"\n",(0,s.jsx)(i.p,{children:"Model poisoning isn\u2019t possible on every system. It specifically affects models that accept user input as part of their continuous learning or fine-tuning pipeline. For example, recommender systems, chatbots, or any adaptive model that automatically re-train on user feedback or submitted content. Static, fully offline models (where training is frozen and never updated from external inputs) are generally not vulnerable. For an attack to succeed, the model must adhere to the following:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Incorporate untrusted user data into its training corpus."}),"\n",(0,s.jsx)(i.li,{children:"Lack rigorous data validation."}),"\n",(0,s.jsx)(i.li,{children:"Redeploy updated weights without strong integrity checks."}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"cheat-sheet-for-pentesters",children:"Cheat Sheet for Pentesters"}),"\n",(0,s.jsx)(i.p,{children:"Here is the checklist for red teamers and pentesters when assessing model poisoning risks:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Data ingestion pipeline"}),": Does the LLM or system retrain on unverified user inputs, feedback, or uploaded content?"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Update frequency"}),": How often is the model fine-tuned or updated?"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Data provenance and sanitisation"}),": Can training data sources be traced, and are they validated against poisoning attempts?"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Access controls"}),": Who can submit data included in re-training, and is that channel exposed to untrusted users?"]}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"image of LLM attack cycle",src:n(2387).A+"",width:"1090",height:"765"})}),"\n",(0,s.jsx)(i.h3,{id:"attack-process",children:"Attack Process"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Where"}),": Poisoning can occur at different stages, during pre-training (large-scale dataset poisoning), fine-tuning (targeted task manipulation), or continual learning (live re-training from user data)."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"How"}),": The attacker seeds malicious examples into the training set, waits for the re-training cycle, and leverages the altered model behaviour for backdoors."]}),"\n"]}),"\n",(0,s.jsx)(i.admonition,{title:"Answer the questions below",type:"info",children:(0,s.jsxs)(t,{children:[(0,s.jsx)("summary",{children:" An adversarial technique where attackers deliberately inject malicious or manipulated data during a model\u2019s training is called? "}),(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-plaintext",children:"Model poisoning\n"})})]})}),"\n",(0,s.jsx)(i.h2,{id:"task-4-model-poisoning---challenge",children:"Task 4 Model Poisoning - Challenge"}),"\n",(0,s.jsx)(i.h2,{id:"task-5-mitigation-measures",children:"Task 5 Mitigation Measures"}),"\n",(0,s.jsx)(i.h2,{id:"task-6-conclusion",children:"Task 6 Conclusion"})]})}function h(e={}){const{wrapper:i}={...(0,a.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},5949:(e,i,n)=>{n.d(i,{A:()=>t});const t=n.p+"assets/images/image_20251202-230237-c84d24a728b5062dc1b824abdb684244.png"},8453:(e,i,n)=>{n.d(i,{R:()=>r,x:()=>o});var t=n(6540);const s={},a=t.createContext(s);function r(e){const i=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function o(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),t.createElement(a.Provider,{value:i},e.children)}}}]);