<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Modules/Memory Analysis/windowsmemoryandprocs" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Windows Memory &amp; Processes | TryHackMe-CN</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryandprocs"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="zh"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Windows Memory &amp; Processes | TryHackMe-CN"><meta data-rh="true" name="description" content="Task 1 Introduction"><meta data-rh="true" property="og:description" content="Task 1 Introduction"><link data-rh="true" rel="icon" href="/TryHackMe-CN/en/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryandprocs"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryandprocs" hreflang="en"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryandprocs" hreflang="zh"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryandprocs" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Modules","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/docs/Modules/"},{"@type":"ListItem","position":2,"name":"Memory Analysis","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/docs/Modules/Memory Analysis/"},{"@type":"ListItem","position":3,"name":"Windows Memory & Processes","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryandprocs"}]}</script><link rel="alternate" type="application/rss+xml" href="/TryHackMe-CN/en/blog/rss.xml" title="TryHackMe-CN RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/TryHackMe-CN/en/blog/atom.xml" title="TryHackMe-CN Atom Feed"><link rel="stylesheet" href="/TryHackMe-CN/en/assets/css/styles.6c4c8a38.css">
<script src="/TryHackMe-CN/en/assets/js/runtime~main.e8036b43.js" defer="defer"></script>
<script src="/TryHackMe-CN/en/assets/js/main.72a18b18.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/TryHackMe-CN/en/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/TryHackMe-CN/en/"><div class="navbar__logo"><img src="/TryHackMe-CN/en/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/TryHackMe-CN/en/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">TryHackMe-CN</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/TryHackMe-CN/en/docs/Modules/">Tutorial</a><a class="navbar__item navbar__link" href="/TryHackMe-CN/en/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryandprocs" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryandprocs" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh">简体中文</a></li></ul></div><a href="https://github.com/TryHackMyOffsecBox/TryHackMe-CN" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/TryHackMe-CN/en/docs/Modules/"><span title="Modules" class="categoryLinkLabel_W154">Modules</span></a><button aria-label="Collapse sidebar category &#x27;Modules&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Attacking LLMs/"><span title="Attacking LLMs" class="categoryLinkLabel_W154">Attacking LLMs</span></a><button aria-label="Expand sidebar category &#x27;Attacking LLMs&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Command Line/"><span title="Command Line" class="categoryLinkLabel_W154">Command Line</span></a><button aria-label="Expand sidebar category &#x27;Command Line&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Container Security/"><span title="Container Security" class="categoryLinkLabel_W154">Container Security</span></a><button aria-label="Expand sidebar category &#x27;Container Security&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Host Evasions/"><span title="Host Evasions" class="categoryLinkLabel_W154">Host Evasions</span></a><button aria-label="Expand sidebar category &#x27;Host Evasions&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/"><span title="Memory Analysis" class="categoryLinkLabel_W154">Memory Analysis</span></a><button aria-label="Collapse sidebar category &#x27;Memory Analysis&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/memoryanalysisintroduction"><span title="Memory Analysis Introduction" class="linkLabel_WmDU">Memory Analysis Introduction</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/memoryacquisition"><span title="Memory Acquisition" class="linkLabel_WmDU">Memory Acquisition</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/volatilityessentials"><span title="Volatility Essentials" class="linkLabel_WmDU">Volatility Essentials</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryandprocs"><span title="Windows Memory &amp; Processes" class="linkLabel_WmDU">Windows Memory &amp; Processes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryanduseractivity"><span title="Windows Memory &amp; User Activity" class="linkLabel_WmDU">Windows Memory &amp; User Activity</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Microsoft Defender XDR/"><span title="Microsoft Defender XDR" class="categoryLinkLabel_W154">Microsoft Defender XDR</span></a><button aria-label="Expand sidebar category &#x27;Microsoft Defender XDR&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Starters/"><span title="Starters" class="categoryLinkLabel_W154">Starters</span></a><button aria-label="Expand sidebar category &#x27;Starters&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/TryHackMe-CN/en/docs/Networks/"><span title="Networks" class="categoryLinkLabel_W154">Networks</span></a><button aria-label="Expand sidebar category &#x27;Networks&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/TryHackMe-CN/en/docs/"><span title="index" class="linkLabel_WmDU">index</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/TryHackMe-CN/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/TryHackMe-CN/en/docs/Modules/"><span>Modules</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/"><span>Memory Analysis</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Windows Memory &amp; Processes</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Windows Memory &amp; Processes</h1></header>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-1-introduction">Task 1 Introduction<a href="#task-1-introduction" class="hash-link" aria-label="Direct link to Task 1 Introduction" title="Direct link to Task 1 Introduction" translate="no">​</a></h2>
<p>Knowing how to analyze memory is an essential skill for a forensic analyst. Attackers often run their malware completely in memory without leaving any traces on the storage. Analyzing memory is slightly more complex than storage and requires a structured approach. Luckily, tools like Volatility and Redline can help extract information from memory. These tools don&#x27;t automate the whole process of memory analysis. It is still up to the forensic analyst to extract the correct information and link it together.</p>
<p>This room is the first in a set of three. It will guide you through analyzing a full memory dump of a Windows host and extracting information from its processes. If the host is indeed compromised, you will need to piece together the scope of the attack and the attack chain.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="learning-objectives">Learning Objectives<a href="#learning-objectives" class="hash-link" aria-label="Direct link to Learning Objectives" title="Direct link to Learning Objectives" translate="no">​</a></h3>
<ul>
<li class="">Extract processes and process information from a memory dump using Volatility</li>
<li class="">Analyze the extracted information</li>
<li class="">Report findings</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="room-prerequisites">Room Prerequisites<a href="#room-prerequisites" class="hash-link" aria-label="Direct link to Room Prerequisites" title="Direct link to Room Prerequisites" translate="no">​</a></h3>
<ul>
<li class=""><a href="https://tryhackme.com/room/volatility" target="_blank" rel="noopener noreferrer" class="">Volatility</a></li>
<li class=""><a href="https://tryhackme.com/module/windows-fundamentals" target="_blank" rel="noopener noreferrer" class="">Windows Fundamentals</a> module</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Answer the questions below</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Ready to start analyzing your first memory dump? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-2-scenario-information">Task 2 Scenario Information<a href="#task-2-scenario-information" class="hash-link" aria-label="Direct link to Task 2 Scenario Information" title="Direct link to Task 2 Scenario Information" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="scenario">Scenario<a href="#scenario" class="hash-link" aria-label="Direct link to Scenario" title="Direct link to Scenario" translate="no">​</a></h3>
<p>You are part of the incident response team handling an incident at TryHatMe - a company that exclusively sells hats online. You are tasked with analyzing a full memory dump of a potentially compromised Windows host. Before you, another analyst had already taken a full memory dump and gathered all the necessary information from the TryHatMe IT support team. You are a bit nervous since this is your first case, but don&#x27;t worry; a senior analyst will guide you.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="information-incident-thm-0001">Information Incident THM-0001<a href="#information-incident-thm-0001" class="hash-link" aria-label="Direct link to Information Incident THM-0001" title="Direct link to Information Incident THM-0001" translate="no">​</a></h3>
<ul>
<li class="">On May 5th, 2025, at 07:30 CET, TryHatMe initiated its incident response plan and escalated the incident to us. After an initial triage, our team found a Windows host that was potentially compromised. The details of the host are as follows:<!-- -->
<ul>
<li class="">Hostname: WIN-001</li>
<li class="">OS: Windows 1022H 10.0.19045</li>
</ul>
</li>
<li class="">At 07:45 CET, our analyst Steve Stevenson took a full memory dump of the Windows host and made a hash to ensure its integrity. The memory dump details are:<!-- -->
<ul>
<li class="">Name: <code>THM-WIN-001_071528_07052025.dmp</code></li>
<li class="">MD5-hash: <code>78535fc49ab54fed57919255709ae650</code></li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="company-information-tryhatme">Company Information TryHatMe<a href="#company-information-tryhatme" class="hash-link" aria-label="Direct link to Company Information TryHatMe" title="Direct link to Company Information TryHatMe" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="network-map">Network Map<a href="#network-map" class="hash-link" aria-label="Direct link to Network Map" title="Direct link to Network Map" translate="no">​</a></h4>
<p><img decoding="async" loading="lazy" alt="Network Map of the TryHatMe Company" src="/TryHackMe-CN/en/assets/images/image_20251242-204239-c8d815645075f11212bd6abd4a0ffb55.png" width="5084" height="3320" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Answer the questions below</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> I went through the case details and am ready to find out more. </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-3-windows-process-architecture">Task 3 Windows Process Architecture<a href="#task-3-windows-process-architecture" class="hash-link" aria-label="Direct link to Task 3 Windows Process Architecture" title="Direct link to Task 3 Windows Process Architecture" translate="no">​</a></h2>
<p>You might wonder where to start analyzing the memory dump. Let&#x27;s start with a high-level overview of the key structures of processes on a Windows host. These structures are essential to understand where tools like <code>volatility</code> extract their information.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="windows-processes-and-threads">Windows Processes and Threads<a href="#windows-processes-and-threads" class="hash-link" aria-label="Direct link to Windows Processes and Threads" title="Direct link to Windows Processes and Threads" translate="no">​</a></h3>
<p>There are four structures that Windows uses to create and manage processes:</p>
<ul>
<li class=""><strong>EPROCESS</strong> is the representation of a process in the <strong>kernel</strong></li>
<li class=""><strong>ETHREAD</strong> is the representation of a thread in the <strong>kernel</strong></li>
<li class=""><strong>Process Environment Block (PEB)</strong> holds the process-wide configuration and runtime data and is located in the <strong>user space</strong></li>
<li class=""><strong>Thread Environment Block (TEB)</strong> holds the thread-specific configuration and other information, including Thread Local Storage (TLS), exception handling data, and information about the stack, and is located in the <strong>user space</strong></li>
</ul>
<p><img decoding="async" loading="lazy" alt="Windows Process Architecture" src="/TryHackMe-CN/en/assets/images/image_20251244-204438-f2432b45a752ba846120ec37ef7a81f5.png" width="1261" height="289" class="img_ev3q"></p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="how-do-these-structures-relate">How Do These Structures Relate?<a href="#how-do-these-structures-relate" class="hash-link" aria-label="Direct link to How Do These Structures Relate?" title="Direct link to How Do These Structures Relate?" translate="no">​</a></h4>
<p>When Windows creates a process, it executes the function <code>CreateProcess()</code>. This function initiates the process start-up and consists of the following steps:</p>
<p><img decoding="async" loading="lazy" alt="Flowchart of Windows Process Creation" src="/TryHackMe-CN/en/assets/images/image_20251246-204639-82c61acd9b7749a61b5552357e23b636.png" width="305" height="959" class="img_ev3q"></p>
<ol>
<li class="">The kernel creates an EPROCESS and ETHREAD object and links them together. EPROCESS has a field called <code>ThreadListHead</code> that keeps track of all its threads</li>
<li class="">The virtual memory is initialized:<!-- -->
<ul>
<li class="">The process is assigned a virtual address space (in user mode)
The image (EXE) is mapped into memory
Space is allocated for the PEB and TEB
Process parameters are created</li>
</ul>
</li>
<li class="">The PEB and TEB are initialized.<!-- -->
<ul>
<li class="">EPROCESS includes a pointer to the PEB</li>
<li class="">ETHREAD includes a pointer to the TEB</li>
<li class="">TEB includes a redundant pointer to the PEB</li>
</ul>
</li>
<li class="">The thread context is set but remains suspended. This thread context includes:<!-- -->
<ul>
<li class="">Start address of the program</li>
<li class="">Stack pointer</li>
<li class="">Instruction pointer</li>
</ul>
</li>
<li class="">The process is created but is still suspended</li>
<li class="">The primary thread of the process is resumed. This is the actual start of the process</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="what-information-can-you-extract-from-these-structures">What Information Can You Extract From These Structures?<a href="#what-information-can-you-extract-from-these-structures" class="hash-link" aria-label="Direct link to What Information Can You Extract From These Structures?" title="Direct link to What Information Can You Extract From These Structures?" translate="no">​</a></h3>
<p>Tools like <code>volatility</code> understand a process&#x27;s architecture and can extract and relate data from these structures. Specific <code>volatility</code> modules will target certain fields of these structures. Below, you can find an overview of interesting fields for each structure. <strong>Note: Only the relevant fields are listed for each structure. The other fields have been omitted.</strong></p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="eprocess">EPROCESS<a href="#eprocess" class="hash-link" aria-label="Direct link to EPROCESS" title="Direct link to EPROCESS" translate="no">​</a></h4>
<p>The following <code>volatility</code> plugins extract information from EPROCESS: <code>pslist</code>, <code>pstree</code>, <code>psscan</code>, <code>malfind</code>, <code>getsids</code>, <code>handles</code>, <code>dlllist</code>, <code>cmdline</code>, <code>envars</code> and <code>ldrmodules</code>. In the terminal below, you can find the fields these modules target:</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">EPROCESS STRUCTURE</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">_EPROCESS</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HANDLE UniqueProcessId</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// PID (Process ID) </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LIST_ENTRY ActiveProcessLinks</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Link in active process list (Used to keep track of all active processes) </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UCHAR ImageFileName</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Short process name LARGE_INTEGER CreateTime; // Process creation time </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LARGE_INTEGER ExitTime</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Exit time if terminated </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PPEB Peb</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Pointer to user-mode PEB </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HANDLE InheritedFromUniqueProcessId</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Parent PID </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LIST_ENTRY ThreadListHead</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// List of ETHREADs </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PHANDLE_TABLE ObjectTable</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Handle table (points to opened files) </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID SectionObject</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Executable image mapping </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID VadRoot</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// VAD tree for memory mapping PACCESS_TOKEN Token; // Security information </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="ethread">ETHREAD<a href="#ethread" class="hash-link" aria-label="Direct link to ETHREAD" title="Direct link to ETHREAD" translate="no">​</a></h4>
<p>The following <code>volatility</code> plugins extract information from ETHREAD: <code>threads</code>, <code>ldrmodules</code>, <code>apihooks</code> and <code>malfind</code>. In the terminal below, you can find the fields these modules target:</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">THREAD STRUCTURE</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">_ETHREAD</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CLIENT_ID Cid</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Thread and Process IDs </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LARGE_INTEGER CreateTime</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Thread creation time </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LARGE_INTEGER ExitTime</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Thread exit time </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID StartAddress</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Kernel-level entry point </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID Win32StartAddress</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// User-mode entry point </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LIST_ENTRY ThreadListEntry</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Link in EPROCESS&#x27;s thread list </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PTEB Teb</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Pointer to TEB </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ULONG ThreadState</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Thread execution state </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ULONG WaitReason</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Reason for being blocked </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="peb">PEB<a href="#peb" class="hash-link" aria-label="Direct link to PEB" title="Direct link to PEB" translate="no">​</a></h4>
<p>The following <code>volatility</code> plugins extract information from the Process Environment Block: <code>cmdline</code>, <code>envars</code>, <code>ldrmodules</code> and <code>malfind</code>. In the terminal below, you can find the fields these modules target:</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">PEB STRUCTURE</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">_PEB</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BOOLEAN BeingDebugged</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Debug flag</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID ImageBaseAddress</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Base address of executable </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PPEB_LDR_DATA Ldr</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Loader data (DLLs) </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PRTL_USER_PROCESS_PARAMETERS ProcessParameters</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">// Command-line, environment variables</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ULONG NtGlobalFlag</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Debugging heap flags </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID ProcessHeap</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Default process heap </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="teb">TEB<a href="#teb" class="hash-link" aria-label="Direct link to TEB" title="Direct link to TEB" translate="no">​</a></h4>
<p>The following <code>volatility</code> plugins extract information from the Thread Environment Block: <code>threads</code> and <code>malfind</code>. In the terminal below, you can find the fields these modules target:</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">TEB STRUCTURE</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">_TEB</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID EnvironmentPointer</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Pointer to env block </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CLIENT_ID ClientId</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Thread + Process IDs </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID ThreadLocalStoragePointer</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// TLS base </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PPEB ProcessEnvironmentBlock</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Pointer to PEB </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ULONG LastErrorValue</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Last error value </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID StackBase</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Upper bound of thread stack </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID StackLimit</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Lower bound of thread stack </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID Win32ThreadInfo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// GUI subsystem data </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Answer the questions below</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What field is used to keep track of all the active processes? Only enter the fields&#x27; name. </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ActiveProcessLinks</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What field is used to store the PID of a process? Only enter the fields&#x27; name. </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">UniqueProcessId</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-4-initial-triage-of-a-new-memory-dump">Task 4 Initial Triage of a New Memory Dump<a href="#task-4-initial-triage-of-a-new-memory-dump" class="hash-link" aria-label="Direct link to Task 4 Initial Triage of a New Memory Dump" title="Direct link to Task 4 Initial Triage of a New Memory Dump" translate="no">​</a></h2>
<p>You refreshed your knowledge of Windows memory and processes in the previous task. You are ready to tackle the fun challenge of analyzing the provided memory dump. During this task, you will start up the analysis VM and verify the hash of the memory dump. Then, you will continue extracting the processes in the memory dump using <code>volatility</code>. After that, you will analyze the results and look for suspicious processes. Last, you will note down your findings.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="environment-and-setup">Environment and Setup<a href="#environment-and-setup" class="hash-link" aria-label="Direct link to Environment and Setup" title="Direct link to Environment and Setup" translate="no">​</a></h3>
<p>During your investigation, you will use an Ubuntu Desktop host with the memory analysis tool <code>volatility</code> version 3. We have assigned the alias <code>vol3</code> to the full command (python3 vol.py) to start <code>volatility</code>. Start the VM now by clicking the <code>Start Machine</code> button at the top of this task. The VM will start in split view. In case it’s not showing up, you can press the <code>Show Split View</code> button at the top of the page.</p>
<p>The default installation of Ubuntu Desktop comes with command-line utilities that supplement <code>volatility</code> and allow you to parse the analysis results in additional detail. These tools include <code>strings</code>, <code>diff</code>, <code>grep</code>, <code>comm</code>, <code>awk</code>, and more.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="verifying-the-memory-dump">Verifying the Memory Dump<a href="#verifying-the-memory-dump" class="hash-link" aria-label="Direct link to Verifying the Memory Dump" title="Direct link to Verifying the Memory Dump" translate="no">​</a></h3>
<p>Open a shell on the analysis VM and navigate to <code>/home/ubuntu</code>. Then use the <code>md5sum</code> command to calculate the MD5 hash of the memory dump. <strong>Note: You don&#x27;t need to enter the command. We have already pre-calculated the hash for you. Due to restrained resources it could take up to five minutes to calculate an MD5 hash.</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Calculate MD5 Hash</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ md5sum THM-WIN-001_071528_07052025.mem </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> newhash.txt</span><br></span></code></pre></div></div>
<p>Then, compare the newly calculated hash with the hash that you received from your colleague who did the memory acquisition:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Compare Hashes</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">diff</span><span class="token plain"> acquisitionhash.txt newhash.txt</span><br></span></code></pre></div></div>
<p>If the above command shows no output, the hashes are the same. Now that you have verified the integrity of the memory dump, you can proceed with extracting its content.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="extract-processes">Extract Processes<a href="#extract-processes" class="hash-link" aria-label="Direct link to Extract Processes" title="Direct link to Extract Processes" translate="no">​</a></h3>
<p><code>volatility</code> comes with multiple modules that can help you extract processes and their information:</p>
<ul>
<li class=""><code>windows.pslist</code>: extract a list of the <strong>active processes at the time of the memory dump</strong></li>
<li class=""><code>windows.psscan</code>: extract <strong>all process objects</strong>, including terminated and unlinked processes</li>
<li class=""><code>windows.pstree</code>: extracts a list of the <strong>active processes at the time of the memory dump</strong> and visualizes the parent-child relationships between them</li>
<li class=""><code>windows.psxview</code>: uses multiple process detection techniques to gather information about processes, threads, process structures, and handles, then cross-reference and compare this information.</li>
</ul>
<p>Navigate to the VM and open a terminal. Now, enter the commands below to extract the active processes from the memory dump and save them in a text file. <strong>Note: Due to size of the memory dump and limited resources, it can take up to a minute until the command finishes running.</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Extract Processes</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ vol3 </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> THM-WIN-001_071528_07052025.mem windows.pslist </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> pslist.txt</span><br></span></code></pre></div></div>
<p>Now, use <code>cat</code> to display the content of <code>pslist.txt</code> and analyze the output. Here is a tip: pipe the output to the command <code>less</code> to get a scrollable output. You can then <strong>press space to scroll through the output</strong>. You can press <code>q</code> to exit.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Display Extracted Processes</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> pslist.txt </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">less</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> Framework </span><span class="token number" style="color:#36acaa">2.26</span><span class="token plain">.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PID </span><span class="token environment constant" style="color:#36acaa">PPID</span><span class="token plain"> ImageFileName Offset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">V</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> Threads Handles SessionId Wow64 CreateTime ExitTime File output</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">   System         0x990b2366a040 </span><span class="token number" style="color:#36acaa">138</span><span class="token plain"> - N/A False </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:48.000000 UTC N/A Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">92</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">   Registry       0x990b236dc080 </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> - N/A False </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:44.000000 UTC N/A Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">324</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">   smss.exe       0x990b2680e040 </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> - N/A False </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:48.000000 UTC N/A Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">440</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">420</span><span class="token plain"> csrss.exe      0x990b26cf0140 </span><span class="token number" style="color:#36acaa">12</span><span class="token plain"> - </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> False </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:48.000000 UTC N/A Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">516</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">508</span><span class="token plain"> csrss.exe      0x990b274bd080 </span><span class="token number" style="color:#36acaa">13</span><span class="token plain"> - </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> False </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:48.000000 UTC N/A Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">524</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">420</span><span class="token plain"> wininit.exe    0x990b2758a140 </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> - </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> False </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:48.000000 UTC N/A Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">592</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">508</span><span class="token plain"> winlogon.exe   0x990b275c00c0 </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> - </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> False </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:48.000000 UTC N/A Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED FOR READABILITY</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="finding-a-needle-in-a-haystack">Finding a Needle in a Haystack<a href="#finding-a-needle-in-a-haystack" class="hash-link" aria-label="Direct link to Finding a Needle in a Haystack" title="Direct link to Finding a Needle in a Haystack" translate="no">​</a></h3>
<p>You are looking for suspicious processes that match one of the indicators below:</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="suspicious-name">Suspicious Name<a href="#suspicious-name" class="hash-link" aria-label="Direct link to Suspicious Name" title="Direct link to Suspicious Name" translate="no">​</a></h4>
<p>Attackers like to use typosquatting to masquerade as a legitimate process. For example:</p>
<ul>
<li class=""><code>scvhost.exe</code> instead of <code>svchost.exe</code></li>
<li class=""><code>explorere.exe</code> instead of <code>explorer.exe</code></li>
<li class=""><code>lsasss.exe</code> instead of <code>lsass.exe</code></li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="suspicious-path">Suspicious Path<a href="#suspicious-path" class="hash-link" aria-label="Direct link to Suspicious Path" title="Direct link to Suspicious Path" translate="no">​</a></h4>
<p>Attackers will use process names identical to legitimate processes, but the processes are located in an unusual path. For example:</p>
<ul>
<li class=""><code>svchost.exe</code> starting from <code>C:\Users\analyst\</code> instead of <code>C:\Windows\System32\</code></li>
<li class=""><code>cmd.exe</code> starting from <code>C:\TMP\</code> instead of <code>C:\Windows\System32\</code></li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="masquerading">Masquerading<a href="#masquerading" class="hash-link" aria-label="Direct link to Masquerading" title="Direct link to Masquerading" translate="no">​</a></h4>
<p>Attackers will use process names that mimic processes and system services. For example:</p>
<ul>
<li class=""><code>dockerupdater.exe</code></li>
<li class=""><code>defenderAV.exe</code></li>
<li class=""><code>pdfupdateservice.exe</code></li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="comparing-with-a-baseline">Comparing With a Baseline<a href="#comparing-with-a-baseline" class="hash-link" aria-label="Direct link to Comparing With a Baseline" title="Direct link to Comparing With a Baseline" translate="no">​</a></h3>
<p>It is sometimes difficult to distinguish between legitimate and malicious processes. The process list in the previous paragraph is luckily not so extensive, but if it were, you could use the following method to narrow down the number of processes to go through:</p>
<ul>
<li class="">Ensure you have a baseline of the processes that run on a host in normal circumstances. For example, during regular business hours</li>
<li class="">Compare the <code>windows.pslist</code> output with the baseline to get a shortlist of processes that were not included in the baseline</li>
<li class="">Filter the processes by comparing them to a shortlist of common processes that run when updating software. You can check the task scheduler to find these processes</li>
<li class="">Investigate the leftover processes</li>
</ul>
<p>Continue with the VM and enter the following commands to compare the <code>pslist.txt</code> file to the <code>baseline.txt</code> file located in <code>~\baseline\</code> (Note: the baseline file was extracted from the Task Manager, so you need to prepare it first):</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Comparing with Baseline</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">awk</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;NR &gt;3{print $2}&#x27;</span><span class="token plain"> baseline/baseline.txt </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sort</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">uniq</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> baseline_procs.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">awk</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;NR &gt;3{print $3}&#x27;</span><span class="token plain"> pslist.txt </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sort</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">uniq</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> current_procs.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">comm</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-13</span><span class="token plain"> baseline_procs.txt current_procs.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED FOR READABILITY</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WINWORD.EXE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ai.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">audiodg.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cmd.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fontdrvhost.ex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msdtc.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pdfupdater.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">smartscreen.ex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sppsvc.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">updater.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">userinit.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vm3dservice.ex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vmtoolsd.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">windows-update</span><br></span></code></pre></div></div>
<p>The first two lines including <code>awk</code> in the terminal above prepare the files to be compared:</p>
<ul>
<li class=""><code>awk &#x27;NR &gt;3{print $2}&#x27;</code> divides the files content in columns excluding the first 3 lines and then prints the n-th column as output</li>
<li class=""><code>sort</code> sorts the values that were passed along from the <code>awk</code> command</li>
<li class=""><code>uniq &gt; *.txt</code> filters out duplicates and then saves the data to a text file</li>
</ul>
<p>The <code>comm</code> command compares the content of each prepared file and outputs the difference. The flags <code>-13</code> are set so only the processes unique to <code>current_procs.txt</code> are displayed.</p>
<p>The results listed in the terminal above need to be interpreted first. Some of the processes included are false positives. These are, for example:</p>
<ul>
<li class="">Legitimate processes that were not running at the time of capturing the baseline</li>
<li class="">Processes where the <code>ImageFileName</code> field was too long and was truncated. This field can only accommodate 16 bytes.</li>
</ul>
<p>Knowing which processes are false positives requires some additional research. The processes below have made it onto your shortlist:</p>
<ul>
<li class=""><code>pdfupdater.exe</code></li>
<li class=""><code>windows-update.exe</code></li>
<li class=""><code>updater.exe</code></li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="analysis-notes-and-next-steps">Analysis Notes and Next Steps<a href="#analysis-notes-and-next-steps" class="hash-link" aria-label="Direct link to Analysis Notes and Next Steps" title="Direct link to Analysis Notes and Next Steps" translate="no">​</a></h3>
<p>You have found three suspicious processes that require further analysis. The table below gives an overview of these suspicious processes.</p>
<table><thead><tr><th style="text-align:left">ImageFileName</th><th style="text-align:left">PID</th><th style="text-align:left">Timestamp</th></tr></thead><tbody><tr><td style="text-align:left">pdfupdater.exe</td><td style="text-align:left">3392</td><td style="text-align:left">2025-05-07 07:13:05.000000</td></tr><tr><td style="text-align:left">windows-update.exe</td><td style="text-align:left">10084</td><td style="text-align:left">2025-05-07 07:13:05.000000</td></tr><tr><td style="text-align:left">updater.exe</td><td style="text-align:left">10032</td><td style="text-align:left">2025-05-07 07:13:56.000000</td></tr></tbody></table>
<p>Continue to the next task and see if these processes are linked to each other or other processes. This might help you uncover other processes that were not initially suspicious but are now suspicious within a new context.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Answer the questions below</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the PID of the csrss.exe process that has 12 threads? You can use the <code>pslist.txt</code> file to find the answer. </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">440</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the (memory) Offset(V) of the process with PID 5672? You can use the <code>pslist.txt</code> file to find the answer. </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">0x990b29293080</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-5-linking-processes">Task 5 Linking Processes<a href="#task-5-linking-processes" class="hash-link" aria-label="Direct link to Task 5 Linking Processes" title="Direct link to Task 5 Linking Processes" translate="no">​</a></h2>
<p>In the previous task, you found multiple separate suspicious processes. Before digging deeper into the memory of these processes, you should first uncover if there is any link between these processes and others. This will help you find other potentially suspicious processes. The terminal below shows what a malicious process tree could look like:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">explorer.exe </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">PID: </span><span class="token number" style="color:#36acaa">1500</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── cmd.exe </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">PID: </span><span class="token number" style="color:#36acaa">2200</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                  ← Triggered by malicious LNK </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └── powershell.exe </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">PID: </span><span class="token number" style="color:#36acaa">2210</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">       ← Downloads and executes the payload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        └── svchost.exe </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">PID: </span><span class="token number" style="color:#36acaa">2220</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">      ← Masquerades as a system process</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            └── asyncrat.exe </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">PID: </span><span class="token number" style="color:#36acaa">2230</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> ← Remote Access Trojan </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">C2 beaconing</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>The example above is an attack chain in which asyncrat, a common Remote Access Trojan, was deployed after a user clicked on a malicious LNK file. The LNK file spawns a command line, <code>cmd.exe</code>, which then launches PowerShell to download and execute a payload. PowerShell, in turn, uses svchost.exe to masquerade as a system process and spawns <code>asyncrat.exe</code>.</p>
<p>Continuing with the VM, enter the following command to generate a tree structure that shows the memory dump&#x27;s process parent-child relationships. <strong>Note: Due to size of the memory dump and limited resources, it can take up to a minute until the command finishes running.</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Show Process Tree</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ vol3 </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> THM-WIN-001_071528_07052025.mem windows.pstree </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> processtree.txt</span><br></span></code></pre></div></div>
<p>The output shown with the <code>cat</code> command is quite overwhelming. You can use the <code>cut</code> command to process the <code>processtree.txt</code> file and only display the PID, PIDD, and image name values. Enter the following command to accomplish this:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Parse Process Tree</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">cut</span><span class="token plain"> -d</span><span class="token string" style="color:#e3116c">$&#x27;</span><span class="token string entity" style="color:#36acaa">\t</span><span class="token string" style="color:#e3116c">&#x27;</span><span class="token plain"> -f1,2,3 processtree.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PID             </span><span class="token environment constant" style="color:#36acaa">PPID</span><span class="token plain">    ImageFileName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">592</span><span class="token plain">             </span><span class="token number" style="color:#36acaa">508</span><span class="token plain">     winlogon.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* </span><span class="token number" style="color:#36acaa">5232</span><span class="token plain">          </span><span class="token number" style="color:#36acaa">592</span><span class="token plain">     userinit.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">** </span><span class="token number" style="color:#36acaa">5672</span><span class="token plain">         </span><span class="token number" style="color:#36acaa">5232</span><span class="token plain">    explorer.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*** </span><span class="token number" style="color:#36acaa">5952</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">5672</span><span class="token plain">    cmd.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**** </span><span class="token number" style="color:#36acaa">3144</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">5952</span><span class="token plain">    conhost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*** </span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">5672</span><span class="token plain">    WINWORD.EXE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**** </span><span class="token number" style="color:#36acaa">3392</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    pdfupdater.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">***** </span><span class="token number" style="color:#36acaa">2576</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">3392</span><span class="token plain">    conhost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">***** </span><span class="token number" style="color:#36acaa">10084</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">3392</span><span class="token plain">    windows-update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">****** </span><span class="token number" style="color:#36acaa">10032</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">10084</span><span class="token plain">   updater.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">******* </span><span class="token number" style="color:#36acaa">432</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">10032</span><span class="token plain">   cmd.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">******** </span><span class="token number" style="color:#36acaa">4592</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">432</span><span class="token plain">     conhost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">******** </span><span class="token number" style="color:#36acaa">6984</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">432</span><span class="token plain">     powershell.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**** </span><span class="token number" style="color:#36acaa">3932</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    ai.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*** </span><span class="token number" style="color:#36acaa">8936</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">5672</span><span class="token plain">    SecurityHealth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*** </span><span class="token number" style="color:#36acaa">9096</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">5672</span><span class="token plain">    msedge.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**** </span><span class="token number" style="color:#36acaa">8100</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">9096</span><span class="token plain">    msedge.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**** </span><span class="token number" style="color:#36acaa">9164</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">9096</span><span class="token plain">    msedge.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**** </span><span class="token number" style="color:#36acaa">3500</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">9096</span><span class="token plain">    msedge.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**** </span><span class="token number" style="color:#36acaa">7408</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">9096</span><span class="token plain">    msedge.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**** </span><span class="token number" style="color:#36acaa">9264</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">9096</span><span class="token plain">    msedge.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**** </span><span class="token number" style="color:#36acaa">4152</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">9096</span><span class="token plain">    msedge.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**** </span><span class="token number" style="color:#36acaa">7420</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">9096</span><span class="token plain">    msedge.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<p>The results above have been redacted for readability. The results shown include the processes of interest you discovered in the previous task.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="observations">Observations<a href="#observations" class="hash-link" aria-label="Direct link to Observations" title="Direct link to Observations" translate="no">​</a></h3>
<p>Now locate the processes you noted during task 3 and check if they relate to other processes. Starting from the WINWORD.exe process, you can see a clear tree structure. We converted the tree to an ASCII tree structure to show it more clearly.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PID         </span><span class="token environment constant" style="color:#36acaa">PPID</span><span class="token plain">    IMAGENAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">5672</span><span class="token plain">    WINWORD.EXE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── </span><span class="token number" style="color:#36acaa">3392</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    pdfupdater.exe    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── </span><span class="token number" style="color:#36acaa">2576</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">3392</span><span class="token plain">    conhost.exe    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └── </span><span class="token number" style="color:#36acaa">10084</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">3392</span><span class="token plain">    windows-update        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        └── </span><span class="token number" style="color:#36acaa">10032</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">10084</span><span class="token plain">   updater.exe            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            └── </span><span class="token number" style="color:#36acaa">432</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">10032</span><span class="token plain">   cmd.exe                </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ├── </span><span class="token number" style="color:#36acaa">4592</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">432</span><span class="token plain">     conhost.exe                </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                └── </span><span class="token number" style="color:#36acaa">6984</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">432</span><span class="token plain">     powershell.exe</span><br></span></code></pre></div></div>
<p>Now note down the observations starting from the bottom:</p>
<ul>
<li class="">The process <code>powershell.exe</code> with the PID ... has the PPID ...</li>
<li class="">The process <code>conhost.exe</code> with the PID ... has the PPID ...</li>
<li class="">The process linked to PPID ... is <code>cmd.exe</code> and has the PID ...</li>
<li class="">And so on</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="analysis-notes-and-next-steps-1">Analysis Notes and Next Steps<a href="#analysis-notes-and-next-steps-1" class="hash-link" aria-label="Direct link to Analysis Notes and Next Steps" title="Direct link to Analysis Notes and Next Steps" translate="no">​</a></h3>
<table><thead><tr><th style="text-align:left">ImageFileName</th><th style="text-align:left">PID</th><th style="text-align:left">PPID</th><th style="text-align:left">Timestamp</th></tr></thead><tbody><tr><td style="text-align:left">WINWORD.EXE</td><td style="text-align:left">5252</td><td style="text-align:left">5672</td><td style="text-align:left">2025-05-07 07:13:04.000000</td></tr><tr><td style="text-align:left">pdfupdater.exe</td><td style="text-align:left">3392</td><td style="text-align:left">5252</td><td style="text-align:left">2025-05-07 07:13:05.000000</td></tr><tr><td style="text-align:left">conhost.exe</td><td style="text-align:left">2576</td><td style="text-align:left">3392</td><td style="text-align:left">2025-05-07 07:13:05.000000</td></tr><tr><td style="text-align:left">windows-update.exe</td><td style="text-align:left">10084</td><td style="text-align:left">3392</td><td style="text-align:left">2025-05-07 07:13:05.000000</td></tr><tr><td style="text-align:left">updater.exe</td><td style="text-align:left">10032</td><td style="text-align:left">10084</td><td style="text-align:left">2025-05-07 07:13:56.000000</td></tr><tr><td style="text-align:left">cmd.exe</td><td style="text-align:left">432</td><td style="text-align:left">10032</td><td style="text-align:left">2025-05-07 07:14:36.000000</td></tr><tr><td style="text-align:left">conhost.exe</td><td style="text-align:left">4592</td><td style="text-align:left">432</td><td style="text-align:left">2025-05-07 07:14:36.000000</td></tr><tr><td style="text-align:left">powershell.exe</td><td style="text-align:left">6984</td><td style="text-align:left">432</td><td style="text-align:left">2025-05-07 07:14:39.000000</td></tr></tbody></table>
<p>From the observations (see table above), we can conclude that the <code>updater.exe</code> process is a child process of <code>windows-update.exe</code>, a child process of <code>pdfupdater.exe</code>. The <code>pdfupdater.exe</code> process is a child of <code>WINWORD.exe</code>. This chain of processes seems quite suspicious:</p>
<ul>
<li class="">Multiple of these processes have the name <code>update</code> in them</li>
<li class="">The <code>WINDWORD.exe</code> process launches the <code>pdfupdater.exe</code> process. This would mean that Microsoft Word is updating a tool related to PDF</li>
<li class="">The <code>pdfupdater.exe</code> process then launches the <code>windows-update.exe</code>. It is highly unlikely that a tool that would update one software would also launch the <code>windows-update.exe</code> process to update the Windows OS</li>
<li class="">To top it off, the <code>windows-update.exe</code> process launches the <code>updater.exe</code> process, which seems to hint at yet another update</li>
<li class="">The presence of the <code>conhost.exe</code> process also indicates that these processes seem to initiate a network connection</li>
</ul>
<p>Looking closely at these observations and remarks and comparing them with factual information like how the Windows, PDF tool, and Microsoft Word update process works and their legitimate process names, you can conclude that this chain of processes is highly likely malicious.</p>
<p>Now that you have found a potential malicious chain, you must dig deeper. Proceed to the next task to uncover terminated and hidden processes and analyze the suspicious processes found in this task.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Answer the questions below</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the parentID (PPID) of the services.exe (PID 664) process? Use the processtree.txt file to answer the question. </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">524</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the ImageFileName of the process that has the PID 7788? Use the processtree.txt file to answer the question. </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FTK Imager.exe</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-6-digging-deeper">Task 6 Digging Deeper<a href="#task-6-digging-deeper" class="hash-link" aria-label="Direct link to Task 6 Digging Deeper" title="Direct link to Task 6 Digging Deeper" translate="no">​</a></h2>
<p>Until now, you have focused on uncovering and linking processes that were part of the active memory. <code>volatility</code> can also scan for processes that were recently terminated, unlinked, or hidden by an attacker. Attackers often employ different techniques to hide processes, threads, drivers, and registry keys. You can use the <code>volatitlity</code> modules <code>windows.psscan</code> and <code>windows.psxview</code> to get an overview of all process structures, including those not in the active process links structure.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="psscan">PSSCAN<a href="#psscan" class="hash-link" aria-label="Direct link to PSSCAN" title="Direct link to PSSCAN" translate="no">​</a></h3>
<p>Continuing with the VM, enter the command shown below to scan for processes that were not part of the active processes list. <strong>Note: Due to size of the memory dump and limited resources, it can take up to three minutes until the command finishes running.</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">PSSCAN</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ vol3 </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> THM-WIN-001_071528_07052025.mem windows.psscan </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> psscan.txt</span><br></span></code></pre></div></div>
<p>You can compare the results of <code>psscan</code> with the results of <code>pslist</code> to uncover hidden processes. You first need to prepare the output files before comparing them. Enter the following commands to extract the PID and process name from the <code>psscan.txt</code> and <code>pslist.txt</code> files and save the output to a new file.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Prepare Files</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">awk</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;{print $1,$3}&#x27;</span><span class="token plain"> pslist.txt </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sort</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> pslist_processed.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">awk</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;{print $1,$3}&#x27;</span><span class="token plain"> psscan.txt </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sort</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> psscan_processed.txt</span><br></span></code></pre></div></div>
<p>Then, you can compare both files to uncover hidden processes:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Prepare Files</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">comm</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-23</span><span class="token plain"> psscan_processed.txt pslist_processed.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5548</span><span class="token plain"> sihost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5592</span><span class="token plain"> svchost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5736</span><span class="token plain"> svchost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5748</span><span class="token plain"> svchost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5752</span><span class="token plain"> taskhostw.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5828</span><span class="token plain"> svchost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5908</span><span class="token plain"> svchost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5972</span><span class="token plain"> ctfmon.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">8708</span><span class="token plain"> svchost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">9040</span><span class="token plain"> vmtoolsd.exe</span><br></span></code></pre></div></div>
<p>The results of this comparison are benign. All the listed processes are common processes that run on a Windows host. For example, <code>svchost.exe</code> is a common process that hosts and runs Windows services. There are a few checks you can do to verify that <code>svchost.exe</code> is indeed benign:</p>
<ul>
<li class="">Check the image path: If it is not located in <code>C:\Windows\System32\</code>, it is suspicious</li>
<li class="">Check the DLLs loaded for this process: Attackers can use techniques like process hollowing or DLL injection to compromise a legitimate process</li>
<li class="">Check if the process still has active threads: If it does have active threads but it doesn&#x27;t appear in the <code>pslist</code> results, it is suspicious. It could be that an attacker is hiding the process</li>
<li class="">If an active process does not have any threads, it is considered suspicious. Every active process should have at least 1 thread. Attackers can use techniques to alter the threads</li>
<li class="">Check the <code>Exit Time</code>: If the process really is terminated, it should display an <code>Exit Time</code>. If there are still active or orphaned threads linked to that process, it is suspicious.</li>
<li class="">Dump the process memory and analyze it further</li>
</ul>
<p>You will explore some of these checks later on.
PSXVIEW</p>
<p>Now, run the windows.psxview module. windows.psxview is a great way to do multiple tests in one and cross-reference the results. You should look for the processes that are not listed in the results of pslist but are listed in the other tests. Enter the following command to run the windows.psxview module. Note: Due to size of the memory dump and limited resources, it can take up to three minutes until the command finishes running.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="psxview">PSXVIEW<a href="#psxview" class="hash-link" aria-label="Direct link to PSXVIEW" title="Direct link to PSXVIEW" translate="no">​</a></h3>
<p>Now, run the <code>windows.psxview</code> module. <code>windows.psxview</code> is a great way to do multiple tests in one and cross-reference the results. You should look for the processes that are not listed in the results of <code>pslist</code> but are listed in the other tests. Enter the following command to run the <code>windows.psxview</code> module. <strong>Note: Due to size of the memory dump and limited resources, it can take up to three minutes until the command finishes running.</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">PSXVIEW</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ vol3 </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> THM-WIN-001_071528_07052025.mem windows.psxview </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> psxview.txt</span><br></span></code></pre></div></div>
<p>You can then use <code>awk</code> to filter the results and display all the lines where the <code>pslist</code> test equals false, as shown below:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Filter Results</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">awk</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;NR==3 || $4 == &quot;False&quot;&#x27;</span><span class="token plain"> psxview.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Offset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Virtual</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> Name            PID     pslist  psscan  thrdscan  csrss   Exit Time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xac80001ca080  svchost.exe     </span><span class="token number" style="color:#36acaa">5828</span><span class="token plain">    False   True    False     False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xac8000083080  svchost.exe     </span><span class="token number" style="color:#36acaa">5592</span><span class="token plain">    False   True    False     False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xac80000b90c0  vmtoolsd.exe    </span><span class="token number" style="color:#36acaa">9040</span><span class="token plain">    False   True    False     False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xac8000084080  svchost.exe     </span><span class="token number" style="color:#36acaa">5748</span><span class="token plain">    False   True    False     False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xac80001c6080  svchost.exe     </span><span class="token number" style="color:#36acaa">5908</span><span class="token plain">    False   True    False     False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xac80001d2080  ctfmon.exe      </span><span class="token number" style="color:#36acaa">5972</span><span class="token plain">    False   True    False     False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xac8000030080  svchost.exe     </span><span class="token number" style="color:#36acaa">5736</span><span class="token plain">    False   True    False     False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xac80000a1080  sihost.exe      </span><span class="token number" style="color:#36acaa">5548</span><span class="token plain">    False   True    False     False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x990b29bef080  svchost.exe     </span><span class="token number" style="color:#36acaa">8708</span><span class="token plain">    False   True    False     False   </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:13:16+00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xac8000031080  taskhostw.exe   </span><span class="token number" style="color:#36acaa">5752</span><span class="token plain">    False   True    False     False</span><br></span></code></pre></div></div>
<p>The output in the terminal above doesn&#x27;t show anything obvious that could hint at an attacker hiding a malicious process. However, you can never be 100% sure. If you are still suspicious of the listed processes, apply the same checks listed in the <strong>psscan section</strong>.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="analysis-notes-and-next-steps-2">Analysis Notes and Next Steps<a href="#analysis-notes-and-next-steps-2" class="hash-link" aria-label="Direct link to Analysis Notes and Next Steps" title="Direct link to Analysis Notes and Next Steps" translate="no">​</a></h3>
<p>You did not uncover new processes using the volatility modules <code>psscan</code> and <code>psxview</code>.</p>
<p>In the next task, you will focus on analyzing the processes uncovered in the previous tasks.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Answer the questions below</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the number of processes that have 0 Threads? Use the <code>psscan.txt</code> file to answer the question. </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">3</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the number of processes that have the Exit Time filled in? Use the <code>psxview.txt</code> file to answer the question. </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">3</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-7-dumping-the-process-memory">Task 7 Dumping the Process Memory<a href="#task-7-dumping-the-process-memory" class="hash-link" aria-label="Direct link to Task 7 Dumping the Process Memory" title="Direct link to Task 7 Dumping the Process Memory" translate="no">​</a></h2>
<p>During the previous tasks, you uncovered a potentially malicious chain of processes. From the information gathered, you could only conclude that these processes are linked and that the chain starts from the <code>WINWORD.exe</code> process. You should focus now on extracting information from processes by dumping their memory.</p>
<p><code>volatility</code> includes several modules to assist you with this. The modules <code>windows.dlllist</code> and <code>windows.dumpfiles</code> should help you uncover several indicators of compromise.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="finding-the-path">Finding the Path<a href="#finding-the-path" class="hash-link" aria-label="Direct link to Finding the Path" title="Direct link to Finding the Path" translate="no">​</a></h3>
<p>Using the <code>windows.dlllist</code> module, you can uncover the path of the main executable and its linked DLLs. Continuing with the VM, run the module <code>windows.dlllist</code> on the processes you noted in task 5 ( <code>WINWORD.exe</code>, <code>pdfupdater.exe</code>, <code>updater.exe</code>, <code>windows-update</code>, <code>cmd.exe</code>, <code>conhost.exe</code>, <code>powershell.exe</code>). Enter the following commands to dump the <code>WINWORD.exe</code> process. <strong>Note: Due to size of the memory dump and limited resources, it can take up to two minutes until the command finishes running.</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Check Results</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ vol3 </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> THM-WIN-001_071528_07052025.mem windows.dlllist </span><span class="token parameter variable" style="color:#36acaa">--pid</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5252</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> 5252_dlllist.txt</span><br></span></code></pre></div></div>
<p><strong>Now, do the same for all other processes.</strong> Then, check every file with <code>cat</code>, look for the path of the main executable, and note it down.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Check Results</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> 5252_dlllist.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> Framework </span><span class="token number" style="color:#36acaa">2.26</span><span class="token plain">.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Progress:  </span><span class="token number" style="color:#36acaa">100.00</span><span class="token plain">               PDB scanning finished</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PID   Process Base  Size      Name                  Path                                                               LoadTime                File output</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">  WINWORD.EXE   0x670000  0x1ac000 WINWORD.EXE  C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Program Files </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft Office</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Root</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Office16</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">WINWORD.EXE  </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:13:04.00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED FOR READABILITY</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<p>Now, update the information you already have with the new findings.</p>
<p>The <code>pdfupdater.exe</code>, <code>windows-update.exe</code>, and <code>updater.exe</code> processes seem to start at unusual locations. This information will be helpful when you focus on investigating user activity.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="dump-process-memory">Dump Process Memory<a href="#dump-process-memory" class="hash-link" aria-label="Direct link to Dump Process Memory" title="Direct link to Dump Process Memory" translate="no">​</a></h3>
<p>You have uncovered multiple suspicious processes until now. This suspicion is based on process names, a process tree with multiple update processes, and processes that start from a user path.</p>
<p>You must dump and analyze the processes&#x27; memory to confirm that these processes are malicious. You can then extract the executable and run the strings command to see if any malicious indicators are present quickly. In most cases, you will pass the executable to a malware analyst for further investigation. Below, are the commands to dump the process with PID 5252. Follow the same steps to dump the memory of the other processes; you can exclude the cmd.exe, PowerShell.exe, and conhost.exe processes. Other <code>volatility</code> modules can analyze these processes better. <strong>Note: Due to size of the memory dump and limited resources, it can take up to one minute until the command finishes running.</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Dump Process Memory</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5252</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token builtin class-name">cd</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5252</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~/5252$ vol3 </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">/THM-WIN-001_071528_07052025.mem windows.dumpfiles </span><span class="token parameter variable" style="color:#36acaa">--pid</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5252</span><br></span></code></pre></div></div>
<p>The dumped files all follow the same naming convention: <code>file.StartAddress.EndAddress.ImageSectionObject.filename.img</code> or <code>file.StartAddress.EndAddress.DataSectionObject.filename.dat</code>.</p>
<p>Note the differences between ImageSectionObject and DataSectionObject.</p>
<table><thead><tr><th style="text-align:left">Feature</th><th style="text-align:left">ImageSectionObject</th><th style="text-align:left">DataSectionObject</th></tr></thead><tbody><tr><td style="text-align:left">Purpose</td><td style="text-align:left">Mapped executable image</td><td style="text-align:left">Mapped data</td></tr><tr><td style="text-align:left">Typical content</td><td style="text-align:left"><code>.exe</code>, <code>.dll</code>, injected PE files</td><td style="text-align:left">Configs, logs, unpacked payloads</td></tr><tr><td style="text-align:left">Executable?</td><td style="text-align:left">Yes</td><td style="text-align:left">Usually no</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="what-to-look-for">What to Look For<a href="#what-to-look-for" class="hash-link" aria-label="Direct link to What to Look For" title="Direct link to What to Look For" translate="no">​</a></h3>
<p>Depending on the process, the number of files dumped from a process can be large. You should filter for specific extensions depending on the context of the process. For example:</p>
<ul>
<li class="">If you dump the Microsoft Word process, searching for macro-enabled files with the extension <code>.docm</code>, <code>.dotm</code>, or <code>.dotx</code> is interesting. Attackers often use these kinds of files to execute Visual Basic code and download the next stage of the attack. MITRE classifies this as <a href="https://attack.mitre.org/techniques/T1059/005/" target="_blank" rel="noopener noreferrer" class="">T1059.005 – Command and Scripting Interpreter: Visual Basic</a></li>
<li class="">If you have a suspiciously named process, look for a <code>.exe</code> and a <code>.dat</code> file. Use the strings command to quickly check for any malicious indicators like suspicious function names, URLs, IPs, system commands, and more</li>
<li class="">If you dump a PDF reader process, look for .pdf files. Use the strings command to check for any malicious indicators like included JavaScript quickly. MITRE classifies this as <a href="https://attack.mitre.org/techniques/T1059/007/" target="_blank" rel="noopener noreferrer" class="">T1059.007 – Command and Scripting Interpreter: JavaScript</a></li>
</ul>
<p>The process 5252 is the Windows Word process. Look for <code>.docm</code> or <code>.dotm</code> files and note your findings. Note: All the dumped files have the extension <code>.img</code> appended. You can verify the type of the file by using the file command.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Find Macro Files</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5252</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-E</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;.docm|.dotm&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae077d0.0x990b2a3f5d70.SharedCacheMap.Normal.dotm.vacb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae077d0.0x990b2b916cd0.DataSectionObject.Normal.dotm.dat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae0ab60.0x990b28043a00.SharedCacheMap.cv-resume-test.docm.vacb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae0ab60.0x990b2a8b4b30.DataSectionObject.cv-resume-test.docm.dat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">/file.0x990b2ae077d0.0x990b2b916cd0.DataSectionObject.Normal.dotm.dat      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">/file.0x990b2ae077d0.0x990b2b916cd0.DataSectionObject.Normal.dotm.dat: Microsoft Word </span><span class="token number" style="color:#36acaa">2007</span><span class="token plain">+</span><br></span></code></pre></div></div>
<p>Continue with the other processes and focus on finding <code>.exe</code> and <code>.dat</code> files. You can skip the processes <code>cmd.exe</code>, <code>conhost.exe</code>, and <code>PowerShell.exe</code>. These processes will be analyzed in the next rooms. You can use the following <code>grep</code> command to filter for <code>.exe</code> and <code>.dat</code> files.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Find Executables</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme:~$ </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3392</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10084</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10032</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-E</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;.exe|.dat&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae26720.0x990b286fa140.ImageSectionObject.updater.exe.img</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2846e310.0x990b282f5b70.DataSectionObject.cversions.2.db.dat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae16230.0x990b29ad0270.ImageSectionObject.windows-update.exe.img</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae16230.0x990b2b92ce90.DataSectionObject.windows-update.exe.dat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae0ee90.0x990b2a466010.ImageSectionObject.pdfupdater.exe.img</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae0ee90.0x990b2b91f290.DataSectionObject.pdfupdater.exe.dat</span><br></span></code></pre></div></div>
<p>Take note of all the files you find and update your findings.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="analysis-notes-and-next-steps-3">Analysis Notes and Next Steps<a href="#analysis-notes-and-next-steps-3" class="hash-link" aria-label="Direct link to Analysis Notes and Next Steps" title="Direct link to Analysis Notes and Next Steps" translate="no">​</a></h3>
<p>You have analyzed the suspicious processes in more detail and uncovered multiple things:</p>
<ul>
<li class="">The paths of the <code>updater.exe</code>, <code>pdfupdater.exe</code>, and <code>windows-update.exe</code> are suspicious. All of them start in user folders</li>
<li class="">The <code>WINWORD.EXE</code> process dump included two macro-enabled word files named <code>cv-resume-test.docm</code> and <code>normal.dotm</code>. These could be malicious files and need to be analyzed further</li>
</ul>
<p>You also extracted the executables of the <code>updater.exe</code>, <code>pdfupdater.exe</code>, and <code>windows-update.exe</code> processes. The malware analyst needs to analyze these executables further.
The table below lists the findings.</p>
<table><thead><tr><th style="text-align:left">PID</th><th style="text-align:left">PIDD</th><th style="text-align:left">Timestamp</th><th style="text-align:left">Path</th><th style="text-align:left">Files - Executables</th></tr></thead><tbody><tr><td style="text-align:left">5252</td><td style="text-align:left">5672</td><td style="text-align:left">2025-05-07 07:13:04.000000</td><td style="text-align:left">C:\Program Files (x86)\Microsoft Office\Root\Office16\WINWORD.EXE</td><td style="text-align:left">file.0x990b2ae0ab60.0x990b2a8b4b30.DataSectionObject.cv-resume-test.docm.dat<br>file.0x990b2ae077d0.0x990b2b916cd0.DataSectionObject.Normal.dotm.dat</td></tr><tr><td style="text-align:left">3392</td><td style="text-align:left">5252</td><td style="text-align:left">2025-05-07 07:13:05.000000</td><td style="text-align:left">C:\Users\operator\pdfupdater.exe</td><td style="text-align:left">file.0x990b2ae0ee90.0x990b2a466010.ImageSectionObject.pdfupdater.exe.img<br>file.0x990b2ae0ee90.0x990b2b91f290.DataSectionObject.pdfupdater.exe.dat</td></tr><tr><td style="text-align:left">2576</td><td style="text-align:left">3392</td><td style="text-align:left">2025-05-07 07:13:05.000000</td><td style="text-align:left">??\C:\Windows\system32\conhost.exe</td><td style="text-align:left">/</td></tr><tr><td style="text-align:left">10084</td><td style="text-align:left">3392</td><td style="text-align:left">2025-05-07 07:13:05.000000</td><td style="text-align:left">C:\Users\operator\AppData\Roaming\Microsoft\Windows\StartMenu\Programs\Startup\windows-update.exe</td><td style="text-align:left">file.0x990b2ae16230.0x990b29ad0270.ImageSectionObject.windows-update.exe.img<br>file.0x990b2ae16230.0x990b2b92ce90.DataSectionObject.windows-update.exe.dat</td></tr><tr><td style="text-align:left">10032</td><td style="text-align:left">10084</td><td style="text-align:left">2025-05-07 07:13:56.000000</td><td style="text-align:left">&quot;C:\Users\operator\Downloads\updater.exe&quot;</td><td style="text-align:left">file.0x990b2ae26720.0x990b286fa140.ImageSectionObject.updater.exe.img</td></tr><tr><td style="text-align:left">432</td><td style="text-align:left">10032</td><td style="text-align:left">2025-05-07 07:14:36.000000</td><td style="text-align:left">C:\Windows\system32\cmd.exe</td><td style="text-align:left">/</td></tr><tr><td style="text-align:left">4592</td><td style="text-align:left">432</td><td style="text-align:left">2025-05-07 07:14:36.000000</td><td style="text-align:left">??\C:\Windows\system32\conhost.exe</td><td style="text-align:left">/</td></tr><tr><td style="text-align:left">6984</td><td style="text-align:left">432</td><td style="text-align:left">2025-05-07 07:14:39.000000</td><td style="text-align:left">powershell</td><td style="text-align:left">/</td></tr></tbody></table>
<p>Now that you have uncovered multiple indicators that point toward an attack, you need to hand the extracted artifacts to the malware analyst and/or threat hunter for further inspection.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Answer the questions below</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the path of the process with PID 7788? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">C:\Program Files\AccessData\FTK Imager\FTK Imager.exe</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Dump the process with PID 7788. What is the name of the dumped file that represents the executable? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae1ed40.0x990b29954a20.ImageSectionObject.FTK Imager.exe.img</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-8-putting-it-all-together">Task 8 Putting It All Together<a href="#task-8-putting-it-all-together" class="hash-link" aria-label="Direct link to Task 8 Putting It All Together" title="Direct link to Task 8 Putting It All Together" translate="no">​</a></h2>
<p>While analyzing the memory dump, you have uncovered possible indicators of compromise. Although, some of these indicators need to be analyzed further to be certain. With the artifacts gathered and observations made, it is possible to recreate a part of the kill chain. The table below shows all the gathered information.</p>
<table><thead><tr><th style="text-align:left">PID</th><th style="text-align:left">PIDD</th><th style="text-align:left">Timestamp</th><th style="text-align:left">Path</th><th style="text-align:left">Files - Executables</th></tr></thead><tbody><tr><td style="text-align:left">5252</td><td style="text-align:left">5672</td><td style="text-align:left">2025-05-07 07:13:04.000000</td><td style="text-align:left">C:\Program Files (x86)\Microsoft Office\Root\Office16\WINWORD.EXE</td><td style="text-align:left">file.0x990b2ae0ab60.0x990b2a8b4b30.DataSectionObject.cv-resume-test.docm.dat<br>file.0x990b2ae077d0.0x990b2b916cd0.DataSectionObject.Normal.dotm.dat</td></tr><tr><td style="text-align:left">3392</td><td style="text-align:left">5252</td><td style="text-align:left">2025-05-07 07:13:05.000000</td><td style="text-align:left">C:\Users\operator\pdfupdater.exe</td><td style="text-align:left">file.0x990b2ae0ee90.0x990b2a466010.ImageSectionObject.pdfupdater.exe.img<br>file.0x990b2ae0ee90.0x990b2b91f290.DataSectionObject.pdfupdater.exe.dat</td></tr><tr><td style="text-align:left">2576</td><td style="text-align:left">3392</td><td style="text-align:left">2025-05-07 07:13:05.000000</td><td style="text-align:left">??\C:\Windows\system32\conhost.exe</td><td style="text-align:left">/</td></tr><tr><td style="text-align:left">10084</td><td style="text-align:left">3392</td><td style="text-align:left">2025-05-07 07:13:05.000000</td><td style="text-align:left">C:\Users\operator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\windows-update.exe</td><td style="text-align:left">file.0x990b2ae16230.0x990b29ad0270.ImageSectionObject.windows-update.exe.img<br>file.0x990b2ae16230.0x990b2b92ce90.DataSectionObject.windows-update.exe.dat</td></tr><tr><td style="text-align:left">10032</td><td style="text-align:left">10084</td><td style="text-align:left">2025-05-07 07:13:56.000000</td><td style="text-align:left">C:\Users\operator\Downloads\updater.exe</td><td style="text-align:left">file.0x990b2ae26720.0x990b286fa140.ImageSectionObject.updater.exe.img</td></tr><tr><td style="text-align:left">432</td><td style="text-align:left">10032</td><td style="text-align:left">2025-05-07 07:14:36.000000</td><td style="text-align:left">C:\Windows\system32\cmd.exe</td><td style="text-align:left">/</td></tr><tr><td style="text-align:left">4592</td><td style="text-align:left">432</td><td style="text-align:left">2025-05-07 07:14:36.000000</td><td style="text-align:left">??\C:\Windows\system32\conhost.exe</td><td style="text-align:left">/</td></tr><tr><td style="text-align:left">6984</td><td style="text-align:left">432</td><td style="text-align:left">2025-05-07 07:14:39.000000</td><td style="text-align:left">powershell</td><td style="text-align:left">/</td></tr></tbody></table>
<p><img decoding="async" loading="lazy" alt="Attack Chain Based on The Collected Information" src="/TryHackMe-CN/en/assets/images/image_20251234-213428-bd8fc0511e9363b2d42f53bef43d0868.png" width="1427" height="797" class="img_ev3q"></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="initial-access">Initial Access<a href="#initial-access" class="hash-link" aria-label="Direct link to Initial Access" title="Direct link to Initial Access" translate="no">​</a></h3>
<p>Now, you can only speculate about the attacker&#x27;s technique to get into the system. Based on the artifacts you have gathered, it is likely that the attacker employed the technique <a href="https://attack.mitre.org/techniques/T1566/" target="_blank" rel="noopener noreferrer" class="">T1566 Phishing</a> to get a malicious macro-enabled Word document onto the system. This needs to be confirmed by analyzing the user&#x27;s activity on the system.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="execution">Execution<a href="#execution" class="hash-link" aria-label="Direct link to Execution" title="Direct link to Execution" translate="no">​</a></h3>
<p>The first indicator of compromise starts with the <code>WINWORD.exe</code> process opening a macro-enabled Word file named <code>cv-resume-test.docm</code> or <code>normal.dotm</code>. MITRE categorizes this technique as <a href="https://attack.mitre.org/techniques/T1059/005/" target="_blank" rel="noopener noreferrer" class="">T1059.005 Command and Scripting Interpreter: Visual Basic</a></p>
<p>The <code>cv-resume-text.docm</code> or <code>normal.dotm</code> file likely downloads and launches a second-stage malware named <code>pdfupdater.exe</code>. Further analysis of the macro files should confirm this.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="persistence">Persistence<a href="#persistence" class="hash-link" aria-label="Direct link to Persistence" title="Direct link to Persistence" translate="no">​</a></h3>
<p>The malware pdfupdater.exe then likely downloads another stage, <code>windows-update.exe</code>, which starts from the <code>C:\Users\operator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\windows-update.exe</code> path. This path typically houses processes or links to processes that start when the OS is loaded. This could be an indicator of persistence. MITRE categorizes this as <a href="https://attack.mitre.org/techniques/T1037/005" target="_blank" rel="noopener noreferrer" class="">Boot or Logon Initialization Scripts: Startup Items</a>.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="command-and-control">Command and Control<a href="#command-and-control" class="hash-link" aria-label="Direct link to Command and Control" title="Direct link to Command and Control" translate="no">​</a></h3>
<p>The observation that the <code>windows-update.exe</code> executable is likely persistent could indicate that it serves as a C2 client or reverse shell. Further analysis of this executable should shed some light on its functions.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="attack-phases-not-accounted-for">Attack Phases Not Accounted For<a href="#attack-phases-not-accounted-for" class="hash-link" aria-label="Direct link to Attack Phases Not Accounted For" title="Direct link to Attack Phases Not Accounted For" translate="no">​</a></h3>
<p>You already have uncovered multiple phases in the kill chain, but there is still one executable that you couldn&#x27;t place in any of the above phases. For now, you can only speculate about what the updater.exe process does. An educated guess would be that because it originates from the likely C2 process <code>windows-update.exe</code>, it likely will include MITRE tactics like <a href="https://attack.mitre.org/tactics/TA0010" target="_blank" rel="noopener noreferrer" class="">Exfiltration</a>, <a href="https://attack.mitre.org/tactics/TA0040" target="_blank" rel="noopener noreferrer" class="">Impact</a>, <a href="https://attack.mitre.org/tactics/TA0007" target="_blank" rel="noopener noreferrer" class="">Discovery</a>, or <a href="https://attack.mitre.org/tactics/TA0008" target="_blank" rel="noopener noreferrer" class="">Lateral Movement</a>. Analysis of the executable should bring more clarity on its functions.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="whats-next">What&#x27;s Next<a href="#whats-next" class="hash-link" aria-label="Direct link to What&#x27;s Next" title="Direct link to What&#x27;s Next" translate="no">​</a></h3>
<p>You have uncovered multiple artifacts that need further analysis. You should collect these artifacts, hash them, and then pass them to the threat hunter or malware analyst.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Answer the questions below</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the name of the likely compromised user? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">operator</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the ID assigned to the MITRE Tactic Command and Control? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">TA0011</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-9-conclusion">Task 9 Conclusion<a href="#task-9-conclusion" class="hash-link" aria-label="Direct link to Task 9 Conclusion" title="Direct link to Task 9 Conclusion" translate="no">​</a></h2>
<p>This room was the first in a series of three that dives into analyzing a memory dump. You went through a real-life scenario and analyzed a memory dump with a focus on extracting processes and their information. You uncovered a potential attack chain and multiple suspicious artifacts.</p>
<p>Analyzing processes is only the beginning. The next steps are analyzing user and network activity.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Answer the questions below</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> I am ready to apply my newly obtained skills! </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/TryHackMyOffsecBox/TryHackMe-CN/tree/main/packages/create-docusaurus/templates/shared/docs/Modules/Memory Analysis/windowsmemoryandprocs.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/volatilityessentials"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Volatility Essentials</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryanduseractivity"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Windows Memory &amp; User Activity</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#task-1-introduction" class="table-of-contents__link toc-highlight">Task 1 Introduction</a><ul><li><a href="#learning-objectives" class="table-of-contents__link toc-highlight">Learning Objectives</a></li><li><a href="#room-prerequisites" class="table-of-contents__link toc-highlight">Room Prerequisites</a></li></ul></li><li><a href="#task-2-scenario-information" class="table-of-contents__link toc-highlight">Task 2 Scenario Information</a><ul><li><a href="#scenario" class="table-of-contents__link toc-highlight">Scenario</a></li><li><a href="#information-incident-thm-0001" class="table-of-contents__link toc-highlight">Information Incident THM-0001</a></li><li><a href="#company-information-tryhatme" class="table-of-contents__link toc-highlight">Company Information TryHatMe</a></li></ul></li><li><a href="#task-3-windows-process-architecture" class="table-of-contents__link toc-highlight">Task 3 Windows Process Architecture</a><ul><li><a href="#windows-processes-and-threads" class="table-of-contents__link toc-highlight">Windows Processes and Threads</a></li><li><a href="#what-information-can-you-extract-from-these-structures" class="table-of-contents__link toc-highlight">What Information Can You Extract From These Structures?</a></li></ul></li><li><a href="#task-4-initial-triage-of-a-new-memory-dump" class="table-of-contents__link toc-highlight">Task 4 Initial Triage of a New Memory Dump</a><ul><li><a href="#environment-and-setup" class="table-of-contents__link toc-highlight">Environment and Setup</a></li><li><a href="#verifying-the-memory-dump" class="table-of-contents__link toc-highlight">Verifying the Memory Dump</a></li><li><a href="#extract-processes" class="table-of-contents__link toc-highlight">Extract Processes</a></li><li><a href="#finding-a-needle-in-a-haystack" class="table-of-contents__link toc-highlight">Finding a Needle in a Haystack</a></li><li><a href="#comparing-with-a-baseline" class="table-of-contents__link toc-highlight">Comparing With a Baseline</a></li><li><a href="#analysis-notes-and-next-steps" class="table-of-contents__link toc-highlight">Analysis Notes and Next Steps</a></li></ul></li><li><a href="#task-5-linking-processes" class="table-of-contents__link toc-highlight">Task 5 Linking Processes</a><ul><li><a href="#observations" class="table-of-contents__link toc-highlight">Observations</a></li><li><a href="#analysis-notes-and-next-steps-1" class="table-of-contents__link toc-highlight">Analysis Notes and Next Steps</a></li></ul></li><li><a href="#task-6-digging-deeper" class="table-of-contents__link toc-highlight">Task 6 Digging Deeper</a><ul><li><a href="#psscan" class="table-of-contents__link toc-highlight">PSSCAN</a></li><li><a href="#psxview" class="table-of-contents__link toc-highlight">PSXVIEW</a></li><li><a href="#analysis-notes-and-next-steps-2" class="table-of-contents__link toc-highlight">Analysis Notes and Next Steps</a></li></ul></li><li><a href="#task-7-dumping-the-process-memory" class="table-of-contents__link toc-highlight">Task 7 Dumping the Process Memory</a><ul><li><a href="#finding-the-path" class="table-of-contents__link toc-highlight">Finding the Path</a></li><li><a href="#dump-process-memory" class="table-of-contents__link toc-highlight">Dump Process Memory</a></li><li><a href="#what-to-look-for" class="table-of-contents__link toc-highlight">What to Look For</a></li><li><a href="#analysis-notes-and-next-steps-3" class="table-of-contents__link toc-highlight">Analysis Notes and Next Steps</a></li></ul></li><li><a href="#task-8-putting-it-all-together" class="table-of-contents__link toc-highlight">Task 8 Putting It All Together</a><ul><li><a href="#initial-access" class="table-of-contents__link toc-highlight">Initial Access</a></li><li><a href="#execution" class="table-of-contents__link toc-highlight">Execution</a></li><li><a href="#persistence" class="table-of-contents__link toc-highlight">Persistence</a></li><li><a href="#command-and-control" class="table-of-contents__link toc-highlight">Command and Control</a></li><li><a href="#attack-phases-not-accounted-for" class="table-of-contents__link toc-highlight">Attack Phases Not Accounted For</a></li><li><a href="#whats-next" class="table-of-contents__link toc-highlight">What&#39;s Next</a></li></ul></li><li><a href="#task-9-conclusion" class="table-of-contents__link toc-highlight">Task 9 Conclusion</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/TryHackMe-CN/en/docs">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/TryHackMyOffsecBox" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github - TryHackMyOffsecBox<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/CRONUS-Security" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github - CRONUS-Security<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 TryHackMyOffsecBox. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>