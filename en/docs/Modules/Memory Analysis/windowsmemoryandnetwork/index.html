<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Modules/Memory Analysis/windowsmemoryandnetwork" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Windows Memory &amp; Network | TryHackMe-CN</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryandnetwork"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="zh"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Windows Memory &amp; Network | TryHackMe-CN"><meta data-rh="true" name="description" content="Task 1 Introduction"><meta data-rh="true" property="og:description" content="Task 1 Introduction"><link data-rh="true" rel="icon" href="/TryHackMe-CN/en/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryandnetwork"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryandnetwork" hreflang="en"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryandnetwork" hreflang="zh"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryandnetwork" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Modules","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/docs/Modules/"},{"@type":"ListItem","position":2,"name":"Memory Analysis","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/docs/Modules/Memory Analysis/"},{"@type":"ListItem","position":3,"name":"Windows Memory & Network","item":"https://tryhackmyoffsecbox.github.io/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryandnetwork"}]}</script><link rel="alternate" type="application/rss+xml" href="/TryHackMe-CN/en/blog/rss.xml" title="TryHackMe-CN RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/TryHackMe-CN/en/blog/atom.xml" title="TryHackMe-CN Atom Feed"><link rel="stylesheet" href="/TryHackMe-CN/en/assets/css/styles.6c4c8a38.css">
<script src="/TryHackMe-CN/en/assets/js/runtime~main.9ad29c9e.js" defer="defer"></script>
<script src="/TryHackMe-CN/en/assets/js/main.700abd2e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/TryHackMe-CN/en/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/TryHackMe-CN/en/"><div class="navbar__logo"><img src="/TryHackMe-CN/en/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/TryHackMe-CN/en/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">TryHackMe-CN</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/TryHackMe-CN/en/docs/Modules/">Tutorial</a><a class="navbar__item navbar__link" href="/TryHackMe-CN/en/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryandnetwork" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/TryHackMe-CN/docs/Modules/Memory Analysis/windowsmemoryandnetwork" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh">简体中文</a></li></ul></div><a href="https://github.com/TryHackMyOffsecBox/TryHackMe-CN" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/TryHackMe-CN/en/docs/Modules/"><span title="Modules" class="categoryLinkLabel_W154">Modules</span></a><button aria-label="Collapse sidebar category &#x27;Modules&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Attacking LLMs/"><span title="Attacking LLMs" class="categoryLinkLabel_W154">Attacking LLMs</span></a><button aria-label="Expand sidebar category &#x27;Attacking LLMs&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Command Line/"><span title="Command Line" class="categoryLinkLabel_W154">Command Line</span></a><button aria-label="Expand sidebar category &#x27;Command Line&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Container Security/"><span title="Container Security" class="categoryLinkLabel_W154">Container Security</span></a><button aria-label="Expand sidebar category &#x27;Container Security&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Host Evasions/"><span title="Host Evasions" class="categoryLinkLabel_W154">Host Evasions</span></a><button aria-label="Expand sidebar category &#x27;Host Evasions&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/"><span title="Memory Analysis" class="categoryLinkLabel_W154">Memory Analysis</span></a><button aria-label="Collapse sidebar category &#x27;Memory Analysis&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/memoryanalysisintroduction"><span title="Memory Analysis Introduction" class="linkLabel_WmDU">Memory Analysis Introduction</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/memoryacquisition"><span title="Memory Acquisition" class="linkLabel_WmDU">Memory Acquisition</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/volatilityessentials"><span title="Volatility Essentials" class="linkLabel_WmDU">Volatility Essentials</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryandprocs"><span title="Windows Memory &amp; Processes" class="linkLabel_WmDU">Windows Memory &amp; Processes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryanduseractivity"><span title="Windows Memory &amp; User Activity" class="linkLabel_WmDU">Windows Memory &amp; User Activity</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryandnetwork"><span title="Windows Memory &amp; Network" class="linkLabel_WmDU">Windows Memory &amp; Network</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Microsoft Defender XDR/"><span title="Microsoft Defender XDR" class="categoryLinkLabel_W154">Microsoft Defender XDR</span></a><button aria-label="Expand sidebar category &#x27;Microsoft Defender XDR&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/TryHackMe-CN/en/docs/Modules/Starters/"><span title="Starters" class="categoryLinkLabel_W154">Starters</span></a><button aria-label="Expand sidebar category &#x27;Starters&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/TryHackMe-CN/en/docs/Networks/"><span title="Networks" class="categoryLinkLabel_W154">Networks</span></a><button aria-label="Expand sidebar category &#x27;Networks&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/TryHackMe-CN/en/docs/"><span title="index" class="linkLabel_WmDU">index</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/TryHackMe-CN/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/TryHackMe-CN/en/docs/Modules/"><span>Modules</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/"><span>Memory Analysis</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Windows Memory &amp; Network</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Windows Memory &amp; Network</h1></header>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-1-introduction">Task 1 Introduction<a href="#task-1-introduction" class="hash-link" aria-label="Direct link to Task 1 Introduction" title="Direct link to Task 1 Introduction" translate="no">​</a></h2>
<p>This room continues the memory investigation from the previous analysis. This is the last room out of 3, and we will be focusing on how network activity and post-exploitation behavior are captured in RAM. We’ll examine artifacts from a live attack involving advance payloads like Meterpreter, suspicious child processes, and unusual outbound connections. All analyses will be performed using Volatility 3 and hands-on techniques applied directly to the memory dump.</p>
<p>We’ll walk through real indicators tied to remote shells, persistence via startup folder abuse, and malware attempting outbound communications. Users will use memory structures, plugin outputs, and process inspection to track network behavior step by step.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="learning-objectives">Learning Objectives<a href="#learning-objectives" class="hash-link" aria-label="Direct link to Learning Objectives" title="Direct link to Learning Objectives" translate="no">​</a></h3>
<ul>
<li class="">Identify network connections in a memory dump.</li>
<li class="">Identify suspicious ports and remote endpoints.</li>
<li class="">Link connections to processes.</li>
<li class="">Detect reverse shells and memory injections in a memory dump.</li>
<li class="">Trace PowerShell and C2 activity in memory.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites" translate="no">​</a></h3>
<ul>
<li class=""><a href="https://tryhackme.com/room/volatility" target="_blank" rel="noopener noreferrer" class="">Volatility</a></li>
<li class=""><a href="https://tryhackme.com/room/yara" target="_blank" rel="noopener noreferrer" class="">Yara</a></li>
<li class=""><a href="https://tryhackme.com/room/windowsmemoryandprocs" target="_blank" rel="noopener noreferrer" class="">Windows Memory &amp; Processes</a></li>
<li class=""><a href="https://tryhackme.com/room/windowsmemoryanduseractivity" target="_blank" rel="noopener noreferrer" class="">Windows Memory &amp; User Activity</a></li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Answer the questions below</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Click to continue to the room. </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-2-scenario-information">Task 2 Scenario Information<a href="#task-2-scenario-information" class="hash-link" aria-label="Direct link to Task 2 Scenario Information" title="Direct link to Task 2 Scenario Information" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="scenario">Scenario<a href="#scenario" class="hash-link" aria-label="Direct link to Scenario" title="Direct link to Scenario" translate="no">​</a></h3>
<p>You are part of the incident response team handling an incident at TryHatMe - a company that exclusively sells hats online. You are tasked with analyzing a full memory dump of a potentially compromised Windows host. Before you, another analyst had already taken a full memory dump and gathered all the necessary information from the TryHatMe IT support team. You are a bit nervous since this is your first case, but don&#x27;t worry; a senior analyst will guide you.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="information-incident-thm-0001">Information Incident THM-0001<a href="#information-incident-thm-0001" class="hash-link" aria-label="Direct link to Information Incident THM-0001" title="Direct link to Information Incident THM-0001" translate="no">​</a></h3>
<ul>
<li class="">On May 5th, 2025, at 07:30 CET, TryHatMe initiated its incident response plan and escalated the incident to us. After an initial triage, our team found a Windows host that was potentially compromised. The details of the host are as follows:<!-- -->
<ul>
<li class="">Hostname: WIN-001</li>
<li class="">OS: Windows 1022H 10.0.19045</li>
</ul>
</li>
<li class="">At 07:45 CET, our analyst Steve Stevenson took a full memory dump of the Windows host and made a hash to ensure its integrity. The memory dump details are:<!-- -->
<ul>
<li class="">Name: <code>THM-WIN-001_071528_07052025.dmp</code></li>
<li class="">MD5-hash: <code>78535fc49ab54fed57919255709ae650</code></li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="company-information-tryhatme">Company Information TryHatMe<a href="#company-information-tryhatme" class="hash-link" aria-label="Direct link to Company Information TryHatMe" title="Direct link to Company Information TryHatMe" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="network-map">Network Map<a href="#network-map" class="hash-link" aria-label="Direct link to Network Map" title="Direct link to Network Map" translate="no">​</a></h4>
<p><img decoding="async" loading="lazy" alt="Image showing the current scenario as a network diagram with the DMZ internal, User LAN and Server Lan networks  " src="/TryHackMe-CN/en/assets/images/image_20251221-092118-c8d815645075f11212bd6abd4a0ffb55.png" width="5084" height="3320" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Answer the questions below</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> I went through the case details and am ready to find out more. </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-3-environment--setup">Task 3 Environment &amp; Setup<a href="#task-3-environment--setup" class="hash-link" aria-label="Direct link to Task 3 Environment &amp; Setup" title="Direct link to Task 3 Environment &amp; Setup" translate="no">​</a></h2>
<p>Before moving forward, start the VM by clicking the <strong>Start Machine</strong> button on the right.</p>
<p>It will take around 2 minutes to load properly. The VM will be accessible on the right side of the split screen. If the VM is not visible, use the blue <strong>Show Split View</strong> button at the top of the page.</p>
<p>The details for the assignment are:</p>
<ul>
<li class="">File Name: <strong>THM-WIN-001_071528_07052025.mem</strong></li>
<li class="">File MD5 Hash: <strong>78535fc49ab54fed57919255709ae650</strong></li>
<li class="">File Location: <code>/home/ubuntu</code></li>
</ul>
<p>To run volatility, you can use the <code>vol</code> command in the VM. For example: <code>vol -h</code> will display the help menu for volatility.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Answer the questions below</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Click here if you were able to start your environment. </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No answer needed</span><br></span></code></pre></div></div></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-4-analyzing-active-connections">Task 4 Analyzing Active Connections<a href="#task-4-analyzing-active-connections" class="hash-link" aria-label="Direct link to Task 4 Analyzing Active Connections" title="Direct link to Task 4 Analyzing Active Connections" translate="no">​</a></h2>
<p>In the previous room, we focused on identifying user activity within memory. Now, we shift our attention to network connections established by the suspected malicious actor. We&#x27;ll begin by searching for artifacts in memory that reveal what connections were made and what kind of network activity took place during the intrusion.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="scanning-memory-for-network-evidence">Scanning Memory for Network Evidence<a href="#scanning-memory-for-network-evidence" class="hash-link" aria-label="Direct link to Scanning Memory for Network Evidence" title="Direct link to Scanning Memory for Network Evidence" translate="no">​</a></h3>
<p>Let&#x27;s start by scanning the memory dump with the <strong>Windows.netscan</strong> plugin. This plugin inspects kernel memory pools for evidence of <strong>TCP</strong> and <strong>UDP</strong> socket objects, regardless of whether the connections are still active. It&#x27;s beneficial in cases where the process we are investigating may have terminated or cleaned up connections.</p>
<p>To inspect the network connections, volatility locates the <a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/kernel/eprocess#eprocess" target="_blank" rel="noopener noreferrer" class="">EPROCESS</a> structure to extract PIDs and map these to active <strong>TCP ENDPOINT</strong> or <strong>UDP ENDPOINT</strong> objects (undocumented) found in memory. This approach works even if a connection has already been closed, making it more useful than <strong>netstat</strong> on a live system.</p>
<p>When analysing connections to look for supicious traffic, we should be aware of the following:</p>
<ul>
<li class="">Unusual port activity or outbound connections to unfamiliar addresses</li>
<li class="">Communication with external IPs on non-standard ports</li>
<li class="">Local processes holding multiple sockets</li>
<li class="">PIDs tied to previously identified suspicious binaries</li>
</ul>
<p>Let&#x27;s look for the patterns mentioned above. We&#x27;ll start by running the following command <code>vol -f THM-WIN-001_071528_07052025.mem windows.netscan &gt; netscan.txt</code>, which will save the output in the <code>netscan.txt</code> file as shown below. We can then inspect it using the <code>cat</code> command or any text visualizer.</p>
<p><strong>Note</strong>: This command can take some time to finish, depending on CPU usage and the size of the memory dump. In case you do not want to wait, you can access the same output in the already existing file <strong>netscan-saved.txt</strong>. There are also some other commands that have been pre-saved to save time if needed.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Example Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">user@tryhackme~$ vol </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> THM-WIN-001_071528_07052025.mem windows.netscan </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">  netscan.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">user@tryhackme</span><span class="token variable" style="color:#36acaa">$cat</span><span class="token plain"> netscan.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Offset    Proto    LocalAddr    LocalPort    ForeignAddr    ForeignPort    State    PID    Owner    Created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x990b28ae34c0    UDPv4    </span><span class="token number" style="color:#36acaa">169.254</span><span class="token plain">.106.169    </span><span class="token number" style="color:#36acaa">138</span><span class="token plain">    *    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">    System    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:58.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x990b28bf3230    TCPv4    </span><span class="token number" style="color:#36acaa">169.254</span><span class="token plain">.106.169    </span><span class="token number" style="color:#36acaa">139</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    LISTENING    </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">    System    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:58.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x990b28bf3650    TCPv4    </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0    </span><span class="token number" style="color:#36acaa">4443</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    LISTENING    </span><span class="token number" style="color:#36acaa">10084</span><span class="token plain">    windows-update    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:13:05.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x990b299a81f0    UDPv4    </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1    </span><span class="token number" style="color:#36acaa">1900</span><span class="token plain">    *    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">9496</span><span class="token plain">    svchost.exe    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:09:11.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x990b29ab8010    TCPv4    </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.1.192    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.0.30    </span><span class="token number" style="color:#36acaa">22</span><span class="token plain">    ESTABLISHED    </span><span class="token number" style="color:#36acaa">6984</span><span class="token plain">    powershell.exe    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:15:15.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x990b29ade8a0    TCPv4    </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.1.192    </span><span class="token number" style="color:#36acaa">4443</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">10.0</span><span class="token plain">.0.129    </span><span class="token number" style="color:#36acaa">47982</span><span class="token plain">    ESTABLISHED    </span><span class="token number" style="color:#36acaa">10084</span><span class="token plain">    windows-update    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:13:35.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x990b2a32ca20    TCPv4    </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.1.192    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">10.0</span><span class="token plain">.0.129    </span><span class="token number" style="color:#36acaa">8081</span><span class="token plain">    ESTABLISHED    </span><span class="token number" style="color:#36acaa">10032</span><span class="token plain">    updater.exe    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x990b2a630a20    TCPv6    ::1    </span><span class="token number" style="color:#36acaa">55986</span><span class="token plain">    ::1    </span><span class="token number" style="color:#36acaa">445</span><span class="token plain">    CLOSED    </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">    System    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:14:06.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x990b2a824770    UDPv6    fe80::185b:1837:f9f7:bffd    </span><span class="token number" style="color:#36acaa">49595</span><span class="token plain">    *    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">9496</span><span class="token plain">    svchost.exe    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:09:11.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x990b2a824900    UDPv6    fe80::185b:1837:f9f7:bffd    </span><span class="token number" style="color:#36acaa">1900</span><span class="token plain">    *    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">9496</span><span class="token plain">    svchost.exe    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:09:11.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x990b2a824db0    UDPv6    ::1    </span><span class="token number" style="color:#36acaa">1900</span><span class="token plain">    *    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">9496</span><span class="token plain">    svchost.exe    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:09:11.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<p>We can observe in the output above that some connections are marked as <strong>ESTABLISHED</strong>. We can notice that PID <strong>10032</strong> (<strong>updater.exe</strong>) is connected to IP <strong>10.0.0.129 on port 8081</strong>. That is an external network and suggests it may be the attacker&#x27;s infrastructure. Another connection of interest is from PID <strong>6984</strong> (<strong>powershell.exe</strong>) reaching out to <strong>192.168.0.30:22</strong>, suggesting lateral movement. Also, as we know from previous analysis, the binary windows-update.exe is also part of the chain of execution we are investigating and was placed for persistence purposes in the <code>C:\Users\operator\AppData\Roaming\Microsoft\Windows\StartMenu\Programs\Startup\</code> directory. It is listening on port <strong>4443</strong>, which makes sense to be set up like that since it seems to be the one listening for instructions. Let’s now move on to confirm this and spot which active listening ports are.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Example Terminal</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">user@tryhackme~$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> netscan.txt </span><span class="token operator" style="color:#393A34">|</span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> LISTENING</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x990b236b3310    TCPv4    </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0    </span><span class="token number" style="color:#36acaa">445</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    LISTENING    </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">    System    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:50.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">REDACTED</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x990b27ffee90    TCPv4    </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0    </span><span class="token number" style="color:#36acaa">3389</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    LISTENING    </span><span class="token number" style="color:#36acaa">364</span><span class="token plain">    svchost.exe    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:49.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x990b27ffee90    TCPv6    ::    </span><span class="token number" style="color:#36acaa">3389</span><span class="token plain">    ::    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    LISTENING    </span><span class="token number" style="color:#36acaa">364</span><span class="token plain">    svchost.exe    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:49.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x990b28bf3230    TCPv4    </span><span class="token number" style="color:#36acaa">169.254</span><span class="token plain">.106.169    </span><span class="token number" style="color:#36acaa">139</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    LISTENING    </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">    System    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:58.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x990b28bf3650    TCPv4    </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0    </span><span class="token number" style="color:#36acaa">4443</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    LISTENING    </span><span class="token number" style="color:#36acaa">10084</span><span class="token plain">    windows-update    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:13:05.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x990b28de7e10    TCPv4    </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0    </span><span class="token number" style="color:#36acaa">49671</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    LISTENING    </span><span class="token number" style="color:#36acaa">3020</span><span class="token plain">    svchost.exe    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:51.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x990b28de80d0    TCPv4    </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0    </span><span class="token number" style="color:#36acaa">49671</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    LISTENING    </span><span class="token number" style="color:#36acaa">3020</span><span class="token plain">    svchost.exe    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:51.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x990b28de80d0    TCPv6    ::    </span><span class="token number" style="color:#36acaa">49671</span><span class="token plain">    ::    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    LISTENING    </span><span class="token number" style="color:#36acaa">3020</span><span class="token plain">    svchost.exe    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:51.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x990b28de8390    TCPv4    </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0    </span><span class="token number" style="color:#36acaa">5040</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    LISTENING    </span><span class="token number" style="color:#36acaa">6124</span><span class="token plain">    svchost.exe    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:59.000000 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x990b28de8910    TCPv4    </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.1.192    </span><span class="token number" style="color:#36acaa">139</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0    </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">    LISTENING    </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">    System    </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain">-05-07 07:08:51.000000 UTC</span><br></span></code></pre></div></div>
<p>We can observe several system processes like <strong>svchost.exe</strong> and <strong>lsass.exe</strong> listening on <a href="http://learn.microsoft.com/en-us/troubleshoot/windows-server/networking/service-overview-and-network-port-requirements" target="_blank" rel="noopener noreferrer" class="">common Windows ports</a>. However, we can also confirm that the only non-standard process listening is <strong>windows-update.exe</strong> (<strong>PID 10084</strong>), which is listening on port <strong>4443</strong>.</p>
<p>This seems to be highly irregular. We already know that the process had established a connection with the potential attacker and is accepting inbound connections. This could be for <strong>file staging</strong>, <strong>secondary payloads</strong>, or as we already confirmed, for <strong>persistence</strong>.</p>
<p><strong>Note</strong>: As a sanity check, try also running <strong>windows.netstat</strong>. This plugin relies on live system structures instead of scanning memory, so it may return fewer results, but it is useful to compare what&#x27;s still <strong>active</strong> and also to check the connection&#x27;s order by timestamp.</p>
<p>Great, at this point, we’ve confirmed:</p>
<ul>
<li class=""><strong>updater.exe</strong> (PID <strong>10032</strong>) was in an active session with a known attacker IP using port <strong>8081</strong>.</li>
<li class=""><strong>windows-update.exe</strong> (PID <strong>10084</strong>) had its own established session and was listening on port <strong>4443</strong>.</li>
<li class=""><strong>powershell.exe</strong> (PID <strong>6984</strong>) connected to <strong>192.168.0.30:22</strong>, likely the next internal target.</li>
</ul>
<p>These findings help confirm suspicions of remote control via <strong>C2</strong>, plus lateral movement activity. In the next section, we&#x27;ll explore more into this in order to confirm our findings.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Answer the questions below</div><div class="admonitionContent_BuS1"><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the remote source port number used in the connection between 192.168.1.192 and 10.0.0.129:8081? </summary><div><div class="collapsibleContent_i85q"><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"></code></pre></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Which internal IP address received a connection on port 22 from the compromised host? </summary><div><div class="collapsibleContent_i85q"><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"></code></pre></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the exact timestamp when the connection from the IP addresses in question 1 was established? </summary><div><div class="collapsibleContent_i85q"><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"></code></pre></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the local port used by the system to initiate the SSH connection to 192.168.0.30? </summary><div><div class="collapsibleContent_i85q"><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"></code></pre></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the protocol used in the connection from 192.168.1.192:55985 to 10.0.0.129:8081? </summary><div><div class="collapsibleContent_i85q"><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"></code></pre></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> What is the order in which the potential malicious processes established outbound connections? </summary><div><div class="collapsibleContent_i85q"><pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"></code></pre></div></div></details></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-5-investigating-remote-access-and-c2-communications">Task 5 Investigating Remote Access and C2 Communications<a href="#task-5-investigating-remote-access-and-c2-communications" class="hash-link" aria-label="Direct link to Task 5 Investigating Remote Access and C2 Communications" title="Direct link to Task 5 Investigating Remote Access and C2 Communications" translate="no">​</a></h2>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-6-post-exploitation-communication">Task 6 Post-Exploitation Communication<a href="#task-6-post-exploitation-communication" class="hash-link" aria-label="Direct link to Task 6 Post-Exploitation Communication" title="Direct link to Task 6 Post-Exploitation Communication" translate="no">​</a></h2>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-7-putting-it-all-together">Task 7 Putting it All Together<a href="#task-7-putting-it-all-together" class="hash-link" aria-label="Direct link to Task 7 Putting it All Together" title="Direct link to Task 7 Putting it All Together" translate="no">​</a></h2>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="task-8-conclusion">Task 8 Conclusion<a href="#task-8-conclusion" class="hash-link" aria-label="Direct link to Task 8 Conclusion" title="Direct link to Task 8 Conclusion" translate="no">​</a></h2></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/TryHackMyOffsecBox/TryHackMe-CN/tree/main/packages/create-docusaurus/templates/shared/docs/Modules/Memory Analysis/windowsmemoryandnetwork.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/TryHackMe-CN/en/docs/Modules/Memory Analysis/windowsmemoryanduseractivity"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Windows Memory &amp; User Activity</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/TryHackMe-CN/en/docs/Modules/Microsoft Defender XDR/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Microsoft Defender XDR</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#task-1-introduction" class="table-of-contents__link toc-highlight">Task 1 Introduction</a><ul><li><a href="#learning-objectives" class="table-of-contents__link toc-highlight">Learning Objectives</a></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li></ul></li><li><a href="#task-2-scenario-information" class="table-of-contents__link toc-highlight">Task 2 Scenario Information</a><ul><li><a href="#scenario" class="table-of-contents__link toc-highlight">Scenario</a></li><li><a href="#information-incident-thm-0001" class="table-of-contents__link toc-highlight">Information Incident THM-0001</a></li><li><a href="#company-information-tryhatme" class="table-of-contents__link toc-highlight">Company Information TryHatMe</a></li></ul></li><li><a href="#task-3-environment--setup" class="table-of-contents__link toc-highlight">Task 3 Environment &amp; Setup</a></li><li><a href="#task-4-analyzing-active-connections" class="table-of-contents__link toc-highlight">Task 4 Analyzing Active Connections</a><ul><li><a href="#scanning-memory-for-network-evidence" class="table-of-contents__link toc-highlight">Scanning Memory for Network Evidence</a></li></ul></li><li><a href="#task-5-investigating-remote-access-and-c2-communications" class="table-of-contents__link toc-highlight">Task 5 Investigating Remote Access and C2 Communications</a></li><li><a href="#task-6-post-exploitation-communication" class="table-of-contents__link toc-highlight">Task 6 Post-Exploitation Communication</a></li><li><a href="#task-7-putting-it-all-together" class="table-of-contents__link toc-highlight">Task 7 Putting it All Together</a></li><li><a href="#task-8-conclusion" class="table-of-contents__link toc-highlight">Task 8 Conclusion</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/TryHackMe-CN/en/docs">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/TryHackMyOffsecBox" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github - TryHackMyOffsecBox<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/CRONUS-Security" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github - CRONUS-Security<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 TryHackMyOffsecBox. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>